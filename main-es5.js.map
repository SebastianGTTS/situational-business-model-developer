{"version":3,"mappings":"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","names":["e","webpackEmptyAsyncContext","module","routes","path","redirectTo","pathMatch","canActivate","_database_auth_guard__WEBPACK_IMPORTED_MODULE_3__","component","_start_start_component__WEBPACK_IMPORTED_MODULE_5__","_login_login_component__WEBPACK_IMPORTED_MODULE_2__","_database_login_guard__WEBPACK_IMPORTED_MODULE_4__","_options_options_component__WEBPACK_IMPORTED_MODULE_0__","_tool_explanation_tool_explanation_component__WEBPACK_IMPORTED_MODULE_1__","_page_not_found_page_not_found_component__WEBPACK_IMPORTED_MODULE_6__","AppRoutingModule","_angular_router__WEBPACK_IMPORTED_MODULE_8__","relativeLinkResolution","imports","exports","_angular_core__WEBPACK_IMPORTED_MODULE_19__","AppComponent","authService","bmProcessService","canvasDefinitionService","companyModelService","developmentMethodService","domainService","expertModelService","ngbConfig","pouchdbService","runningProcessService","_environments_app_version__WEBPACK_IMPORTED_MODULE_6__","animation","logout","subscribe","addDefaultData","getList","methods","map","method","_development_process_registry_development_method_development_method__WEBPACK_IMPORTED_MODULE_1__","undefined","out","toDb","forEach","_rev","console","log","processes","process","_development_process_registry_bm_process_bm_process__WEBPACK_IMPORTED_MODULE_0__","_development_process_registry_running_process_running_process__WEBPACK_IMPORTED_MODULE_4__","models","model","_canvas_meta_model_expert_model__WEBPACK_IMPORTED_MODULE_3__","getAll","_canvas_meta_model_company_model__WEBPACK_IMPORTED_MODULE_2__","domain","_development_process_registry_knowledge_domain__WEBPACK_IMPORTED_MODULE_5__","canvasDefinition","_canvas_meta_model_canvas_definition__WEBPACK_IMPORTED_MODULE_8__","isLoggedIn","_environments_environment__WEBPACK_IMPORTED_MODULE_7__","selectors","decls","vars","consts","template","AppModule","bootstrap","_app_component__WEBPACK_IMPORTED_MODULE_0__","_angular_platform_browser__WEBPACK_IMPORTED_MODULE_23__","_database_database_module__WEBPACK_IMPORTED_MODULE_2__","_development_process_registry_development_process_registry_module__WEBPACK_IMPORTED_MODULE_6__","_canvas_meta_model_canvas_meta_model_module__WEBPACK_IMPORTED_MODULE_8__","_whiteboard_meta_model_whiteboard_meta_model_module__WEBPACK_IMPORTED_MODULE_20__","_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_24__","_angular_forms__WEBPACK_IMPORTED_MODULE_25__","ngx_quill__WEBPACK_IMPORTED_MODULE_26__","format","_canvas_canvas_module__WEBPACK_IMPORTED_MODULE_9__","_whiteboard_whiteboard_module__WEBPACK_IMPORTED_MODULE_21__","_development_processes_development_processes_module__WEBPACK_IMPORTED_MODULE_5__","_app_routing_module__WEBPACK_IMPORTED_MODULE_1__","declarations","_navbar_navbar_component__WEBPACK_IMPORTED_MODULE_3__","_options_options_component__WEBPACK_IMPORTED_MODULE_7__","_tool_explanation_tool_explanation_component__WEBPACK_IMPORTED_MODULE_4__","_method_modeler_explanation_method_modeler_explanation_component__WEBPACK_IMPORTED_MODULE_10__","_feature_modeler_explanation_feature_modeler_explanation_component__WEBPACK_IMPORTED_MODULE_11__","_enaction_explanation_enaction_explanation_component__WEBPACK_IMPORTED_MODULE_12__","_login_login_component__WEBPACK_IMPORTED_MODULE_13__","_start_start_component__WEBPACK_IMPORTED_MODULE_14__","_start_business_developer_start_business_developer_component__WEBPACK_IMPORTED_MODULE_15__","_start_method_engineer_start_method_engineer_component__WEBPACK_IMPORTED_MODULE_16__","_change_password_form_change_password_form_component__WEBPACK_IMPORTED_MODULE_17__","_profile_profile_component__WEBPACK_IMPORTED_MODULE_18__","_page_not_found_page_not_found_component__WEBPACK_IMPORTED_MODULE_19__","CanvasDefinitionCell","entry","init","element","isSpacer","id","name","rowspan","colspan","other","CanvasDefinitionService","_canvas_definition__WEBPACK_IMPORTED_MODULE_0__","newRows","get","updateRows","save","dbElement","update","_database_default_element_service__WEBPACK_IMPORTED_MODULE_1__","t","factory","providedIn","CanvasDefinition","typeName","description","relationshipTypes","_a","rows","_b","row","cell","_canvas_definition_cell__WEBPACK_IMPORTED_MODULE_2__","_c","_d","_e","Object","assign","ids","Set","filter","Array","from","has","add","rootFeatures","push","_feature__WEBPACK_IMPORTED_MODULE_0__","_database_database_model__WEBPACK_IMPORTED_MODULE_1__","CanvasMetaModelApiService","router","reference","viewMethod","warn","companyModel","instances","length","resetDatabaseState","createdByMethod","_id","type","_company_model__WEBPACK_IMPORTED_MODULE_0__","_angular_core__WEBPACK_IMPORTED_MODULE_3__","CanvasMetaModelModule","databaseModule","Error","_angular_core__WEBPACK_IMPORTED_MODULE_2__","_canvas_meta_model_service__WEBPACK_IMPORTED_MODULE_0__","_canvas_meta_model_api_service__WEBPACK_IMPORTED_MODULE_1__","provide","useFactory","canvasMetaModelService","deps","multi","CanvasMetaModelService","canvasMetaModelApiService","metaModelService","definition","api","registerMetaModel","view","CanvasModelConsistencyService","featureModel","blocks","feature","every","features","featureIds","iterateFeatures","relationships","getAllReferencedFeatureIds","getRelationshipTypes","some","includes","instance","usedFeatures","featureMap","getFeatureMap","testInstance","_instance__WEBPACK_IMPORTED_MODULE_1__","addFeaturesToPossibleInstances","values","results","checkPossibleInstanceErrors","possibleInstance","result","find","res","problems","min","Math","addFeature","parent","addFeatureToPossibleInstances","getRelationships","subfeatures","subfeature","subfeatureConnections","newInstances","inst","keys","tmpInstance","addFeatureToPossibleInstance","problemFeatureIds","excludedFeature","relatedFeature","instanceId","patterns","i","_conformance_report__WEBPACK_IMPORTED_MODULE_2__","getConformanceMessages","getHints","getPatternHints","errorFeatureIds","warningFeatureIds","strengthFeatureIds","errors","warnings","strengths","checkFeature","selected","selectedSubfeaturesLength","missingRequiredFeatures","getFeature","disallowedFeatures","supportedFeatures","hurtedFeatures","hintFeatureIds","hints","checkHint","isFeatureEasyAddable","f","patternHintFeatureIds","patternHints","usedPatterns","pattern","leafFeatures","usedLeafFeatures","hasMissingFeatures","isPossible","hint","missingFeatures","CompanyModelService","_super","call","definitionId","selector","$definition","put","_feature_model_service__WEBPACK_IMPORTED_MODULE_1__","CompanyModel","expertModelTraces","entries","trace","_trace__WEBPACK_IMPORTED_MODULE_1__","featureIdList","featureList","expertModelTrace","expertModelId","expertModelFeatureId","deleteTrace","addTrace","removeTrace","expertModel","expertFeatureId","companyFeatureId","expertFeature","companyFeature","addTraceRelationship","addRelationship","eF","hasRelationship","cFId","expertFeatureIdMap","relationshipType","relExpertFeatureId","relCompanyFeatureId","getAllSubfeatures","featureTraceToDelete","_feature_model__WEBPACK_IMPORTED_MODULE_0__","ConformanceReport","conformanceReport","ExpertModelService","_expert_model__WEBPACK_IMPORTED_MODULE_0__","domains","updateDomains","addInstance","removeInstance","ExpertModel","_development_process_registry_knowledge_domain__WEBPACK_IMPORTED_MODULE_2__","version","FeatureModelService","elementConstructor","author","updateAuthor","_database_default_element_service__WEBPACK_IMPORTED_MODULE_0__","FeatureModel","nextInstanceId","copyright","_model_author__WEBPACK_IMPORTED_MODULE_1__","_feature__WEBPACK_IMPORTED_MODULE_2__","_instance__WEBPACK_IMPORTED_MODULE_3__","_canvas_definition__WEBPACK_IMPORTED_MODULE_5__","featureId","getFeatureId","addSubfeature","featureName","getFeatureList","removeSubfeature","cleanReferences","removeRelationships","removeFeatures","parentFeatureId","currentFeature","currentParent","newParent","addToFeatureList","levelname","getLevelname","addToFeatureMap","isFeature","fromFeatureId","toFeatureId","fromFeature","removeRelationship","addedInstance","rootFeature","currentInstance","adaptationName","getInstance","removeFeature","func","featureStack","reverse","current","pop","_database_database_model__WEBPACK_IMPORTED_MODULE_0__","FeatureType","SubfeatureConnectionsType","Feature","OPTIONAL","level","_relationships__WEBPACK_IMPORTED_MODULE_0__","subId","innerFeature","_fixId","getFixId","replace","repeat","InstanceArtifactData","instanceArtifactData","InstanceType","Instance","Relationships","list","relationshipLists","relationshipCount","reduce","acc","concat","Trace","_angular_core__WEBPACK_IMPORTED_MODULE_11__","ctx_r0","CompareComponent","canvasResolveService","instanceLoaderService","instanceService","processApiService","loaded","competitors","compareInstance","compare","resolveEditCanvas","stepInfo","modelId","convertExpertInstance","percentages","compareInstances","comment","addComment","runningProcess","runningMethod","executionId","updateComment","commentId","removeComment","isCorrectStep","_instance_loader_service__WEBPACK_IMPORTED_MODULE_1__","_development_process_registry_module_api_process_api_service__WEBPACK_IMPORTED_MODULE_0__","_angular_core__WEBPACK_IMPORTED_MODULE_4__","CreateCanvasConfigurationComponent","fb","featureModelFormService","modalService","loadCompanyModels","createForm","group","modalReference","open","createModal","size","value","predefinedInput","createFeatureModel","forceUpdate","emit","companyModelId","automaticCreation","dismissAll","navigate","queryParams","bmProcessId","bmProcess","stepDecision","companyModels","formGroup","viewQuery","ctx","_angular_core__WEBPACK_IMPORTED_MODULE_8__","CreateCanvasComponent","featureModelInstanceFormService","form","loadCompanyModel","decision","stepDecisions","currentStepNumber","resolveCreateCanvas","_angular_core__WEBPACK_IMPORTED_MODULE_6__","CreateCompetitorCanvasComponent","route","array","routeSubscription","paramMap","unsubscribe","formArray","index","removeAt","controls","control","EditCanvasComponent","canvasModelConsistencyService","conformanceIsChecked","checkConformance","uncheckConformance","conformance","_canvas_meta_model_conformance_report__WEBPACK_IMPORTED_MODULE_0__","checkConformanceOfInstance","_instance_loader_service__WEBPACK_IMPORTED_MODULE_2__","_development_process_registry_module_api_process_api_service__WEBPACK_IMPORTED_MODULE_1__","ctx_r1","EditCompetitorCanvasComponent","newCompetitorId","competitorId","competitor","EditCompetitorsComponent","updateCompanyModel","_angular_core__WEBPACK_IMPORTED_MODULE_9__","EditModelComponent","InstanceLoaderService","changesFeed","getChangesFeed","loadInstance","elementLoaded","_database_element_loader_service__WEBPACK_IMPORTED_MODULE_0__","_angular_core__WEBPACK_IMPORTED_MODULE_15__","RefineCanvasComponent","_canvas_meta_model_conformance_report__WEBPACK_IMPORTED_MODULE_1__","showWarnings","showStrengths","showHints","showPatternHints","showUsedPatterns","loadExpertModels","clearPattern","expertModels","getPatterns","prev","curr","patternInstance","expertModelIds","_angular_core__WEBPACK_IMPORTED_MODULE_1__","SelectCanvasDefinitionConfigurationComponent","loadCanvasDefinitions","canvasDefinitions","_angular_core__WEBPACK_IMPORTED_MODULE_5__","ctx_r5","ViewCanvasComponent","concreteArtifactService","querySubscription","queryParamMap","params","artifact","artifactId","CanvasApiService","input","getStepInfo","inputStepArtifacts","data","methodName","createCanvas","editCanvas","refineCanvas","compareCompetitors","createCompetitors","manageCompetitors","viewCanvas","editModel","step","runningProcessId","_angular_core__WEBPACK_IMPORTED_MODULE_0__","CanvasDefinitionFormComponent","_angular_forms__WEBPACK_IMPORTED_MODULE_1__","changeSubscription","valueChanges","pipe","changed","equalCanvasDefinitions","changes","newCanvasDefinition","currentValue","oldCanvasDefinition","previousValue","loadForm","submitForm","patchValue","canvasDefinitionA","canvasDefinitionB","inputs","outputs","CanvasDefinitionLoaderService","canvasDefinitionId","loadCanvasDefinition","cell_r3","CanvasDefinitionOverviewComponent","canvasDefinitionCells","CanvasDefinitionRelationshipsFormComponent","equals","oldRelationshipTypes","newRelationshipTypes","relationshipTypesA","relationshipTypesB","setControl","_angular_forms__WEBPACK_IMPORTED_MODULE_5__","submitRelationshipTypesForm","CanvasDefinitionRowFormComponent","canvasDefinitionRowFormService","equalCanvasDefinitionRows","canvasDefinitionRows","newCanvasDefinitionRows","oldCanvasDefinitionRows","rowsFormArray","insert","getRow","createCanvasDefinitionCellForm","at","convertCanvasDefinitionCellForm","canvasDefinitionRowsA","canvasDefinitionRowsB","_angular_core__WEBPACK_IMPORTED_MODULE_7__","CanvasDefinitionComponent","canvasDefinitionLoaderService","formSubscription","_canvas_definition_loader_service__WEBPACK_IMPORTED_MODULE_0__","CanvasDefinitionsComponent","listService","nameControl","addCanvasDefinitionForm","reset","modalCanvas","deleteCanvasDefinitionModal","elements","noResults","loading","reloading","_shared_list_service__WEBPACK_IMPORTED_MODULE_1__","useExisting","_canvas_meta_model_canvas_definition_service__WEBPACK_IMPORTED_MODULE_0__","CanvasResolveService","artifactData","getArtifactData","finishExecuteStep","outputArtifactData","_development_process_registry_running_process_artifact_data__WEBPACK_IMPORTED_MODULE_0__","_canvas_meta_model_instance_artifact_data__WEBPACK_IMPORTED_MODULE_1__","_database_auth_guard__WEBPACK_IMPORTED_MODULE_22__","children","_canvas_definition_canvas_definitions_canvas_definitions_component__WEBPACK_IMPORTED_MODULE_12__","_canvas_definition_canvas_definition_canvas_definition_component__WEBPACK_IMPORTED_MODULE_13__","_api_create_canvas_create_canvas_component__WEBPACK_IMPORTED_MODULE_10__","_api_edit_canvas_edit_canvas_component__WEBPACK_IMPORTED_MODULE_11__","_api_refine_canvas_refine_canvas_component__WEBPACK_IMPORTED_MODULE_19__","_api_view_canvas_view_canvas_component__WEBPACK_IMPORTED_MODULE_20__","_api_edit_model_edit_model_component__WEBPACK_IMPORTED_MODULE_21__","_api_create_competitor_canvas_create_competitor_canvas_component__WEBPACK_IMPORTED_MODULE_16__","_api_edit_competitors_edit_competitors_component__WEBPACK_IMPORTED_MODULE_17__","_api_edit_competitor_canvas_edit_competitor_canvas_component__WEBPACK_IMPORTED_MODULE_18__","_api_compare_compare_component__WEBPACK_IMPORTED_MODULE_15__","_company_model_company_models_company_models_component__WEBPACK_IMPORTED_MODULE_8__","_company_model_company_model_company_model_component__WEBPACK_IMPORTED_MODULE_9__","_company_model_company_model_edit_company_model_edit_component__WEBPACK_IMPORTED_MODULE_7__","_company_model_company_model_select_expert_knowledge_company_model_select_expert_knowledge_component__WEBPACK_IMPORTED_MODULE_14__","_expert_model_expert_models_expert_models_component__WEBPACK_IMPORTED_MODULE_2__","_expert_model_expert_model_expert_model_component__WEBPACK_IMPORTED_MODULE_3__","_expert_model_expert_model_edit_expert_model_edit_component__WEBPACK_IMPORTED_MODULE_4__","_instances_example_example_component__WEBPACK_IMPORTED_MODULE_6__","_instances_pattern_pattern_component__WEBPACK_IMPORTED_MODULE_5__","_merge_merge_expert_models_merge_expert_models_component__WEBPACK_IMPORTED_MODULE_0__","_merge_merge_model_view_merge_model_view_component__WEBPACK_IMPORTED_MODULE_1__","_elements_canvas_elements_canvas_elements_component__WEBPACK_IMPORTED_MODULE_23__","CanvasRoutingModule","_angular_router__WEBPACK_IMPORTED_MODULE_25__","CanvasModule","_angular_core__WEBPACK_IMPORTED_MODULE_62__","canvasService","_canvas_service__WEBPACK_IMPORTED_MODULE_1__","_shared_shared_module__WEBPACK_IMPORTED_MODULE_3__","_canvas_routing_module__WEBPACK_IMPORTED_MODULE_0__","_api_compare_compare_component__WEBPACK_IMPORTED_MODULE_45__","_api_create_canvas_create_canvas_component__WEBPACK_IMPORTED_MODULE_38__","_api_create_canvas_configuration_create_canvas_configuration_component__WEBPACK_IMPORTED_MODULE_37__","_api_create_competitor_canvas_create_competitor_canvas_component__WEBPACK_IMPORTED_MODULE_47__","_api_edit_canvas_edit_canvas_component__WEBPACK_IMPORTED_MODULE_39__","_api_edit_competitor_canvas_edit_competitor_canvas_component__WEBPACK_IMPORTED_MODULE_48__","_api_edit_competitors_edit_competitors_component__WEBPACK_IMPORTED_MODULE_49__","_api_edit_model_edit_model_component__WEBPACK_IMPORTED_MODULE_53__","_api_refine_canvas_refine_canvas_component__WEBPACK_IMPORTED_MODULE_50__","_api_select_canvas_definition_configuration_select_canvas_definition_configuration_component__WEBPACK_IMPORTED_MODULE_43__","_api_view_canvas_view_canvas_component__WEBPACK_IMPORTED_MODULE_52__","_canvas_definition_canvas_definition_canvas_definition_component__WEBPACK_IMPORTED_MODULE_41__","_canvas_definition_canvas_definition_form_canvas_definition_form_component__WEBPACK_IMPORTED_MODULE_54__","_canvas_definition_canvas_definition_overview_canvas_definition_overview_component__WEBPACK_IMPORTED_MODULE_58__","_canvas_definition_canvas_definition_relationships_form_canvas_definition_relationships_form_component__WEBPACK_IMPORTED_MODULE_56__","_canvas_definition_canvas_definition_row_form_canvas_definition_row_form_component__WEBPACK_IMPORTED_MODULE_55__","_canvas_definition_canvas_definitions_canvas_definitions_component__WEBPACK_IMPORTED_MODULE_40__","_company_model_company_model_company_model_component__WEBPACK_IMPORTED_MODULE_36__","_company_model_company_model_edit_company_model_edit_component__WEBPACK_IMPORTED_MODULE_34__","_company_model_company_model_select_expert_knowledge_company_model_select_expert_knowledge_component__WEBPACK_IMPORTED_MODULE_44__","_company_model_company_models_company_models_component__WEBPACK_IMPORTED_MODULE_35__","_elements_canvas_elements_canvas_elements_component__WEBPACK_IMPORTED_MODULE_57__","_expert_model_expert_model_expert_model_component__WEBPACK_IMPORTED_MODULE_16__","_expert_model_expert_model_edit_expert_model_edit_component__WEBPACK_IMPORTED_MODULE_20__","_expert_model_expert_models_expert_models_component__WEBPACK_IMPORTED_MODULE_17__","_feature_model_delete_feature_confirm_delete_feature_confirm_component__WEBPACK_IMPORTED_MODULE_12__","_feature_model_feature_building_block_feature_building_block_component__WEBPACK_IMPORTED_MODULE_15__","_feature_model_feature_form_feature_form_component__WEBPACK_IMPORTED_MODULE_13__","_feature_model_feature_model_feature_model_component__WEBPACK_IMPORTED_MODULE_14__","_feature_model_feature_model_edit_feature_model_edit_component__WEBPACK_IMPORTED_MODULE_21__","_feature_model_feature_model_form_feature_model_form_component__WEBPACK_IMPORTED_MODULE_23__","_feature_model_feature_model_subform_feature_model_subform_component__WEBPACK_IMPORTED_MODULE_2__","_feature_model_feature_tree_feature_tree_component__WEBPACK_IMPORTED_MODULE_22__","_feature_model_model_import_view_model_import_view_component__WEBPACK_IMPORTED_MODULE_19__","_feature_model_model_info_box_model_info_box_component__WEBPACK_IMPORTED_MODULE_33__","_feature_model_model_list_model_list_component__WEBPACK_IMPORTED_MODULE_18__","_instances_add_decision_modal_add_decision_modal_component__WEBPACK_IMPORTED_MODULE_28__","_instances_canvas_canvas_component__WEBPACK_IMPORTED_MODULE_42__","_instances_canvas_building_block_canvas_building_block_component__WEBPACK_IMPORTED_MODULE_31__","_instances_delete_decision_modal_delete_decision_modal_component__WEBPACK_IMPORTED_MODULE_27__","_instances_example_example_component__WEBPACK_IMPORTED_MODULE_32__","_instances_feature_model_instance_subform_feature_model_instance_subform_component__WEBPACK_IMPORTED_MODULE_4__","_instances_instance_instance_component__WEBPACK_IMPORTED_MODULE_25__","_instances_instance_compare_form_instance_compare_form_component__WEBPACK_IMPORTED_MODULE_46__","_instances_instance_form_instance_form_component__WEBPACK_IMPORTED_MODULE_30__","_instances_instance_info_box_instance_info_box_component__WEBPACK_IMPORTED_MODULE_29__","_instances_instance_list_instance_list_component__WEBPACK_IMPORTED_MODULE_24__","_instances_instance_select_pattern_form_instance_select_pattern_form_component__WEBPACK_IMPORTED_MODULE_51__","_instances_pattern_pattern_component__WEBPACK_IMPORTED_MODULE_26__","_instances_pattern_description_modal_pattern_description_modal_component__WEBPACK_IMPORTED_MODULE_59__","_instances_pattern_hint_pattern_hint_component__WEBPACK_IMPORTED_MODULE_61__","_instances_pattern_view_pattern_view_component__WEBPACK_IMPORTED_MODULE_60__","_merge_merge_expert_models_merge_expert_models_component__WEBPACK_IMPORTED_MODULE_5__","_merge_merge_into_tree_merge_into_tree_component__WEBPACK_IMPORTED_MODULE_6__","_merge_merge_model_view_merge_model_view_component__WEBPACK_IMPORTED_MODULE_7__","_merge_merge_tree_merge_tree_component__WEBPACK_IMPORTED_MODULE_8__","_merge_trace_modal_trace_modal_component__WEBPACK_IMPORTED_MODULE_9__","_relationships_cross_tree_relationship_form_cross_tree_relationship_form_component__WEBPACK_IMPORTED_MODULE_10__","_relationships_cross_tree_relationship_modal_cross_tree_relationship_modal_component__WEBPACK_IMPORTED_MODULE_11__","CanvasService","canvasApiService","moduleService","_development_process_registry_module_api_module__WEBPACK_IMPORTED_MODULE_0__","addMethods","service","registerModule","registerViewMethod","viewModel","modelReference","referenceType","versionId","self","addMethod","output","_canvas_meta_model_company_model__WEBPACK_IMPORTED_MODULE_1__","configurationFormComponent","_api_select_canvas_definition_configuration_select_canvas_definition_configuration_component__WEBPACK_IMPORTED_MODULE_3__","createConfigurationForm","_angular_forms__WEBPACK_IMPORTED_MODULE_10__","equalPredefinedInput","predefinedInputA","predefinedInputB","decisionConfigurationFormComponent","_api_create_canvas_configuration_create_canvas_configuration_component__WEBPACK_IMPORTED_MODULE_2__","createDecisionConfigurationForm","CompanyModelEditComponent","companyModelLoaderService","_company_model_loader_service__WEBPACK_IMPORTED_MODULE_0__","CompanyModelLoaderService","CompanyModelSelectExpertKnowledgeComponent","mergeService","loadBmProcess","selectExpertModel","selectedExpertModelForm","unselectExpertModel","loadSelectedExpertModels","loadUnselectedExpertModels","getSelectedExpertModels","selectedExpertModelList","getUnselectedExpertModels","unselectedExpertModelList","d","CompanyModelComponent","_angular_forms__WEBPACK_IMPORTED_MODULE_8__","authorInfo","ctx_r6","CompanyModelsComponent","modelList","resetAddForm","featureModelId","modalCompanyModel","deleteCompanyModelModal","_feature_model_model_list_model_list_component__WEBPACK_IMPORTED_MODULE_2__","_canvas_meta_model_company_model_service__WEBPACK_IMPORTED_MODULE_0__","CanvasElementsComponent","ExpertModelEditComponent","expertModelLoaderService","_expert_model_loader_service__WEBPACK_IMPORTED_MODULE_0__","ExpertModelLoaderService","loadExpertModel","_angular_core__WEBPACK_IMPORTED_MODULE_10__","ctx_r13","ctx_r14","ExpertModelComponent","importExportService","toString","exportExpertModel","instanceForm","_canvas_meta_model_instance__WEBPACK_IMPORTED_MODULE_0__","_expert_model_loader_service__WEBPACK_IMPORTED_MODULE_1__","ExpertModelsComponent","modalExpertModel","deleteExpertModelModal","load","_canvas_meta_model_expert_model_service__WEBPACK_IMPORTED_MODULE_0__","DeleteFeatureConfirmComponent","closeModal","deletionResult","FeatureBuildingBlockComponent","buildingBlockName","fl_r3","FeatureFormComponent","submitFeatureForm","featureForm","_canvas_meta_model_feature__WEBPACK_IMPORTED_MODULE_0__","_angular_forms__WEBPACK_IMPORTED_MODULE_2__","subfeatureOf","disable","disabledSubfeatures","enabledSubfeatures","submitButtonText","ctx_r3","FeatureModelEditComponent","modalFeature","checkInstantiationPossible","dependencyModal","modalSubfeatureIds","updateModal","deleteModal","close","updateFeatureModel","updateFeature","relationshipForm","instanceIsPossible","supportsHurtsResult","checkHurtsSupports","supportsHurtsProblems","supportsHurtsProblemFeatureIds","FeatureModelFormComponent","featureModelForm","oldFeatureModel","newFeatureModel","submitFeatureModelForm","featureModelA","featureModelB","FeatureModelSubformComponent","controlContainer","cell_r5","FeatureModelComponent","FeatureTreeComponent","openDependenciesEmitter","openDependencies","updateFeatureEmitter","deleteFeatureEmitter","deleteFeature","styles","ImportExportService","ajv__WEBPACK_IMPORTED_MODULE_0___default","json","Blob","JSON","stringify","file","importJson","_canvas_meta_model_expert_model__WEBPACK_IMPORTED_MODULE_2__","checkFormalConsistency","Promise","resolve","reject","validate","ajv","compile","_assets_schema_beta_json__WEBPACK_IMPORTED_MODULE_3__","fileReader","FileReader","addEventListener","event","parse","target","error","valid","readAsText","ModelImportViewComponent","importError","files","importExpertModel","imported","message","isArray","ajvError","formTitle","ModelInfoBoxComponent","ctx_r15","ctx_r17","ctx_r18","ctx_r19","ModelListComponent","modelForm","addModel","_canvas_meta_model_canvas_definition__WEBPACK_IMPORTED_MODULE_0__","modelListTitle","modelFormTitle","deleteModel","CanvasDefinitionRowFormService","forms","canvasDefinitionCell","removeControl","canvasDefinitionCellForm","spacer","formValue","_canvas_meta_model_canvas_definition_cell__WEBPACK_IMPORTED_MODULE_0__","getCanvasDefinitionCellForm","FeatureModelFormService","_angular_forms__WEBPACK_IMPORTED_MODULE_0__","FeatureModelInstanceFormService","AddDecisionModalComponent","addFeatureForm","addBusinessModelDecision","ctx_r4","CanvasBuildingBlockComponent","addFeatureEmitter","levelDepth","editable","pipes","ctx_r7","ctx_r9","cell_r4","CanvasComponent","conformanceOptions","addFeatureModal","deleteFeatureModal","DeleteDecisionModalComponent","deleteBusinessModelDecision","ctx_r2","ExampleComponent","exampleId","activeId","clearView","initConformanceOptionsForm","example","showPattern","getAdaptionName","adaptInstance","nextId","clearCompare","hideUsedPatterns","selectOtherInstanceForm","enable","selectPatternForm","conformanceOptionsForm","setValue","FeatureModelInstanceSubformComponent","ctx_r10","InstanceCompareFormComponent","featureModelControl","currentExpertModel","currentlyComparing","instanceControl","getExamples","InstanceFormComponent","submitInstanceForm","InstanceInfoBoxComponent","_canvas_meta_model_expert_model__WEBPACK_IMPORTED_MODULE_0__","InstanceListComponent","listTitle","viewInstanceLink","deleteInstance","InstanceSelectPatternFormComponent","showsPattern","InstanceService","currentName","nameSplit","split","isNaN","parseInt","instanceA","instanceB","unshift","outMap","inA","inB","count","agg","expertInstance","ctx_r20","InstanceComponent","addModal","addedFeature","addFeatureToInstance","removeFeatureFromInstance","patternInfo","updateInstance","PatternDescriptionModalComponent","activeModal","dismiss","PatternHintComponent","patternHint","buildMissingFeaturesInfo","missingFeaturesInfo","join","PatternViewComponent","modal","_pattern_description_modal_pattern_description_modal_component__WEBPACK_IMPORTED_MODULE_0__","componentInstance","PatternComponent","patternId","MergeExpertModelsComponent","_angular_forms__WEBPACK_IMPORTED_MODULE_3__","ctx_r21","ctx_r24","ctx_r27","ctx_r31","ctx_r33","ctx_r34","ctx_r35","MergeIntoTreeComponent","state","openPanels","splice","indexOf","openTrace","fl_r39","ctx_r45","ctx_r46","MergeModelViewComponent","bmProcessGiven","paramSubscription","loadModels","all","isFullyMerged","checkIsFullyMerged","companyOpenPanels","fixId","companyFeatureList","openDependenciesModal","modalFeatureModel","modalTracedFeature","traceModal","parentId","companyModelFeatureParentId","mergeModal","addAllModal","selectedIds","modalSelectFeatureForm","selectModal","addFeatureMerge","addAllSubfeaturesMerge","deleteCompanyTrace","deleteExpertTrace","fromId","toId","ctx_r16","ctx_r22","ctx_r25","ctx_r28","ctx_r36","MergeTreeComponent","selectFeature","addAll","MergeService","addExpertModel","removeExpertModel","$in","getRootFeatureIds","rootFeatureIds","definitionIds","$not","newFeature","addExpertModelTrace","TraceModalComponent","tracedFeature","CrossTreeRelationshipFormComponent","submitRelationshipForm","CrossTreeRelationshipModalComponent","toExpertFeatureId","toCompanyFeatureId","addRelationshipOnCompanyModel","loadRelationship","tracedFeatureId","ChangePasswordFormComponent","password","confirm","validators","passwordNotConfirmed","changePassword","passwordControl","passwordForm","AuthGuard","url","createUrlTree","AuthService","AuthErrors","CouchdbAuthService","http","URL","location","origin","href","_username","_group","headers","response","initUser","userCtx","roles","checkAndLogin","username","post","redirect","closeDb","clearUser","newPassword","userUrl","NOT_AUTHENTICATED","user","newUser","passwordChanged","navigateByUrl","getGroup","NOT_ACTIVATED","databaseUrl","checkServerAvailable","available","SERVER_MAINTENANCE","checkDatabaseAvailable","NOT_AVAILABLE","sessionExpired","dbError","loggedIn","expired","role","test","head","status","upUrl","DatabaseModel","getId","String","Date","now","DatabaseModule","_auth_guard__WEBPACK_IMPORTED_MODULE_2__","_login_guard__WEBPACK_IMPORTED_MODULE_6__","_pouchdb_service__WEBPACK_IMPORTED_MODULE_0__","_auth_service__WEBPACK_IMPORTED_MODULE_3__","useClass","_environments_environment__WEBPACK_IMPORTED_MODULE_4__","_local_auth_service__WEBPACK_IMPORTED_MODULE_5__","_couchdb_auth_service__WEBPACK_IMPORTED_MODULE_1__","_angular_common_http__WEBPACK_IMPORTED_MODULE_8__","DefaultElementService","remove","ElementLoaderService","_loaded","rxjs__WEBPACK_IMPORTED_MODULE_0__","_loadedObservable","asObservable","checkUnsubscribeChangesFeed","rxjs__WEBPACK_IMPORTED_MODULE_3__","initParams","_changesFeed","complete","next","getAllDocs","allDocs","exportContent","docs","doc","identifier","content","convertContentToDocs","clearDatabase","importDocs","importContent","LocalAuthService","getDatabaseInfo","info","doc_count","_environments_environment__WEBPACK_IMPORTED_MODULE_0__","LoginGuard","DatabaseErrors","PouchdbService","zone","pouchdb_browser__WEBPACK_IMPORTED_MODULE_0__","pouchdb_find__WEBPACK_IMPORTED_MODULE_1__","db","getDatabase","getDb","MISSING_NAME","INVALID_NAME","_environments_environment__WEBPACK_IMPORTED_MODULE_3__","options","fetch","fetchUrl","fetchOptions","set","skip_setup","handleError","request","_find","$and","subject","rxjs__WEBPACK_IMPORTED_MODULE_5__","since","live","doc_ids","on","run","cancel","bulkDocs","_examples__WEBPACK_IMPORTED_MODULE_2__","toBeDeleted","rev","_deleted","docCount","couchDbResponse","bookmark","nextPage","couchDbNextPage","BmProcessService","_bm_process__WEBPACK_IMPORTED_MODULE_0__","dbProcess","finishInitialization","situationalFactors","selection","_development_method_selection__WEBPACK_IMPORTED_MODULE_4__","_method_elements_situational_factor_situational_factor__WEBPACK_IMPORTED_MODULE_2__","processDiagram","decisions","updateDecisions","provided","checkMatchByFactor","missing","incorrect","low","distance","factor","internalDistance","correct","executionSteps","getModuleMethod","_database_default_element_service__WEBPACK_IMPORTED_MODULE_3__","_development_process_registry_module__WEBPACK_IMPORTED_MODULE_1__","BmProcess","initial","_knowledge_domain__WEBPACK_IMPORTED_MODULE_3__","_method_elements_situational_factor_situational_factor__WEBPACK_IMPORTED_MODULE_1__","elementId","_decision__WEBPACK_IMPORTED_MODULE_2__","_f","_g","_h","_j","factorMap","ordered","stakeholders","inputArtifacts","outputArtifacts","tools","GroupSummary","GroupSelection","databaseConstructor","selectedGroup","groupSelection","createElement","providedByMethod","multiple","summary","part","multipleElements","thisElementGroup","otherElementGroup","Decision","_development_method_development_method__WEBPACK_IMPORTED_MODULE_0__","_method_elements_artifact_artifact__WEBPACK_IMPORTED_MODULE_1__","_method_elements_stakeholder_stakeholder__WEBPACK_IMPORTED_MODULE_2__","_method_elements_tool_tool__WEBPACK_IMPORTED_MODULE_3__","isComplete","ArtifactMapping","pouchDb","DevelopmentMethodService","_development_method__WEBPACK_IMPORTED_MODULE_0__","needed","forbidden","_method_elements_type_type__WEBPACK_IMPORTED_MODULE_2__","types","developmentMethod","isExecutionStepsCorrectlyDefined","executionStep","isExecutionStepCorrectlyDefined","hasInputArtifactForStep","isPredefinedInputDefined","artifactInputs","checkStepInputArtifacts","artifactInput","isStep","DevelopmentMethod","examples","_selection__WEBPACK_IMPORTED_MODULE_10__","_method_elements_type_type__WEBPACK_IMPORTED_MODULE_4__","inputArtifact","_multiple_mapping_selection__WEBPACK_IMPORTED_MODULE_9__","_method_elements_artifact_artifact__WEBPACK_IMPORTED_MODULE_3__","outputArtifact","_multiple_selection__WEBPACK_IMPORTED_MODULE_7__","_k","stakeholder","_method_elements_stakeholder_stakeholder__WEBPACK_IMPORTED_MODULE_5__","_l","_m","tool","_method_elements_tool_tool__WEBPACK_IMPORTED_MODULE_6__","_o","_p","_execution_step__WEBPACK_IMPORTED_MODULE_8__","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_0","_1","_2","_3","_4","artifactDefined","fill","j","outputMappings","mapping","inputGroup","toolGroup","ExecutionStep","mappings","_artifact_mapping__WEBPACK_IMPORTED_MODULE_0__","MultipleMappingSelection","_artifact_mapping__WEBPACK_IMPORTED_MODULE_1__","_multiple_selection__WEBPACK_IMPORTED_MODULE_0__","MultipleSelection","Selection","DevelopmentProcessRegistryModule","developmentProcessRegistryModule","DomainService","_domain__WEBPACK_IMPORTED_MODULE_0__","dbDomain","_database_default_element_service__WEBPACK_IMPORTED_MODULE_2__","Domain","MetaModelService","metaModels","metaModelType","getMetaModelDefinition","metaModelDefinition","_development_process_registry_module__WEBPACK_IMPORTED_MODULE_0__","ArtifactService","_artifact__WEBPACK_IMPORTED_MODULE_1__","_method_element_service__WEBPACK_IMPORTED_MODULE_0__","_development_process_registry_module__WEBPACK_IMPORTED_MODULE_2__","Artifact","internalArtifact","metaModel","_method_element__WEBPACK_IMPORTED_MODULE_0__","MethodElementService","elementListMap","elementLists","listName","currentElement","MethodElement","SituationalFactorDefinition","situationalFactorDefinition","SituationalFactorService","_situational_factor_definition__WEBPACK_IMPORTED_MODULE_0__","_method_element_service__WEBPACK_IMPORTED_MODULE_2__","SituationalFactor","StakeholderService","_stakeholder__WEBPACK_IMPORTED_MODULE_1__","Stakeholder","ToolService","_tool__WEBPACK_IMPORTED_MODULE_1__","Tool","TypeService","_type__WEBPACK_IMPORTED_MODULE_1__","Type","hasType","listNames","l","hasNeeded","hasForbidden","ModuleService","modules","m","moduleListMap","moduleLists","realModule","Module","ProcessApiService","rxjs__WEBPACK_IMPORTED_MODULE_1__","loadProcessInfo","errorLoading","getRunningMethod","ProcessPatternService","_process_pattern__WEBPACK_IMPORTED_MODULE_0__","_method_elements_type_type__WEBPACK_IMPORTED_MODULE_1__","processPattern","dbProcessPattern","ProcessPattern","_method_elements_type_type__WEBPACK_IMPORTED_MODULE_3__","ArtifactDataErrors","ArtifactDataService","_artifact_data__WEBPACK_IMPORTED_MODULE_1__","WRONG_ARTIFACT_TYPE","getMetaModelApi","reason","copy","ArtifactDataType","ArtifactData","STRING","ArtifactVersion","time","createdBy","importName","executedBy","_artifact_data__WEBPACK_IMPORTED_MODULE_0__","Comment","userName","title","ConcreteArtifactService","artifactDataService","_running_artifact__WEBPACK_IMPORTED_MODULE_1__","versions","_artifact_data__WEBPACK_IMPORTED_MODULE_2__","runningArtifact","_artifact_version__WEBPACK_IMPORTED_MODULE_3__","MethodExecutionErrors","MethodExecutionService","addTodoMethod","_running_method__WEBPACK_IMPORTED_MODULE_2__","steps","removeTodoMethod","nodeId","getRunningMethodByNode","ALREADY_EXECUTING","isExecutable","NO_METHOD","addRunningMethodOfProcess","getTodoMethod","NOT_DEFINED","addRunningMethod","inputArtifactMapping","NOT_EXECUTING","artifacts","_step_input_artifact__WEBPACK_IMPORTED_MODULE_3__","versionInfo","number","_isExecutionStepPrepared","hasStepsLeft","NO_STEPS_LEFT","isPrepared","currentStep","getModule","moduleMethod","ALREADY_PREPARED","stepInput","getStepArtifacts","copyStepArtifacts","stepArtifacts","setInternalStepArtifacts","NOT_PREPARED","moduleMethodDefinition","internalStepArtifacts","getInternalStepArtifacts","executeMethod","WRONG_STEP","finishStepExecution","_step_artifact__WEBPACK_IMPORTED_MODULE_0__","STEPS_LEFT","updateOutputArtifacts","outputArtifactsMapping","getProcessOutputArtifacts","getOutputArtifacts","methodOutputArtifacts","addOutputArtifacts","hasOutputArtifactsCorrectlyDefined","MISSING_OUTPUT","removeUnusedArtifacts","addExecutedMethod","comments","removeRunningMethod","getAllStepArtifacts","toRemove","_development_process_registry_module__WEBPACK_IMPORTED_MODULE_4__","OutputArtifactMapping","isDefinition","artifactName","ProcessExecutionModelerService","processModeler","getRunningProcessModeler","importXML","modeler","saveXML","xml","destroy","bpmn_js_lib_Modeler__WEBPACK_IMPORTED_MODULE_2__","additionalModules","moddleExtensions","bmdl","rbmp","node","businessObject","incoming","currentNode","outgoingFlows","outgoing","flow","updateProperties","executed","used","delta","modeling","tokens","getTokens","_development_process_registry_module__WEBPACK_IMPORTED_MODULE_5__","ExecutionErrors","ProcessExecutionService","processExecutionModelerService","initModeling","startNode","getStartNode","updateTokens","endModeling","flowId","getNode","NODE_NOT_FOUND","isCommonNode","INCORRECT_NODE","_moveToNextStep","hasEnoughTokens","NOT_ENOUGH_TOKENS","targetFlows","getTargetFlows","isExclusiveGateway","MULTIPLE_OPTIONS","setExecuted","followFlows","getMinimumNeededTokens","ignoredIds","filterCommonNodes","nodes","_getExecutableNodes","setUsed","targets","getTargetNode","abortModeling","filterNodes","isSubProcess","isParallelGateway","getIncomingFlows","RunningArtifact","_method_elements_artifact_artifact__WEBPACK_IMPORTED_MODULE_0__","_artifact_version__WEBPACK_IMPORTED_MODULE_1__","_database_database_model__WEBPACK_IMPORTED_MODULE_2__","RunningMethod","_comment__WEBPACK_IMPORTED_MODULE_3__","_bm_process_decision__WEBPACK_IMPORTED_MODULE_1__","_step__WEBPACK_IMPORTED_MODULE_0__","_step_input_artifact__WEBPACK_IMPORTED_MODULE_2__","_output_artifact_mapping__WEBPACK_IMPORTED_MODULE_4__","finish","currentDecision","iterateMappings","artifactLength","iterateInputMappings","iterateExecutionStepMappings","artifactInputGroup","summay","RunningProcessService","methodExecutionService","processExecutionService","_running_process__WEBPACK_IMPORTED_MODULE_0__","initRunningProcess","jumpToNextMethod","databaseProcess","moveToNextStep","canExecuteNode","startMethodExecution","startTodoMethodExecution","isExecutionStepPrepared","prepareExecuteStep","executeStep","stopMethodExecution","moveToNextMethod","abortMethodExecution","getExecutableNodes","getExecutableDecisionNodes","executableNodes","selectInputArtifacts","importArtifact","removeMethod","runningMethods","dbComment","getComment","renameArtifact","RunningProcess","_bm_process_bm_process__WEBPACK_IMPORTED_MODULE_0__","todoMethods","_running_method__WEBPACK_IMPORTED_MODULE_3__","executedMethods","_comment__WEBPACK_IMPORTED_MODULE_5__","_running_artifact__WEBPACK_IMPORTED_MODULE_2__","_step__WEBPACK_IMPORTED_MODULE_4__","runningMethodInfo","addVersion","executedMethod","StepArtifact","StepInputArtifact","Step","RunningProcessViewRenderer","eventBus","bpmnRenderer","textRenderer","HIGH_PRIORITY","parentNode","shape","drawShape","createText","box","align","padding","rx","ry","stroke","connection","drawConnection","getShapePath","diagram_js_lib_draw_BaseRenderer__WEBPACK_IMPORTED_MODULE_0__","__webpack_exports__","__depends__","bpmn_js_lib_core__WEBPACK_IMPORTED_MODULE_0__","__init__","runningProcessViewRenderer","_RunningProcessViewRenderer__WEBPACK_IMPORTED_MODULE_1__","DevelopmentProcessViewModule","_angular_common__WEBPACK_IMPORTED_MODULE_6__","_angular_forms__WEBPACK_IMPORTED_MODULE_7__","ngx_quill__WEBPACK_IMPORTED_MODULE_8__","_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_9__","_running_process_viewer_running_process_viewer_component__WEBPACK_IMPORTED_MODULE_0__","_kanban_board_kanban_board_component__WEBPACK_IMPORTED_MODULE_1__","_running_process_kanban_board_running_process_kanban_board_component__WEBPACK_IMPORTED_MODULE_2__","_running_process_method_comments_running_process_method_comments_component__WEBPACK_IMPORTED_MODULE_3__","_running_process_method_comment_form_running_process_method_comment_form_component__WEBPACK_IMPORTED_MODULE_4__","ctx_r23","ctx_r26","ctx_r29","KanbanBoardComponent","showExecutionInfo","showNodeInfo","startExecution","startNodeExecution","todo","doing","done","addTodo","removeTodo","viewNode","viewExecution","viewComments","RunningProcessKanbanBoardComponent","updateBoard","showInfo","todoMethod","getTodoList","getDoingList","getDoneList","getExecutableMethods","slice","RunningProcessMethodCommentFormComponent","userNameControl","userNameChangeSubscription","commentForm","submitCommentForm","RunningProcessMethodCommentsComponent","_development_process_registry_running_process_comment__WEBPACK_IMPORTED_MODULE_0__","getRawValue","modalComment","editCommentModal","RunningProcessViewerComponent","runningProcessViewerService","viewer","getBpmnViewer","firstChange","attachTo","canvas","nativeElement","focusElement","scrollIntoView","behavior","firstLoad","then","resizeView","BpmnViewerService","bbox","viewbox","x","y","width","outer","height","select","adjustRatio","ratio","RunningProcessViewerService","bpmn_js_lib_NavigatedViewer__WEBPACK_IMPORTED_MODULE_0__","_bpmn_extensions_running_process_view__WEBPACK_IMPORTED_MODULE_1__","_bpmn_viewer_service__WEBPACK_IMPORTED_MODULE_4__","ArtifactDefinitionFormComponent","requiredMetaModel","rxjs__WEBPACK_IMPORTED_MODULE_4__","openMetaModelInput","term","metaModelItem","toLowerCase","definitionForm","internalArtifactSubscription","internalArtifactControl","metaModelControl","oldArtifact","newArtifact","artifactA","artifactB","equalsMetaModel","metaModelA","metaModelB","submitArtifactForm","ArtifactComponent","artifactLoaderService","artifactService","methodElement","_shared_method_element_loader_service__WEBPACK_IMPORTED_MODULE_1__","_development_process_registry_method_elements_method_element_service__WEBPACK_IMPORTED_MODULE_2__","_development_process_registry_method_elements_artifact_artifact_service__WEBPACK_IMPORTED_MODULE_0__","ArtifactsGroupInfoComponent","loadMethodElements","methodElements","groups","submitGroupsForm","_r0","ArtifactsSelectionFormComponent","artifactMappingFormService","allowNone","allowNoneSubscription","artifactsForm","oldArtifactGroups","newArtifactGroups","submitArtifactsForm","formArrays","_development_process_registry_development_method_multiple_mapping_selection__WEBPACK_IMPORTED_MODULE_0__","disabled","createMappingsForm","ArtifactsComponent","getLists","modalArtifact","deleteArtifactModal","_angular_core__WEBPACK_IMPORTED_MODULE_12__","ctx_r53","ctx_r11","BmProcessDiagramComponent","bpmnService","processPatternService","getBmProcessModeler","subProcessElement","openDeleteProcessPatternModal","openAddProcessPatternModal","removeMethodFromTask","taskElement","openSelectDevelopmentMethodModal","callActivityElement","openSelectProcessPatternModal","openShowTypesModal","openMethodInfoModal","processPatternElement","openProcessPatternInfoModal","openDevelopmentMethodSummary","checkWarnings","checkArtifacts","createDiagram","startingElement","modalProcessPatterns","modalElement","getValidProcessPatterns","processPatterns","sortByDistance","addProcessPatternModal","appendBpmn","deselect","saveDiagram","showTypesModal","deleteProcessPatternModal","removeDecision","removeProcessPattern","off","getTypesOfActivity","getValidDevelopmentMethods","neededType","forbiddenType","validDevelopmentMethods","selectDevelopmentMethodModal","beforeDismiss","isCorrectlyDefined","_development_method_incomplete_modal_development_method_incomplete_modal_component__WEBPACK_IMPORTED_MODULE_1__","resetSelectDevelopmentMethodModal","addDecision","selectDevelopmentMethodForProcessTask","modalDevelopmentMethod","methodInfoModal","developmentMethodSummaryModal","modalProcessPattern","patternInfoModal","selectProcessPatternModal","insertProcessPatternIntoCallActivity","removeDevelopmentMethodFromProcessTask","isGeneratingWarnings","wantsToGenerateWarnings","lowWarnings","incorrectWarnings","generateWarnings","elementName","factors","_development_process_registry_method_elements_situational_factor_situational_factor__WEBPACK_IMPORTED_MODULE_0__","checkMatch","generateMethodWarnings","generatePatternWarnings","activities","getActivitiesWithMethod","activity","patternElements","getProcessPatterns","dbPatterns","dbPatternsMap","dbPattern","patternElement","saveBmProcess","distanceMap","distanceToContext","sort","elementA","elementB","missingMap","elementRegistry","key","missingArtifacts","unreachableActivities","BmProcessComponent","bmProcessLoaderService","previousInitial","document","body","updateSituationalFactors","saveBmProcessDiagram","diagramComponent","diagramChanged","_bm_process_diagram_bm_process_diagram_component__WEBPACK_IMPORTED_MODULE_0__","_shared_bm_process_loader_service__WEBPACK_IMPORTED_MODULE_1__","ctx_r8","BmProcessesComponent","modalBmProcess","deleteBmProcessModal","bmProcessForm","_development_process_registry_bm_process_bm_process_service__WEBPACK_IMPORTED_MODULE_0__","BmProcessPatternsContextPad","contextPad","registerProvider","className","inherit","action","click","fire","BmProcessPatternsOverrideContextPadProvider","actions","bpmn_js_lib_features_context_pad_ContextPadProvider__WEBPACK_IMPORTED_MODULE_0__","BmProcessPatternsPaletteProvider","actionNames","newActions","bpmn_js_lib_features_palette_PaletteProvider__WEBPACK_IMPORTED_MODULE_0__","BmProcessPatternsReplaceMenuProvider","replaceOptions","allowedTargetTypes","option","eventDefinitionType","bpmn_js_lib_features_popup_menu_ReplaceMenuProvider__WEBPACK_IMPORTED_MODULE_0__","diagram_js_lib_features_context_pad__WEBPACK_IMPORTED_MODULE_4__","bpmn_js_lib_core__WEBPACK_IMPORTED_MODULE_5__","bpmn_js_lib_features_modeling__WEBPACK_IMPORTED_MODULE_6__","bpmn_js_lib_features_palette__WEBPACK_IMPORTED_MODULE_7__","bmProcessPatternsContextPad","_BmProcessPatternsContextPad__WEBPACK_IMPORTED_MODULE_0__","contextPadProvider","_BmProcessPatternsOverrideContextPadProvider__WEBPACK_IMPORTED_MODULE_1__","paletteProvider","_BmProcessPatternsPaletteProvider__WEBPACK_IMPORTED_MODULE_2__","replaceMenuProvider","_BmProcessPatternsReplaceMenuProvider__WEBPACK_IMPORTED_MODULE_3__","BmProcessContextPadProvider","BmProcessLabelEditing","PRIORITY","BmProcessPaletteProvider","BmProcessRuleProvider","addRule","context","currentSource","sourceRef","currentTarget","targetRef","newSource","source","newTarget","shapes","fn","diagram_js_lib_features_rules_RuleProvider__WEBPACK_IMPORTED_MODULE_0__","BmProcessTaskRenderer","checkDecisionStepArtifacts","diagram_js_lib_features_context_pad__WEBPACK_IMPORTED_MODULE_5__","bpmn_js_lib_core__WEBPACK_IMPORTED_MODULE_6__","bpmn_js_lib_features_modeling__WEBPACK_IMPORTED_MODULE_7__","bpmn_js_lib_features_palette__WEBPACK_IMPORTED_MODULE_8__","bmProcessLabelEditing","_BmProcessLabelEditing__WEBPACK_IMPORTED_MODULE_1__","bmProcessRuleProvider","_BmProcessRuleProvider__WEBPACK_IMPORTED_MODULE_3__","_BmProcessContextPadProvider__WEBPACK_IMPORTED_MODULE_0__","dropOnFlowBehavior","_BmProcessPaletteProvider__WEBPACK_IMPORTED_MODULE_2__","taskRenderer","_BmProcessTaskRenderer__WEBPACK_IMPORTED_MODULE_4__","ConcreteArtifactFormComponent","artifactForm","equalArtifacts","ConcreteArtifactComponent","concreteArtifactLoaderService","updateIdentifier","modalVersion","showArtifactVersionModal","_development_process_registry_running_process_artifact_data__WEBPACK_IMPORTED_MODULE_1__","_shared_concrete_artifact_loader_service__WEBPACK_IMPORTED_MODULE_0__","ConcreteArtifactsComponent","_development_process_registry_running_process_concrete_artifact_service__WEBPACK_IMPORTED_MODULE_0__","ConfigurationFormPlaceholderDirective","viewContainerRef","ConfirmLeaveModalComponent","DevelopmentMethodArtifactMappingComponent","artifactMappingService","formGroupDirective","updateSubscriptions","outputChangeSubscription","outputControl","convertMappingForm","executionStepsFormValue","stepControl","updateStepArtifacts","stepChangeSubscription","groupChangeSubscription","groupControl","updateGroupArtifacts","groupNumber","stepNumber","artifactControl","DevelopmentMethodArtifactMappingsComponent","formArrayName","createMappingForm","DevelopmentMethodFormComponent","oldDevelopmentMethod","newDevelopmentMethod","submitDevelopmentMethodForm","DevelopmentMethodIncompleteModalComponent","ctx_r12","output_r13","DevelopmentMethodSelectExecutionStepComponent","componentFactoryResolver","executionStepsFormService","rxjs__WEBPACK_IMPORTED_MODULE_6__","openModuleInput","moduleItem","openMethodInput","methodItem","moduleControl","initMethods","selectedMethod","initConfiguration","moduleChangeSubscription","methodControl","methodChangeSubscription","outputArtifactsControl","clear","clearConfiguration","executionStepMethodChange","calculateInput","toolNames","getAllToolNames","contains","addControl","createPredefinedInputForm","configurationFormComponentFactory","resolveComponentFactory","configurationFormHost","componentRef","createComponent","predefinedInputControl","_configuration_form_placeholder_directive__WEBPACK_IMPORTED_MODULE_1__","control_r3","index_r4","DevelopmentMethodSelectExecutionStepsComponent","executionStepsSelectionForm","equalExecutionSteps","getExecutionSteps","addExecutionStep","removeExecutionStep","submitExecutionStepsSelectionForm","executionStepsA","executionStepsB","stepA","DevelopmentMethodSelectionFormComponent","contextSituationalFactors","selectDevelopmentMethod","DevelopmentMethodSummaryComponent","getSummary","metaModelDefinitions","stepArtifact","viewArtifactReference","_angular_core__WEBPACK_IMPORTED_MODULE_13__","DevelopmentMethodComponent","developmentMethodLoaderService","updateDevelopmentMethodValue","_shared_development_method_loader_service__WEBPACK_IMPORTED_MODULE_0__","item_r2","DevelopmentMethodsSelectionFormComponent","developmentMethods","_shared_search_service__WEBPACK_IMPORTED_MODULE_0__","useValue","DevelopmentMethodsComponent","deleteDevelopmentMethodModal","developmentMethodForm","_development_process_registry_development_method_development_method_service__WEBPACK_IMPORTED_MODULE_0__","_bm_processes_bm_processes_component__WEBPACK_IMPORTED_MODULE_0__","_bm_process_bm_process_component__WEBPACK_IMPORTED_MODULE_1__","canDeactivate","_shared_diagram_change_guard__WEBPACK_IMPORTED_MODULE_6__","_concrete_artifacts_concrete_artifacts_component__WEBPACK_IMPORTED_MODULE_24__","_concrete_artifact_concrete_artifact_component__WEBPACK_IMPORTED_MODULE_25__","_development_methods_development_methods_component__WEBPACK_IMPORTED_MODULE_2__","_development_method_development_method_component__WEBPACK_IMPORTED_MODULE_3__","_process_patterns_process_patterns_component__WEBPACK_IMPORTED_MODULE_4__","_process_pattern_process_pattern_component__WEBPACK_IMPORTED_MODULE_5__","_domains_domains_component__WEBPACK_IMPORTED_MODULE_20__","_domain_domain_component__WEBPACK_IMPORTED_MODULE_21__","_method_elements_method_elements_component__WEBPACK_IMPORTED_MODULE_23__","_artifacts_artifacts_component__WEBPACK_IMPORTED_MODULE_9__","_artifact_artifact_component__WEBPACK_IMPORTED_MODULE_10__","_situational_factors_situational_factors_component__WEBPACK_IMPORTED_MODULE_7__","_situational_factor_situational_factor_component__WEBPACK_IMPORTED_MODULE_8__","_stakeholders_stakeholders_component__WEBPACK_IMPORTED_MODULE_11__","_stakeholder_stakeholder_component__WEBPACK_IMPORTED_MODULE_12__","_tools_tools_component__WEBPACK_IMPORTED_MODULE_13__","_tool_tool_component__WEBPACK_IMPORTED_MODULE_14__","_types_types_component__WEBPACK_IMPORTED_MODULE_15__","_type_type_component__WEBPACK_IMPORTED_MODULE_16__","_running_processes_running_processes_component__WEBPACK_IMPORTED_MODULE_17__","_running_process_running_process_component__WEBPACK_IMPORTED_MODULE_18__","_running_process_method_running_process_method_component__WEBPACK_IMPORTED_MODULE_19__","DevelopmentProcessesRoutingModule","_angular_router__WEBPACK_IMPORTED_MODULE_27__","DevelopmentProcessesModule","_development_processes_routing_module__WEBPACK_IMPORTED_MODULE_6__","_shared_shared_module__WEBPACK_IMPORTED_MODULE_0__","ngx_quill__WEBPACK_IMPORTED_MODULE_76__","_bm_process_diagram_bm_process_diagram_component__WEBPACK_IMPORTED_MODULE_2__","_bm_processes_bm_processes_component__WEBPACK_IMPORTED_MODULE_3__","_development_method_development_method_component__WEBPACK_IMPORTED_MODULE_4__","_development_methods_development_methods_component__WEBPACK_IMPORTED_MODULE_5__","_process_pattern_process_pattern_component__WEBPACK_IMPORTED_MODULE_7__","_process_pattern_diagram_process_pattern_diagram_component__WEBPACK_IMPORTED_MODULE_8__","_process_pattern_types_form_process_pattern_types_form_component__WEBPACK_IMPORTED_MODULE_9__","_process_patterns_process_patterns_component__WEBPACK_IMPORTED_MODULE_10__","_confirm_leave_modal_confirm_leave_modal_component__WEBPACK_IMPORTED_MODULE_11__","_situational_factors_situational_factors_component__WEBPACK_IMPORTED_MODULE_12__","_situational_factor_situational_factor_component__WEBPACK_IMPORTED_MODULE_13__","_method_element_list_method_element_list_component__WEBPACK_IMPORTED_MODULE_14__","_method_element_form_method_element_form_component__WEBPACK_IMPORTED_MODULE_15__","_artifacts_artifacts_component__WEBPACK_IMPORTED_MODULE_16__","_artifact_artifact_component__WEBPACK_IMPORTED_MODULE_17__","_stakeholders_stakeholders_component__WEBPACK_IMPORTED_MODULE_18__","_stakeholder_stakeholder_component__WEBPACK_IMPORTED_MODULE_19__","_tool_tool_component__WEBPACK_IMPORTED_MODULE_20__","_tools_tools_component__WEBPACK_IMPORTED_MODULE_21__","_types_types_component__WEBPACK_IMPORTED_MODULE_22__","_type_type_component__WEBPACK_IMPORTED_MODULE_23__","_method_element_selection_form_method_element_selection_form_component__WEBPACK_IMPORTED_MODULE_24__","_method_elements_selection_form_method_elements_selection_form_component__WEBPACK_IMPORTED_MODULE_25__","_types_selection_form_types_selection_form_component__WEBPACK_IMPORTED_MODULE_26__","_situational_factors_selection_form_situational_factors_selection_form_component__WEBPACK_IMPORTED_MODULE_27__","_situational_factor_selection_form_situational_factor_selection_form_component__WEBPACK_IMPORTED_MODULE_28__","_artifacts_selection_form_artifacts_selection_form_component__WEBPACK_IMPORTED_MODULE_29__","_stakeholders_selection_form_stakeholders_selection_form_component__WEBPACK_IMPORTED_MODULE_30__","_tools_selection_form_tools_selection_form_component__WEBPACK_IMPORTED_MODULE_31__","_examples_form_examples_form_component__WEBPACK_IMPORTED_MODULE_32__","_method_info_method_info_component__WEBPACK_IMPORTED_MODULE_33__","_method_element_group_info_method_element_group_info_component__WEBPACK_IMPORTED_MODULE_34__","_method_element_info_method_element_info_component__WEBPACK_IMPORTED_MODULE_35__","_artifacts_group_info_artifacts_group_info_component__WEBPACK_IMPORTED_MODULE_36__","_stakeholders_group_info_stakeholders_group_info_component__WEBPACK_IMPORTED_MODULE_37__","_situational_factors_overview_situational_factors_overview_component__WEBPACK_IMPORTED_MODULE_38__","_pattern_info_pattern_info_component__WEBPACK_IMPORTED_MODULE_39__","_development_method_selection_form_development_method_selection_form_component__WEBPACK_IMPORTED_MODULE_40__","_development_methods_selection_form_development_methods_selection_form_component__WEBPACK_IMPORTED_MODULE_41__","_process_pattern_selection_form_process_pattern_selection_form_component__WEBPACK_IMPORTED_MODULE_42__","_process_patterns_selection_form_process_patterns_selection_form_component__WEBPACK_IMPORTED_MODULE_43__","_development_method_summary_development_method_summary_component__WEBPACK_IMPORTED_MODULE_44__","_tools_group_info_tools_group_info_component__WEBPACK_IMPORTED_MODULE_45__","_running_process_running_process_component__WEBPACK_IMPORTED_MODULE_46__","_running_processes_running_processes_component__WEBPACK_IMPORTED_MODULE_47__","_running_process_select_output_artifacts_running_process_select_output_artifacts_component__WEBPACK_IMPORTED_MODULE_48__","_running_process_select_input_artifacts_running_process_select_input_artifacts_component__WEBPACK_IMPORTED_MODULE_49__","_development_method_select_execution_steps_development_method_select_execution_steps_component__WEBPACK_IMPORTED_MODULE_50__","_development_method_select_execution_step_development_method_select_execution_step_component__WEBPACK_IMPORTED_MODULE_51__","_development_method_artifact_mapping_development_method_artifact_mapping_component__WEBPACK_IMPORTED_MODULE_52__","_development_method_artifact_mappings_development_method_artifact_mappings_component__WEBPACK_IMPORTED_MODULE_53__","_running_process_method_running_process_method_component__WEBPACK_IMPORTED_MODULE_54__","_configuration_form_placeholder_directive__WEBPACK_IMPORTED_MODULE_55__","_method_info_step_method_info_step_component__WEBPACK_IMPORTED_MODULE_56__","_method_info_steps_method_info_steps_component__WEBPACK_IMPORTED_MODULE_57__","_domain_domain_component__WEBPACK_IMPORTED_MODULE_58__","_domains_domains_component__WEBPACK_IMPORTED_MODULE_59__","_situational_factor_form_situational_factor_form_component__WEBPACK_IMPORTED_MODULE_60__","_artifact_definition_form_artifact_definition_form_component__WEBPACK_IMPORTED_MODULE_61__","_method_elements_method_elements_component__WEBPACK_IMPORTED_MODULE_62__","_concrete_artifacts_concrete_artifacts_component__WEBPACK_IMPORTED_MODULE_63__","_concrete_artifact_concrete_artifact_component__WEBPACK_IMPORTED_MODULE_64__","_running_process_artifact_export_form_running_process_artifact_export_form_component__WEBPACK_IMPORTED_MODULE_65__","_concrete_artifact_form_concrete_artifact_form_component__WEBPACK_IMPORTED_MODULE_66__","_running_process_artifact_import_form_running_process_artifact_import_form_component__WEBPACK_IMPORTED_MODULE_67__","_running_process_artifact_rename_form_running_process_artifact_rename_form_component__WEBPACK_IMPORTED_MODULE_68__","_pipes_multiple_pipe__WEBPACK_IMPORTED_MODULE_69__","_pipes_list_pipe__WEBPACK_IMPORTED_MODULE_70__","_running_process_select_output_artifact_running_process_select_output_artifact_component__WEBPACK_IMPORTED_MODULE_71__","_development_method_incomplete_modal_development_method_incomplete_modal_component__WEBPACK_IMPORTED_MODULE_72__","_development_method_form_development_method_form_component__WEBPACK_IMPORTED_MODULE_73__","_process_pattern_form_process_pattern_form_component__WEBPACK_IMPORTED_MODULE_74__","DomainComponent","domainLoaderService","_shared_domain_loader_service__WEBPACK_IMPORTED_MODULE_0__","DomainsComponent","domainForm","modalDomain","deleteDomainModal","_development_process_registry_knowledge_domain_service__WEBPACK_IMPORTED_MODULE_0__","ExamplesFormComponent","examplesForm","equalExamples","oldExamples","newExamples","submitExamplesForm","formGroups","_angular_forms__WEBPACK_IMPORTED_MODULE_4__","examplesA","examplesB","exampleA","MethodElementFormComponent","openListInput","listItem","methodElementForm","oldMethodElement","newMethodElement","methodElementA","methodElementB","submitMethodElementForm","element_r12","MethodElementGroupInfoComponent","selectedIndexSubscription","selectedGroupControl","generateControls","oldSelection","newSelection","emitEvent","elementsFormArray","methodElementName","ctx_r30","MethodElementInfoComponent","field","openElementInput","MethodElementListComponent","getRouterLink","deleteElement","MethodElementSelectionFormComponent","rxjs__WEBPACK_IMPORTED_MODULE_2__","listControl","listChangeSubscription","elementControl","elementChangeSubscription","multipleAllowed","multipleChangeSubscription","multipleControl","multipleElementsControl","MethodElementsSelectionFormComponent","createFormGroupFactory","bind","methodElementFormTemplate","MethodElementsComponent","MethodInfoStepComponent","contextDomains","_configuration_form_placeholder_directive__WEBPACK_IMPORTED_MODULE_0__","step_r2","MethodInfoStepsComponent","methodInfoStepsFormService","submitStepsForm","getStepDecisions","MethodInfoComponent","PatternInfoComponent","ListPipe","pure","MultiplePipe","ProcessPatternDiagramComponent","getBpmnProcessPatternModeler","businessTask","openManageTypesModal","loadProcessPattern","saveProcessPattern","modalTask","manageTypesModal","typesForm","setTypesOfActivity","ProcessPatternFormComponent","oldProcessPattern","newProcessPattern","submitProcessPatternForm","ProcessPatternSelectionFormComponent","selectProcessPattern","ProcessPatternTypesFormComponent","typeService","loadTypes","submitTypesForm","mapTypeToFormGroup","neededTypesFormGroups","forbiddenTypesFormGroups","ProcessPatternComponent","processPatternLoaderService","_process_pattern_diagram_process_pattern_diagram_component__WEBPACK_IMPORTED_MODULE_0__","_shared_process_pattern_loader_service__WEBPACK_IMPORTED_MODULE_1__","ProcessPatternsSelectionFormComponent","ProcessPatternsComponent","processPatternForm","_development_process_registry_process_pattern_process_pattern_service__WEBPACK_IMPORTED_MODULE_0__","RunningProcessArtifactExportFormComponent","submitArtifactExportForm","RunningProcessArtifactImportFormComponent","loadArtifacts","selectArtifact","searchValue","item","RunningProcessArtifactRenameFormComponent","index_r21","State","RunningProcessMethodComponent","outputArtifactMappingFormService","runningMethodLoaderService","inputArtifactMappingValue","inputArtifactMap","setInputArtifacts","executeMethodStep","jumpSteps","INPUT_SELECTION","EXECUTION","OUTPUT_SELECTION","errorStatus","errorReason","_shared_running_method_loader_service__WEBPACK_IMPORTED_MODULE_0__","RunningProcessSelectInputArtifactsComponent","RunningProcessSelectOutputArtifactComponent","artifactIsDefinitionChangeSubscription","definitionControl","artifactNameControl","setDefaultName","artifactSelectionChangeSubscription","loadData","processArtifacts","dataControl","getName","RunningProcessSelectOutputArtifactsComponent","reload","oldRunningMethod","newRunningMethod","internalOutputArtifacts","outputArtifactsA","outputArtifactsB","mappingA","mappingB","_angular_core__WEBPACK_IMPORTED_MODULE_21__","ctx_r49","ctx_r54","ctx_r59","RunningProcessComponent","runningProcessLoaderService","afterReload","modalArtifactVersion","modalDecision","infoModal","selectMethodModal","modalDevelopmentMethods","_development_process_registry_development_method_development_method__WEBPACK_IMPORTED_MODULE_2__","_development_method_incomplete_modal_development_method_incomplete_modal_component__WEBPACK_IMPORTED_MODULE_6__","_development_process_registry_bm_process_decision__WEBPACK_IMPORTED_MODULE_1__","methodConfigurationModal","updates","selectedFlow","runningProcessViewer","getSelectedFlow","_development_process_registry_running_process_process_execution_service__WEBPACK_IMPORTED_MODULE_3__","focus","multipleOptionsInfoModal","modalRunningMethodInfo","getMethod","commentsModal","artifactExportModal","artifactImportModal","copiedArtifact","artifactRenameModal","_development_process_registry_running_process_artifact_data__WEBPACK_IMPORTED_MODULE_4__","_development_process_view_running_process_viewer_running_process_viewer_component__WEBPACK_IMPORTED_MODULE_0__","_shared_running_process_loader_service__WEBPACK_IMPORTED_MODULE_5__","RunningProcessesComponent","loadProcesses","initForm","addRunningProcessForm","_angular_forms__WEBPACK_IMPORTED_MODULE_6__","processControl","modalRunningProcess","deleteProcessModal","_development_process_registry_running_process_running_process_service__WEBPACK_IMPORTED_MODULE_0__","ArtifactMappingFormService","mappingForm","mappingsForm","getMapping","BmProcessLoaderService","BpmnService","bpmn_js_lib_Modeler__WEBPACK_IMPORTED_MODULE_0__","_bpmn_extensions_bm_process_patterns__WEBPACK_IMPORTED_MODULE_2__","_bpmn_extensions_bm_process__WEBPACK_IMPORTED_MODULE_1__","lastElement","processPatternModeler","operation","BpmnAttachOperation","attach","BpmnRemoveOperation","removeElements","activityId","neededTypes","forbiddenTypes","moddle","mapTypes","$parent","create","BpmnInsertOperation","BpmnCheckArtifacts","_development_process_view_shared_bpmn_viewer_service__WEBPACK_IMPORTED_MODULE_8__","BpmnOperation","currentElementRegistry","currentElementFactory","currentBpmnFactory","currentModdle","currentModeling","oldConnection","flowBusinessObject","$type","waypoints","flowElement","createConnection","label","updateLabel","oldElement","newElement","BpmnAppendOperation","append","appendElementRegistry","calculateOldBoundaries","calculateProcessSize","oldBoundaries","processSize","point","processPoint","processPatternId","bmBusinessObject","bmElement","createShape","isExpanded","subprocess","subProcess","suffix","attachedToRef","translatePoint","waypoint","insertElement","calculateProcessPoint","mid","processName","insertSubProcess","appendNodes","connectNodes","createSpace","createSubProcess","reconnect","copyBpmnData","taskName","innerSubProcesses","getParents","leftRightCheck","checkLeftSpace","checkRightSpace","topBottomCheck","checkTopSpace","checkBottomSpace","completeSpaceCheck","checkCompleteSpace","createLeftSpace","createRightSpace","createTopSpace","createBottomSpace","condition","checkSpace","waypointsToLines","lines","abs","line","xDelta","createSpaceDirection","yDelta","direction","toMove","parents","createActivity","reconnectActivity","removeSubprocess","attachmentElement","appendSubProcess","currentNodes","incomingArtifacts","getIncomingArtifactsUnion","getIncomingArtifactsIntersect","getIncomingArtifacts","visitedNodes","incomingArtifactIds","neededArtifacts","getNeededArtifacts","previousArtifactIds","getCreatedArtifacts","currentArtifactIds","unchanged","getTargets","getDecisionArtifacts","decisionArtifacts","sources","getSources","getArtifacts","others","resultingArtifacts","incomingFlows","ConcreteArtifactLoaderService","loadArtifact","DevelopmentMethodLoaderService","developmentMethodId","loadDevelopmentMethod","DiagramChangeGuard","currentRoute","currentState","nextState","_confirm_leave_modal_confirm_leave_modal_component__WEBPACK_IMPORTED_MODULE_0__","DomainLoaderService","domainId","loadDomain","ExecutionStepsFormService","createExecutionStepForm","executionStepForm","resetMappingTo","removeMappingTo","_development_process_registry_development_method_execution_step__WEBPACK_IMPORTED_MODULE_0__","getMappings","MethodElementLoaderService","methodElementService","methodElementId","loadMethodElement","MethodInfoStepsFormService","createStepDecisionForm","OutputArtifactMappingFormService","createOutputArtifactMappingControl","_development_process_registry_running_process_output_artifact_mapping__WEBPACK_IMPORTED_MODULE_1__","requiredName","requiredArtifact","ProcessPatternLoaderService","RunningMethodLoaderService","loadRunningMethod","_running_process_loader_service__WEBPACK_IMPORTED_MODULE_0__","RunningProcessLoaderService","loadRunningProcess","SituationalFactorFormComponent","situationalFactor","oldSituationalFactor","newSituationalFactor","situationalFactorA","situationalFactorB","valuesFormArray","submitSituationalFactorForm","SituationalFactorSelectionFormComponent","factorControl","factorChangeSubscription","valueControl","preventDefault","_development_process_registry_method_elements_situational_factor_situational_factor_definition__WEBPACK_IMPORTED_MODULE_0__","factorValue","SituationalFactorComponent","situationalFactorLoaderService","situationalFactorService","orderedForm","orderedSubscription","updateSituationalFactorValue","_development_process_registry_method_elements_situational_factor_situational_factor_service__WEBPACK_IMPORTED_MODULE_0__","SituationalFactorsOverviewComponent","createFactorsMap","calculateFactors","getProvidedValue","fulfills","factorsMap","SituationalFactorsSelectionFormComponent","loadFactors","situationalFactorsForm","oldFactors","newFactors","submitSituationalFactorsForm","SituationalFactorsComponent","loadSituationalFactors","modalSituationalFactor","deleteSituationalFactorModal","situationalFactorForm","StakeholderComponent","stakeholderLoaderService","stakeholderService","_development_process_registry_method_elements_stakeholder_stakeholder_service__WEBPACK_IMPORTED_MODULE_0__","StakeholdersGroupInfoComponent","StakeholdersSelectionFormComponent","loadStakeholders","stakeholdersForm","oldStakeholderGroups","newStakeholderGroups","submitStakeholdersForm","StakeholdersComponent","lists","modalStakeholder","deleteStakeholderModal","ToolComponent","toolLoaderService","toolService","_development_process_registry_method_elements_tool_tool_service__WEBPACK_IMPORTED_MODULE_0__","ToolsGroupInfoComponent","ToolsSelectionFormComponent","loadTools","toolsForm","oldToolGroups","newToolGroups","submitToolsForm","_development_process_registry_method_elements_tool_tool__WEBPACK_IMPORTED_MODULE_0__","ToolsComponent","modalTool","deleteToolModal","TypeComponent","typeLoaderService","_development_process_registry_method_elements_type_type_service__WEBPACK_IMPORTED_MODULE_0__","TypesSelectionFormComponent","oldTypes","newTypes","internalTypes","TypesComponent","modalType","deleteTypeModal","EnactionExplanationComponent","tab","carousel","slideEvent","pagination","selectPage","Number","_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_1__","FeatureModelerExplanationComponent","LoginComponent","loginSubscription","login","MethodModelerExplanationComponent","Author","company","email","website","nameToId","currentIdList","startsWith","currentCount","max","substring","NavItem","RootNavItem","NavbarComponent","userService","_user_service__WEBPACK_IMPORTED_MODULE_0__","submenu","roleForm","activatedRole","roleSubscription","OptionsComponent","verify","verifyString","notVerified","passwordChangeError","passwordChangeForbidden","importModal","fileInput","importDatabase","exportDatabase","PageNotFoundComponent","ProfileComponent","ApiNavigationComponent","apiName","ngContentSelectors","AuthorFormComponent","authorForm","oldAuthor","newAuthor","submitAuthorForm","_model_author__WEBPACK_IMPORTED_MODULE_0__","AuthorInfoComponent","DeleteModalComponent","DescriptionFormComponent","descriptionForm","submitDescriptionForm","DomainSelectionFormComponent","openDomainInput","domainDefinitions","formControl","_development_process_registry_knowledge_domain__WEBPACK_IMPORTED_MODULE_0__","index_r3","DomainsSelectionFormComponent","loadDomains","domainsForm","oldDomains","newDomains","domainsFormArray","submitDomainsForm","FormArrayListComponent","position","changePosition","newPosition","ListWrapperComponent","ELEMENT_SERVICE","ListService","elementService","_elements","_reloading","ResultsListItemComponent","viewLink","SEARCH_FUNCTION","searchFunction","SearchService","search","items","_items","searchForm","_filteredResults","searchSubscription","SearchComponent","searchService","filteredResults","heading","itemName","_search_service__WEBPACK_IMPORTED_MODULE_0__","SharedModule","_angular_common__WEBPACK_IMPORTED_MODULE_14__","_development_process_view_development_process_view_module__WEBPACK_IMPORTED_MODULE_3__","_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_15__","_angular_forms__WEBPACK_IMPORTED_MODULE_16__","_angular_router__WEBPACK_IMPORTED_MODULE_17__","_api_navigation_api_navigation_component__WEBPACK_IMPORTED_MODULE_11__","_author_form_author_form_component__WEBPACK_IMPORTED_MODULE_0__","_author_info_author_info_component__WEBPACK_IMPORTED_MODULE_1__","_description_form_description_form_component__WEBPACK_IMPORTED_MODULE_2__","_form_array_list_form_array_list_component__WEBPACK_IMPORTED_MODULE_4__","_domain_selection_form_domain_selection_form_component__WEBPACK_IMPORTED_MODULE_5__","_domains_selection_form_domains_selection_form_component__WEBPACK_IMPORTED_MODULE_6__","_delete_modal_delete_modal_component__WEBPACK_IMPORTED_MODULE_7__","_search_search_component__WEBPACK_IMPORTED_MODULE_8__","_list_wrapper_list_wrapper_component__WEBPACK_IMPORTED_MODULE_9__","_results_list_item_results_list_item_component__WEBPACK_IMPORTED_MODULE_10__","_step_errors_step_errors_component__WEBPACK_IMPORTED_MODULE_12__","StepErrorsComponent","getTypeaheadInputPipe","equalsListOfLists","listsA","listsB","equalsListGeneric","a","b","equalsList","listA","listB","equalsListString","itemB","itemA","StartBusinessDeveloperComponent","StartMethodEngineerComponent","StartComponent","_environments_environment__WEBPACK_IMPORTED_MODULE_1__","ToolExplanationComponent","InternalRoles","UserService","BUSINESSDEVELOPER","CanvasNote","fabric__WEBPACK_IMPORTED_MODULE_0__","initialize","fromObject","text","originX","originY","noteRect","color","shadow","offsetY","selectable","noteTriangle","darkerColor","callSuper","left","top","objects","isAlreadyGrouped","_initEventListeners","mousedblclickHandler","getTextbox","getObjects","setActiveObject","enterEditing","selectAll","handleExitEditing","note","_set","_objects","getRectangle","getTriangle","setFillColor","darker","setStrokeColor","object","callback","enlivenedObjects","WhiteboardCanvasService","canvasElement","whiteboardCanvas","interactive","loadFromJSON","forEachObject","lockMovementX","lockMovementY","lockScalingX","lockScalingY","lockUniScaling","lockRotation","hoverCursor","moveCursor","toJSON","serialization","dispose","getWhiteboardCanvasSerialization","WhiteboardInstanceService","whiteboardCanvasService","_whiteboard_instance__WEBPACK_IMPORTED_MODULE_1__","setReadOnly","whiteboard","WhiteboardInstance","_whiteboard__WEBPACK_IMPORTED_MODULE_0__","WhiteboardMetaModelApiService","whiteboardInstanceService","_whiteboard_instance__WEBPACK_IMPORTED_MODULE_0__","WhiteboardMetaModelModule","whiteboardMetaModelModule","_whiteboard_canvas_service__WEBPACK_IMPORTED_MODULE_3__","_whiteboard_instance_service__WEBPACK_IMPORTED_MODULE_2__","_whiteboard_meta_model_service__WEBPACK_IMPORTED_MODULE_0__","_whiteboard_meta_model_api_service__WEBPACK_IMPORTED_MODULE_1__","WhiteboardMetaModelService","whiteboardMetaModelApiService","whiteboardMetaModelIdentifier","WhiteboardTemplateService","_whiteboard_template__WEBPACK_IMPORTED_MODULE_2__","getEmptyWhiteboardCanvas","_whiteboard_meta_model_module__WEBPACK_IMPORTED_MODULE_0__","WhiteboardTemplate","Whiteboard","CreateWhiteboardInstanceComponent","whiteboardResolveService","whiteboardTemplateService","loadWhiteboardTemplate","whiteboardTemplate","addByTemplate","templateId","EditWhiteboardInstanceComponent","whiteboardInstanceLoaderService","whiteboardChanged","saveWhiteboard","changesSaved","whiteboardInstance","whiteboardCanvasControls","saveWhiteboardCanvas","_whiteboard_canvas_whiteboard_canvas_component__WEBPACK_IMPORTED_MODULE_1__","_shared_whiteboard_instance_loader_service__WEBPACK_IMPORTED_MODULE_2__","SelectWhiteboardTemplateConfigurationComponent","loadWhiteboardTemplates","whiteboardTemplates","ViewWhiteboardInstanceComponent","_shared_whiteboard_instance_loader_service__WEBPACK_IMPORTED_MODULE_0__","ConfirmLeaveWhiteboardModalComponent","WhiteboardChangeGuard","_confirm_leave_whiteboard_modal_confirm_leave_whiteboard_modal_component__WEBPACK_IMPORTED_MODULE_0__","WhiteboardInstanceLoaderService","whiteboardInstanceId","loadWhiteboardInstance","WhiteboardTemplateLoaderService","whiteboardTemplateId","WhiteboardApiService","createWhiteboard","editWhiteboard","viewWhiteboard","WhiteboardCanvasViewComponent","initCanvas","resizeSubscription","window","resize","getReadonlyWhiteboardCanvas","mouseMove","mouseDown","mouseUp","newWidth","canvasWrapper","clientWidth","setWidth","setHeight","setZoom","zoomValue","absolutePointer","moving","lastMousePosition","viewport","viewportTransform","setViewportTransform","noColor","colors","ColorControls","ColorFormService","FILL","colorFormSubscriptions","colorControlControl","updateColorForm","colorControl","setColor","subscription","isDrawingMode","getColorFromValue","freeDrawingBrush","getActiveObjects","colorControlValue","STROKE","firstObject","colorValue","isEditing","selectionStyles","getSelectionStyles","style","canvasNote","setSelectionStyles","renderAll","_color_definition__WEBPACK_IMPORTED_MODULE_0__","colorForm","Controls","ControlFormService","VIEW","colorMenu","fontMenu","propertiesMenu","controlChangeSubscriptions","colorMenuControl","fontMenuControl","propertiesMenuControl","controlsForm","controlControl","PropertiesFormService","propertiesFormSubscriptions","widthControl","strokeWidth","propertiesForm","TextFormService","bold","italic","underline","strikethrough","textFormSubscriptions","boldControl","setBold","italicControl","setItalic","underlineControl","setUnderline","strikethroughControl","setStrikethrough","textForm","setTextStyle","activeObjects","activeObject","WhiteboardCanvasComponent","colorFormService","controlFormService","propertiesFormService","textFormService","controlChangeSubscription","controlChange","getWhiteboardCanvas","_color_definition__WEBPACK_IMPORTED_MODULE_2__","widthControlValue","updateForms","updateTextForm","updatePropertiesForm","controlValue","_control_form_service__WEBPACK_IMPORTED_MODULE_5__","defaultCursor","createNote","adding","distanceFrom","rect","discardActiveObject","colorMenuShown","fontMenuShown","propertiesMenuShown","_color_form_service__WEBPACK_IMPORTED_MODULE_4__","_whiteboard_meta_model_canvas_note__WEBPACK_IMPORTED_MODULE_1__","_properties_form_service__WEBPACK_IMPORTED_MODULE_6__","_text_form_service__WEBPACK_IMPORTED_MODULE_3__","WhiteboardResolveService","placeData","getPlaceData","_whiteboard_meta_model_whiteboard_instance__WEBPACK_IMPORTED_MODULE_1__","_database_auth_guard__WEBPACK_IMPORTED_MODULE_0__","_whiteboard_templates_whiteboard_templates_component__WEBPACK_IMPORTED_MODULE_1__","_whiteboard_template_whiteboard_template_component__WEBPACK_IMPORTED_MODULE_2__","_shared_whiteboard_change_guard__WEBPACK_IMPORTED_MODULE_6__","_api_create_whiteboard_instance_create_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_3__","_api_edit_whiteboard_instance_edit_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_4__","_api_view_whiteboard_instance_view_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_5__","WhiteboardRoutingModule","WhiteboardTemplateComponent","whiteboardTemplateLoaderService","_shared_whiteboard_template_loader_service__WEBPACK_IMPORTED_MODULE_0__","WhiteboardTemplatesComponent","modalWhiteboardTemplate","deleteWhiteboardTemplateModal","whiteboardTemplateForm","getWhiteboardTemplateInitialization","_shared_list_service__WEBPACK_IMPORTED_MODULE_0__","_whiteboard_meta_model_whiteboard_template_service__WEBPACK_IMPORTED_MODULE_1__","WhiteboardModule","whiteboardService","_whiteboard_service__WEBPACK_IMPORTED_MODULE_7__","_shared_shared_module__WEBPACK_IMPORTED_MODULE_1__","_whiteboard_routing_module__WEBPACK_IMPORTED_MODULE_0__","_whiteboard_canvas_whiteboard_canvas_component__WEBPACK_IMPORTED_MODULE_2__","_whiteboard_templates_whiteboard_templates_component__WEBPACK_IMPORTED_MODULE_3__","_whiteboard_template_whiteboard_template_component__WEBPACK_IMPORTED_MODULE_4__","_api_create_whiteboard_instance_create_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_5__","_api_select_whiteboard_template_configuration_select_whiteboard_template_configuration_component__WEBPACK_IMPORTED_MODULE_6__","_api_edit_whiteboard_instance_edit_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_8__","_whiteboard_canvas_view_whiteboard_canvas_view_component__WEBPACK_IMPORTED_MODULE_9__","_api_view_whiteboard_instance_view_whiteboard_instance_component__WEBPACK_IMPORTED_MODULE_10__","_confirm_leave_whiteboard_modal_confirm_leave_whiteboard_modal_component__WEBPACK_IMPORTED_MODULE_11__","WhiteboardService","whiteboardApiService","whiteboardMetaModelService","viewWhiteboardInstance","_api_select_whiteboard_template_configuration_select_whiteboard_template_configuration_component__WEBPACK_IMPORTED_MODULE_1__","environment","production","localDatabase","exampleData","_db_json__WEBPACK_IMPORTED_MODULE_0__","_angular_platform_browser__WEBPACK_IMPORTED_MODULE_3__","bootstrapModule","_app_app_module__WEBPACK_IMPORTED_MODULE_0__","err"],"sources":["webpack:///$_lazy_route_resources|lazy|groupOptions:%20%7B%7D|namespace%20object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/app/canvas-meta-model/canvas-definition-cell.ts","webpack:///src/app/canvas-meta-model/canvas-definition.service.ts","webpack:///src/app/canvas-meta-model/canvas-definition.ts","webpack:///src/app/canvas-meta-model/canvas-meta-model-api.service.ts","webpack:///src/app/canvas-meta-model/canvas-meta-model.module.ts","webpack:///src/app/canvas-meta-model/canvas-meta-model.service.ts","webpack:///src/app/canvas-meta-model/canvas-model-consistency.service.ts","webpack:///src/app/canvas-meta-model/company-model.service.ts","webpack:///src/app/canvas-meta-model/company-model.ts","webpack:///src/app/canvas-meta-model/conformance-report.ts","webpack:///src/app/canvas-meta-model/expert-model.service.ts","webpack:///src/app/canvas-meta-model/expert-model.ts","webpack:///src/app/canvas-meta-model/feature-model.service.ts","webpack:///src/app/canvas-meta-model/feature-model.ts","webpack:///src/app/canvas-meta-model/feature.ts","webpack:///src/app/canvas-meta-model/instance-artifact-data.ts","webpack:///src/app/canvas-meta-model/instance.ts","webpack:///src/app/canvas-meta-model/relationships.ts","webpack:///src/app/canvas-meta-model/trace.ts","webpack:///src/app/canvas/api/compare/compare.component.html","webpack:///src/app/canvas/api/compare/compare.component.ts","webpack:///src/app/canvas/api/create-canvas-configuration/create-canvas-configuration.component.html","webpack:///src/app/canvas/api/create-canvas-configuration/create-canvas-configuration.component.ts","webpack:///src/app/canvas/api/create-canvas/create-canvas.component.html","webpack:///src/app/canvas/api/create-canvas/create-canvas.component.ts","webpack:///src/app/canvas/api/create-competitor-canvas/create-competitor-canvas.component.html","webpack:///src/app/canvas/api/create-competitor-canvas/create-competitor-canvas.component.ts","webpack:///src/app/canvas/api/edit-canvas/edit-canvas.component.html","webpack:///src/app/canvas/api/edit-canvas/edit-canvas.component.ts","webpack:///src/app/canvas/api/edit-competitor-canvas/edit-competitor-canvas.component.html","webpack:///src/app/canvas/api/edit-competitor-canvas/edit-competitor-canvas.component.ts","webpack:///src/app/canvas/api/edit-competitors/edit-competitors.component.html","webpack:///src/app/canvas/api/edit-competitors/edit-competitors.component.ts","webpack:///src/app/canvas/api/edit-model/edit-model.component.html","webpack:///src/app/canvas/api/edit-model/edit-model.component.ts","webpack:///src/app/canvas/api/instance-loader.service.ts","webpack:///src/app/canvas/api/refine-canvas/refine-canvas.component.html","webpack:///src/app/canvas/api/refine-canvas/refine-canvas.component.ts","webpack:///src/app/canvas/api/select-canvas-definition-configuration/select-canvas-definition-configuration.component.html","webpack:///src/app/canvas/api/select-canvas-definition-configuration/select-canvas-definition-configuration.component.ts","webpack:///src/app/canvas/api/view-canvas/view-canvas.component.html","webpack:///src/app/canvas/api/view-canvas/view-canvas.component.ts","webpack:///src/app/canvas/canvas-api.service.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition-form/canvas-definition-form.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definition-form/canvas-definition-form.component.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition-loader.service.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition-overview/canvas-definition-overview.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definition-overview/canvas-definition-overview.component.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition-relationships-form/canvas-definition-relationships-form.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definition-relationships-form/canvas-definition-relationships-form.component.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition-row-form/canvas-definition-row-form.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definition-row-form/canvas-definition-row-form.component.ts","webpack:///src/app/canvas/canvas-definition/canvas-definition/canvas-definition.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definition/canvas-definition.component.ts","webpack:///src/app/canvas/canvas-definition/canvas-definitions/canvas-definitions.component.html","webpack:///src/app/canvas/canvas-definition/canvas-definitions/canvas-definitions.component.ts","webpack:///src/app/canvas/canvas-resolve.service.ts","webpack:///src/app/canvas/canvas-routing.module.ts","webpack:///src/app/canvas/canvas.module.ts","webpack:///src/app/canvas/canvas.service.ts","webpack:///src/app/canvas/company-model/company-model-edit/company-model-edit.component.html","webpack:///src/app/canvas/company-model/company-model-edit/company-model-edit.component.ts","webpack:///src/app/canvas/company-model/company-model-loader.service.ts","webpack:///src/app/canvas/company-model/company-model-select-expert-knowledge/company-model-select-expert-knowledge.component.html","webpack:///src/app/canvas/company-model/company-model-select-expert-knowledge/company-model-select-expert-knowledge.component.ts","webpack:///src/app/canvas/company-model/company-model/company-model.component.html","webpack:///src/app/canvas/company-model/company-model/company-model.component.ts","webpack:///src/app/canvas/company-model/company-models/company-models.component.html","webpack:///src/app/canvas/company-model/company-models/company-models.component.ts","webpack:///src/app/canvas/elements/canvas-elements/canvas-elements.component.ts","webpack:///src/app/canvas/elements/canvas-elements/canvas-elements.component.html","webpack:///src/app/canvas/expert-model/expert-model-edit/expert-model-edit.component.html","webpack:///src/app/canvas/expert-model/expert-model-edit/expert-model-edit.component.ts","webpack:///src/app/canvas/expert-model/expert-model-loader.service.ts","webpack:///src/app/canvas/expert-model/expert-model/expert-model.component.html","webpack:///src/app/canvas/expert-model/expert-model/expert-model.component.ts","webpack:///src/app/canvas/expert-model/expert-models/expert-models.component.html","webpack:///src/app/canvas/expert-model/expert-models/expert-models.component.ts","webpack:///src/app/canvas/feature-model/delete-feature-confirm/delete-feature-confirm.component.ts","webpack:///src/app/canvas/feature-model/delete-feature-confirm/delete-feature-confirm.component.html","webpack:///src/app/canvas/feature-model/feature-building-block/feature-building-block.component.html","webpack:///src/app/canvas/feature-model/feature-building-block/feature-building-block.component.ts","webpack:///src/app/canvas/feature-model/feature-form/feature-form.component.html","webpack:///src/app/canvas/feature-model/feature-form/feature-form.component.ts","webpack:///src/app/canvas/feature-model/feature-model-edit/feature-model-edit.component.html","webpack:///src/app/canvas/feature-model/feature-model-edit/feature-model-edit.component.ts","webpack:///src/app/canvas/feature-model/feature-model-form/feature-model-form.component.html","webpack:///src/app/canvas/feature-model/feature-model-form/feature-model-form.component.ts","webpack:///src/app/canvas/feature-model/feature-model-subform/feature-model-subform.component.ts","webpack:///src/app/canvas/feature-model/feature-model-subform/feature-model-subform.component.html","webpack:///src/app/canvas/feature-model/feature-model/feature-model.component.html","webpack:///src/app/canvas/feature-model/feature-model/feature-model.component.ts","webpack:///src/app/canvas/feature-model/feature-tree/feature-tree.component.html","webpack:///src/app/canvas/feature-model/feature-tree/feature-tree.component.ts","webpack:///src/app/canvas/feature-model/import-export.service.ts","webpack:///src/app/canvas/feature-model/model-import-view/model-import-view.component.ts","webpack:///src/app/canvas/feature-model/model-import-view/model-import-view.component.html","webpack:///src/app/canvas/feature-model/model-info-box/model-info-box.component.html","webpack:///src/app/canvas/feature-model/model-info-box/model-info-box.component.ts","webpack:///src/app/canvas/feature-model/model-list/model-list.component.html","webpack:///src/app/canvas/feature-model/model-list/model-list.component.ts","webpack:///src/app/canvas/form-services/canvas-definition-row-form.service.ts","webpack:///src/app/canvas/form-services/feature-model-form.service.ts","webpack:///src/app/canvas/form-services/feature-model-instance-form.service.ts","webpack:///src/app/canvas/instances/add-decision-modal/add-decision-modal.component.html","webpack:///src/app/canvas/instances/add-decision-modal/add-decision-modal.component.ts","webpack:///src/app/canvas/instances/canvas-building-block/canvas-building-block.component.html","webpack:///src/app/canvas/instances/canvas-building-block/canvas-building-block.component.ts","webpack:///src/app/canvas/instances/canvas/canvas.component.html","webpack:///src/app/canvas/instances/canvas/canvas.component.ts","webpack:///src/app/canvas/instances/delete-decision-modal/delete-decision-modal.component.ts","webpack:///src/app/canvas/instances/delete-decision-modal/delete-decision-modal.component.html","webpack:///src/app/canvas/instances/example/example.component.html","webpack:///src/app/canvas/instances/example/example.component.ts","webpack:///src/app/canvas/instances/feature-model-instance-subform/feature-model-instance-subform.component.ts","webpack:///src/app/canvas/instances/feature-model-instance-subform/feature-model-instance-subform.component.html","webpack:///src/app/canvas/instances/instance-compare-form/instance-compare-form.component.html","webpack:///src/app/canvas/instances/instance-compare-form/instance-compare-form.component.ts","webpack:///src/app/canvas/instances/instance-form/instance-form.component.ts","webpack:///src/app/canvas/instances/instance-form/instance-form.component.html","webpack:///src/app/canvas/instances/instance-info-box/instance-info-box.component.html","webpack:///src/app/canvas/instances/instance-info-box/instance-info-box.component.ts","webpack:///src/app/canvas/instances/instance-list/instance-list.component.html","webpack:///src/app/canvas/instances/instance-list/instance-list.component.ts","webpack:///src/app/canvas/instances/instance-select-pattern-form/instance-select-pattern-form.component.html","webpack:///src/app/canvas/instances/instance-select-pattern-form/instance-select-pattern-form.component.ts","webpack:///src/app/canvas/instances/instance.service.ts","webpack:///src/app/canvas/instances/instance/instance.component.html","webpack:///src/app/canvas/instances/instance/instance.component.ts","webpack:///src/app/canvas/instances/pattern-description-modal/pattern-description-modal.component.ts","webpack:///src/app/canvas/instances/pattern-description-modal/pattern-description-modal.component.html","webpack:///src/app/canvas/instances/pattern-hint/pattern-hint.component.ts","webpack:///src/app/canvas/instances/pattern-hint/pattern-hint.component.html","webpack:///src/app/canvas/instances/pattern-view/pattern-view.component.ts","webpack:///src/app/canvas/instances/pattern-view/pattern-view.component.html","webpack:///src/app/canvas/instances/pattern/pattern.component.html","webpack:///src/app/canvas/instances/pattern/pattern.component.ts","webpack:///src/app/canvas/merge/merge-expert-models/merge-expert-models.component.html","webpack:///src/app/canvas/merge/merge-expert-models/merge-expert-models.component.ts","webpack:///src/app/canvas/merge/merge-into-tree/merge-into-tree.component.html","webpack:///src/app/canvas/merge/merge-into-tree/merge-into-tree.component.ts","webpack:///src/app/canvas/merge/merge-model-view/merge-model-view.component.html","webpack:///src/app/canvas/merge/merge-model-view/merge-model-view.component.ts","webpack:///src/app/canvas/merge/merge-tree/merge-tree.component.html","webpack:///src/app/canvas/merge/merge-tree/merge-tree.component.ts","webpack:///src/app/canvas/merge/merge.service.ts","webpack:///src/app/canvas/merge/trace-modal/trace-modal.component.html","webpack:///src/app/canvas/merge/trace-modal/trace-modal.component.ts","webpack:///src/app/canvas/relationships/cross-tree-relationship-form/cross-tree-relationship-form.component.html","webpack:///src/app/canvas/relationships/cross-tree-relationship-form/cross-tree-relationship-form.component.ts","webpack:///src/app/canvas/relationships/cross-tree-relationship-modal/cross-tree-relationship-modal.component.html","webpack:///src/app/canvas/relationships/cross-tree-relationship-modal/cross-tree-relationship-modal.component.ts","webpack:///src/app/change-password-form/change-password-form.component.html","webpack:///src/app/change-password-form/change-password-form.component.ts","webpack:///src/app/database/auth.guard.ts","webpack:///src/app/database/auth.service.ts","webpack:///src/app/database/couchdb-auth.service.ts","webpack:///src/app/database/database-model.ts","webpack:///src/app/database/database.module.ts","webpack:///src/app/database/default-element.service.ts","webpack:///src/app/database/element-loader.service.ts","webpack:///src/app/database/import-export.service.ts","webpack:///src/app/database/local-auth.service.ts","webpack:///src/app/database/login.guard.ts","webpack:///src/app/database/pouchdb.service.ts","webpack:///src/app/development-process-registry/bm-process/bm-process.service.ts","webpack:///src/app/development-process-registry/bm-process/bm-process.ts","webpack:///src/app/development-process-registry/bm-process/decision.ts","webpack:///src/app/development-process-registry/development-method/artifact-mapping.ts","webpack:///src/app/development-process-registry/development-method/development-method.service.ts","webpack:///src/app/development-process-registry/development-method/development-method.ts","webpack:///src/app/development-process-registry/development-method/execution-step.ts","webpack:///src/app/development-process-registry/development-method/multiple-mapping-selection.ts","webpack:///src/app/development-process-registry/development-method/multiple-selection.ts","webpack:///src/app/development-process-registry/development-method/selection.ts","webpack:///src/app/development-process-registry/development-process-registry.module.ts","webpack:///src/app/development-process-registry/knowledge/domain.service.ts","webpack:///src/app/development-process-registry/knowledge/domain.ts","webpack:///src/app/development-process-registry/meta-model.service.ts","webpack:///src/app/development-process-registry/method-elements/artifact/artifact.service.ts","webpack:///src/app/development-process-registry/method-elements/artifact/artifact.ts","webpack:///src/app/development-process-registry/method-elements/method-element.service.ts","webpack:///src/app/development-process-registry/method-elements/method-element.ts","webpack:///src/app/development-process-registry/method-elements/situational-factor/situational-factor-definition.ts","webpack:///src/app/development-process-registry/method-elements/situational-factor/situational-factor.service.ts","webpack:///src/app/development-process-registry/method-elements/situational-factor/situational-factor.ts","webpack:///src/app/development-process-registry/method-elements/stakeholder/stakeholder.service.ts","webpack:///src/app/development-process-registry/method-elements/stakeholder/stakeholder.ts","webpack:///src/app/development-process-registry/method-elements/tool/tool.service.ts","webpack:///src/app/development-process-registry/method-elements/tool/tool.ts","webpack:///src/app/development-process-registry/method-elements/type/type.service.ts","webpack:///src/app/development-process-registry/method-elements/type/type.ts","webpack:///src/app/development-process-registry/module-api/module.service.ts","webpack:///src/app/development-process-registry/module-api/module.ts","webpack:///src/app/development-process-registry/module-api/process-api.service.ts","webpack:///src/app/development-process-registry/process-pattern/process-pattern.service.ts","webpack:///src/app/development-process-registry/process-pattern/process-pattern.ts","webpack:///src/app/development-process-registry/running-process/artifact-data.service.ts","webpack:///src/app/development-process-registry/running-process/artifact-data.ts","webpack:///src/app/development-process-registry/running-process/artifact-version.ts","webpack:///src/app/development-process-registry/running-process/comment.ts","webpack:///src/app/development-process-registry/running-process/concrete-artifact.service.ts","webpack:///src/app/development-process-registry/running-process/method-execution.service.ts","webpack:///src/app/development-process-registry/running-process/output-artifact-mapping.ts","webpack:///src/app/development-process-registry/running-process/process-execution-modeler.service.ts","webpack:///src/app/development-process-registry/running-process/process-execution.service.ts","webpack:///src/app/development-process-registry/running-process/running-artifact.ts","webpack:///src/app/development-process-registry/running-process/running-method.ts","webpack:///src/app/development-process-registry/running-process/running-process.service.ts","webpack:///src/app/development-process-registry/running-process/running-process.ts","webpack:///src/app/development-process-registry/running-process/step-artifact.ts","webpack:///src/app/development-process-registry/running-process/step-input-artifact.ts","webpack:///src/app/development-process-registry/running-process/step.ts","webpack:///src/app/development-process-view/bpmn-extensions/running-process-view/RunningProcessViewRenderer.ts","webpack:///src/app/development-process-view/bpmn-extensions/running-process-view/index.ts","webpack:///src/app/development-process-view/development-process-view.module.ts","webpack:///src/app/development-process-view/kanban-board/kanban-board.component.html","webpack:///src/app/development-process-view/kanban-board/kanban-board.component.ts","webpack:///src/app/development-process-view/running-process-kanban-board/running-process-kanban-board.component.ts","webpack:///src/app/development-process-view/running-process-kanban-board/running-process-kanban-board.component.html","webpack:///src/app/development-process-view/running-process-method-comment-form/running-process-method-comment-form.component.html","webpack:///src/app/development-process-view/running-process-method-comment-form/running-process-method-comment-form.component.ts","webpack:///src/app/development-process-view/running-process-method-comments/running-process-method-comments.component.html","webpack:///src/app/development-process-view/running-process-method-comments/running-process-method-comments.component.ts","webpack:///src/app/development-process-view/running-process-viewer/running-process-viewer.component.ts","webpack:///src/app/development-process-view/running-process-viewer/running-process-viewer.component.html","webpack:///src/app/development-process-view/shared/bpmn-viewer.service.ts","webpack:///src/app/development-process-view/shared/running-process-viewer.service.ts","webpack:///src/app/development-processes/artifact-definition-form/artifact-definition-form.component.html","webpack:///src/app/development-processes/artifact-definition-form/artifact-definition-form.component.ts","webpack:///src/app/development-processes/artifact/artifact.component.html","webpack:///src/app/development-processes/artifact/artifact.component.ts","webpack:///src/app/development-processes/artifacts-group-info/artifacts-group-info.component.ts","webpack:///src/app/development-processes/artifacts-group-info/artifacts-group-info.component.html","webpack:///src/app/development-processes/artifacts-selection-form/artifacts-selection-form.component.html","webpack:///src/app/development-processes/artifacts-selection-form/artifacts-selection-form.component.ts","webpack:///src/app/development-processes/artifacts/artifacts.component.html","webpack:///src/app/development-processes/artifacts/artifacts.component.ts","webpack:///src/app/development-processes/bm-process-diagram/bm-process-diagram.component.html","webpack:///src/app/development-processes/bm-process-diagram/bm-process-diagram.component.ts","webpack:///src/app/development-processes/bm-process/bm-process.component.html","webpack:///src/app/development-processes/bm-process/bm-process.component.ts","webpack:///src/app/development-processes/bm-processes/bm-processes.component.html","webpack:///src/app/development-processes/bm-processes/bm-processes.component.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process-patterns/BmProcessPatternsContextPad.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process-patterns/BmProcessPatternsOverrideContextPadProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process-patterns/BmProcessPatternsPaletteProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process-patterns/BmProcessPatternsReplaceMenuProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process-patterns/index.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/BmProcessContextPadProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/BmProcessLabelEditing.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/BmProcessPaletteProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/BmProcessRuleProvider.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/BmProcessTaskRenderer.ts","webpack:///src/app/development-processes/bpmn-extensions/bm-process/index.ts","webpack:///src/app/development-processes/concrete-artifact-form/concrete-artifact-form.component.html","webpack:///src/app/development-processes/concrete-artifact-form/concrete-artifact-form.component.ts","webpack:///src/app/development-processes/concrete-artifact/concrete-artifact.component.html","webpack:///src/app/development-processes/concrete-artifact/concrete-artifact.component.ts","webpack:///src/app/development-processes/concrete-artifacts/concrete-artifacts.component.html","webpack:///src/app/development-processes/concrete-artifacts/concrete-artifacts.component.ts","webpack:///src/app/development-processes/configuration-form-placeholder.directive.ts","webpack:///src/app/development-processes/confirm-leave-modal/confirm-leave-modal.component.ts","webpack:///src/app/development-processes/confirm-leave-modal/confirm-leave-modal.component.html","webpack:///src/app/development-processes/development-method-artifact-mapping/development-method-artifact-mapping.component.html","webpack:///src/app/development-processes/development-method-artifact-mapping/development-method-artifact-mapping.component.ts","webpack:///src/app/development-processes/development-method-artifact-mappings/development-method-artifact-mappings.component.html","webpack:///src/app/development-processes/development-method-artifact-mappings/development-method-artifact-mappings.component.ts","webpack:///src/app/development-processes/development-method-form/development-method-form.component.html","webpack:///src/app/development-processes/development-method-form/development-method-form.component.ts","webpack:///src/app/development-processes/development-method-incomplete-modal/development-method-incomplete-modal.component.html","webpack:///src/app/development-processes/development-method-incomplete-modal/development-method-incomplete-modal.component.ts","webpack:///src/app/development-processes/development-method-select-execution-step/development-method-select-execution-step.component.html","webpack:///src/app/development-processes/development-method-select-execution-step/development-method-select-execution-step.component.ts","webpack:///src/app/development-processes/development-method-select-execution-steps/development-method-select-execution-steps.component.html","webpack:///src/app/development-processes/development-method-select-execution-steps/development-method-select-execution-steps.component.ts","webpack:///src/app/development-processes/development-method-selection-form/development-method-selection-form.component.html","webpack:///src/app/development-processes/development-method-selection-form/development-method-selection-form.component.ts","webpack:///src/app/development-processes/development-method-summary/development-method-summary.component.html","webpack:///src/app/development-processes/development-method-summary/development-method-summary.component.ts","webpack:///src/app/development-processes/development-method/development-method.component.html","webpack:///src/app/development-processes/development-method/development-method.component.ts","webpack:///src/app/development-processes/development-methods-selection-form/development-methods-selection-form.component.html","webpack:///src/app/development-processes/development-methods-selection-form/development-methods-selection-form.component.ts","webpack:///src/app/development-processes/development-methods/development-methods.component.html","webpack:///src/app/development-processes/development-methods/development-methods.component.ts","webpack:///src/app/development-processes/development-processes-routing.module.ts","webpack:///src/app/development-processes/development-processes.module.ts","webpack:///src/app/development-processes/domain/domain.component.html","webpack:///src/app/development-processes/domain/domain.component.ts","webpack:///src/app/development-processes/domains/domains.component.html","webpack:///src/app/development-processes/domains/domains.component.ts","webpack:///src/app/development-processes/examples-form/examples-form.component.html","webpack:///src/app/development-processes/examples-form/examples-form.component.ts","webpack:///src/app/development-processes/method-element-form/method-element-form.component.html","webpack:///src/app/development-processes/method-element-form/method-element-form.component.ts","webpack:///src/app/development-processes/method-element-group-info/method-element-group-info.component.html","webpack:///src/app/development-processes/method-element-group-info/method-element-group-info.component.ts","webpack:///src/app/development-processes/method-element-info/method-element-info.component.html","webpack:///src/app/development-processes/method-element-info/method-element-info.component.ts","webpack:///src/app/development-processes/method-element-list/method-element-list.component.html","webpack:///src/app/development-processes/method-element-list/method-element-list.component.ts","webpack:///src/app/development-processes/method-element-selection-form/method-element-selection-form.component.html","webpack:///src/app/development-processes/method-element-selection-form/method-element-selection-form.component.ts","webpack:///src/app/development-processes/method-elements-selection-form/method-elements-selection-form.component.html","webpack:///src/app/development-processes/method-elements-selection-form/method-elements-selection-form.component.ts","webpack:///src/app/development-processes/method-elements/method-elements.component.html","webpack:///src/app/development-processes/method-elements/method-elements.component.ts","webpack:///src/app/development-processes/method-info-step/method-info-step.component.ts","webpack:///src/app/development-processes/method-info-step/method-info-step.component.html","webpack:///src/app/development-processes/method-info-steps/method-info-steps.component.html","webpack:///src/app/development-processes/method-info-steps/method-info-steps.component.ts","webpack:///src/app/development-processes/method-info/method-info.component.html","webpack:///src/app/development-processes/method-info/method-info.component.ts","webpack:///src/app/development-processes/pattern-info/pattern-info.component.html","webpack:///src/app/development-processes/pattern-info/pattern-info.component.ts","webpack:///src/app/development-processes/pipes/list.pipe.ts","webpack:///src/app/development-processes/pipes/multiple.pipe.ts","webpack:///src/app/development-processes/process-pattern-diagram/process-pattern-diagram.component.html","webpack:///src/app/development-processes/process-pattern-diagram/process-pattern-diagram.component.ts","webpack:///src/app/development-processes/process-pattern-form/process-pattern-form.component.html","webpack:///src/app/development-processes/process-pattern-form/process-pattern-form.component.ts","webpack:///src/app/development-processes/process-pattern-selection-form/process-pattern-selection-form.component.html","webpack:///src/app/development-processes/process-pattern-selection-form/process-pattern-selection-form.component.ts","webpack:///src/app/development-processes/process-pattern-types-form/process-pattern-types-form.component.html","webpack:///src/app/development-processes/process-pattern-types-form/process-pattern-types-form.component.ts","webpack:///src/app/development-processes/process-pattern/process-pattern.component.html","webpack:///src/app/development-processes/process-pattern/process-pattern.component.ts","webpack:///src/app/development-processes/process-patterns-selection-form/process-patterns-selection-form.component.html","webpack:///src/app/development-processes/process-patterns-selection-form/process-patterns-selection-form.component.ts","webpack:///src/app/development-processes/process-patterns/process-patterns.component.html","webpack:///src/app/development-processes/process-patterns/process-patterns.component.ts","webpack:///src/app/development-processes/running-process-artifact-export-form/running-process-artifact-export-form.component.ts","webpack:///src/app/development-processes/running-process-artifact-export-form/running-process-artifact-export-form.component.html","webpack:///src/app/development-processes/running-process-artifact-import-form/running-process-artifact-import-form.component.html","webpack:///src/app/development-processes/running-process-artifact-import-form/running-process-artifact-import-form.component.ts","webpack:///src/app/development-processes/running-process-artifact-rename-form/running-process-artifact-rename-form.component.ts","webpack:///src/app/development-processes/running-process-artifact-rename-form/running-process-artifact-rename-form.component.html","webpack:///src/app/development-processes/running-process-method/running-process-method.component.html","webpack:///src/app/development-processes/running-process-method/running-process-method.component.ts","webpack:///src/app/development-processes/running-process-select-input-artifacts/running-process-select-input-artifacts.component.html","webpack:///src/app/development-processes/running-process-select-input-artifacts/running-process-select-input-artifacts.component.ts","webpack:///src/app/development-processes/running-process-select-output-artifact/running-process-select-output-artifact.component.html","webpack:///src/app/development-processes/running-process-select-output-artifact/running-process-select-output-artifact.component.ts","webpack:///src/app/development-processes/running-process-select-output-artifacts/running-process-select-output-artifacts.component.html","webpack:///src/app/development-processes/running-process-select-output-artifacts/running-process-select-output-artifacts.component.ts","webpack:///src/app/development-processes/running-process/running-process.component.html","webpack:///src/app/development-processes/running-process/running-process.component.ts","webpack:///src/app/development-processes/running-processes/running-processes.component.html","webpack:///src/app/development-processes/running-processes/running-processes.component.ts","webpack:///src/app/development-processes/shared/artifact-mapping-form.service.ts","webpack:///src/app/development-processes/shared/bm-process-loader.service.ts","webpack:///src/app/development-processes/shared/bpmn.service.ts","webpack:///src/app/development-processes/shared/concrete-artifact-loader.service.ts","webpack:///src/app/development-processes/shared/development-method-loader.service.ts","webpack:///src/app/development-processes/shared/diagram-change.guard.ts","webpack:///src/app/development-processes/shared/domain-loader.service.ts","webpack:///src/app/development-processes/shared/execution-steps-form.service.ts","webpack:///src/app/development-processes/shared/method-element-loader.service.ts","webpack:///src/app/development-processes/shared/method-info-steps-form.service.ts","webpack:///src/app/development-processes/shared/output-artifact-mapping-form.service.ts","webpack:///src/app/development-processes/shared/process-pattern-loader.service.ts","webpack:///src/app/development-processes/shared/running-method-loader.service.ts","webpack:///src/app/development-processes/shared/running-process-loader.service.ts","webpack:///src/app/development-processes/situational-factor-form/situational-factor-form.component.html","webpack:///src/app/development-processes/situational-factor-form/situational-factor-form.component.ts","webpack:///src/app/development-processes/situational-factor-selection-form/situational-factor-selection-form.component.html","webpack:///src/app/development-processes/situational-factor-selection-form/situational-factor-selection-form.component.ts","webpack:///src/app/development-processes/situational-factor/situational-factor.component.html","webpack:///src/app/development-processes/situational-factor/situational-factor.component.ts","webpack:///src/app/development-processes/situational-factors-overview/situational-factors-overview.component.html","webpack:///src/app/development-processes/situational-factors-overview/situational-factors-overview.component.ts","webpack:///src/app/development-processes/situational-factors-selection-form/situational-factors-selection-form.component.html","webpack:///src/app/development-processes/situational-factors-selection-form/situational-factors-selection-form.component.ts","webpack:///src/app/development-processes/situational-factors/situational-factors.component.html","webpack:///src/app/development-processes/situational-factors/situational-factors.component.ts","webpack:///src/app/development-processes/stakeholder/stakeholder.component.html","webpack:///src/app/development-processes/stakeholder/stakeholder.component.ts","webpack:///src/app/development-processes/stakeholders-group-info/stakeholders-group-info.component.ts","webpack:///src/app/development-processes/stakeholders-group-info/stakeholders-group-info.component.html","webpack:///src/app/development-processes/stakeholders-selection-form/stakeholders-selection-form.component.html","webpack:///src/app/development-processes/stakeholders-selection-form/stakeholders-selection-form.component.ts","webpack:///src/app/development-processes/stakeholders/stakeholders.component.html","webpack:///src/app/development-processes/stakeholders/stakeholders.component.ts","webpack:///src/app/development-processes/tool/tool.component.html","webpack:///src/app/development-processes/tool/tool.component.ts","webpack:///src/app/development-processes/tools-group-info/tools-group-info.component.ts","webpack:///src/app/development-processes/tools-group-info/tools-group-info.component.html","webpack:///src/app/development-processes/tools-selection-form/tools-selection-form.component.html","webpack:///src/app/development-processes/tools-selection-form/tools-selection-form.component.ts","webpack:///src/app/development-processes/tools/tools.component.html","webpack:///src/app/development-processes/tools/tools.component.ts","webpack:///src/app/development-processes/type/type.component.html","webpack:///src/app/development-processes/type/type.component.ts","webpack:///src/app/development-processes/types-selection-form/types-selection-form.component.html","webpack:///src/app/development-processes/types-selection-form/types-selection-form.component.ts","webpack:///src/app/development-processes/types/types.component.html","webpack:///src/app/development-processes/types/types.component.ts","webpack:///src/app/enaction-explanation/enaction-explanation.component.html","webpack:///src/app/enaction-explanation/enaction-explanation.component.ts","webpack:///src/app/feature-modeler-explanation/feature-modeler-explanation.component.html","webpack:///src/app/feature-modeler-explanation/feature-modeler-explanation.component.ts","webpack:///src/app/login/login.component.html","webpack:///src/app/login/login.component.ts","webpack:///src/app/method-modeler-explanation/method-modeler-explanation.component.html","webpack:///src/app/method-modeler-explanation/method-modeler-explanation.component.ts","webpack:///src/app/model/author.ts","webpack:///src/app/model/utils.ts","webpack:///src/app/navbar/navbar.component.html","webpack:///src/app/navbar/navbar.component.ts","webpack:///src/app/options/options.component.html","webpack:///src/app/options/options.component.ts","webpack:///src/app/page-not-found/page-not-found.component.ts","webpack:///src/app/page-not-found/page-not-found.component.html","webpack:///src/app/profile/profile.component.html","webpack:///src/app/profile/profile.component.ts","webpack:///src/app/shared/api-navigation/api-navigation.component.html","webpack:///src/app/shared/api-navigation/api-navigation.component.ts","webpack:///src/app/shared/author-form/author-form.component.html","webpack:///src/app/shared/author-form/author-form.component.ts","webpack:///src/app/shared/author-info/author-info.component.html","webpack:///src/app/shared/author-info/author-info.component.ts","webpack:///src/app/shared/delete-modal/delete-modal.component.ts","webpack:///src/app/shared/delete-modal/delete-modal.component.html","webpack:///src/app/shared/description-form/description-form.component.html","webpack:///src/app/shared/description-form/description-form.component.ts","webpack:///src/app/shared/domain-selection-form/domain-selection-form.component.ts","webpack:///src/app/shared/domain-selection-form/domain-selection-form.component.html","webpack:///src/app/shared/domains-selection-form/domains-selection-form.component.html","webpack:///src/app/shared/domains-selection-form/domains-selection-form.component.ts","webpack:///src/app/shared/form-array-list/form-array-list.component.html","webpack:///src/app/shared/form-array-list/form-array-list.component.ts","webpack:///src/app/shared/list-wrapper/list-wrapper.component.html","webpack:///src/app/shared/list-wrapper/list-wrapper.component.ts","webpack:///src/app/shared/list.service.ts","webpack:///src/app/shared/results-list-item/results-list-item.component.ts","webpack:///src/app/shared/results-list-item/results-list-item.component.html","webpack:///src/app/shared/search.service.ts","webpack:///src/app/shared/search/search.component.html","webpack:///src/app/shared/search/search.component.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/shared/step-errors/step-errors.component.html","webpack:///src/app/shared/step-errors/step-errors.component.ts","webpack:///src/app/shared/utils.ts","webpack:///src/app/start-business-developer/start-business-developer.component.ts","webpack:///src/app/start-business-developer/start-business-developer.component.html","webpack:///src/app/start-method-engineer/start-method-engineer.component.ts","webpack:///src/app/start-method-engineer/start-method-engineer.component.html","webpack:///src/app/start/start.component.html","webpack:///src/app/start/start.component.ts","webpack:///src/app/tool-explanation/tool-explanation.component.html","webpack:///src/app/tool-explanation/tool-explanation.component.ts","webpack:///src/app/user.service.ts","webpack:///src/app/whiteboard-meta-model/canvas-note.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-canvas.service.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-instance.service.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-instance.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-meta-model-api.service.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-meta-model.module.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-meta-model.service.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-template.service.ts","webpack:///src/app/whiteboard-meta-model/whiteboard-template.ts","webpack:///src/app/whiteboard-meta-model/whiteboard.ts","webpack:///src/app/whiteboard/api/create-whiteboard-instance/create-whiteboard-instance.component.html","webpack:///src/app/whiteboard/api/create-whiteboard-instance/create-whiteboard-instance.component.ts","webpack:///src/app/whiteboard/api/edit-whiteboard-instance/edit-whiteboard-instance.component.html","webpack:///src/app/whiteboard/api/edit-whiteboard-instance/edit-whiteboard-instance.component.ts","webpack:///src/app/whiteboard/api/select-whiteboard-template-configuration/select-whiteboard-template-configuration.component.html","webpack:///src/app/whiteboard/api/select-whiteboard-template-configuration/select-whiteboard-template-configuration.component.ts","webpack:///src/app/whiteboard/api/view-whiteboard-instance/view-whiteboard-instance.component.html","webpack:///src/app/whiteboard/api/view-whiteboard-instance/view-whiteboard-instance.component.ts","webpack:///src/app/whiteboard/confirm-leave-whiteboard-modal/confirm-leave-whiteboard-modal.component.ts","webpack:///src/app/whiteboard/confirm-leave-whiteboard-modal/confirm-leave-whiteboard-modal.component.html","webpack:///src/app/whiteboard/shared/whiteboard-change.guard.ts","webpack:///src/app/whiteboard/shared/whiteboard-instance-loader.service.ts","webpack:///src/app/whiteboard/shared/whiteboard-template-loader.service.ts","webpack:///src/app/whiteboard/whiteboard-api.service.ts","webpack:///src/app/whiteboard/whiteboard-canvas-view/whiteboard-canvas-view.component.ts","webpack:///src/app/whiteboard/whiteboard-canvas-view/whiteboard-canvas-view.component.html","webpack:///src/app/whiteboard/whiteboard-canvas/color-definition.ts","webpack:///src/app/whiteboard/whiteboard-canvas/color-form.service.ts","webpack:///src/app/whiteboard/whiteboard-canvas/control-form.service.ts","webpack:///src/app/whiteboard/whiteboard-canvas/properties-form.service.ts","webpack:///src/app/whiteboard/whiteboard-canvas/text-form.service.ts","webpack:///src/app/whiteboard/whiteboard-canvas/whiteboard-canvas.component.html","webpack:///src/app/whiteboard/whiteboard-canvas/whiteboard-canvas.component.ts","webpack:///src/app/whiteboard/whiteboard-resolve.service.ts","webpack:///src/app/whiteboard/whiteboard-routing.module.ts","webpack:///src/app/whiteboard/whiteboard-template/whiteboard-template.component.html","webpack:///src/app/whiteboard/whiteboard-template/whiteboard-template.component.ts","webpack:///src/app/whiteboard/whiteboard-templates/whiteboard-templates.component.html","webpack:///src/app/whiteboard/whiteboard-templates/whiteboard-templates.component.ts","webpack:///src/app/whiteboard/whiteboard.module.ts","webpack:///src/app/whiteboard/whiteboard.service.ts","webpack:///src/environments/app.version.ts","webpack:///src/environments/environment.ts","webpack:///src/examples/index.ts","webpack:///src/main.ts","webpack:///ignored|C:\\Users\\sebastian\\Documents\\canvas-modeler\\node_modules\\fabric\\dist|jsdom","webpack:///ignored|C:\\Users\\sebastian\\Documents\\canvas-modeler\\node_modules\\fabric\\dist|jsdom/lib/jsdom/living/generated/utils","webpack:///ignored|C:\\Users\\sebastian\\Documents\\canvas-modeler\\node_modules\\fabric\\dist|jsdom/lib/jsdom/utils","webpack:///ignored|C:\\Users\\sebastian\\Documents\\canvas-modeler\\node_modules\\immediate\\lib|./nextTick"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 98255;\nmodule.exports = webpackEmptyAsyncContext;","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { OptionsComponent } from './options/options.component';\r\nimport { ToolExplanationComponent } from './tool-explanation/tool-explanation.component';\r\nimport { LoginComponent } from './login/login.component';\r\nimport { AuthGuard } from './database/auth.guard';\r\nimport { LoginGuard } from './database/login.guard';\r\nimport { StartComponent } from './start/start.component';\r\nimport { PageNotFoundComponent } from './page-not-found/page-not-found.component';\r\n\r\n// Routing for the Feature Modeler\r\nconst routes: Routes = [\r\n  { path: '', redirectTo: '/start', pathMatch: 'full' },\r\n  {\r\n    path: 'start',\r\n    canActivate: [AuthGuard],\r\n    component: StartComponent,\r\n  },\r\n  { path: 'login', component: LoginComponent, canActivate: [LoginGuard] },\r\n  { path: 'options', component: OptionsComponent, canActivate: [AuthGuard] },\r\n  {\r\n    path: 'explanation',\r\n    component: ToolExplanationComponent,\r\n    canActivate: [AuthGuard],\r\n  },\r\n  { path: '**', component: PageNotFoundComponent },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' })],\r\n  exports: [RouterModule],\r\n})\r\nexport class AppRoutingModule {}\r\n","<app-navbar *ngIf=\"showNavbar\"></app-navbar>\r\n\r\n<div id=\"wrapper\" class=\"min-vh-100 d-flex flex-column align-content-center\">\r\n  <div class=\"flex-1\">\r\n    <router-outlet></router-outlet>\r\n  </div>\r\n\r\n  <footer\r\n    *ngIf=\"showNavbar\"\r\n    class=\"\r\n      text-muted\r\n      container\r\n      text-center\r\n      mb-3\r\n      d-flex\r\n      align-items-baseline\r\n      justify-content-center\r\n    \"\r\n  >\r\n    <button\r\n      *ngIf=\"!isLocalDatabase()\"\r\n      type=\"button\"\r\n      class=\"btn btn-link\"\r\n      (click)=\"logout()\"\r\n    >\r\n      Logout\r\n    </button>\r\n    <div *ngIf=\"!isLocalDatabase()\">&ndash;</div>\r\n    <a\r\n      class=\"btn btn-link\"\r\n      routerLinkActive=\"active\"\r\n      [routerLink]=\"['/', 'options']\"\r\n      >Options</a\r\n    >\r\n    <div>&ndash;</div>\r\n    <div class=\"btn btn-link\" routerLinkActive=\"active\" [routerLink]=\"['/']\">\r\n      SBMD v{{ VERSION }}\r\n    </div>\r\n  </footer>\r\n</div>\r\n","import { Component } from '@angular/core';\r\nimport { BmProcessService } from './development-process-registry/bm-process/bm-process.service';\r\nimport { BmProcess } from './development-process-registry/bm-process/bm-process';\r\nimport { DevelopmentMethodService } from './development-process-registry/development-method/development-method.service';\r\nimport { DevelopmentMethod } from './development-process-registry/development-method/development-method';\r\nimport { CompanyModelService } from './canvas-meta-model/company-model.service';\r\nimport { CompanyModel } from './canvas-meta-model/company-model';\r\nimport { ExpertModelService } from './canvas-meta-model/expert-model.service';\r\nimport { ExpertModel } from './canvas-meta-model/expert-model';\r\nimport { RunningProcessService } from './development-process-registry/running-process/running-process.service';\r\nimport { RunningProcess } from './development-process-registry/running-process/running-process';\r\nimport { DomainService } from './development-process-registry/knowledge/domain.service';\r\nimport { Domain } from './development-process-registry/knowledge/domain';\r\nimport { NgbConfig } from '@ng-bootstrap/ng-bootstrap';\r\nimport { PouchdbService } from './database/pouchdb.service';\r\nimport { AuthService } from './database/auth.service';\r\nimport { version } from '../environments/app.version';\r\nimport { environment } from '../environments/environment';\r\nimport { CanvasDefinitionService } from './canvas-meta-model/canvas-definition.service';\r\nimport { CanvasDefinition } from './canvas-meta-model/canvas-definition';\r\nimport { DatabaseMeta } from './database/database-entry';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.css'],\r\n})\r\nexport class AppComponent {\r\n  VERSION = version;\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private bmProcessService: BmProcessService,\r\n    private canvasDefinitionService: CanvasDefinitionService,\r\n    private companyModelService: CompanyModelService,\r\n    private developmentMethodService: DevelopmentMethodService,\r\n    private domainService: DomainService,\r\n    private expertModelService: ExpertModelService,\r\n    ngbConfig: NgbConfig,\r\n    private pouchdbService: PouchdbService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {\r\n    ngbConfig.animation = false;\r\n  }\r\n\r\n  logout(): void {\r\n    this.authService.logout().subscribe();\r\n  }\r\n\r\n  async addDefaultData(): Promise<void> {\r\n    await this.pouchdbService.addDefaultData();\r\n  }\r\n\r\n  async printDevelopmentMethods(): Promise<void> {\r\n    const methods = (await this.developmentMethodService.getList()).map(\r\n      (method) => new DevelopmentMethod(method, undefined)\r\n    );\r\n    const out = methods.map((method) => method.toDb());\r\n    out.forEach((method) => delete (method as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printBmProcesses(): Promise<void> {\r\n    const processes = (await this.bmProcessService.getList()).map(\r\n      (process) => new BmProcess(process, undefined)\r\n    );\r\n    const out = processes.map((process) => process.toDb());\r\n    out.forEach((process) => delete (process as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printRunningProcesses(): Promise<void> {\r\n    const processes = (await this.runningProcessService.getList()).map(\r\n      (process) => new RunningProcess(process, undefined)\r\n    );\r\n    const out = processes.map((process) => process.toDb());\r\n    out.forEach((process) => delete (process as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printExpertModels(): Promise<void> {\r\n    const models = (await this.expertModelService.getList()).map(\r\n      (model) => new ExpertModel(model, undefined)\r\n    );\r\n    const out = models.map((model) => model.toDb());\r\n    out.forEach((model) => delete (model as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printCompanyModels(): Promise<void> {\r\n    const models = (await this.companyModelService.getAll()).map(\r\n      (model) => new CompanyModel(model, undefined)\r\n    );\r\n    const out = models.map((model) => model.toDb());\r\n    out.forEach((model) => delete (model as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printDomains(): Promise<void> {\r\n    const models = (await this.domainService.getList()).map(\r\n      (domain) => new Domain(domain, undefined)\r\n    );\r\n    const out = models.map((domain) => domain.toDb());\r\n    out.forEach((domain) => delete (domain as DatabaseMeta)._rev);\r\n    console.log(out);\r\n  }\r\n\r\n  async printCanvasDefinitions(): Promise<void> {\r\n    const models = (await this.canvasDefinitionService.getList()).map(\r\n      (canvasDefinition) => new CanvasDefinition(canvasDefinition, undefined)\r\n    );\r\n    const out = models.map((canvasDefinition) => canvasDefinition.toDb());\r\n    out.forEach(\r\n      (canvasDefinition) => delete (canvasDefinition as DatabaseMeta)._rev\r\n    );\r\n    console.log(out);\r\n  }\r\n\r\n  get showNavbar(): boolean {\r\n    return this.authService.isLoggedIn();\r\n  }\r\n\r\n  isLocalDatabase(): boolean {\r\n    return environment.localDatabase === true;\r\n  }\r\n}\r\n","import { AppComponent } from './app.component';\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { DatabaseModule } from './database/database.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { NavbarComponent } from './navbar/navbar.component';\r\nimport { ToolExplanationComponent } from './tool-explanation/tool-explanation.component';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { DevelopmentProcessesModule } from './development-processes/development-processes.module';\r\nimport { DevelopmentProcessRegistryModule } from './development-process-registry/development-process-registry.module';\r\nimport { OptionsComponent } from './options/options.component';\r\nimport { CanvasMetaModelModule } from './canvas-meta-model/canvas-meta-model.module';\r\nimport { CanvasModule } from './canvas/canvas.module';\r\nimport { MethodModelerExplanationComponent } from './method-modeler-explanation/method-modeler-explanation.component';\r\nimport { FeatureModelerExplanationComponent } from './feature-modeler-explanation/feature-modeler-explanation.component';\r\nimport { EnactionExplanationComponent } from './enaction-explanation/enaction-explanation.component';\r\nimport { LoginComponent } from './login/login.component';\r\nimport { StartComponent } from './start/start.component';\r\nimport { StartBusinessDeveloperComponent } from './start-business-developer/start-business-developer.component';\r\nimport { StartMethodEngineerComponent } from './start-method-engineer/start-method-engineer.component';\r\nimport { ChangePasswordFormComponent } from './change-password-form/change-password-form.component';\r\nimport { ProfileComponent } from './profile/profile.component';\r\nimport { PageNotFoundComponent } from './page-not-found/page-not-found.component';\r\nimport { QuillModule } from 'ngx-quill';\r\nimport { WhiteboardMetaModelModule } from './whiteboard-meta-model/whiteboard-meta-model.module';\r\nimport { WhiteboardModule } from './whiteboard/whiteboard.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    NavbarComponent,\r\n    OptionsComponent,\r\n    ToolExplanationComponent,\r\n    MethodModelerExplanationComponent,\r\n    FeatureModelerExplanationComponent,\r\n    EnactionExplanationComponent,\r\n    LoginComponent,\r\n    StartComponent,\r\n    StartBusinessDeveloperComponent,\r\n    StartMethodEngineerComponent,\r\n    ChangePasswordFormComponent,\r\n    ProfileComponent,\r\n    PageNotFoundComponent,\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    DatabaseModule,\r\n    DevelopmentProcessRegistryModule,\r\n    CanvasMetaModelModule,\r\n    WhiteboardMetaModelModule,\r\n    NgbModule,\r\n    ReactiveFormsModule,\r\n\r\n    QuillModule.forRoot({\r\n      format: 'json',\r\n    }),\r\n\r\n    CanvasModule,\r\n    WhiteboardModule,\r\n\r\n    DevelopmentProcessesModule,\r\n\r\n    AppRoutingModule, // has to be the last one\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent],\r\n})\r\nexport class AppModule {}\r\n","import { DatabaseModelPart } from '../database/database-model-part';\r\nimport { Equality } from '../shared/equality';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport interface CanvasDefinitionCellInit extends DatabaseInit {\r\n  isSpacer: boolean;\r\n  id?: string;\r\n  name?: string;\r\n  rowspan: number;\r\n  colspan: number;\r\n}\r\n\r\nexport interface CanvasDefinitionCellEntry extends DatabaseEntry {\r\n  isSpacer: boolean;\r\n  id?: string;\r\n  name?: string;\r\n  rowspan: number;\r\n  colspan: number;\r\n}\r\n\r\nexport class CanvasDefinitionCell\r\n  implements\r\n    CanvasDefinitionCellInit,\r\n    DatabaseModelPart,\r\n    Equality<CanvasDefinitionCell>\r\n{\r\n  isSpacer: boolean;\r\n  id?: string;\r\n  name?: string;\r\n  rowspan: number;\r\n  colspan: number;\r\n\r\n  constructor(\r\n    entry: CanvasDefinitionCellEntry | undefined,\r\n    init: CanvasDefinitionCellInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.isSpacer = element.isSpacer;\r\n    this.id = element.id;\r\n    this.name = element.name;\r\n    this.rowspan = element.rowspan;\r\n    this.colspan = element.colspan;\r\n  }\r\n\r\n  toDb(): CanvasDefinitionCellEntry {\r\n    return {\r\n      isSpacer: this.isSpacer,\r\n      id: this.id,\r\n      name: this.name,\r\n      rowspan: this.rowspan,\r\n      colspan: this.colspan,\r\n    };\r\n  }\r\n\r\n  equals(other: CanvasDefinitionCell): boolean {\r\n    if (other == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      this.isSpacer === other.isSpacer &&\r\n      this.name === other.name &&\r\n      this.rowspan === other.rowspan &&\r\n      this.colspan === other.colspan\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { CanvasDefinition, CanvasDefinitionInit } from './canvas-definition';\r\nimport { CanvasDefinitionCell } from './canvas-definition-cell';\r\nimport { DefaultElementService } from '../database/default-element.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasDefinitionService extends DefaultElementService<\r\n  CanvasDefinition,\r\n  CanvasDefinitionInit\r\n> {\r\n  protected readonly typeName = CanvasDefinition.typeName;\r\n\r\n  protected readonly elementConstructor = CanvasDefinition;\r\n\r\n  async updateRows(\r\n    id: string,\r\n    newRows: CanvasDefinitionCell[][]\r\n  ): Promise<void> {\r\n    const canvasDefinition = await this.get(id);\r\n    canvasDefinition.updateRows(newRows);\r\n    await this.save(canvasDefinition);\r\n  }\r\n\r\n  async update(id: string, element: Partial<CanvasDefinition>): Promise<void> {\r\n    const dbElement = await this.get(id);\r\n    dbElement.update(element);\r\n    await this.save(dbElement);\r\n  }\r\n}\r\n","import { Feature } from './feature';\r\nimport { DatabaseModel } from '../database/database-model';\r\nimport {\r\n  CanvasDefinitionCell,\r\n  CanvasDefinitionCellEntry,\r\n  CanvasDefinitionCellInit,\r\n} from './canvas-definition-cell';\r\nimport { getId } from '../model/utils';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../database/database-entry';\r\n\r\nexport interface CanvasDefinitionInit extends DatabaseRootInit {\r\n  name: string;\r\n  description?: string;\r\n  rows?: CanvasDefinitionCellInit[][];\r\n  relationshipTypes?: string[];\r\n}\r\n\r\nexport interface CanvasDefinitionEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  description?: string;\r\n  rows: CanvasDefinitionCellEntry[][];\r\n  relationshipTypes: string[];\r\n}\r\n\r\ninterface CanvasDefinitionJsonSchema {\r\n  name: string;\r\n  description?: string;\r\n  rows: CanvasDefinitionCellEntry[][];\r\n  relationshipTypes: string[];\r\n}\r\n\r\nexport class CanvasDefinition\r\n  extends DatabaseModel\r\n  implements CanvasDefinitionInit\r\n{\r\n  static readonly typeName = 'CanvasDefinition';\r\n\r\n  name: string;\r\n  description?: string;\r\n\r\n  rows: CanvasDefinitionCell[][] = [];\r\n\r\n  relationshipTypes: string[] = [];\r\n\r\n  constructor(\r\n    entry: CanvasDefinitionEntry | undefined,\r\n    init: CanvasDefinitionInit | undefined\r\n  ) {\r\n    super(entry, init, CanvasDefinition.typeName);\r\n    const element = entry ?? init;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n    this.relationshipTypes =\r\n      element.relationshipTypes ?? this.relationshipTypes;\r\n    if (entry != null) {\r\n      this.rows =\r\n        entry.rows?.map((row) =>\r\n          row.map((cell) => new CanvasDefinitionCell(cell, undefined))\r\n        ) ?? this.rows;\r\n    } else if (init != null) {\r\n      this.rows =\r\n        init.rows?.map((row) =>\r\n          row.map((cell) => new CanvasDefinitionCell(undefined, cell))\r\n        ) ?? this.rows;\r\n    }\r\n  }\r\n\r\n  update(canvasDefinition: Partial<CanvasDefinition>): void {\r\n    Object.assign(this, canvasDefinition);\r\n  }\r\n\r\n  /**\r\n   * Update the rows of this canvas definition and give them correct ids\r\n   *\r\n   * @param newRows the new rows\r\n   */\r\n  updateRows(newRows: CanvasDefinitionCell[][]): void {\r\n    const ids = new Set<string>();\r\n    newRows.forEach((row) =>\r\n      row\r\n        .filter((cell) => !cell.isSpacer)\r\n        .forEach((cell) => {\r\n          if (!cell.id) {\r\n            cell.id = getId(cell.name, Array.from(ids));\r\n          } else if (ids.has(cell.id)) {\r\n            cell.id = getId(cell.name, Array.from(ids));\r\n          }\r\n          ids.add(cell.id);\r\n        })\r\n    );\r\n    this.rows = newRows;\r\n  }\r\n\r\n  get rootFeatures(): Feature[] {\r\n    const rootFeatures: Feature[] = [];\r\n    this.rows.forEach((row) =>\r\n      row\r\n        .filter((cell) => !cell.isSpacer)\r\n        .forEach((cell) => {\r\n          rootFeatures.push(\r\n            new Feature(undefined, { name: cell.name }, cell.id, null)\r\n          );\r\n        })\r\n    );\r\n    return rootFeatures;\r\n  }\r\n\r\n  toDb(): CanvasDefinitionEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      description: this.description,\r\n      rows: this.rows.map((row) => row.map((cell) => cell.toDb())),\r\n      relationshipTypes: this.relationshipTypes,\r\n    };\r\n  }\r\n\r\n  toJSON(): CanvasDefinitionJsonSchema {\r\n    return {\r\n      name: this.name,\r\n      description: this.description,\r\n      rows: this.rows.map((row) => row.map((cell) => cell.toDb())),\r\n      relationshipTypes: this.relationshipTypes,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { CompanyModel } from './company-model';\r\nimport { CompanyModelService } from './company-model.service';\r\nimport {\r\n  MetaModelApi,\r\n  Reference,\r\n} from '../development-process-registry/meta-model-definition';\r\nimport { Router } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class CanvasMetaModelApiService implements MetaModelApi {\r\n  viewMethod: (\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ) => void;\r\n\r\n  constructor(private companyModelService: CompanyModelService) {}\r\n\r\n  view(\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ): void {\r\n    if (this.viewMethod == null) {\r\n      console.warn('No module for viewing of canvas models added');\r\n    } else {\r\n      this.viewMethod(model, router, reference);\r\n    }\r\n  }\r\n\r\n  async getName(model: ArtifactDataReference): Promise<string | undefined> {\r\n    const companyModel = await this.companyModelService.get(model.id);\r\n    if (companyModel.instances.length > 0) {\r\n      return companyModel.instances[0].name;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  async copy(model: ArtifactDataReference): Promise<ArtifactDataReference> {\r\n    const companyModel = await this.companyModelService.get(model.id);\r\n    companyModel.resetDatabaseState();\r\n    companyModel.createdByMethod = true;\r\n    await this.companyModelService.save(companyModel);\r\n    return {\r\n      ...model,\r\n      id: companyModel._id,\r\n      type: CompanyModel.typeName,\r\n    };\r\n  }\r\n\r\n  async remove(model: ArtifactDataReference): Promise<void> {\r\n    await this.companyModelService.delete(model.id);\r\n  }\r\n}\r\n","import { APP_INITIALIZER, NgModule, Optional, SkipSelf } from '@angular/core';\r\nimport { CanvasMetaModelService } from './canvas-meta-model.service';\r\nimport { CanvasMetaModelApiService } from './canvas-meta-model-api.service';\r\n\r\n@NgModule({\r\n  providers: [\r\n    CanvasMetaModelService,\r\n    CanvasMetaModelApiService,\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: (canvasMetaModelService: CanvasMetaModelService) => () =>\r\n        canvasMetaModelService.init(),\r\n      deps: [CanvasMetaModelService],\r\n      multi: true,\r\n    },\r\n  ],\r\n})\r\nexport class CanvasMetaModelModule {\r\n  // see https://angular.io/guide/singleton-services#prevent-reimport-of-the-greetingmodule\r\n  constructor(@Optional() @SkipSelf() databaseModule?: CanvasMetaModelModule) {\r\n    if (databaseModule) {\r\n      throw new Error(\r\n        'CanvasMetaModelModule is already loaded. Import it in the AppModule only.'\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MetaModelService } from '../development-process-registry/meta-model.service';\r\nimport { CompanyModel } from './company-model';\r\nimport {\r\n  MetaModelDefinition,\r\n  Reference,\r\n} from '../development-process-registry/meta-model-definition';\r\nimport { CanvasMetaModelApiService } from './canvas-meta-model-api.service';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { Router } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class CanvasMetaModelService {\r\n  constructor(\r\n    private canvasMetaModelApiService: CanvasMetaModelApiService,\r\n    private metaModelService: MetaModelService\r\n  ) {}\r\n\r\n  init() {\r\n    const definition: MetaModelDefinition = {\r\n      name: 'Canvas',\r\n      type: CompanyModel.typeName,\r\n      api: this.canvasMetaModelApiService,\r\n    };\r\n    this.metaModelService.registerMetaModel(definition);\r\n    console.log('Registered Canvas Meta Model');\r\n  }\r\n\r\n  registerViewMethod(\r\n    view: (\r\n      model: ArtifactDataReference,\r\n      router: Router,\r\n      reference: Reference\r\n    ) => void\r\n  ) {\r\n    this.canvasMetaModelApiService.viewMethod = view;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FeatureModel } from './feature-model';\r\nimport { Feature, FeatureType, SubfeatureConnectionsType } from './feature';\r\nimport { Instance, InstanceType } from './instance';\r\nimport { ConformanceReport, PatternHint } from './conformance-report';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasModelConsistencyService {\r\n  /**\r\n   * Called to check whether a feature model is consistent. Raises an error if not.\r\n   *\r\n   * @param featureModel the feature model to check\r\n   */\r\n  checkFormalConsistency(featureModel: FeatureModel): void {\r\n    // has a definition\r\n    if (!featureModel.definition) {\r\n      throw new Error('Missing definition');\r\n    }\r\n\r\n    // has the root canvas blocks of the definition\r\n    const blocks = featureModel.definition.rootFeatures.map(\r\n      (feature) => feature.id\r\n    );\r\n    if (!blocks.every((id) => id in featureModel.features)) {\r\n      throw new Error('Missing canvas blocks');\r\n    }\r\n\r\n    // has unique feature ids and only references valid features in relationships\r\n    const featureIds = new Set<string>();\r\n    featureModel.iterateFeatures((feature: Feature) => {\r\n      if (featureIds.has(feature.id)) {\r\n        throw new Error('Feature id ' + feature.id + ' is not unique');\r\n      } else {\r\n        featureIds.add(feature.id);\r\n      }\r\n      return false;\r\n    });\r\n    featureModel.iterateFeatures((feature: Feature) => {\r\n      if (\r\n        !feature.relationships\r\n          .getAllReferencedFeatureIds()\r\n          .every((id) => featureIds.has(id))\r\n      ) {\r\n        throw new Error(\r\n          'Relationships of feature ' +\r\n            feature.id +\r\n            ' reference a non existing feature id'\r\n        );\r\n      }\r\n      if (\r\n        feature.relationships\r\n          .getRelationshipTypes()\r\n          .some(\r\n            (type) => !featureModel.definition.relationshipTypes.includes(type)\r\n          )\r\n      ) {\r\n        throw new Error(\r\n          'Feature ' +\r\n            feature.id +\r\n            ' has a relationship types that does not exist in the definition'\r\n        );\r\n      }\r\n      return false;\r\n    });\r\n\r\n    // instances use at least the nine root canvas blocks\r\n    if (\r\n      !featureModel.instances.every((instance) =>\r\n        blocks.every((id) => instance.usedFeatures.includes(id))\r\n      )\r\n    ) {\r\n      throw new Error('Instance does not reference all root canvas blocks');\r\n    }\r\n\r\n    // instances only reference valid features\r\n    if (\r\n      !featureModel.instances.every((instance) =>\r\n        instance.usedFeatures.every((id) => featureIds.has(id))\r\n      )\r\n    ) {\r\n      throw new Error('Instance references non existing feature id');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check whether an instantiation is possible or not possible\r\n   *\r\n   * @param featureModel the feature model to check\r\n   */\r\n  instanceIsPossible(featureModel: FeatureModel): {\r\n    problems: string[];\r\n    problemFeatureIds: string[];\r\n    possibleInstance: Instance;\r\n  } {\r\n    const featureMap = featureModel.getFeatureMap();\r\n    const testInstance = new Instance(undefined, {\r\n      name: 'Possible Instance',\r\n      type: InstanceType.EXAMPLE,\r\n    });\r\n    testInstance.usedFeatures = [];\r\n\r\n    const instances = this.addFeaturesToPossibleInstances(\r\n      [testInstance],\r\n      Object.values(featureModel.features),\r\n      featureMap\r\n    );\r\n\r\n    const results = instances.map((instance) => {\r\n      return {\r\n        ...this.checkPossibleInstanceErrors(featureModel, instance),\r\n        possibleInstance: instance,\r\n      };\r\n    });\r\n\r\n    const result = results.find((res) => res.problems.length === 0);\r\n\r\n    if (result) {\r\n      return result;\r\n    } else {\r\n      const min = Math.min(...results.map((res) => res.problems.length));\r\n      return results.find((res) => res.problems.length === min);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a feature to a possible instance and add all features that are required after this feature is added\r\n   * (required, parent, mandatory, subfeatures)\r\n   *\r\n   * @param instance the possible instance\r\n   * @param feature the feature to add\r\n   * @param featureMap the feature map of the feature model\r\n   */\r\n  private addFeatureToPossibleInstance(\r\n    instance: Instance,\r\n    feature: Feature,\r\n    featureMap: { [id: string]: Feature }\r\n  ): Instance[] {\r\n    instance.addFeature(feature.id);\r\n\r\n    let instances = [instance];\r\n\r\n    // Add parent of feature\r\n    if (feature.parent !== null) {\r\n      instances = this.addFeatureToPossibleInstances(\r\n        instances,\r\n        feature.parent,\r\n        featureMap\r\n      );\r\n    }\r\n\r\n    // Add all required features\r\n    instances = this.addFeaturesToPossibleInstances(\r\n      instances,\r\n      feature.relationships\r\n        .getRelationships('required')\r\n        .map((id) => featureMap[id]),\r\n      featureMap\r\n    );\r\n\r\n    // Check for new mandatory features\r\n    instances = this.addFeaturesToPossibleInstances(\r\n      instances,\r\n      Object.values(feature.subfeatures).filter(\r\n        (subfeature) => subfeature.type === FeatureType.MANDATORY\r\n      ),\r\n      featureMap\r\n    );\r\n\r\n    // Check OR and XOR\r\n    if (\r\n      feature.subfeatureConnections === SubfeatureConnectionsType.XOR ||\r\n      feature.subfeatureConnections === SubfeatureConnectionsType.OR\r\n    ) {\r\n      const newInstances = [\r\n        ...instances.filter(\r\n          (inst) =>\r\n            Object.keys(feature.subfeatures).filter((id) =>\r\n              inst.usedFeatures.includes(id)\r\n            ).length > 0\r\n        ),\r\n      ];\r\n      instances\r\n        .filter(\r\n          (inst) =>\r\n            Object.keys(feature.subfeatures).filter((id) =>\r\n              inst.usedFeatures.includes(id)\r\n            ).length === 0\r\n        )\r\n        .forEach((inst) => {\r\n          if (Object.keys(feature.subfeatures).length === 0) {\r\n            newInstances.push(inst);\r\n          } else {\r\n            Object.values(feature.subfeatures).forEach((subfeature) => {\r\n              const tmpInstance = new Instance(undefined, inst);\r\n              tmpInstance.usedFeatures = [...tmpInstance.usedFeatures];\r\n              newInstances.push(\r\n                ...this.addFeatureToPossibleInstance(\r\n                  tmpInstance,\r\n                  subfeature,\r\n                  featureMap\r\n                )\r\n              );\r\n            });\r\n          }\r\n        });\r\n      instances = newInstances;\r\n    }\r\n\r\n    return instances;\r\n  }\r\n\r\n  /**\r\n   * Add a feature to possible instances. Return the resulting possible instances.\r\n   *\r\n   * @param instances the possible instances\r\n   * @param feature the feature to add\r\n   * @param featureMap the feature map of the feature model\r\n   */\r\n  private addFeatureToPossibleInstances(\r\n    instances: Instance[],\r\n    feature: Feature,\r\n    featureMap: { [id: string]: Feature }\r\n  ): Instance[] {\r\n    const newInstances = [];\r\n    instances.forEach((instance) => {\r\n      instance.usedFeatures.includes(feature.id)\r\n        ? newInstances.push(instance)\r\n        : newInstances.push(\r\n            ...this.addFeatureToPossibleInstance(instance, feature, featureMap)\r\n          );\r\n    });\r\n    return newInstances;\r\n  }\r\n\r\n  /**\r\n   * Add features to possible instances. Return the resulting possible instances.\r\n   *\r\n   * @param instances the possible instances\r\n   * @param features the features to add\r\n   * @param featureMap the feature map of the feature model\r\n   */\r\n  private addFeaturesToPossibleInstances(\r\n    instances: Instance[],\r\n    features: Feature[],\r\n    featureMap: { [id: string]: Feature }\r\n  ): Instance[] {\r\n    features.forEach(\r\n      (feature) =>\r\n        (instances = this.addFeatureToPossibleInstances(\r\n          instances,\r\n          feature,\r\n          featureMap\r\n        ))\r\n    );\r\n    return instances;\r\n  }\r\n\r\n  /**\r\n   * Checks for problems with an instance that is valid except for XOR and excludes fields\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instance the instance to check\r\n   */\r\n  private checkPossibleInstanceErrors(\r\n    featureModel: FeatureModel,\r\n    instance: Instance\r\n  ): { problems: string[]; problemFeatureIds: string[] } {\r\n    const featureMap = featureModel.getFeatureMap();\r\n    const problems: string[] = [];\r\n    const problemFeatureIds: Set<string> = new Set<string>();\r\n\r\n    featureModel.iterateFeatures(\r\n      (feature) => {\r\n        // Check for XOR problem\r\n        if (\r\n          feature.subfeatureConnections === SubfeatureConnectionsType.XOR &&\r\n          Object.keys(feature.subfeatures).filter((id) =>\r\n            instance.usedFeatures.includes(id)\r\n          ).length !== 1\r\n        ) {\r\n          problems.push(\r\n            feature.name + ' is XOR, but can not have exactly one subfeature'\r\n          );\r\n          problemFeatureIds.add(feature.id);\r\n        }\r\n\r\n        // Check for OR problem\r\n        if (\r\n          feature.subfeatureConnections === SubfeatureConnectionsType.OR &&\r\n          Object.keys(feature.subfeatures).filter((id) =>\r\n            instance.usedFeatures.includes(id)\r\n          ).length === 0\r\n        ) {\r\n          problems.push(\r\n            feature.name + ' is OR, but can not have at least one subfeature'\r\n          );\r\n          problemFeatureIds.add(feature.id);\r\n        }\r\n\r\n        // Check excludes problem\r\n        feature.relationships\r\n          .getRelationships('excludes')\r\n          .filter((id) => instance.usedFeatures.includes(id))\r\n          .forEach((id) => {\r\n            const excludedFeature = featureMap[id];\r\n            problems.push(\r\n              feature.name +\r\n                ' excludes the feature ' +\r\n                excludedFeature.name +\r\n                ', but both features have to be included'\r\n            );\r\n            problemFeatureIds.add(feature.id);\r\n          });\r\n        return false;\r\n      },\r\n      (feature) => instance.usedFeatures.includes(feature.id)\r\n    );\r\n    return {\r\n      problems,\r\n      problemFeatureIds: Array.from(problemFeatureIds),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check that hurts and supports do not exclude each other.\r\n   *\r\n   * @param featureModel the feature model to check\r\n   * @return problems and problem feature ids of the features that have an incorrect relationship\r\n   */\r\n  checkHurtsSupports(featureModel: FeatureModel): {\r\n    problems: string[];\r\n    problemFeatureIds: string[];\r\n  } {\r\n    const featureMap = featureModel.getFeatureMap();\r\n    const problems: string[] = [];\r\n    const problemFeatureIds: Set<string> = new Set<string>();\r\n\r\n    featureModel.iterateFeatures((feature) => {\r\n      const features = feature.relationships\r\n        .getRelationships('supports')\r\n        .map((id) => featureMap[id])\r\n        .filter((relatedFeature) =>\r\n          relatedFeature.relationships\r\n            .getRelationships('hurts')\r\n            .includes(feature.id)\r\n        );\r\n      features.forEach((relatedFeature) => {\r\n        problems.push(\r\n          'Feature ' +\r\n            feature.name +\r\n            ' supports ' +\r\n            relatedFeature.name +\r\n            ', but ' +\r\n            relatedFeature.name +\r\n            ' hurts ' +\r\n            feature.name +\r\n            '.'\r\n        );\r\n        problemFeatureIds.add(relatedFeature.id);\r\n      });\r\n      if (features.length > 0) {\r\n        problemFeatureIds.add(feature.id);\r\n      }\r\n      return false;\r\n    });\r\n\r\n    return {\r\n      problems,\r\n      problemFeatureIds: Array.from(problemFeatureIds),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Checks the conformance of an instance of a feature model\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instanceId the id of the instance\r\n   * @param patterns the patterns\r\n   * @return featureIds that have problems and errors as messages\r\n   */\r\n  checkConformanceOfInstance(\r\n    featureModel: FeatureModel,\r\n    instanceId: number,\r\n    patterns: Instance[]\r\n  ): ConformanceReport {\r\n    const instance = featureModel.instances.find((i) => i.id === instanceId);\r\n\r\n    return new ConformanceReport({\r\n      ...this.getConformanceMessages(featureModel, instance),\r\n      ...this.getHints(featureModel, instance),\r\n      ...this.getPatternHints(featureModel, instance, patterns),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get errors, warnings and strengths for the instance\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instance the instance\r\n   */\r\n  private getConformanceMessages(\r\n    featureModel: FeatureModel,\r\n    instance: Instance\r\n  ): {\r\n    errorFeatureIds: string[];\r\n    errors: string[];\r\n    warningFeatureIds: string[];\r\n    warnings: string[];\r\n    strengthFeatureIds: string[];\r\n    strengths: string[];\r\n  } {\r\n    const errorFeatureIds = new Set<string>();\r\n    const warningFeatureIds = new Set<string>();\r\n    const strengthFeatureIds = new Set<string>();\r\n    const errors: string[] = [];\r\n    const warnings: string[] = [];\r\n    const strengths: string[] = [];\r\n\r\n    const filter = (feature: Feature): boolean =>\r\n      instance.usedFeatures.includes(feature.id) ||\r\n      feature.type === FeatureType.MANDATORY;\r\n    const checkFeature = (feature: Feature): boolean => {\r\n      const selected = instance.usedFeatures.includes(feature.id);\r\n      const selectedSubfeaturesLength = Object.keys(feature.subfeatures).filter(\r\n        (id: string) => instance.usedFeatures.includes(id)\r\n      ).length;\r\n\r\n      if (feature.type === FeatureType.MANDATORY && !selected) {\r\n        errorFeatureIds.add(feature.id);\r\n        errors.push(feature.name + ' is mandatory');\r\n      }\r\n\r\n      switch (feature.subfeatureConnections) {\r\n        case SubfeatureConnectionsType.OR:\r\n          if (selectedSubfeaturesLength === 0) {\r\n            errorFeatureIds.add(feature.id);\r\n            errors.push(feature.name + ' needs at least one subfeature');\r\n          }\r\n          break;\r\n        case SubfeatureConnectionsType.XOR:\r\n          if (selectedSubfeaturesLength !== 1) {\r\n            errorFeatureIds.add(feature.id);\r\n            errors.push(feature.name + ' needs exactly one subfeature');\r\n          }\r\n          break;\r\n      }\r\n\r\n      const missingRequiredFeatures = feature.relationships\r\n        .getRelationships('requires')\r\n        .filter((id: string) => !instance.usedFeatures.includes(id));\r\n      if (missingRequiredFeatures.length > 0) {\r\n        errorFeatureIds.add(feature.id);\r\n        missingRequiredFeatures.forEach((id: string) =>\r\n          errors.push(\r\n            feature.name +\r\n              ' requires the feature ' +\r\n              featureModel.getFeature(id).name\r\n          )\r\n        );\r\n      }\r\n\r\n      const disallowedFeatures = feature.relationships\r\n        .getRelationships('excludes')\r\n        .filter((id: string) => instance.usedFeatures.includes(id));\r\n      if (disallowedFeatures.length > 0) {\r\n        errorFeatureIds.add(feature.id);\r\n        disallowedFeatures.forEach((id: string) =>\r\n          errors.push(\r\n            feature.name +\r\n              ' excludes the feature ' +\r\n              featureModel.getFeature(id).name\r\n          )\r\n        );\r\n      }\r\n\r\n      const supportedFeatures = feature.relationships\r\n        .getRelationships('supports')\r\n        .filter((id: string) => instance.usedFeatures.includes(id));\r\n      if (supportedFeatures.length > 0) {\r\n        strengthFeatureIds.add(feature.id);\r\n        supportedFeatures.forEach((id: string) =>\r\n          strengths.push(\r\n            feature.name +\r\n              ' supports the feature ' +\r\n              featureModel.getFeature(id).name\r\n          )\r\n        );\r\n      }\r\n\r\n      const hurtedFeatures = feature.relationships\r\n        .getRelationships('hurts')\r\n        .filter((id: string) => instance.usedFeatures.includes(id));\r\n      if (hurtedFeatures.length > 0) {\r\n        warningFeatureIds.add(feature.id);\r\n        hurtedFeatures.forEach((id: string) =>\r\n          warnings.push(\r\n            feature.name +\r\n              ' hurts the feature ' +\r\n              featureModel.getFeature(id).name\r\n          )\r\n        );\r\n      }\r\n\r\n      return false;\r\n    };\r\n    featureModel.iterateFeatures(checkFeature, filter);\r\n\r\n    return {\r\n      errorFeatureIds: Array.from(errorFeatureIds),\r\n      errors,\r\n      warningFeatureIds: Array.from(warningFeatureIds),\r\n      warnings,\r\n      strengthFeatureIds: Array.from(strengthFeatureIds),\r\n      strengths,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Gets hints for the instance\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instance the instance\r\n   */\r\n  private getHints(\r\n    featureModel: FeatureModel,\r\n    instance: Instance\r\n  ): { hintFeatureIds: string[]; hints: string[] } {\r\n    const hintFeatureIds = new Set<string>();\r\n    const hints: string[] = [];\r\n\r\n    const checkHint = (feature: Feature): boolean => {\r\n      if (\r\n        !instance.usedFeatures.includes(feature.id) &&\r\n        this.isFeatureEasyAddable(featureModel, instance, feature)\r\n      ) {\r\n        feature.relationships.getRelationships('supports').forEach((id) => {\r\n          if (instance.usedFeatures.includes(id)) {\r\n            hints.push(\r\n              'Including ' +\r\n                feature.name +\r\n                ' would support ' +\r\n                featureModel.getFeature(id).name\r\n            );\r\n            hintFeatureIds.add(feature.id);\r\n            for (let f = feature.parent; f !== null; f = f.parent) {\r\n              if (instance.usedFeatures.includes(f.id)) {\r\n                break;\r\n              }\r\n              hintFeatureIds.add(f.id);\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      return false;\r\n    };\r\n    featureModel.iterateFeatures(checkHint);\r\n\r\n    return {\r\n      hintFeatureIds: Array.from(hintFeatureIds),\r\n      hints,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get all pattern hints for the instance\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instance the instance\r\n   * @param patterns the patterns in the format of this feature model\r\n   */\r\n  getPatternHints(\r\n    featureModel: FeatureModel,\r\n    instance: Instance,\r\n    patterns: Instance[]\r\n  ): {\r\n    patternHintFeatureIds: string[];\r\n    patternHints: PatternHint[];\r\n    usedPatterns: Instance[];\r\n  } {\r\n    const patternHintFeatureIds = new Set<string>();\r\n    const patternHints: PatternHint[] = [];\r\n    const usedPatterns: Instance[] = [];\r\n\r\n    patterns.forEach((pattern) => {\r\n      let leafFeatures = 0;\r\n      let usedLeafFeatures = 0;\r\n      featureModel.iterateFeatures(\r\n        (feature) => {\r\n          if (feature.parent === null) {\r\n            // do not count main features\r\n            return false;\r\n          }\r\n          if (\r\n            Object.keys(feature.subfeatures).every(\r\n              (id) => !pattern.usedFeatures.includes(id)\r\n            )\r\n          ) {\r\n            leafFeatures += 1;\r\n            if (instance.usedFeatures.includes(feature.id)) {\r\n              usedLeafFeatures += 1;\r\n            }\r\n          }\r\n          return false;\r\n        },\r\n        (feature) => pattern.usedFeatures.includes(feature.id)\r\n      );\r\n      if (usedLeafFeatures / leafFeatures >= 0.5) {\r\n        let hasMissingFeatures = false;\r\n        let isPossible = true;\r\n        const hint: PatternHint = {\r\n          pattern: pattern,\r\n          missingFeatures: [],\r\n        };\r\n        const features = new Set<Feature>();\r\n        featureModel.iterateFeatures(\r\n          (feature) => {\r\n            if (!instance.usedFeatures.includes(feature.id)) {\r\n              if (!this.isFeatureEasyAddable(featureModel, instance, feature)) {\r\n                isPossible = false;\r\n                return true;\r\n              } else {\r\n                features.add(feature);\r\n                hasMissingFeatures = true;\r\n              }\r\n            }\r\n            return false;\r\n          },\r\n          (feature) => pattern.usedFeatures.includes(feature.id)\r\n        );\r\n        if (isPossible) {\r\n          if (hasMissingFeatures) {\r\n            hint.missingFeatures.push(...Array.from(features));\r\n            patternHints.push(hint);\r\n            features.forEach((feature) =>\r\n              patternHintFeatureIds.add(feature.id)\r\n            );\r\n          } else {\r\n            usedPatterns.push(pattern);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    return {\r\n      patternHintFeatureIds: Array.from(patternHintFeatureIds),\r\n      patternHints,\r\n      usedPatterns,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Checks whether the feature can be easily added to the instance. Easily means that all requirements are satisfied and\r\n   * the feature is not excluded by any other feature nor it is excluded by the tree relationship XOR and every parent\r\n   * of this feature is already added to the instance or it would be possible to add it easily too.\r\n   *\r\n   * @param featureModel the feature model\r\n   * @param instance the instance to add the feature to\r\n   * @param feature the feature to add to the instance\r\n   * @return whether it would be easily possible to add the feature\r\n   */\r\n  private isFeatureEasyAddable(\r\n    featureModel: FeatureModel,\r\n    instance: Instance,\r\n    feature: Feature\r\n  ): boolean {\r\n    return (\r\n      instance.usedFeatures.includes(feature.id) ||\r\n      (feature.relationships\r\n        .getRelationships('excludes')\r\n        .every((id) => !instance.usedFeatures.includes(id)) &&\r\n        instance.usedFeatures.every(\r\n          (id) =>\r\n            !featureModel\r\n              .getFeature(id)\r\n              .relationships.getRelationships('excludes')\r\n              .includes(feature.id)\r\n        ) &&\r\n        (feature.parent === null ||\r\n          feature.parent.subfeatureConnections !==\r\n            SubfeatureConnectionsType.XOR ||\r\n          Object.keys(feature.parent.subfeatures).every(\r\n            (id) => !instance.usedFeatures.includes(id)\r\n          )) &&\r\n        feature.relationships\r\n          .getRelationships('requires')\r\n          .every((id) => instance.usedFeatures.includes(id)) &&\r\n        (feature.parent === null ||\r\n          this.isFeatureEasyAddable(featureModel, instance, feature.parent)))\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  CompanyModel,\r\n  CompanyModelEntry,\r\n  CompanyModelInit,\r\n} from './company-model';\r\nimport { FeatureModelService } from './feature-model.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CompanyModelService extends FeatureModelService<\r\n  CompanyModel,\r\n  CompanyModelInit\r\n> {\r\n  protected readonly typeName = CompanyModel.typeName;\r\n\r\n  protected readonly elementConstructor = CompanyModel;\r\n\r\n  async getAll(): Promise<CompanyModelEntry[]> {\r\n    return super.getList();\r\n  }\r\n\r\n  async getList(definitionId: string = null): Promise<CompanyModelEntry[]> {\r\n    let results = await this.pouchdbService.find<CompanyModelEntry>(\r\n      CompanyModel.typeName,\r\n      {\r\n        selector: {\r\n          createdByMethod: false,\r\n        },\r\n      }\r\n    );\r\n    if (definitionId != null) {\r\n      results = results.filter(\r\n        (companyModel) => companyModel.$definition._id === definitionId\r\n      );\r\n    }\r\n    return results;\r\n  }\r\n\r\n  async save(companyModel: CompanyModel): Promise<void> {\r\n    await this.pouchdbService.put(companyModel);\r\n  }\r\n}\r\n","import {\r\n  FeatureModel,\r\n  FeatureModelEntry,\r\n  FeatureModelInit,\r\n} from './feature-model';\r\nimport { Trace, TraceEntry, TraceInit } from './trace';\r\nimport { RelationshipType } from './relationships';\r\nimport { Feature } from './feature';\r\nimport { ExpertModel } from './expert-model';\r\n\r\nexport interface CompanyModelInit extends FeatureModelInit {\r\n  expertModelTraces?: { [expertModelId: string]: TraceInit };\r\n  createdByMethod?: boolean;\r\n}\r\n\r\nexport interface CompanyModelEntry extends FeatureModelEntry {\r\n  expertModelTraces: { [expertModelId: string]: TraceEntry };\r\n  createdByMethod: boolean;\r\n}\r\n\r\nexport class CompanyModel extends FeatureModel implements CompanyModelInit {\r\n  static readonly typeName = 'CompanyModel';\r\n\r\n  // stored\r\n  expertModelTraces: { [expertModelId: string]: Trace } = {};\r\n  createdByMethod: boolean = false;\r\n\r\n  constructor(\r\n    entry: CompanyModelEntry | undefined,\r\n    init: CompanyModelInit | undefined\r\n  ) {\r\n    super(entry, init, CompanyModel.typeName);\r\n    if (entry != null) {\r\n      if (entry.expertModelTraces != null) {\r\n        Object.entries(entry.expertModelTraces).forEach(\r\n          ([id, trace]) =>\r\n            (this.expertModelTraces[id] = new Trace(trace, undefined))\r\n        );\r\n      }\r\n    } else if (init != null) {\r\n      if (init.expertModelTraces != null) {\r\n        Object.entries(init.expertModelTraces).forEach(\r\n          ([id, trace]) =>\r\n            (this.expertModelTraces[id] = new Trace(undefined, trace))\r\n        );\r\n      }\r\n    }\r\n    this.createdByMethod =\r\n      (entry ?? init).createdByMethod ?? this.createdByMethod;\r\n  }\r\n\r\n  protected cleanReferences(\r\n    featureIdList: string[],\r\n    featureList: Feature[]\r\n  ): void {\r\n    super.cleanReferences(featureIdList, featureList);\r\n\r\n    // ** Traces\r\n    for (const f of featureList) {\r\n      for (const [expertModelId, expertModelFeatureId] of Object.entries(\r\n        f.expertModelTrace\r\n      )) {\r\n        this.expertModelTraces[expertModelId].deleteTrace(expertModelFeatureId);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Expert Models\r\n\r\n  /**\r\n   * Add expert model to this company model\r\n   *\r\n   * @param expertModelId the expert model id\r\n   */\r\n  addExpertModel(expertModelId: string): void {\r\n    this.expertModelTraces[expertModelId] = new Trace(undefined, {});\r\n    for (const feature of Object.values(this.features)) {\r\n      this.expertModelTraces[expertModelId].addTrace(feature.id, feature.id);\r\n      feature.addTrace(expertModelId, feature.id);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove expert model from this company model\r\n   *\r\n   * @param expertModelId the expert model id\r\n   */\r\n  removeExpertModel(expertModelId: string): void {\r\n    delete this.expertModelTraces[expertModelId];\r\n    this.iterateFeatures((feature) => {\r\n      feature.removeTrace(expertModelId);\r\n      return false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add a trace to an expert model for a company feature. Also adds cross tree relationships if possible.\r\n   *\r\n   * @param expertModel the expert model to trace to\r\n   * @param expertFeatureId the feature id of the feature in the expert model\r\n   * @param companyFeatureId the feature id of the feature in the company model\r\n   */\r\n  addExpertModelTrace(\r\n    expertModel: ExpertModel,\r\n    expertFeatureId: string,\r\n    companyFeatureId: string\r\n  ): void {\r\n    const expertFeature = expertModel.getFeature(expertFeatureId);\r\n    const companyFeature = this.getFeature(companyFeatureId);\r\n    companyFeature.addTrace(expertModel._id, expertFeatureId);\r\n    this.expertModelTraces[expertModel._id].addTrace(\r\n      expertFeatureId,\r\n      companyFeatureId\r\n    );\r\n\r\n    // Add cross tree relationships\r\n    const relationshipTypes = expertModel.definition.relationshipTypes;\r\n    relationshipTypes.forEach((type) =>\r\n      this.addTraceRelationship(\r\n        expertModel._id,\r\n        expertFeature,\r\n        companyFeatureId,\r\n        type\r\n      )\r\n    );\r\n\r\n    const addRelationship = (eF: Feature): boolean => {\r\n      relationshipTypes.forEach((type) => {\r\n        if (eF.relationships.hasRelationship(type, expertFeatureId)) {\r\n          const cFId =\r\n            this.expertModelTraces[expertModel._id].expertFeatureIdMap[eF.id];\r\n          if (cFId != null) {\r\n            this.addRelationship(type, cFId, companyFeatureId);\r\n          }\r\n        }\r\n      });\r\n      return false;\r\n    };\r\n    expertModel.iterateFeatures(addRelationship);\r\n  }\r\n\r\n  /**\r\n   * Adds traces to the feature\r\n   *\r\n   * @param expertModelId the expert model id\r\n   * @param expertFeature the expert feature to lookup the relationships\r\n   * @param companyFeatureId the id of the company feature to add the relationships to\r\n   * @param relationshipType the relationship type to handle\r\n   */\r\n  private addTraceRelationship(\r\n    expertModelId: string,\r\n    expertFeature: Feature,\r\n    companyFeatureId: string,\r\n    relationshipType: RelationshipType\r\n  ): void {\r\n    const relationships: string[] =\r\n      expertFeature.relationships.getRelationships(relationshipType);\r\n    for (const relExpertFeatureId of relationships) {\r\n      const relCompanyFeatureId =\r\n        this.expertModelTraces[expertModelId].expertFeatureIdMap[\r\n          relExpertFeatureId\r\n        ];\r\n      if (relCompanyFeatureId) {\r\n        this.addRelationship(\r\n          relationshipType,\r\n          companyFeatureId,\r\n          relCompanyFeatureId\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a trace to an expert feature\r\n   *\r\n   * @param companyFeatureId the id of the company feature that has a trace to the expert feature\r\n   * @param expertModelId the id of the expert model\r\n   */\r\n  removeTrace(companyFeatureId: string, expertModelId: string): void {\r\n    const feature = this.getFeature(companyFeatureId);\r\n    if (companyFeatureId in this.features) {\r\n      throw new Error('Can not delete trace of main features');\r\n    }\r\n    const features = feature.getAllSubfeatures();\r\n    features.push(feature);\r\n    for (const featureTraceToDelete of features) {\r\n      this.expertModelTraces[expertModelId].deleteTrace(\r\n        featureTraceToDelete.expertModelTrace[expertModelId]\r\n      );\r\n      featureTraceToDelete.removeTrace(expertModelId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all ids of merged expert models\r\n   */\r\n  get expertModelIds(): string[] {\r\n    return Object.keys(this.expertModelTraces);\r\n  }\r\n\r\n  toDb(): CompanyModelEntry {\r\n    const expertModelTraces = {};\r\n    Object.entries(this.expertModelTraces).forEach(\r\n      ([id, trace]) => (expertModelTraces[id] = trace.toDb())\r\n    );\r\n    return {\r\n      ...super.toDb(),\r\n      expertModelTraces,\r\n      createdByMethod: this.createdByMethod,\r\n    };\r\n  }\r\n}\r\n","import { Instance } from './instance';\r\nimport { Feature } from './feature';\r\n\r\nexport interface PatternHint {\r\n  pattern: Instance;\r\n  missingFeatures: Feature[];\r\n}\r\n\r\nexport class ConformanceReport {\r\n  errorFeatureIds: string[] = [];\r\n  errors: string[] = [];\r\n  warningFeatureIds: string[] = [];\r\n  warnings: string[] = [];\r\n  strengthFeatureIds: string[] = [];\r\n  strengths: string[] = [];\r\n  hintFeatureIds: string[] = [];\r\n  hints: string[] = [];\r\n  patternHintFeatureIds: string[] = [];\r\n  patternHints: PatternHint[] = [];\r\n  usedPatterns: Instance[] = [];\r\n\r\n  constructor(conformanceReport: Partial<ConformanceReport> = {}) {\r\n    Object.assign(this, conformanceReport);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ExpertModel, ExpertModelEntry, ExpertModelInit } from './expert-model';\r\nimport { Domain } from '../development-process-registry/knowledge/domain';\r\nimport { InstanceInit } from './instance';\r\nimport { FeatureModelService } from './feature-model.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ExpertModelService extends FeatureModelService<\r\n  ExpertModel,\r\n  ExpertModelInit\r\n> {\r\n  protected readonly typeName = ExpertModel.typeName;\r\n\r\n  protected readonly elementConstructor = ExpertModel;\r\n\r\n  async getList(selector = {}): Promise<ExpertModelEntry[]> {\r\n    return this.pouchdbService.find<ExpertModelEntry>(ExpertModel.typeName, {\r\n      selector,\r\n    });\r\n  }\r\n\r\n  async updateDomains(id: string, domains: Domain[]): Promise<void> {\r\n    const expertModel = await this.get(id);\r\n    expertModel.updateDomains(domains);\r\n    await this.save(expertModel);\r\n  }\r\n\r\n  async addInstance(id: string, instance: InstanceInit): Promise<void> {\r\n    const expertModel = await this.get(id);\r\n    expertModel.addInstance(instance);\r\n    await this.save(expertModel);\r\n  }\r\n\r\n  async removeInstance(id: string, instanceId: number): Promise<void> {\r\n    const expertModel = await this.get(id);\r\n    expertModel.removeInstance(instanceId);\r\n    await this.save(expertModel);\r\n  }\r\n\r\n  async save(expertModel: ExpertModel): Promise<void> {\r\n    await this.pouchdbService.put(expertModel);\r\n  }\r\n}\r\n","import {\r\n  FeatureModel,\r\n  FeatureModelEntry,\r\n  FeatureModelInit,\r\n  FeatureModelJsonSchema,\r\n} from './feature-model';\r\nimport { Instance, InstanceType } from './instance';\r\nimport {\r\n  Domain,\r\n  DomainEntry,\r\n  DomainInit,\r\n} from '../development-process-registry/knowledge/domain';\r\n\r\nexport interface ExpertModelInit extends FeatureModelInit {\r\n  domains?: DomainInit[];\r\n  version?: string;\r\n}\r\n\r\nexport interface ExpertModelEntry extends FeatureModelEntry {\r\n  domains: DomainEntry[];\r\n  version: string;\r\n}\r\n\r\ninterface ExpertModelJsonSchema extends FeatureModelJsonSchema {\r\n  version: string;\r\n}\r\n\r\nexport class ExpertModel extends FeatureModel implements ExpertModelInit {\r\n  static readonly typeName = 'ExpertModel';\r\n\r\n  domains: Domain[] = [];\r\n  version: string;\r\n\r\n  constructor(\r\n    entry: ExpertModelEntry | undefined,\r\n    init: ExpertModelInit | undefined\r\n  ) {\r\n    super(entry, init, ExpertModel.typeName);\r\n    if (entry != null) {\r\n      this.domains =\r\n        entry.domains?.map((domain) => new Domain(domain, undefined)) ??\r\n        this.domains;\r\n      this.version = entry.version;\r\n    } else if (init != null) {\r\n      this.domains =\r\n        init.domains?.map((domain) => new Domain(undefined, domain)) ??\r\n        this.domains;\r\n      this.version = init.version;\r\n    }\r\n  }\r\n\r\n  update(expertModel: Partial<ExpertModel>): void {\r\n    super.update(expertModel);\r\n    if (expertModel.version !== undefined) {\r\n      this.version = expertModel.version;\r\n    }\r\n  }\r\n\r\n  updateDomains(domains: DomainInit[]): void {\r\n    this.domains = domains.map((domain) => new Domain(undefined, domain));\r\n  }\r\n\r\n  getExamples(): Instance[] {\r\n    return this.instances.filter(\r\n      (instance) => instance.type === InstanceType.EXAMPLE\r\n    );\r\n  }\r\n\r\n  getPatterns(): Instance[] {\r\n    return this.instances.filter(\r\n      (instance) => instance.type === InstanceType.PATTERN\r\n    );\r\n  }\r\n\r\n  toDb(): ExpertModelEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      domains: this.domains.map((domain) => domain.toDb()),\r\n      version: this.version,\r\n    };\r\n  }\r\n\r\n  toJSON(): ExpertModelJsonSchema {\r\n    return {\r\n      ...super.toJSON(),\r\n      version: this.version,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DefaultElementService } from '../database/default-element.service';\r\nimport { FeatureModel, FeatureModelInit } from './feature-model';\r\nimport { Author } from '../model/author';\r\nimport { CanvasDefinition } from './canvas-definition';\r\n\r\n@Injectable()\r\nexport abstract class FeatureModelService<\r\n  T extends FeatureModel,\r\n  S extends FeatureModelInit\r\n> extends DefaultElementService<T, S> {\r\n  createFeatureModel(model: S, definition: CanvasDefinition): T {\r\n    const expertModel = new this.elementConstructor(undefined, model);\r\n    expertModel.definition = definition;\r\n    return expertModel;\r\n  }\r\n\r\n  /**\r\n   * Update a feature model\r\n   *\r\n   * @param id the id of the feature model to update\r\n   * @param element the new data of the feature model\r\n   */\r\n  async update(id: string, element: Partial<T>): Promise<void> {\r\n    const featureModel = await this.get(id);\r\n    featureModel.update(element);\r\n    await this.save(featureModel);\r\n  }\r\n\r\n  async updateAuthor(id: string, author: Partial<Author>): Promise<void> {\r\n    const featureModel = await this.get(id);\r\n    featureModel.updateAuthor(author);\r\n    await this.save(featureModel);\r\n  }\r\n}\r\n","import { DatabaseModel } from '../database/database-model';\r\nimport { Author, AuthorEntry, AuthorInit } from '../model/author';\r\nimport { Feature, FeatureEntry, FeatureInit } from './feature';\r\nimport { Instance, InstanceEntry, InstanceInit } from './instance';\r\nimport { RelationshipType } from './relationships';\r\nimport { getId } from '../model/utils';\r\nimport {\r\n  CanvasDefinition,\r\n  CanvasDefinitionEntry,\r\n  CanvasDefinitionInit,\r\n} from './canvas-definition';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../database/database-entry';\r\n\r\nexport interface FeatureModelInit extends DatabaseRootInit {\r\n  name: string;\r\n  $definition: CanvasDefinitionInit;\r\n\r\n  description?: string;\r\n  copyright?: string;\r\n  author?: AuthorInit;\r\n  features?: { [id: string]: FeatureInit };\r\n  instances?: InstanceInit[];\r\n}\r\n\r\nexport interface FeatureModelEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  description: string;\r\n  copyright: string;\r\n  author: AuthorEntry;\r\n  features: { [id: string]: FeatureEntry };\r\n  instances: InstanceEntry[];\r\n\r\n  nextInstanceId: number;\r\n\r\n  $definition: CanvasDefinitionEntry;\r\n}\r\n\r\nexport interface FeatureModelJsonSchema {\r\n  $definition: CanvasDefinition;\r\n  name: string;\r\n  description: string;\r\n  copyright: string;\r\n  author: Author;\r\n  features: { [id: string]: Feature };\r\n  instances: Instance[];\r\n}\r\n\r\nexport class FeatureModel extends DatabaseModel implements FeatureModelInit {\r\n  // JSON Schema (stored)\r\n  name: string;\r\n  description: string;\r\n  copyright: string;\r\n  author: Author;\r\n  features: { [id: string]: Feature } = {};\r\n  instances: Instance[] = [];\r\n\r\n  nextInstanceId: number;\r\n\r\n  $definition: CanvasDefinition;\r\n\r\n  constructor(\r\n    entry: FeatureModelEntry | undefined,\r\n    init: FeatureModelInit | undefined,\r\n    type: string\r\n  ) {\r\n    super(entry, init, type);\r\n    const element = entry ?? init;\r\n    this.nextInstanceId = element.instances ? element.instances.length : 0;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n    this.copyright = element.copyright;\r\n\r\n    if (entry != null) {\r\n      this.author = new Author(entry.author, undefined);\r\n      if (entry.features != null) {\r\n        Object.entries(entry.features).forEach(\r\n          ([id, feature]) =>\r\n            (this.features[id] = new Feature(feature, undefined, id, null))\r\n        );\r\n      }\r\n      this.instances =\r\n        entry.instances?.map((instance) => new Instance(instance, undefined)) ??\r\n        this.instances;\r\n      this.$definition = new CanvasDefinition(entry.$definition, undefined);\r\n    } else if (init != null) {\r\n      this.author = new Author(undefined, init.author ?? {});\r\n      if (init.features != null) {\r\n        Object.entries(init.features).forEach(\r\n          ([id, feature]) =>\r\n            (this.features[id] = new Feature(undefined, feature, id, null))\r\n        );\r\n      }\r\n      this.instances =\r\n        init.instances?.map((instance) => new Instance(undefined, instance)) ??\r\n        this.instances;\r\n      this.$definition = new CanvasDefinition(undefined, init.$definition);\r\n    }\r\n  }\r\n\r\n  set definition(definition: CanvasDefinition) {\r\n    this.$definition = definition;\r\n    this.features = {};\r\n    this.instances = [];\r\n    this.$definition.rootFeatures.forEach(\r\n      (feature) =>\r\n        (this.features[feature.id] = new Feature(\r\n          undefined,\r\n          feature,\r\n          feature.id,\r\n          null\r\n        ))\r\n    );\r\n  }\r\n\r\n  get definition(): CanvasDefinition {\r\n    return this.$definition;\r\n  }\r\n\r\n  update(featureModel: Partial<FeatureModel>): void {\r\n    if (featureModel.name !== undefined) {\r\n      this.name = featureModel.name;\r\n    }\r\n    if (featureModel.description !== undefined) {\r\n      this.description = featureModel.description;\r\n    }\r\n    if (featureModel.copyright !== undefined) {\r\n      this.copyright = featureModel.copyright;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the author of this feature model with new values\r\n   *\r\n   * @param author the new values of the author (values will be copied to the current object)\r\n   */\r\n  updateAuthor(author: Partial<Author>): void {\r\n    this.author.update(author);\r\n  }\r\n\r\n  /**\r\n   * Add a feature to the feature model\r\n   *\r\n   * @param feature the feature to add to the feature model (values will be copied to a new object)\r\n   * @param featureId the feature id of the parent model\r\n   * @return the added feature\r\n   */\r\n  addFeature(feature: FeatureInit, featureId: string): Feature {\r\n    const parent = this.getFeature(featureId);\r\n    if (!feature.id) {\r\n      feature.id = this.getFeatureId(feature.name);\r\n    }\r\n    return parent.addSubfeature(feature);\r\n  }\r\n\r\n  /**\r\n   * Get the next unique feature id by name\r\n   *\r\n   * @param featureName the name of the feature\r\n   */\r\n  private getFeatureId(featureName: string): string {\r\n    return getId(\r\n      featureName,\r\n      this.getFeatureList().map((f) => f.id)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Remove a feature from the feature model\r\n   *\r\n   * @param featureId the feature of the feature\r\n   */\r\n  removeFeature(featureId: string): void {\r\n    const feature = this.getFeature(featureId);\r\n    const parent = feature.parent;\r\n    if (parent === null) {\r\n      throw new Error('Can not remove root features');\r\n    }\r\n    parent.removeSubfeature(featureId);\r\n\r\n    // * Clean up references\r\n    const featureList = feature.getAllSubfeatures();\r\n    featureList.push(feature);\r\n    const featureIdList = featureList.map((f) => f.id);\r\n    this.cleanReferences(featureIdList, featureList);\r\n  }\r\n\r\n  protected cleanReferences(\r\n    featureIdList: string[],\r\n    featureList: Feature[]\r\n  ): void {\r\n    // ** Relationships\r\n    const removeRelationships = (f: Feature): boolean => {\r\n      f.removeRelationships(featureIdList);\r\n      return false;\r\n    };\r\n    this.iterateFeatures(removeRelationships);\r\n\r\n    // ** Instances\r\n    this.instances.forEach((instance) =>\r\n      instance.removeFeatures(featureIdList)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Update a feature of this feature model\r\n   *\r\n   * @param featureId the feature of the feature\r\n   * @param parentFeatureId the feature id of the parent feature\r\n   * @param feature the new values of the feature (values will be copied to the current object)\r\n   */\r\n  updateFeature(\r\n    featureId: string,\r\n    parentFeatureId: string,\r\n    feature: Partial<Feature>\r\n  ): void {\r\n    const currentFeature = this.getFeature(featureId);\r\n    currentFeature.update(feature);\r\n    const currentParent = currentFeature.parent;\r\n    if (currentParent === null && parentFeatureId !== null) {\r\n      throw new Error('Can not move root features');\r\n    }\r\n    if (currentParent !== null && parentFeatureId === null) {\r\n      throw new Error('Can not move to root features');\r\n    }\r\n    if (currentParent !== null && currentParent.id !== parentFeatureId) {\r\n      const newParent = this.getFeature(parentFeatureId);\r\n      currentParent.removeSubfeature(featureId);\r\n      newParent.addSubfeature(currentFeature);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a list of all features with their id and their levelname\r\n   */\r\n  getFeatureList(): { id: string; levelname: string }[] {\r\n    const featureList: { id: string; levelname: string }[] = [];\r\n    const addToFeatureList = (feature: Feature): boolean => {\r\n      featureList.push({ id: feature.id, levelname: feature.getLevelname() });\r\n      return false;\r\n    };\r\n    this.iterateFeatures(addToFeatureList);\r\n    return featureList;\r\n  }\r\n\r\n  /**\r\n   * Get feature map that maps id of feature to the feature\r\n   *\r\n   * @return the feature map\r\n   */\r\n  getFeatureMap(): { [id: string]: Feature } {\r\n    const featureMap: { [id: string]: Feature } = {};\r\n    const addToFeatureMap = (feature: Feature): boolean => {\r\n      featureMap[feature.id] = feature;\r\n      return false;\r\n    };\r\n    this.iterateFeatures(addToFeatureMap);\r\n    return featureMap;\r\n  }\r\n\r\n  /**\r\n   * Get a feature of this feature model by its id\r\n   *\r\n   * @param featureId the feature id of the feature to get\r\n   */\r\n  getFeature(featureId: string): Feature {\r\n    let feature: Feature = null;\r\n    const isFeature = (f: Feature): boolean => {\r\n      if (f.id === featureId) {\r\n        feature = f;\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n    this.iterateFeatures(isFeature);\r\n    if (feature === null) {\r\n      throw new Error(\r\n        'Feature with id ' +\r\n          featureId +\r\n          ' does not exist on feature model ' +\r\n          this.name\r\n      );\r\n    }\r\n    return feature;\r\n  }\r\n\r\n  // Relationships between features\r\n\r\n  addRelationship(\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): void {\r\n    if (!this.definition.relationshipTypes.includes(relationshipType)) {\r\n      throw new Error(\r\n        'Relationship type ' +\r\n          relationshipType +\r\n          ' is not defined for this feature model.'\r\n      );\r\n    }\r\n    const fromFeature = this.getFeature(fromFeatureId);\r\n    this.getFeature(toFeatureId); // to check whether the feature really exists\r\n    fromFeature.addRelationship(relationshipType, toFeatureId);\r\n  }\r\n\r\n  removeRelationship(\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): void {\r\n    if (!this.definition.relationshipTypes.includes(relationshipType)) {\r\n      throw new Error(\r\n        'Relationship type ' +\r\n          relationshipType +\r\n          ' is not defined for this feature model.'\r\n      );\r\n    }\r\n    const fromFeature = this.getFeature(fromFeatureId);\r\n    fromFeature.removeRelationship(relationshipType, toFeatureId);\r\n  }\r\n\r\n  // Instances\r\n\r\n  /**\r\n   * Add an instance to this feature model\r\n   *\r\n   * @param instance the instance to add to this feature model (values will be copied to a new object)\r\n   * @return the new instance\r\n   */\r\n  addInstance(instance: InstanceInit): Instance {\r\n    const addedInstance = new Instance(undefined, {\r\n      ...instance,\r\n      id: this.nextInstanceId++,\r\n    });\r\n    if (\r\n      !this.definition.rootFeatures.every((rootFeature) =>\r\n        addedInstance.usedFeatures.includes(rootFeature.id)\r\n      )\r\n    ) {\r\n      this.definition.rootFeatures.forEach((feature) =>\r\n        addedInstance.addFeature(feature.id)\r\n      );\r\n    }\r\n    this.instances.push(addedInstance);\r\n    return addedInstance;\r\n  }\r\n\r\n  /**\r\n   * Get an instance of this feature model\r\n   *\r\n   * @param instanceId the id of the instance\r\n   */\r\n  getInstance(instanceId: number): Instance {\r\n    return this.instances.find((instance) => instance.id === instanceId);\r\n  }\r\n\r\n  /**\r\n   * Remove an instance from this feature model\r\n   *\r\n   * @param instanceId the id of the instance\r\n   */\r\n  removeInstance(instanceId: number): void {\r\n    this.instances = this.instances.filter(\r\n      (instance) => instance.id !== instanceId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Update an instance of this feature model\r\n   *\r\n   * @param instanceId the id of the instance\r\n   * @param instance the new values of the instance (values will be copied to the current object)\r\n   */\r\n  updateInstance(instanceId: number, instance: Partial<Instance>): void {\r\n    const currentInstance = this.instances.find((i) => i.id === instanceId);\r\n    currentInstance.update(instance);\r\n  }\r\n\r\n  /**\r\n   * Adapts an instance by copy it and add it as a new instance with a new name\r\n   *\r\n   * @param instanceId the id of the instance\r\n   * @param adaptationName the new name of the instance\r\n   */\r\n  adaptInstance(instanceId: number, adaptationName: string): void {\r\n    const instance = this.instances.find((i) => i.id === instanceId);\r\n    const addedInstance = this.addInstance(instance);\r\n    addedInstance.update({ id: this.nextInstanceId - 1, name: adaptationName });\r\n  }\r\n\r\n  /**\r\n   * Add a feature to an instance\r\n   *\r\n   * @param instanceId the id of the instance\r\n   * @param featureId the feature id of the feature to add to the instance\r\n   */\r\n  addFeatureToInstance(instanceId: number, featureId: string): void {\r\n    this.getFeature(featureId); // to check whether the feature really exists\r\n    const instance = this.instances.find((i) => i.id === instanceId);\r\n    instance.addFeature(featureId);\r\n  }\r\n\r\n  /**\r\n   * Remove a feature and its subfeatures from an instance\r\n   *\r\n   * @param instanceId the id of the instance\r\n   * @param featureId the feature id of the feature to remove from the instance\r\n   */\r\n  removeFeatureFromInstance(instanceId: number, featureId: string): void {\r\n    const instance = this.getInstance(instanceId);\r\n    const feature = this.getFeature(featureId);\r\n    const featureIds = feature.getAllSubfeatures().map((f) => f.id);\r\n    instance.removeFeature(feature.id);\r\n    instance.removeFeatures(featureIds);\r\n  }\r\n\r\n  // Export\r\n\r\n  toDb(): FeatureModelEntry {\r\n    const features = {};\r\n    Object.entries(this.features).forEach(\r\n      ([id, feature]) => (features[id] = feature.toDb())\r\n    );\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      description: this.description,\r\n      copyright: this.copyright,\r\n      author: this.author.toDb(),\r\n      features,\r\n      instances: this.instances.map((instance) => instance.toDb()),\r\n      nextInstanceId: this.nextInstanceId,\r\n      $definition: this.$definition ? this.$definition.toDb() : null,\r\n    };\r\n  }\r\n\r\n  toJSON(): FeatureModelJsonSchema {\r\n    return {\r\n      $definition: this.$definition,\r\n      name: this.name,\r\n      description: this.description ? this.description : undefined,\r\n      copyright: this.copyright,\r\n      author: this.author,\r\n      features: this.features,\r\n      instances: this.instances,\r\n    };\r\n  }\r\n\r\n  // Helper Functions\r\n\r\n  /**\r\n   * Iterates over all features until the function returns true.\r\n   * Iterates from top to bottom with all nested features\r\n   *\r\n   * @param func function to use on the features\r\n   * @param filter function to decide whether to walk through this part of the tree\r\n   */\r\n  iterateFeatures(\r\n    func: (feature: Feature) => boolean,\r\n    filter: (feature: Feature) => boolean = (): boolean => true\r\n  ): void {\r\n    const featureStack: Feature[] = [];\r\n\r\n    featureStack.push(...Object.values(this.features).reverse().filter(filter));\r\n\r\n    while (featureStack.length > 0) {\r\n      const current = featureStack.pop();\r\n\r\n      if (func(current)) {\r\n        return;\r\n      }\r\n\r\n      featureStack.push(\r\n        ...Object.values(current.subfeatures).reverse().filter(filter)\r\n      );\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Relationships,\r\n  RelationshipsEntry,\r\n  RelationshipsInit,\r\n  RelationshipType,\r\n} from './relationships';\r\nimport { DatabaseModelPart } from '../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport enum FeatureType {\r\n  OPTIONAL = 'optional',\r\n  MANDATORY = 'mandatory',\r\n}\r\n\r\nexport enum SubfeatureConnectionsType {\r\n  OR = 'or',\r\n  XOR = 'xor',\r\n}\r\n\r\nexport interface FeatureInit extends DatabaseInit {\r\n  id?: string;\r\n  name: string;\r\n  description?: string;\r\n  type?: FeatureType;\r\n  subfeatures?: { [id: string]: FeatureInit };\r\n  subfeatureConnections?: SubfeatureConnectionsType;\r\n  relationships?: RelationshipsInit;\r\n  expertModelTrace?: { [expertModel: string]: string };\r\n}\r\n\r\nexport interface FeatureEntry extends DatabaseEntry {\r\n  name: string;\r\n  description: string;\r\n  type: FeatureType;\r\n  subfeatures: { [id: string]: FeatureEntry };\r\n  subfeatureConnections: SubfeatureConnectionsType;\r\n  relationships: RelationshipsEntry;\r\n  expertModelTrace: { [expertModel: string]: string };\r\n}\r\n\r\ninterface FeatureJsonSchema {\r\n  name: string;\r\n  description: string;\r\n  type: FeatureType;\r\n  subfeatures: { [id: string]: Feature };\r\n  subfeatureConnections: SubfeatureConnectionsType;\r\n  relationships: Relationships;\r\n}\r\n\r\nexport class Feature implements FeatureInit, DatabaseModelPart {\r\n  // JSON Schema (stored)\r\n  name: string;\r\n  description: string;\r\n  type: FeatureType = FeatureType.OPTIONAL;\r\n  subfeatures: { [id: string]: Feature } = {};\r\n  subfeatureConnections: SubfeatureConnectionsType = null;\r\n  relationships: Relationships;\r\n\r\n  // stored\r\n  expertModelTrace: { [expertModel: string]: string } = {};\r\n\r\n  // non stored\r\n  id: string;\r\n  parent: Feature = null;\r\n  level: number;\r\n\r\n  // Fix the id for ng bootstrap\r\n  _fixId: string;\r\n\r\n  get fixId(): string {\r\n    if (this._fixId === undefined) {\r\n      this._fixId = this.getFixId();\r\n    }\r\n    return this._fixId;\r\n  }\r\n\r\n  private getFixId(): string {\r\n    if (this.id == null) {\r\n      return null;\r\n    }\r\n    return '_' + this.id.replace(/[&/]/, '');\r\n  }\r\n\r\n  constructor(\r\n    entry: FeatureEntry | undefined,\r\n    init: FeatureInit | undefined,\r\n    id: string,\r\n    parent: Feature\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.id = id;\r\n    this.parent = parent;\r\n    this.level = this.parent ? this.parent.level + 1 : 1;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n    this.type = element.type ?? this.type;\r\n    this.expertModelTrace = element.expertModelTrace ?? this.expertModelTrace;\r\n    this.subfeatureConnections =\r\n      element.subfeatureConnections ?? this.subfeatureConnections;\r\n\r\n    if (entry != null) {\r\n      this.relationships = new Relationships(entry.relationships, undefined);\r\n      if (entry.subfeatures != null) {\r\n        Object.entries(entry.subfeatures).forEach(\r\n          ([subId, innerFeature]) =>\r\n            (this.subfeatures[subId] = new Feature(\r\n              innerFeature,\r\n              undefined,\r\n              subId,\r\n              this\r\n            ))\r\n        );\r\n      }\r\n    } else if (init != null) {\r\n      this.relationships = new Relationships(\r\n        undefined,\r\n        init.relationships ?? {}\r\n      );\r\n      if (init.subfeatures != null) {\r\n        Object.entries(init.subfeatures).forEach(\r\n          ([subId, innerFeature]) =>\r\n            (this.subfeatures[subId] = new Feature(\r\n              undefined,\r\n              innerFeature,\r\n              subId,\r\n              this\r\n            ))\r\n        );\r\n      }\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update this feature with new values\r\n   *\r\n   * @param feature the new values of this feature (values will be copied to the current object)\r\n   */\r\n  update(feature: Partial<Feature>): void {\r\n    Object.assign(this, feature);\r\n  }\r\n\r\n  /**\r\n   * Add a new subfeature to this feature\r\n   *\r\n   * @param feature the feature to add to the feature (values will be copied to a new object)\r\n   * @return the added feature\r\n   */\r\n  addSubfeature(feature: FeatureInit): Feature {\r\n    const id = feature.id;\r\n    this.subfeatures[id] = new Feature(undefined, feature, id, this);\r\n    return this.subfeatures[id];\r\n  }\r\n\r\n  /**\r\n   * Remove a subfeature of this feature\r\n   *\r\n   * @param featureId the featureId of the feature to remove\r\n   */\r\n  removeSubfeature(featureId: string): void {\r\n    if (!(featureId in this.subfeatures)) {\r\n      throw new Error(\r\n        'Feature ' + this.name + ' has no subfeature with id ' + featureId\r\n      );\r\n    }\r\n    delete this.subfeatures[featureId];\r\n  }\r\n\r\n  /**\r\n   * Get a list of all subfeatures and nested subfeatures\r\n   *\r\n   * @return the list of features\r\n   */\r\n  getAllSubfeatures(): Feature[] {\r\n    const featureList = [];\r\n    const addFeature = (feature: Feature): boolean => {\r\n      featureList.push(feature);\r\n      return false;\r\n    };\r\n    this.iterateFeatures(addFeature);\r\n    return featureList;\r\n  }\r\n\r\n  /**\r\n   * Get the levelname of this feature for level level\r\n   */\r\n  getLevelname(): string {\r\n    return '-'.repeat(this.level) + ' ' + this.name;\r\n  }\r\n\r\n  // Relationships\r\n\r\n  /**\r\n   * Add a relationship to a another feature\r\n   *\r\n   * @param relationshipType the relationship type\r\n   * @param toFeatureId the id of the other feature\r\n   */\r\n  addRelationship(\r\n    relationshipType: RelationshipType,\r\n    toFeatureId: string\r\n  ): void {\r\n    this.relationships.addRelationship(relationshipType, toFeatureId);\r\n  }\r\n\r\n  /**\r\n   * Remove a relationship to a another feature\r\n   *\r\n   * @param relationshipType the relationship type\r\n   * @param toFeatureId the id of the other feature\r\n   */\r\n  removeRelationship(\r\n    relationshipType: RelationshipType,\r\n    toFeatureId: string\r\n  ): void {\r\n    this.relationships.removeRelationship(relationshipType, toFeatureId);\r\n  }\r\n\r\n  /**\r\n   * Remove relationships to all features in featureIds array\r\n   *\r\n   * @param featureIds the feature ids\r\n   */\r\n  removeRelationships(featureIds: string[]): void {\r\n    this.relationships.removeRelationships(featureIds);\r\n  }\r\n\r\n  // Traces\r\n\r\n  /**\r\n   * Add a trace to a feature of an expert model\r\n   *\r\n   * @param expertModelId the expert model id\r\n   * @param expertFeatureId the id of the feature of the expert model\r\n   */\r\n  addTrace(expertModelId: string, expertFeatureId: string): void {\r\n    if (this.expertModelTrace[expertModelId]) {\r\n      throw new Error('Trace for this feature is already defined');\r\n    }\r\n    this.expertModelTrace[expertModelId] = expertFeatureId;\r\n  }\r\n\r\n  /**\r\n   * Remove a trace to a feature of an expert model\r\n   *\r\n   * @param expertModelId the expert model id\r\n   */\r\n  removeTrace(expertModelId: string): void {\r\n    delete this.expertModelTrace[expertModelId];\r\n  }\r\n\r\n  // Export\r\n\r\n  toDb(): FeatureEntry {\r\n    const subfeatures = {};\r\n    Object.entries(this.subfeatures).forEach(\r\n      ([id, feature]) => (subfeatures[id] = feature.toDb())\r\n    );\r\n    return {\r\n      name: this.name,\r\n      description: this.description,\r\n      type: this.type,\r\n      subfeatures,\r\n      subfeatureConnections: this.subfeatureConnections,\r\n      relationships: this.relationships.toDb(),\r\n      expertModelTrace: this.expertModelTrace,\r\n    };\r\n  }\r\n\r\n  toJSON(): FeatureJsonSchema {\r\n    return {\r\n      name: this.name,\r\n      description: this.description ? this.description : undefined,\r\n      type: this.type,\r\n      subfeatures: this.subfeatures,\r\n      subfeatureConnections: this.subfeatureConnections,\r\n      relationships: this.relationships,\r\n    };\r\n  }\r\n\r\n  // Helper Functions\r\n\r\n  /**\r\n   * Iterates over all features until the function returns true.\r\n   * Iterates from top to bottom with all nested features\r\n   *\r\n   * @param func function to use on the features\r\n   */\r\n  private iterateFeatures(func: (feature: Feature) => boolean): void {\r\n    const featureStack: Feature[] = [];\r\n\r\n    featureStack.push(...Object.values(this.subfeatures).reverse());\r\n\r\n    while (featureStack.length > 0) {\r\n      const current = featureStack.pop();\r\n\r\n      if (func(current)) {\r\n        return;\r\n      }\r\n\r\n      featureStack.push(...Object.values(current.subfeatures).reverse());\r\n    }\r\n  }\r\n}\r\n","import { CompanyModel } from './company-model';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\n\r\nexport class InstanceArtifactData implements ArtifactDataReference {\r\n  type = CompanyModel.typeName;\r\n  id: string;\r\n  instanceId: number;\r\n\r\n  constructor(instanceArtifactData: Partial<InstanceArtifactData>) {\r\n    Object.assign(this, instanceArtifactData);\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport enum InstanceType {\r\n  PATTERN = 'pattern',\r\n  EXAMPLE = 'example',\r\n}\r\n\r\nexport interface InstanceInit extends DatabaseInit {\r\n  name: string;\r\n  type: InstanceType;\r\n  description?: string;\r\n  usedFeatures?: string[];\r\n  id?: number;\r\n}\r\n\r\nexport interface InstanceEntry extends DatabaseEntry {\r\n  name: string;\r\n  type: InstanceType;\r\n  description: string;\r\n  usedFeatures: string[];\r\n  id: number;\r\n}\r\n\r\ninterface InstanceJsonSchema {\r\n  name: string;\r\n  type: InstanceType;\r\n  description: string;\r\n  usedFeatures: string[];\r\n}\r\n\r\nexport class Instance implements InstanceInit, DatabaseModelPart {\r\n  // JSON Schema (stored)\r\n  name: string;\r\n  type: InstanceType;\r\n  description: string;\r\n  usedFeatures: string[] = [];\r\n\r\n  // stored\r\n  id: number;\r\n\r\n  constructor(\r\n    entry: InstanceEntry | undefined,\r\n    init: InstanceInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.id = element.id;\r\n    this.name = element.name;\r\n    this.type = element.type;\r\n    this.description = element.description;\r\n    this.usedFeatures = element.usedFeatures ?? this.usedFeatures;\r\n  }\r\n\r\n  /**\r\n   * Update this instance with new values\r\n   *\r\n   * @param instance the new values of this instance (values will be copied to the current object)\r\n   */\r\n  update(instance: Partial<Instance>): void {\r\n    Object.assign(this, instance);\r\n  }\r\n\r\n  /**\r\n   * Add a feature to this instance\r\n   *\r\n   * @param featureId the feature id of the feature to add\r\n   */\r\n  addFeature(featureId: string): void {\r\n    if (this.usedFeatures.includes(featureId)) {\r\n      throw new Error(\r\n        'Feature with id ' +\r\n          featureId +\r\n          ' is already used in instance ' +\r\n          this.name\r\n      );\r\n    }\r\n    this.usedFeatures.push(featureId);\r\n  }\r\n\r\n  /**\r\n   * Remove a feature from this instance\r\n   *\r\n   * @param featureId the feature id of the feature to remove\r\n   */\r\n  removeFeature(featureId: string): void {\r\n    if (!this.usedFeatures.includes(featureId)) {\r\n      throw new Error(\r\n        'Feature with id ' + featureId + ' is not used in instance ' + this.name\r\n      );\r\n    }\r\n    this.usedFeatures = this.usedFeatures.filter((id) => id !== featureId);\r\n  }\r\n\r\n  /**\r\n   * Remove features from this instance\r\n   *\r\n   * @param featureIds the feature ids of the features to remove\r\n   */\r\n  removeFeatures(featureIds: string[]): void {\r\n    this.usedFeatures = this.usedFeatures.filter(\r\n      (id) => !featureIds.includes(id)\r\n    );\r\n  }\r\n\r\n  // Export\r\n\r\n  toDb(): InstanceEntry {\r\n    return {\r\n      id: this.id,\r\n      name: this.name,\r\n      type: this.type,\r\n      description: this.description,\r\n      usedFeatures: this.usedFeatures,\r\n    };\r\n  }\r\n\r\n  toJSON(): InstanceJsonSchema {\r\n    return {\r\n      name: this.name,\r\n      type: this.type,\r\n      description: this.description,\r\n      usedFeatures: this.usedFeatures,\r\n    };\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport type RelationshipType = string;\r\n\r\nexport interface RelationshipsInit extends DatabaseInit {\r\n  relationships?: { [type: string]: string[] };\r\n}\r\n\r\nexport interface RelationshipsEntry extends DatabaseEntry {\r\n  relationships: { [type: string]: string[] };\r\n}\r\n\r\nexport class Relationships implements RelationshipsInit, DatabaseModelPart {\r\n  // JSON Schema (stored)\r\n  relationships: { [type: string]: string[] } = {};\r\n\r\n  constructor(\r\n    entry: RelationshipsEntry | undefined,\r\n    init: RelationshipsInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.relationships = element.relationships ?? this.relationships;\r\n  }\r\n\r\n  /**\r\n   * Add a relationship to a feature\r\n   *\r\n   * @param relationshipType the relationship type\r\n   * @param featureId the id of the feature\r\n   */\r\n  addRelationship(relationshipType: RelationshipType, featureId: string): void {\r\n    if (!(relationshipType in this.relationships)) {\r\n      this.relationships[relationshipType] = [];\r\n    }\r\n    const list: string[] = this.relationships[relationshipType];\r\n    if (list.includes(featureId)) {\r\n      return;\r\n    }\r\n    list.push(featureId);\r\n  }\r\n\r\n  /**\r\n   * Remove a relationship to a feature\r\n   *\r\n   * @param relationshipType the relationship type\r\n   * @param featureId the id of the feature\r\n   */\r\n  removeRelationship(\r\n    relationshipType: RelationshipType,\r\n    featureId: string\r\n  ): void {\r\n    const list: string[] = this.relationships[relationshipType];\r\n    if (list == null) {\r\n      return;\r\n    }\r\n    this.relationships[relationshipType] = list.filter(\r\n      (id) => id !== featureId\r\n    );\r\n    if (this.relationships[relationshipType].length === 0) {\r\n      delete this.relationships[relationshipType];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove relationships to all features in featureIds array\r\n   *\r\n   * @param featureIds the feature ids\r\n   */\r\n  removeRelationships(featureIds: string[]): void {\r\n    const relationshipTypes = Object.keys(this.relationships);\r\n    relationshipTypes.forEach((type) => {\r\n      this.relationships[type] = this.relationships[type].filter(\r\n        (id) => !featureIds.includes(id)\r\n      );\r\n      if (this.relationships[type].length === 0) {\r\n        delete this.relationships[type];\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Returns true, if it has no relationships, otherwise false\r\n   *\r\n   * @return true if it has no relationships\r\n   */\r\n  hasNoRelationships(): boolean {\r\n    const relationshipLists = Object.values(this.relationships);\r\n    const relationshipCount = relationshipLists\r\n      .map((list) => list.length)\r\n      .reduce((acc, current) => acc + current, 0);\r\n    return relationshipCount === 0;\r\n  }\r\n\r\n  /**\r\n   * Get an array of all referenced feature ids\r\n   *\r\n   * @return the array with all feature ids\r\n   */\r\n  getAllReferencedFeatureIds(): string[] {\r\n    const relationshipLists = Object.values(this.relationships);\r\n    return relationshipLists.reduce((acc, current) => acc.concat(current), []);\r\n  }\r\n\r\n  /**\r\n   * Get the relationships of a specific type\r\n   *\r\n   * @param relationshipType the type of the relationship\r\n   * @return the array with all feature ids\r\n   */\r\n  getRelationships(relationshipType: RelationshipType): string[] {\r\n    const list: string[] = this.relationships[relationshipType];\r\n    if (list == null) {\r\n      return [];\r\n    }\r\n    return list;\r\n  }\r\n\r\n  /**\r\n   * Checks whether the relationship of a specific type to a specific feature\r\n   * is included\r\n   *\r\n   * @param relationshipType the relationship type\r\n   * @param featureId the id of the feature\r\n   * @return true if the relationship exists\r\n   */\r\n  hasRelationship(\r\n    relationshipType: RelationshipType,\r\n    featureId: string\r\n  ): boolean {\r\n    const relationships = this.getRelationships(relationshipType);\r\n    return relationships.includes(featureId);\r\n  }\r\n\r\n  /**\r\n   * Get all used relationship types in this relationship class\r\n   *\r\n   * @return an array of relationship types\r\n   */\r\n  getRelationshipTypes(): RelationshipType[] {\r\n    return Object.keys(this.relationships);\r\n  }\r\n\r\n  // Export\r\n\r\n  toDb(): RelationshipsEntry {\r\n    return {\r\n      relationships: this.relationships,\r\n    };\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport interface TraceInit extends DatabaseInit {\r\n  expertFeatureIdMap?: { [expertModelFeatureId: string]: string };\r\n}\r\n\r\nexport interface TraceEntry extends DatabaseEntry {\r\n  expertFeatureIdMap: { [expertModelFeatureId: string]: string };\r\n}\r\n\r\nexport class Trace implements DatabaseModelPart {\r\n  // stored\r\n  expertFeatureIdMap: { [expertModelFeatureId: string]: string } = {};\r\n\r\n  constructor(entry: TraceEntry, init: TraceInit) {\r\n    const element = entry ?? init;\r\n    this.expertFeatureIdMap =\r\n      element.expertFeatureIdMap ?? this.expertFeatureIdMap;\r\n  }\r\n\r\n  addTrace(expertFeatureId: string, companyFeatureId: string): void {\r\n    this.expertFeatureIdMap[expertFeatureId] = companyFeatureId;\r\n  }\r\n\r\n  deleteTrace(expertFeatureId: string): void {\r\n    delete this.expertFeatureIdMap[expertFeatureId];\r\n  }\r\n\r\n  toDb(): TraceEntry {\r\n    return {\r\n      expertFeatureIdMap: this.expertFeatureIdMap,\r\n    };\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Compare Canvas\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"instance && runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <app-instance\r\n    [compareInstance]=\"compareInstance\"\r\n    [percentages]=\"percentages\"\r\n    [featureModel]=\"companyModel\"\r\n    [instance]=\"instance\"\r\n    [adaptable]=\"false\"\r\n    [updatable]=\"false\"\r\n    (updateFeatureModel)=\"updateCompanyModel()\"\r\n  ></app-instance>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Compare</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-instance-compare-form\r\n        [companyModel]=\"companyModel\"\r\n        [currentlyComparing]=\"compareInstance != null\"\r\n        [competitors]=\"competitors\"\r\n        (compare)=\"compare($event.instance, $event.featureModelId)\"\r\n        (clearCompare)=\"clearCompare()\"\r\n      ></app-instance-compare-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish comparison</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish comparison\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { InstanceService } from '../../instances/instance.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-compare',\r\n  templateUrl: './compare.component.html',\r\n  styleUrls: ['./compare.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class CompareComponent implements OnInit {\r\n  competitors: Instance[];\r\n\r\n  expertModelId: string = null;\r\n  compareInstance: Instance = null;\r\n  percentages: { [id: string]: number } = null;\r\n\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private instanceService: InstanceService,\r\n    private processApiService: ProcessApiService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.instanceLoaderService.loaded.subscribe(() => {\r\n      this.competitors = this.companyModel.instances.filter(\r\n        (instance) => instance.id !== this.instance.id\r\n      );\r\n      if (this.compareInstance) {\r\n        this.compare(this.compareInstance, this.expertModelId);\r\n      }\r\n    });\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instance.id\r\n    );\r\n  }\r\n\r\n  compare(instance: Instance, modelId: string): void {\r\n    if (modelId !== this.companyModel._id) {\r\n      this.expertModelId = modelId;\r\n    } else {\r\n      this.expertModelId = null;\r\n    }\r\n    this.compareInstance = this.expertModelId\r\n      ? this.instanceService.convertExpertInstance(\r\n          this.companyModel,\r\n          this.expertModelId,\r\n          instance\r\n        )\r\n      : instance;\r\n    this.percentages = this.instanceService.compareInstances(\r\n      this.companyModel,\r\n      this.instance,\r\n      this.compareInstance\r\n    );\r\n  }\r\n\r\n  clearCompare(): void {\r\n    this.expertModelId = null;\r\n    this.compareInstance = null;\r\n    this.percentages = null;\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  async updateCompanyModel(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instance(): Instance {\r\n    return this.instanceLoaderService.instance;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<ng-template #createModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">Create Composed Model</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"createForm\" (ngSubmit)=\"createCompanyModel()\">\r\n        <app-feature-model-subform\r\n          formGroupName=\"featureModel\"\r\n        ></app-feature-model-subform>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!createForm.valid\"\r\n            >\r\n              Create Composed Model\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-container [formGroup]=\"formGroup\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"companyModelSelector\" class=\"col-sm-6 col-form-label\"\r\n      >Composed Model</label\r\n    >\r\n    <div class=\"col-sm-6 input-group\">\r\n      <select\r\n        id=\"companyModelSelector\"\r\n        formControlName=\"companyModelId\"\r\n        class=\"form-control\"\r\n      >\r\n        <option *ngFor=\"let model of companyModels\" [value]=\"model._id\">\r\n          {{ model.name }}\r\n        </option>\r\n      </select>\r\n      <div\r\n        class=\"input-group-append\"\r\n        *ngIf=\"\r\n          stepDecision &&\r\n          stepDecision.automaticCreation &&\r\n          stepDecision.companyModelId === companyModelIdControl.value\r\n        \"\r\n      >\r\n        <button\r\n          class=\"btn btn-outline-warning\"\r\n          type=\"button\"\r\n          (click)=\"navigateSelectExpertKnowledge()\"\r\n        >\r\n          Edit\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <button\r\n      type=\"button\"\r\n      class=\"btn btn-primary ml-auto\"\r\n      (click)=\"openCreateCompanyModelModal()\"\r\n    >\r\n      Create new Composed Model\r\n    </button>\r\n  </div>\r\n</ng-container>\r\n","import { Component, EventEmitter, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\r\nimport { CompanyModelEntry } from '../../../canvas-meta-model/company-model';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { DecisionConfigurationFormComponent } from '../../../development-process-registry/module-api/decision-configuration-form-component';\r\nimport { Domain } from '../../../development-process-registry/knowledge/domain';\r\nimport {\r\n  FeatureModelFormService,\r\n  FeatureModelFormValue,\r\n} from '../../form-services/feature-model-form.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { CanvasDefinitionService } from '../../../canvas-meta-model/canvas-definition.service';\r\nimport { BmProcess } from '../../../development-process-registry/bm-process/bm-process';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-create-canvas-configuration',\r\n  templateUrl: './create-canvas-configuration.component.html',\r\n  styleUrls: ['./create-canvas-configuration.component.css'],\r\n})\r\nexport class CreateCanvasConfigurationComponent\r\n  implements OnInit, DecisionConfigurationFormComponent\r\n{\r\n  formGroup: FormGroup;\r\n  bmProcess: BmProcess;\r\n  predefinedInput: any;\r\n  contextDomains: Domain[];\r\n  stepDecision: any;\r\n  forceUpdate: EventEmitter<any>;\r\n\r\n  createForm: FormGroup;\r\n\r\n  companyModels: CompanyModelEntry[];\r\n\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('createModal', { static: true }) createModal: unknown;\r\n\r\n  constructor(\r\n    private canvasDefinitionService: CanvasDefinitionService,\r\n    private companyModelService: CompanyModelService,\r\n    private fb: FormBuilder,\r\n    private featureModelFormService: FeatureModelFormService,\r\n    private modalService: NgbModal,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadCompanyModels();\r\n    this.createForm = this.fb.group({\r\n      featureModel: this.featureModelFormService.createForm(),\r\n    });\r\n  }\r\n\r\n  openCreateCompanyModelModal(): void {\r\n    this.modalReference = this.modalService.open(this.createModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async createCompanyModel(): Promise<void> {\r\n    const model: FeatureModelFormValue = this.featureModelFormService.get(\r\n      this.createForm.get('featureModel').value\r\n    );\r\n    const canvasDefinition = await this.canvasDefinitionService.get(\r\n      this.predefinedInput.definitionId\r\n    );\r\n    const companyModel = this.companyModelService.createFeatureModel(\r\n      { ...model, $definition: canvasDefinition },\r\n      canvasDefinition\r\n    );\r\n    await this.companyModelService.add(companyModel);\r\n    this.forceUpdate.emit({\r\n      companyModelId: companyModel._id,\r\n      automaticCreation: true,\r\n    });\r\n    this.modalService.dismissAll();\r\n    await this.router.navigate(['companyModels', companyModel._id, 'select'], {\r\n      queryParams: {\r\n        bmProcessId: this.bmProcess._id,\r\n      },\r\n    });\r\n  }\r\n\r\n  async navigateSelectExpertKnowledge(): Promise<void> {\r\n    this.modalService.dismissAll();\r\n    await this.router.navigate(\r\n      ['companyModels', this.stepDecision.companyModelId, 'select'],\r\n      {\r\n        queryParams: {\r\n          bmProcessId: this.bmProcess._id,\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  private async loadCompanyModels(): Promise<void> {\r\n    this.companyModels = await this.companyModelService.getList(\r\n      this.predefinedInput.definitionId\r\n    );\r\n  }\r\n\r\n  get companyModelIdControl(): FormControl {\r\n    return this.formGroup.get('companyModelId') as FormControl;\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Create Canvas\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Create Artifact</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"form\" (ngSubmit)=\"submit()\">\r\n        <app-feature-model-instance-subform></app-feature-model-instance-subform>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!form.valid\"\r\n            >\r\n              Create Canvas Artifact\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n  <div *ngIf=\"companyModel\" class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">\r\n      Canvas Artifact Preview: {{ companyModel.definition.name }}\r\n    </h6>\r\n    <section>\r\n      <app-feature-model [featureModel]=\"companyModel\"></app-feature-model>\r\n    </section>\r\n    <section class=\"mt-3\" *ngIf=\"companyModel.definition.description\">\r\n      <h6>Description</h6>\r\n      <p class=\"mb-0\">{{ companyModel.definition.description }}</p>\r\n    </section>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { FeatureModelInstanceFormService } from '../../form-services/feature-model-instance-form.service';\r\nimport { InstanceInit } from '../../../canvas-meta-model/instance';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\n\r\n@Component({\r\n  selector: 'app-create-canvas',\r\n  templateUrl: './create-canvas.component.html',\r\n  styleUrls: ['./create-canvas.component.css'],\r\n  providers: [ProcessApiService],\r\n})\r\nexport class CreateCanvasComponent implements OnInit {\r\n  companyModel: CompanyModel;\r\n  form: FormGroup;\r\n\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private featureModelInstanceFormService: FeatureModelInstanceFormService,\r\n    private processApiService: ProcessApiService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.form = this.featureModelInstanceFormService.createForm();\r\n    this.processApiService.loaded.subscribe(() => this.loadCompanyModel());\r\n  }\r\n\r\n  async submit(): Promise<void> {\r\n    if (this.processApiService.stepInfo) {\r\n      const companyModel = await this.companyModelService.get(\r\n        this.runningMethod.decision.stepDecisions[\r\n          this.runningMethod.currentStepNumber\r\n        ].companyModelId\r\n      );\r\n      const instance: InstanceInit = this.featureModelInstanceFormService.get(\r\n        this.form.value\r\n      );\r\n      const instanceId = companyModel.addInstance(instance).id;\r\n      companyModel.resetDatabaseState();\r\n      companyModel.createdByMethod = true;\r\n      await this.companyModelService.save(companyModel);\r\n      this.canvasResolveService.resolveCreateCanvas(\r\n        this.processApiService.stepInfo,\r\n        companyModel._id,\r\n        instanceId\r\n      );\r\n    }\r\n  }\r\n\r\n  private async loadCompanyModel(): Promise<void> {\r\n    this.companyModel = await this.companyModelService.get(\r\n      this.runningMethod.decision.stepDecisions[\r\n        this.runningMethod.currentStepNumber\r\n      ].companyModelId\r\n    );\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"processApiService.runningProcess\">\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        processApiService.runningProcess._id\r\n      ]\"\r\n    >\r\n      {{ processApiService.runningProcess.process.name }} &ndash;\r\n      {{ processApiService.runningProcess.name }}\r\n    </a>\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        processApiService.runningProcess._id,\r\n        'method',\r\n        processApiService.runningMethod.executionId\r\n      ]\"\r\n    >\r\n      {{ processApiService.runningMethod.methodName }}\r\n    </a>\r\n    <a\r\n      class=\"nav-link active\"\r\n      [routerLink]=\"[]\"\r\n      [queryParams]=\"processApiService.queryParams\"\r\n    >\r\n      Create Competitor Canvas\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"\r\n    processApiService.runningMethod != null && processApiService.isCorrectStep()\r\n  \"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Create Competitors</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"form\" (ngSubmit)=\"submit()\">\r\n        <ul class=\"list-group mb-3\" formArrayName=\"competitors\">\r\n          <li\r\n            *ngFor=\"let control of formArray.controls; let index = index\"\r\n            class=\"list-group-item\"\r\n          >\r\n            <app-feature-model-instance-subform\r\n              [formGroupName]=\"index.toString()\"\r\n            ></app-feature-model-instance-subform>\r\n            <div class=\"d-flex\">\r\n              <button\r\n                type=\"button\"\r\n                class=\"btn btn-dark ml-auto\"\r\n                (click)=\"removeCompetitor(index)\"\r\n              >\r\n                Remove\r\n              </button>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n        <div class=\"d-flex\">\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-primary ml-auto mb-3\"\r\n            (click)=\"addCompetitor()\"\r\n          >\r\n            Add Competitor\r\n          </button>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!form.valid\"\r\n            >\r\n              Create Competitors\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { FormArray, FormBuilder, FormGroup } from '@angular/forms';\r\nimport { InstanceInit } from '../../../canvas-meta-model/instance';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { FeatureModelInstanceFormService } from '../../form-services/feature-model-instance-form.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\n\r\n@Component({\r\n  selector: 'app-create-competitor-canvas',\r\n  templateUrl: './create-competitor-canvas.component.html',\r\n  styleUrls: ['./create-competitor-canvas.component.css'],\r\n  providers: [ProcessApiService],\r\n})\r\nexport class CreateCompetitorCanvasComponent implements OnInit, OnDestroy {\r\n  companyModel: CompanyModel;\r\n  instanceId: number;\r\n\r\n  form: FormGroup = this.fb.group({\r\n    competitors: this.fb.array([]),\r\n  });\r\n\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private fb: FormBuilder,\r\n    private featureModelInstanceFormService: FeatureModelInstanceFormService,\r\n    public processApiService: ProcessApiService,\r\n    private route: ActivatedRoute\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      this.instanceId = +paramMap.get('instanceId');\r\n      void this.loadCompanyModel(paramMap.get('companyModelId'));\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.routeSubscription) {\r\n      this.routeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  addCompetitor(): void {\r\n    this.formArray.push(this.featureModelInstanceFormService.createForm());\r\n  }\r\n\r\n  removeCompetitor(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  async submit(): Promise<void> {\r\n    if (this.processApiService.stepInfo) {\r\n      const companyModel = this.companyModel;\r\n      for (const control of this.formArray.controls) {\r\n        const instance: InstanceInit = this.featureModelInstanceFormService.get(\r\n          control.value\r\n        );\r\n        companyModel.addInstance(instance);\r\n      }\r\n      await this.companyModelService.save(companyModel);\r\n      this.canvasResolveService.resolveEditCanvas(\r\n        this.processApiService.stepInfo,\r\n        this.companyModel._id,\r\n        this.instanceId\r\n      );\r\n    }\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.form.get('competitors') as FormArray;\r\n  }\r\n\r\n  private async loadCompanyModel(companyModelId: string): Promise<void> {\r\n    this.companyModel = await this.companyModelService.get(companyModelId);\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Edit Canvas\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"instance && runningMethod && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <app-instance\r\n    [conformance]=\"conformance\"\r\n    [conformanceIsChecked]=\"conformanceIsChecked\"\r\n    [featureModel]=\"companyModel\"\r\n    [instance]=\"instance\"\r\n    [adaptable]=\"false\"\r\n    [updatable]=\"false\"\r\n    (updateFeatureModel)=\"updateCompanyModel()\"\r\n  ></app-instance>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Conformance Check</h6>\r\n    <div class=\"container\">\r\n      <div class=\"row\" style=\"margin-top: 20px\">\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"!conformanceIsChecked\"\r\n          (click)=\"checkConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          Activate Conformance Checking of Business Model\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"conformanceIsChecked\"\r\n          (click)=\"uncheckConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          Deactivate Conformance Checking of Business Model\r\n        </button>\r\n      </div>\r\n      <div *ngIf=\"conformanceIsChecked\" style=\"margin-top: 20px\">\r\n        <div class=\"row\">\r\n          <div class=\"col\">\r\n            <h6>Errors</h6>\r\n            <ul>\r\n              <li *ngFor=\"let error of conformance.errors\">{{ error }}</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish editing</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish editing\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\nimport { CanvasModelConsistencyService } from '../../../canvas-meta-model/canvas-model-consistency.service';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-canvas',\r\n  templateUrl: './edit-canvas.component.html',\r\n  styleUrls: ['./edit-canvas.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class EditCanvasComponent implements OnInit {\r\n  conformanceIsChecked: boolean;\r\n  conformance: ConformanceReport;\r\n\r\n  constructor(\r\n    private canvasModelConsistencyService: CanvasModelConsistencyService,\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private processApiService: ProcessApiService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.instanceLoaderService.loaded.subscribe(() => {\r\n      if (this.conformanceIsChecked) {\r\n        this.checkConformance();\r\n      } else {\r\n        this.uncheckConformance();\r\n      }\r\n    });\r\n  }\r\n\r\n  uncheckConformance(): void {\r\n    this.conformanceIsChecked = false;\r\n    this.conformance = new ConformanceReport();\r\n  }\r\n\r\n  checkConformance(): void {\r\n    this.conformance =\r\n      this.canvasModelConsistencyService.checkConformanceOfInstance(\r\n        this.companyModel,\r\n        this.instance.id,\r\n        []\r\n      );\r\n    this.conformanceIsChecked = true;\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instance.id\r\n    );\r\n  }\r\n\r\n  async updateCompanyModel(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instance(): Instance {\r\n    return this.instanceLoaderService.instance;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<app-api-navigation [apiName]=\"'Edit ' + (competitor ? competitor.name : '')\">\r\n  <a\r\n    *ngIf=\"companyModel != null\"\r\n    class=\"nav-link\"\r\n    [routerLink]=\"[\r\n      '/',\r\n      'canvas',\r\n      this.companyModel._id,\r\n      'instance',\r\n      this.instanceId,\r\n      'competitors',\r\n      'edit'\r\n    ]\"\r\n    [queryParams]=\"queryParams\"\r\n  >\r\n    Edit Competitors\r\n  </a>\r\n</app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"competitor && runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <app-instance\r\n    [featureModel]=\"companyModel\"\r\n    [instance]=\"competitor\"\r\n    [adaptable]=\"false\"\r\n    [updatable]=\"true\"\r\n    (updateFeatureModel)=\"updateCompetitor()\"\r\n  ></app-instance>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <a\r\n      class=\"btn btn-sm btn-primary btn-block\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'canvas',\r\n        this.companyModel._id,\r\n        'instance',\r\n        this.instanceId,\r\n        'competitors',\r\n        'edit'\r\n      ]\"\r\n      [queryParams]=\"queryParams\"\r\n      >Go back to overview of competitors</a\r\n    >\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { Subscription } from 'rxjs';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-competitor-canvas',\r\n  templateUrl: './edit-competitor-canvas.component.html',\r\n  styleUrls: ['./edit-competitor-canvas.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class EditCompetitorCanvasComponent implements OnInit, OnDestroy {\r\n  private competitorId: number;\r\n  competitor: Instance;\r\n\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private companyModelService: CompanyModelService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private processApiService: ProcessApiService,\r\n    private route: ActivatedRoute,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      const newCompetitorId = +paramMap.get('competitorId');\r\n      if (this.competitorId !== newCompetitorId) {\r\n        this.competitorId = newCompetitorId;\r\n        if (this.companyModel != null) {\r\n          this.competitor = this.companyModel.getInstance(this.competitorId);\r\n        }\r\n      }\r\n    });\r\n    this.instanceLoaderService.loaded.subscribe(() => {\r\n      this.competitor = this.companyModel.getInstance(this.competitorId);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.routeSubscription) {\r\n      this.routeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async updateCompetitor(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instanceId(): number {\r\n    return this.instanceLoaderService.instance.id;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  get queryParams(): {\r\n    step: number;\r\n    runningProcessId: string;\r\n    executionId: string;\r\n  } {\r\n    return this.processApiService.queryParams;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Edit Competitors\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"companyModel && runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Competitors</h6>\r\n    <ul class=\"list-group\">\r\n      <li\r\n        *ngFor=\"let competitor of competitors\"\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-center\r\n        \"\r\n      >\r\n        <span\r\n          >{{ competitor.name }}\r\n          <small class=\"text-muted\" *ngIf=\"competitor.description\">{{\r\n            competitor.description\r\n          }}</small></span\r\n        >\r\n        <div>\r\n          <button\r\n            (click)=\"editCompetitor(competitor.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n          >\r\n            Edit\r\n          </button>\r\n          <button\r\n            (click)=\"removeCompetitor(competitor.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Remove\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish editing competitors</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish editing competitors\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { Router } from '@angular/router';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-competitors',\r\n  templateUrl: './edit-competitors.component.html',\r\n  styleUrls: ['./edit-competitors.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class EditCompetitorsComponent implements OnInit {\r\n  competitors: Instance[];\r\n\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private processApiService: ProcessApiService,\r\n    private router: Router,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.instanceLoaderService.loaded.subscribe(() => {\r\n      this.competitors = this.companyModel.instances.filter(\r\n        (instance) => instance.id !== this.instanceId\r\n      );\r\n    });\r\n  }\r\n\r\n  async editCompetitor(id: number): Promise<void> {\r\n    await this.router.navigate(\r\n      [\r\n        'canvas',\r\n        this.companyModel._id,\r\n        'instance',\r\n        this.instanceId,\r\n        'competitors',\r\n        id,\r\n        'edit',\r\n      ],\r\n      { queryParams: this.processApiService.queryParams }\r\n    );\r\n  }\r\n\r\n  async removeCompetitor(id: number): Promise<void> {\r\n    this.companyModel.removeInstance(id);\r\n    await this.updateCompanyModel();\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instanceId\r\n    );\r\n  }\r\n\r\n  private async updateCompanyModel(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instanceId(): number {\r\n    return this.instanceLoaderService.instance.id;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Edit Model\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"companyModel && runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <app-feature-model-edit\r\n    [featureModel]=\"companyModel\"\r\n    (updateFeatureModel)=\"updateCompanyModel()\"\r\n  ></app-feature-model-edit>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish editing</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish editing\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-model',\r\n  templateUrl: './edit-model.component.html',\r\n  styleUrls: ['./edit-model.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class EditModelComponent {\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private companyModelService: CompanyModelService,\r\n    private processApiService: ProcessApiService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instanceLoaderService.instance.id\r\n    );\r\n  }\r\n\r\n  async updateCompanyModel(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { CompanyModelService } from '../../canvas-meta-model/company-model.service';\r\nimport { CompanyModel } from '../../canvas-meta-model/company-model';\r\nimport { Instance } from '../../canvas-meta-model/instance';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class InstanceLoaderService extends ElementLoaderService {\r\n  companyModel: CompanyModel = null;\r\n  instance: Instance = null;\r\n\r\n  constructor(\r\n    private companyModelService: CompanyModelService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const companyModelId = paramMap.get('companyModelId');\r\n    const instanceId = +paramMap.get('instanceId');\r\n    this.changesFeed = this.companyModelService\r\n      .getChangesFeed(companyModelId)\r\n      .subscribe(() => this.loadInstance(companyModelId, instanceId));\r\n    void this.loadInstance(companyModelId, instanceId);\r\n  }\r\n\r\n  private async loadInstance(\r\n    companyModelId: string,\r\n    instanceId: number\r\n  ): Promise<void> {\r\n    this.companyModel = await this.companyModelService.get(companyModelId);\r\n    this.instance = this.companyModel.getInstance(instanceId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Refine Canvas\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"instance && runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <app-instance\r\n    [conformanceIsChecked]=\"conformanceIsChecked\"\r\n    [conformance]=\"conformance\"\r\n    [conformanceOptions]=\"conformanceOptionsForm.value\"\r\n    [featureModel]=\"companyModel\"\r\n    [instance]=\"instance\"\r\n    [patternInstance]=\"patternInstance\"\r\n    [adaptable]=\"false\"\r\n    [updatable]=\"false\"\r\n    (updateFeatureModel)=\"updateCompanyModel()\"\r\n  ></app-instance>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Hints</h6>\r\n    <div class=\"container\">\r\n      <div class=\"row\" style=\"margin-top: 20px\">\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"!conformanceIsChecked\"\r\n          (click)=\"checkConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          <span>Show Hints of Business Model</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"conformanceIsChecked\"\r\n          (click)=\"uncheckConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          <span>Hide Hints of Business Model</span>\r\n        </button>\r\n      </div>\r\n      <div *ngIf=\"conformanceIsChecked\" style=\"margin-top: 20px\">\r\n        <form [formGroup]=\"conformanceOptionsForm\">\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showWarnings\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"optionShowWarnings\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"optionShowWarnings\">\r\n              Show weaknesses\r\n              <small class=\"text-muted d-block\"\r\n                >Used features that have a hurt cross-tree relationship to other\r\n                used features</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showStrengths\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showStrengths\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showStrengths\">\r\n              Show strengths\r\n              <small class=\"text-muted d-block\"\r\n                >Used features that have a supports cross-tree relationship to\r\n                other used features</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showHints\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showHints\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showHints\">\r\n              Show hints\r\n              <small class=\"text-muted d-block\"\r\n                >Unused features that have a supports cross-tree relationship to\r\n                other used features and can be added without requirements and do\r\n                not lead to other errors</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showPatternHints\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showPatternHints\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showPatternHints\">\r\n              Show pattern hints\r\n              <small class=\"text-muted d-block\"\r\n                >A pattern is shown as a hint, if at least half of the pattern\r\n                is included in the current business model</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showUsedPatterns\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showUsedPatterns\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showUsedPatterns\">\r\n              Show used patterns\r\n              <small class=\"text-muted d-block\"\r\n                >A pattern is shown as used, if it is completely included in the\r\n                current business model</small\r\n              >\r\n            </label>\r\n          </div>\r\n        </form>\r\n        <div class=\"row\">\r\n          <div class=\"col\">\r\n            <h6>Errors</h6>\r\n            <ul>\r\n              <li *ngFor=\"let error of conformance.errors\">{{ error }}</li>\r\n            </ul>\r\n          </div>\r\n          <div\r\n            class=\"col border-left\"\r\n            *ngIf=\"\r\n              conformanceOptionsForm.value.showWarnings ||\r\n              conformanceOptionsForm.value.showStrengths\r\n            \"\r\n          >\r\n            <div *ngIf=\"conformanceOptionsForm.value.showWarnings\">\r\n              <h6>Weaknesses</h6>\r\n              <ul>\r\n                <li *ngFor=\"let warning of conformance.warnings\">\r\n                  {{ warning }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showStrengths\">\r\n              <h6>Strengths</h6>\r\n              <ul>\r\n                <li *ngFor=\"let strength of conformance.strengths\">\r\n                  {{ strength }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"col border-left\"\r\n            *ngIf=\"\r\n              conformanceOptionsForm.value.showHints ||\r\n              conformanceOptionsForm.value.showPatternHints ||\r\n              conformanceOptionsForm.value.showUsedPatterns\r\n            \"\r\n          >\r\n            <div *ngIf=\"conformanceOptionsForm.value.showHints\">\r\n              <h6>Hints</h6>\r\n              <ul>\r\n                <li *ngFor=\"let hint of conformance.hints\">{{ hint }}</li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showPatternHints\">\r\n              <h6>Pattern Hints</h6>\r\n              <ul>\r\n                <li *ngFor=\"let hint of conformance.patternHints\">\r\n                  <app-pattern-hint [patternHint]=\"hint\"></app-pattern-hint>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showUsedPatterns\">\r\n              <h6>Used Patterns</h6>\r\n              <ul>\r\n                <li *ngFor=\"let pattern of conformance.usedPatterns\">\r\n                  <app-pattern-view [pattern]=\"pattern\"></app-pattern-view>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Show pattern</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-instance-select-pattern-form\r\n        [expertModels]=\"expertModels\"\r\n        [showsPattern]=\"patternInstance != null\"\r\n        (showPattern)=\"showPattern($event.instance)\"\r\n        (clearPattern)=\"clearPattern()\"\r\n      ></app-instance-select-pattern-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"runningMethod.comments\"\r\n      (addComment)=\"addComment($event)\"\r\n      (updateComment)=\"updateComment($event)\"\r\n      (removeComment)=\"removeComment($event)\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish refinement</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish refinement\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\nimport { CanvasModelConsistencyService } from '../../../canvas-meta-model/canvas-model-consistency.service';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\n\r\n@Component({\r\n  selector: 'app-refine-canvas',\r\n  templateUrl: './refine-canvas.component.html',\r\n  styleUrls: ['./refine-canvas.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class RefineCanvasComponent implements OnInit {\r\n  expertModels: ExpertModel[];\r\n\r\n  conformanceIsChecked: boolean;\r\n  conformance: ConformanceReport = new ConformanceReport();\r\n  conformanceOptionsForm: FormGroup = this.fb.group({\r\n    showWarnings: true,\r\n    showStrengths: true,\r\n    showHints: true,\r\n    showPatternHints: true,\r\n    showUsedPatterns: false,\r\n  });\r\n\r\n  patternInstance: Instance = null;\r\n\r\n  constructor(\r\n    private canvasModelConsistencyService: CanvasModelConsistencyService,\r\n    private canvasResolveService: CanvasResolveService,\r\n    private companyModelService: CompanyModelService,\r\n    private expertModelService: ExpertModelService,\r\n    private fb: FormBuilder,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    private processApiService: ProcessApiService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.instanceLoaderService.loaded.subscribe(() => {\r\n      if (this.conformanceIsChecked) {\r\n        this.checkConformance();\r\n      } else {\r\n        this.uncheckConformance();\r\n      }\r\n      void this.loadExpertModels();\r\n    });\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instance.id\r\n    );\r\n  }\r\n\r\n  uncheckConformance(): void {\r\n    this.conformanceIsChecked = false;\r\n    this.conformance = new ConformanceReport();\r\n  }\r\n\r\n  checkConformance(): void {\r\n    this.clearPattern();\r\n    this.conformance =\r\n      this.canvasModelConsistencyService.checkConformanceOfInstance(\r\n        this.companyModel,\r\n        this.instance.id,\r\n        this.expertModels\r\n          .map((expertModel) => expertModel.getPatterns())\r\n          .reduce((prev, curr) => {\r\n            prev.push(...curr);\r\n            return prev;\r\n          }, [])\r\n      );\r\n    this.conformanceIsChecked = true;\r\n  }\r\n\r\n  showPattern(patternInstance: Instance): void {\r\n    this.uncheckConformance();\r\n    this.patternInstance = patternInstance;\r\n  }\r\n\r\n  clearPattern(): void {\r\n    this.patternInstance = null;\r\n  }\r\n\r\n  async loadExpertModels(): Promise<void> {\r\n    const expertModels: ExpertModel[] = [];\r\n    for (const expertModelId of this.companyModel.expertModelIds) {\r\n      const expertModel = await this.expertModelService.get(expertModelId);\r\n      const featureIds = expertModel\r\n        .getFeatureList()\r\n        .map((feature) => feature.id);\r\n      if (\r\n        featureIds.every(\r\n          (id) =>\r\n            id in\r\n            this.companyModel.expertModelTraces[expertModel._id]\r\n              .expertFeatureIdMap\r\n        ) &&\r\n        expertModel.getPatterns().length > 0\r\n      ) {\r\n        expertModels.push(expertModel);\r\n      }\r\n    }\r\n    this.expertModels = expertModels;\r\n  }\r\n\r\n  async updateCompanyModel(): Promise<void> {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instance(): Instance {\r\n    return this.instanceLoaderService.instance;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n}\r\n","<ng-container [formGroup]=\"formGroup\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"definitionSelector\" class=\"col-sm-6 col-form-label\"\r\n      >Canvas Model</label\r\n    >\r\n    <div class=\"col-sm-6\">\r\n      <select\r\n        id=\"definitionSelector\"\r\n        formControlName=\"definitionId\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"\r\n          definitionControl.invalid && definitionControl.touched\r\n        \"\r\n      >\r\n        <option\r\n          *ngFor=\"let definition of canvasDefinitions\"\r\n          [ngValue]=\"definition._id\"\r\n        >\r\n          {{ definition.name }}\r\n        </option>\r\n        <option *ngIf=\"canvasDefinitions == null\">Loading...</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroup } from '@angular/forms';\r\nimport { ConfigurationFormComponent } from '../../../development-process-registry/module-api/configuration-form-component';\r\nimport { CanvasDefinitionEntry } from '../../../canvas-meta-model/canvas-definition';\r\nimport { CanvasDefinitionService } from '../../../canvas-meta-model/canvas-definition.service';\r\n\r\n@Component({\r\n  selector: 'app-select-canvas-definition-configuration',\r\n  templateUrl: './select-canvas-definition-configuration.component.html',\r\n  styleUrls: ['./select-canvas-definition-configuration.component.css'],\r\n})\r\nexport class SelectCanvasDefinitionConfigurationComponent\r\n  implements OnInit, ConfigurationFormComponent\r\n{\r\n  formGroup: FormGroup;\r\n\r\n  canvasDefinitions: CanvasDefinitionEntry[] = null;\r\n\r\n  constructor(private canvasDefinitionService: CanvasDefinitionService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadCanvasDefinitions();\r\n  }\r\n\r\n  async loadCanvasDefinitions(): Promise<void> {\r\n    this.canvasDefinitions = await this.canvasDefinitionService.getList();\r\n  }\r\n\r\n  get definitionControl(): FormControl {\r\n    return this.formGroup.get('definitionId') as FormControl;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a\r\n      *ngIf=\"processApiService.runningProcess\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        processApiService.runningProcess._id\r\n      ]\"\r\n    >\r\n      {{ processApiService.runningProcess.process.name }} &ndash;\r\n      {{ processApiService.runningProcess.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"processApiService.runningMethod != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        processApiService.runningProcess._id,\r\n        'method',\r\n        processApiService.runningMethod.executionId\r\n      ]\"\r\n    >\r\n      {{ processApiService.runningMethod.methodName }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"artifact != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts']\"\r\n    >\r\n      Concrete Artifacts\r\n    </a>\r\n    <a\r\n      *ngIf=\"artifact != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts', 'detail', artifact._id]\"\r\n    >\r\n      {{ artifact.identifier }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"artifact != null && version != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts', 'detail', artifact._id]\"\r\n    >\r\n      Version #{{ version + 1 }}\r\n    </a>\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\" [queryParams]=\"queryParams\">\r\n      View Canvas\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"instance\" role=\"main\" class=\"container\">\r\n  <app-instance\r\n    [featureModel]=\"companyModel\"\r\n    [instance]=\"instance\"\r\n    [adaptable]=\"false\"\r\n    [editable]=\"false\"\r\n    [updatable]=\"false\"\r\n  ></app-instance>\r\n\r\n  <div\r\n    class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    *ngIf=\"processApiService.stepInfo.step != null\"\r\n  >\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish viewing</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish viewing\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { CanvasResolveService } from '../../canvas-resolve.service';\r\nimport { InstanceLoaderService } from '../instance-loader.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { RunningArtifact } from '../../../development-process-registry/running-process/running-artifact';\r\nimport { ConcreteArtifactService } from '../../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\n\r\n@Component({\r\n  selector: 'app-view-canvas',\r\n  templateUrl: './view-canvas.component.html',\r\n  styleUrls: ['./view-canvas.component.css'],\r\n  providers: [InstanceLoaderService, ProcessApiService],\r\n})\r\nexport class ViewCanvasComponent implements OnInit, OnDestroy {\r\n  artifact: RunningArtifact = null;\r\n  version: number = null;\r\n\r\n  private querySubscription: Subscription;\r\n\r\n  constructor(\r\n    private canvasResolveService: CanvasResolveService,\r\n    private concreteArtifactService: ConcreteArtifactService,\r\n    private instanceLoaderService: InstanceLoaderService,\r\n    public processApiService: ProcessApiService,\r\n    private route: ActivatedRoute\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.querySubscription = this.route.queryParamMap.subscribe(\r\n      async (params) => {\r\n        if (params.has('artifactId')) {\r\n          this.artifact = await this.concreteArtifactService.get(\r\n            params.get('artifactId')\r\n          );\r\n          this.version = +params.get('versionId');\r\n        } else {\r\n          this.artifact = null;\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.querySubscription) {\r\n      this.querySubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  finish(): void {\r\n    this.canvasResolveService.resolveEditCanvas(\r\n      this.processApiService.stepInfo,\r\n      this.companyModel._id,\r\n      this.instance.id\r\n    );\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.instanceLoaderService.companyModel;\r\n  }\r\n\r\n  get instance(): Instance {\r\n    return this.instanceLoaderService.instance;\r\n  }\r\n\r\n  get queryParams() {\r\n    if (this.artifact != null) {\r\n      return {\r\n        artifactId: this.artifact._id,\r\n      };\r\n    } else {\r\n      return this.processApiService.queryParams;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ModuleApiService } from '../development-process-registry/module-api/module-api-service';\r\nimport { MethodExecutionInput } from '../development-process-registry/module-api/method-execution-input';\r\nimport { StepInfo } from '../development-process-registry/module-api/step-info';\r\nimport { InstanceArtifactData } from '../canvas-meta-model/instance-artifact-data';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasApiService implements ModuleApiService {\r\n  createCanvas(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    void input.router.navigate(['canvas', 'instance', 'create'], {\r\n      queryParams: stepInfo,\r\n    });\r\n  }\r\n\r\n  editCanvas(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['canvas', reference.id, 'instance', reference.instanceId, 'edit'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  refineCanvas(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['canvas', reference.id, 'instance', reference.instanceId, 'refine'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  compareCompetitors(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['canvas', reference.id, 'instance', reference.instanceId, 'compare'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  createCompetitors(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['canvas', reference.id, 'instance', reference.instanceId, 'competitors'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  manageCompetitors(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      [\r\n        'canvas',\r\n        reference.id,\r\n        'instance',\r\n        reference.instanceId,\r\n        'competitors',\r\n        'edit',\r\n      ],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  viewCanvas(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['canvas', reference.id, 'instance', reference.instanceId, 'view'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  editModel(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    const reference: InstanceArtifactData =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      [\r\n        'canvas',\r\n        reference.id,\r\n        'instance',\r\n        reference.instanceId,\r\n        'model',\r\n        'edit',\r\n      ],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  executeMethod(methodName: string, input: MethodExecutionInput): void {\r\n    switch (methodName) {\r\n      case 'createCanvas':\r\n        this.createCanvas(input);\r\n        break;\r\n      case 'editCanvas':\r\n        this.editCanvas(input);\r\n        break;\r\n      case 'refineCanvas':\r\n        this.refineCanvas(input);\r\n        break;\r\n      case 'compareCompetitors':\r\n        this.compareCompetitors(input);\r\n        break;\r\n      case 'createCompetitors':\r\n        this.createCompetitors(input);\r\n        break;\r\n      case 'manageCompetitors':\r\n        this.manageCompetitors(input);\r\n        break;\r\n      case 'viewCanvas':\r\n        this.viewCanvas(input);\r\n        break;\r\n      case 'editModel':\r\n        this.editModel(input);\r\n        break;\r\n    }\r\n  }\r\n\r\n  private getStepInfo(input: MethodExecutionInput): StepInfo {\r\n    return {\r\n      step: input.runningMethod.currentStepNumber,\r\n      executionId: input.runningMethod.executionId,\r\n      runningProcessId: input.runningProcess._id,\r\n    };\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"emitSubmitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"nameControl.invalid && nameControl.touched\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\">Description</label>\r\n    <div class=\"col-sm-8\">\r\n      <textarea\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n        rows=\"3\"\r\n      ></textarea>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update Canvas Model<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { CanvasDefinition } from '../../../canvas-meta-model/canvas-definition';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definition-form',\r\n  templateUrl: './canvas-definition-form.component.html',\r\n  styleUrls: ['./canvas-definition-form.component.css'],\r\n})\r\nexport class CanvasDefinitionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() canvasDefinition: CanvasDefinition;\r\n\r\n  @Output() submitForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n    description: [''],\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.form.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equalCanvasDefinitions(\r\n              this.canvasDefinition,\r\n              value\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.canvasDefinition) {\r\n      const newCanvasDefinition = changes.canvasDefinition.currentValue;\r\n      const oldCanvasDefinition = changes.canvasDefinition.previousValue;\r\n      if (\r\n        !this.equalCanvasDefinitions(oldCanvasDefinition, newCanvasDefinition)\r\n      ) {\r\n        this.loadForm(newCanvasDefinition);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  emitSubmitForm(): void {\r\n    this.submitForm.emit(this.form);\r\n  }\r\n\r\n  private loadForm(canvasDefinition: CanvasDefinition): void {\r\n    if (canvasDefinition != null) {\r\n      this.form.patchValue({\r\n        name: canvasDefinition.name,\r\n        description: canvasDefinition.description,\r\n      });\r\n    } else {\r\n      this.form.patchValue({ name: '', description: '' });\r\n    }\r\n  }\r\n\r\n  private equalCanvasDefinitions(\r\n    canvasDefinitionA: CanvasDefinition,\r\n    canvasDefinitionB: CanvasDefinition\r\n  ): boolean {\r\n    if (canvasDefinitionA == null && canvasDefinitionB == null) {\r\n      return true;\r\n    }\r\n    if (canvasDefinitionA == null || canvasDefinitionB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      canvasDefinitionA.name === canvasDefinitionB.name &&\r\n      canvasDefinitionA.description === canvasDefinitionB.description\r\n    );\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.form.get('name') as FormControl;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { CanvasDefinition } from '../../canvas-meta-model/canvas-definition';\r\nimport { CanvasDefinitionService } from '../../canvas-meta-model/canvas-definition.service';\r\n\r\n@Injectable()\r\nexport class CanvasDefinitionLoaderService extends ElementLoaderService {\r\n  canvasDefinition: CanvasDefinition = null;\r\n\r\n  constructor(\r\n    private canvasDefinitionService: CanvasDefinitionService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const canvasDefinitionId = paramMap.get('id');\r\n    this.changesFeed = this.canvasDefinitionService\r\n      .getChangesFeed(canvasDefinitionId)\r\n      .subscribe(() => this.loadCanvasDefinition(canvasDefinitionId));\r\n    void this.loadCanvasDefinition(canvasDefinitionId);\r\n  }\r\n\r\n  private async loadCanvasDefinition(\r\n    canvasDefinitionId: string\r\n  ): Promise<void> {\r\n    this.canvasDefinition = await this.canvasDefinitionService.get(\r\n      canvasDefinitionId\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","<table class=\"table table-bordered\" style=\"table-layout: fixed\">\r\n  <tbody>\r\n    <tr *ngFor=\"let row of canvasDefinitionCells\">\r\n      <ng-container *ngFor=\"let cell of row\">\r\n        <td\r\n          *ngIf=\"!cell.isSpacer\"\r\n          [colSpan]=\"cell.colspan\"\r\n          [rowSpan]=\"cell.rowspan\"\r\n        >\r\n          <b>{{ cell.name }}</b>\r\n        </td>\r\n        <td\r\n          *ngIf=\"cell.isSpacer\"\r\n          [colSpan]=\"cell.colspan\"\r\n          [rowSpan]=\"cell.rowspan\"\r\n        ></td>\r\n      </ng-container>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import { Component, Input } from '@angular/core';\r\nimport { CanvasDefinitionCell } from '../../../canvas-meta-model/canvas-definition-cell';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definition-overview',\r\n  templateUrl: './canvas-definition-overview.component.html',\r\n  styleUrls: ['./canvas-definition-overview.component.css'],\r\n})\r\nexport class CanvasDefinitionOverviewComponent {\r\n  @Input() canvasDefinitionCells: CanvasDefinitionCell[][];\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\" formArrayName=\"relationshipTypes\">\r\n    <app-form-array-list\r\n      elementName=\"Relationship Name\"\r\n      [formArray]=\"formArray\"\r\n      [ordered]=\"false\"\r\n    ></app-form-array-list>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update Relationships<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsListString } from '../../../shared/utils';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definition-relationships-form',\r\n  templateUrl: './canvas-definition-relationships-form.component.html',\r\n  styleUrls: ['./canvas-definition-relationships-form.component.css'],\r\n})\r\nexport class CanvasDefinitionRelationshipsFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() relationshipTypes: string[];\r\n\r\n  @Output() submitRelationshipTypesForm = new EventEmitter<FormArray>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    relationshipTypes: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.form.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equals(\r\n              this.relationshipTypes,\r\n              value.relationshipTypes\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.relationshipTypes) {\r\n      const oldRelationshipTypes: string[] =\r\n        changes.relationshipTypes.previousValue;\r\n      const newRelationshipTypes: string[] =\r\n        changes.relationshipTypes.currentValue;\r\n      if (!this.equals(newRelationshipTypes, oldRelationshipTypes)) {\r\n        this.loadForm(newRelationshipTypes);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private equals(\r\n    relationshipTypesA: string[],\r\n    relationshipTypesB: string[]\r\n  ): boolean {\r\n    return equalsListString(relationshipTypesA, relationshipTypesB);\r\n  }\r\n\r\n  private loadForm(relationshipTypes: string[]): void {\r\n    this.form.setControl(\r\n      'relationshipTypes',\r\n      this.fb.array(\r\n        relationshipTypes.map((typeName) =>\r\n          this.fb.control(typeName, Validators.required)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitRelationshipTypesForm.emit(this.formArray);\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.form.get('relationshipTypes') as FormArray;\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"emitSubmitForm()\">\r\n  <button\r\n    type=\"button\"\r\n    class=\"btn btn-block btn-sm btn-primary mb-3\"\r\n    (click)=\"addRow()\"\r\n  >\r\n    Add row\r\n  </button>\r\n  <ul formArrayName=\"rows\" class=\"list-group\">\r\n    <li\r\n      class=\"list-group-item\"\r\n      *ngFor=\"let row of rowsFormArray.controls; let rowIndex = index\"\r\n      [formArrayName]=\"rowIndex.toString()\"\r\n    >\r\n      <div class=\"d-flex\">\r\n        <b>{{ rowIndex + 1 }}. Row</b>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-xs btn-primary ml-auto\"\r\n          (click)=\"addBlock(rowIndex)\"\r\n        >\r\n          Add Block\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-xs btn-secondary ml-3\"\r\n          (click)=\"addRow(rowIndex)\"\r\n        >\r\n          Add Row above\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-xs btn-dark ml-3\"\r\n          (click)=\"removeRow(rowIndex)\"\r\n        >\r\n          Remove\r\n        </button>\r\n      </div>\r\n      <div *ngIf=\"asFormArray(row).length > 0\" class=\"form-group mt-2\">\r\n        <div\r\n          class=\"form-row\"\r\n          *ngFor=\"\r\n            let block of asFormArray(row).controls;\r\n            let blockIndex = index\r\n          \"\r\n          [formGroupName]=\"blockIndex.toString()\"\r\n        >\r\n          <div class=\"form-group col-md-3\">\r\n            <label for=\"selectSpacer{{ blockIndex }}\">Element or Spacer</label>\r\n            <select\r\n              id=\"selectSpacer{{ blockIndex }}\"\r\n              class=\"form-control\"\r\n              formControlName=\"isSpacer\"\r\n              (change)=\"spacerChange(rowIndex, blockIndex)\"\r\n            >\r\n              <option [ngValue]=\"false\">Element</option>\r\n              <option [ngValue]=\"true\">Spacer</option>\r\n            </select>\r\n          </div>\r\n          <div class=\"col-md-3\" *ngIf=\"block.value.isSpacer\"></div>\r\n          <div class=\"form-group col-md-3\" *ngIf=\"!block.value.isSpacer\">\r\n            <label for=\"inputName{{ blockIndex }}\">Name</label>\r\n            <input\r\n              class=\"form-control\"\r\n              id=\"inputName{{ blockIndex }}\"\r\n              formControlName=\"name\"\r\n            />\r\n          </div>\r\n          <div class=\"form-group col-md-3\">\r\n            <label for=\"inputRowspan{{ blockIndex }}\">Rowspan</label>\r\n            <input\r\n              type=\"number\"\r\n              [min]=\"1\"\r\n              class=\"form-control\"\r\n              id=\"inputRowspan{{ blockIndex }}\"\r\n              formControlName=\"rowspan\"\r\n            />\r\n          </div>\r\n          <div class=\"form-group col-md-3\">\r\n            <label for=\"inputColspan{{ blockIndex }}\">Colspan</label>\r\n            <div class=\"input-group\">\r\n              <input\r\n                type=\"number\"\r\n                [min]=\"1\"\r\n                class=\"form-control\"\r\n                id=\"inputColspan{{ blockIndex }}\"\r\n                formControlName=\"colspan\"\r\n              />\r\n              <div class=\"input-group-append\">\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"btn btn-dark form-control\"\r\n                  (click)=\"removeBlock(rowIndex, blockIndex)\"\r\n                >\r\n                  Remove\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n  <button\r\n    type=\"submit\"\r\n    class=\"btn btn-sm btn-block mt-3\"\r\n    [class.btn-dark]=\"!changed\"\r\n    [class.btn-primary]=\"changed\"\r\n    [disabled]=\"!form.valid\"\r\n  >\r\n    Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n  </button>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  AbstractControl,\r\n  FormArray,\r\n  FormBuilder,\r\n  FormGroup,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { CanvasDefinitionRowFormService } from '../../form-services/canvas-definition-row-form.service';\r\nimport { equalsListOfLists } from '../../../shared/utils';\r\nimport { CanvasDefinitionCell } from '../../../canvas-meta-model/canvas-definition-cell';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definition-row-form',\r\n  templateUrl: './canvas-definition-row-form.component.html',\r\n  styleUrls: ['./canvas-definition-row-form.component.css'],\r\n})\r\nexport class CanvasDefinitionRowFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() canvasDefinitionRows: CanvasDefinitionCell[][];\r\n\r\n  @Output() submitForm = new EventEmitter<FormArray>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    rows: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private canvasDefinitionRowFormService: CanvasDefinitionRowFormService,\r\n    private fb: FormBuilder\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.form.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equalCanvasDefinitionRows(\r\n              this.canvasDefinitionRows,\r\n              this.canvasDefinitionRowFormService.get(value.rows)\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.canvasDefinitionRows) {\r\n      const newCanvasDefinitionRows = changes.canvasDefinitionRows.currentValue;\r\n      const oldCanvasDefinitionRows =\r\n        changes.canvasDefinitionRows.previousValue;\r\n      if (\r\n        !this.equalCanvasDefinitionRows(\r\n          oldCanvasDefinitionRows,\r\n          newCanvasDefinitionRows\r\n        )\r\n      ) {\r\n        this.loadForm(newCanvasDefinitionRows);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  emitSubmitForm() {\r\n    this.submitForm.emit(this.rowsFormArray);\r\n  }\r\n\r\n  addRow(index: number = null) {\r\n    if (index == null) {\r\n      this.rowsFormArray.push(this.fb.array([]));\r\n    } else {\r\n      this.rowsFormArray.insert(index, this.fb.array([]));\r\n    }\r\n  }\r\n\r\n  removeRow(index: number) {\r\n    this.rowsFormArray.removeAt(index);\r\n  }\r\n\r\n  addBlock(row: number) {\r\n    this.getRow(row).push(\r\n      this.canvasDefinitionRowFormService.createCanvasDefinitionCellForm()\r\n    );\r\n  }\r\n\r\n  spacerChange(row: number, index: number) {\r\n    const form = this.getRow(row).at(index) as FormGroup;\r\n    this.canvasDefinitionRowFormService.convertCanvasDefinitionCellForm(\r\n      form,\r\n      form.value.isSpacer\r\n    );\r\n  }\r\n\r\n  removeBlock(row: number, index: number) {\r\n    this.getRow(row).removeAt(index);\r\n  }\r\n\r\n  getRow(index: number): FormArray {\r\n    return this.rowsFormArray.at(index) as FormArray;\r\n  }\r\n\r\n  asFormArray(form: AbstractControl): FormArray {\r\n    return form as FormArray;\r\n  }\r\n\r\n  private loadForm(canvasDefinitionRows: CanvasDefinitionCell[][]) {\r\n    this.form.setControl(\r\n      'rows',\r\n      this.canvasDefinitionRowFormService.createForm(canvasDefinitionRows)\r\n    );\r\n  }\r\n\r\n  private equalCanvasDefinitionRows(\r\n    canvasDefinitionRowsA: CanvasDefinitionCell[][],\r\n    canvasDefinitionRowsB: CanvasDefinitionCell[][]\r\n  ) {\r\n    if (canvasDefinitionRowsA == null && canvasDefinitionRowsB == null) {\r\n      return true;\r\n    }\r\n    if (canvasDefinitionRowsA == null || canvasDefinitionRowsB == null) {\r\n      return false;\r\n    }\r\n    return equalsListOfLists(canvasDefinitionRowsA, canvasDefinitionRowsB);\r\n  }\r\n\r\n  get nameControl() {\r\n    return this.form.get('name');\r\n  }\r\n\r\n  get rowsFormArray(): FormArray {\r\n    return this.form.get('rows') as FormArray;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'canvas', 'definitions']\"\r\n      >Canvas Models</a\r\n    >\r\n    <a *ngIf=\"canvasDefinition\" class=\"nav-link active\" [routerLink]=\"[]\">{{\r\n      canvasDefinition.name\r\n    }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"canvasDefinition\" role=\"main\" class=\"container\">\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Canvas Model</h6>\r\n    <app-canvas-definition-row-form\r\n      #canvasDefinitionRowFormComponent\r\n      [canvasDefinitionRows]=\"canvasDefinition.rows\"\r\n      (submitForm)=\"submitRowForm($event.value)\"\r\n    ></app-canvas-definition-row-form>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Canvas Model Overview</h6>\r\n    <app-canvas-definition-overview\r\n      [canvasDefinitionCells]=\"\r\n        toCanvasDefinitionRows(\r\n          canvasDefinitionRowFormComponent.form.valueChanges | async\r\n        )\r\n      \"\r\n    ></app-canvas-definition-overview>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Canvas Model Relationships</h6>\r\n    <app-canvas-definition-relationships-form\r\n      [relationshipTypes]=\"canvasDefinition.relationshipTypes\"\r\n      (submitRelationshipTypesForm)=\"\r\n        update({ relationshipTypes: $event.value })\r\n      \"\r\n    ></app-canvas-definition-relationships-form>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Edit Canvas Model</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-canvas-definition-form\r\n        [canvasDefinition]=\"canvasDefinition\"\r\n        (submitForm)=\"update($event.value)\"\r\n      ></app-canvas-definition-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy } from '@angular/core';\r\nimport { CanvasDefinition } from '../../../canvas-meta-model/canvas-definition';\r\nimport { Subscription } from 'rxjs';\r\nimport { CanvasDefinitionService } from '../../../canvas-meta-model/canvas-definition.service';\r\nimport {\r\n  CanvasDefinitionCellFormValue,\r\n  CanvasDefinitionRowFormService,\r\n} from '../../form-services/canvas-definition-row-form.service';\r\nimport { CanvasDefinitionCell } from '../../../canvas-meta-model/canvas-definition-cell';\r\nimport { CanvasDefinitionLoaderService } from '../canvas-definition-loader.service';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definition',\r\n  templateUrl: './canvas-definition.component.html',\r\n  styleUrls: ['./canvas-definition.component.css'],\r\n  providers: [CanvasDefinitionLoaderService],\r\n})\r\nexport class CanvasDefinitionComponent implements OnDestroy {\r\n  canvas: CanvasDefinitionCell[][] = [];\r\n\r\n  private formSubscription: Subscription;\r\n\r\n  constructor(\r\n    private canvasDefinitionLoaderService: CanvasDefinitionLoaderService,\r\n    private canvasDefinitionRowFormService: CanvasDefinitionRowFormService,\r\n    private canvasDefinitionService: CanvasDefinitionService\r\n  ) {}\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.formSubscription) {\r\n      this.formSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async submitRowForm(value: CanvasDefinitionCellFormValue[][]): Promise<void> {\r\n    const rows = this.canvasDefinitionRowFormService.get(value);\r\n    await this.canvasDefinitionService.updateRows(\r\n      this.canvasDefinition._id,\r\n      rows\r\n    );\r\n  }\r\n\r\n  toCanvasDefinitionRows(value: {\r\n    rows: CanvasDefinitionCellFormValue[][];\r\n  }): CanvasDefinitionCell[][] {\r\n    if (value == null) {\r\n      return this.canvasDefinition.rows;\r\n    }\r\n    return this.canvasDefinitionRowFormService.get(value.rows);\r\n  }\r\n\r\n  async update(value: Partial<CanvasDefinition>): Promise<void> {\r\n    await this.canvasDefinitionService.update(this.canvasDefinition._id, value);\r\n  }\r\n\r\n  get canvasDefinition(): CanvasDefinition {\r\n    return this.canvasDefinitionLoaderService.canvasDefinition;\r\n  }\r\n}\r\n","<ng-template #deleteCanvasDefinitionModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (delete)=\"deleteCanvasDefinition(modalCanvas._id); c()\"\r\n    (dismiss)=\"d()\"\r\n  >\r\n    <div modalTitle>Delete Canvas Model {{ modalCanvas.name }}</div>\r\n    You are deleting the canvas model {{ modalCanvas.name }}. The deletion can\r\n    not be undone. The canvas building blocks that are using it will still be\r\n    available after the deletion.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Canvas Models</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Canvas models are used to define different types of canvases, e.g., business\r\n    model canvas and value proposition canvas.\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Canvas Models\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No canvas models available.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let canvasDefinition of canvasDefinitions\"\r\n      >\r\n        <div>\r\n          <span>{{ canvasDefinition.name }}</span>\r\n        </div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"[canvasDefinition._id]\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n            >View</a\r\n          >\r\n          <button\r\n            (click)=\"openDeleteCanvasDefinitionModal(canvasDefinition)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Add Canvas Model</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"addCanvasDefinitionForm\"\r\n        (ngSubmit)=\"addCanvasDefinition()\"\r\n      >\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"nameControl.invalid && nameControl.touched\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!addCanvasDefinitionForm.valid\"\r\n            >\r\n              Add\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  CanvasDefinition,\r\n  CanvasDefinitionEntry,\r\n  CanvasDefinitionInit,\r\n} from '../../../canvas-meta-model/canvas-definition';\r\nimport { CanvasDefinitionService } from '../../../canvas-meta-model/canvas-definition.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { ELEMENT_SERVICE, ListService } from '../../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-canvas-definitions',\r\n  templateUrl: './canvas-definitions.component.html',\r\n  styleUrls: ['./canvas-definitions.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: CanvasDefinitionService },\r\n  ],\r\n})\r\nexport class CanvasDefinitionsComponent {\r\n  addCanvasDefinitionForm: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n\r\n  modalCanvas: CanvasDefinitionEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteCanvasDefinitionModal', { static: true })\r\n  deleteCanvasDefinitionModal: unknown;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private listService: ListService<CanvasDefinition, CanvasDefinitionInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  async addCanvasDefinition(): Promise<void> {\r\n    await this.listService.add({ name: this.nameControl.value });\r\n    this.addCanvasDefinitionForm.reset();\r\n  }\r\n\r\n  openDeleteCanvasDefinitionModal(\r\n    canvasDefinition: CanvasDefinitionEntry\r\n  ): void {\r\n    this.modalCanvas = canvasDefinition;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteCanvasDefinitionModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  async deleteCanvasDefinition(canvasDefinitionId: string): Promise<void> {\r\n    await this.listService.delete(canvasDefinitionId);\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.addCanvasDefinitionForm.get('name') as FormControl;\r\n  }\r\n\r\n  get canvasDefinitions(): CanvasDefinitionEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ArtifactData,\r\n  ArtifactDataType,\r\n} from '../development-process-registry/running-process/artifact-data';\r\nimport { InstanceArtifactData } from '../canvas-meta-model/instance-artifact-data';\r\nimport { RunningProcessService } from '../development-process-registry/running-process/running-process.service';\r\nimport { StepInfo } from '../development-process-registry/module-api/step-info';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasResolveService {\r\n  constructor(private runningProcessService: RunningProcessService) {}\r\n\r\n  resolveCreateCanvas(\r\n    stepInfo: StepInfo,\r\n    companyModelId: string,\r\n    instanceId: number\r\n  ): void {\r\n    const artifactData = this.getArtifactData(companyModelId, instanceId);\r\n    void this.runningProcessService.finishExecuteStep(stepInfo, {\r\n      outputArtifactData: [artifactData],\r\n    });\r\n  }\r\n\r\n  resolveEditCanvas(\r\n    stepInfo: StepInfo,\r\n    companyModelId: string,\r\n    instanceId: number\r\n  ): void {\r\n    const artifactData = this.getArtifactData(companyModelId, instanceId);\r\n    void this.runningProcessService.finishExecuteStep(stepInfo, {\r\n      outputArtifactData: [artifactData],\r\n    });\r\n  }\r\n\r\n  private getArtifactData(\r\n    companyModelId: string,\r\n    instanceId: number\r\n  ): ArtifactData {\r\n    return new ArtifactData(undefined, {\r\n      data: new InstanceArtifactData({\r\n        id: companyModelId,\r\n        instanceId,\r\n      }),\r\n      type: ArtifactDataType.REFERENCE,\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { MergeExpertModelsComponent } from './merge/merge-expert-models/merge-expert-models.component';\r\nimport { MergeModelViewComponent } from './merge/merge-model-view/merge-model-view.component';\r\nimport { ExpertModelsComponent } from './expert-model/expert-models/expert-models.component';\r\nimport { ExpertModelComponent } from './expert-model/expert-model/expert-model.component';\r\nimport { ExpertModelEditComponent } from './expert-model/expert-model-edit/expert-model-edit.component';\r\nimport { PatternComponent } from './instances/pattern/pattern.component';\r\nimport { ExampleComponent } from './instances/example/example.component';\r\nimport { CompanyModelEditComponent } from './company-model/company-model-edit/company-model-edit.component';\r\nimport { CompanyModelsComponent } from './company-model/company-models/company-models.component';\r\nimport { CompanyModelComponent } from './company-model/company-model/company-model.component';\r\nimport { CreateCanvasComponent } from './api/create-canvas/create-canvas.component';\r\nimport { EditCanvasComponent } from './api/edit-canvas/edit-canvas.component';\r\nimport { CanvasDefinitionsComponent } from './canvas-definition/canvas-definitions/canvas-definitions.component';\r\nimport { CanvasDefinitionComponent } from './canvas-definition/canvas-definition/canvas-definition.component';\r\nimport { CompanyModelSelectExpertKnowledgeComponent } from './company-model/company-model-select-expert-knowledge/company-model-select-expert-knowledge.component';\r\nimport { CompareComponent } from './api/compare/compare.component';\r\nimport { CreateCompetitorCanvasComponent } from './api/create-competitor-canvas/create-competitor-canvas.component';\r\nimport { EditCompetitorsComponent } from './api/edit-competitors/edit-competitors.component';\r\nimport { EditCompetitorCanvasComponent } from './api/edit-competitor-canvas/edit-competitor-canvas.component';\r\nimport { RefineCanvasComponent } from './api/refine-canvas/refine-canvas.component';\r\nimport { ViewCanvasComponent } from './api/view-canvas/view-canvas.component';\r\nimport { EditModelComponent } from './api/edit-model/edit-model.component';\r\nimport { AuthGuard } from '../database/auth.guard';\r\nimport { CanvasElementsComponent } from './elements/canvas-elements/canvas-elements.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'canvas',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: 'definitions', component: CanvasDefinitionsComponent },\r\n      { path: 'definitions/:id', component: CanvasDefinitionComponent },\r\n      { path: 'instance/create', component: CreateCanvasComponent },\r\n      {\r\n        path: ':companyModelId/instance/:instanceId',\r\n        children: [\r\n          { path: 'edit', component: EditCanvasComponent },\r\n          { path: 'refine', component: RefineCanvasComponent },\r\n          { path: 'view', component: ViewCanvasComponent },\r\n          { path: 'model/edit', component: EditModelComponent },\r\n          {\r\n            path: 'competitors',\r\n            children: [\r\n              { path: '', component: CreateCompetitorCanvasComponent },\r\n              { path: 'edit', component: EditCompetitorsComponent },\r\n              {\r\n                path: ':competitorId/edit',\r\n                component: EditCompetitorCanvasComponent,\r\n              },\r\n            ],\r\n          },\r\n          { path: 'compare', component: CompareComponent },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'companyModels',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: CompanyModelsComponent },\r\n      { path: ':id', component: CompanyModelComponent },\r\n      { path: ':id/edit', component: CompanyModelEditComponent },\r\n      {\r\n        path: ':id/select',\r\n        component: CompanyModelSelectExpertKnowledgeComponent,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'expertModels',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: ExpertModelsComponent },\r\n      { path: ':id', component: ExpertModelComponent },\r\n      { path: ':id/edit', component: ExpertModelEditComponent },\r\n      { path: ':id/examples/:exampleId', component: ExampleComponent },\r\n      { path: ':id/patterns/:patternId', component: PatternComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'merge',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: ':companyModelId', component: MergeExpertModelsComponent },\r\n      {\r\n        path: ':companyModelId/:expertModelId',\r\n        component: MergeModelViewComponent,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'canvasElements',\r\n    component: CanvasElementsComponent,\r\n    canActivate: [AuthGuard],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class CanvasRoutingModule {}\r\n","import { APP_INITIALIZER, NgModule } from '@angular/core';\r\n\r\nimport { CanvasRoutingModule } from './canvas-routing.module';\r\nimport { CanvasService } from './canvas.service';\r\nimport { FeatureModelSubformComponent } from './feature-model/feature-model-subform/feature-model-subform.component';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { FeatureModelInstanceSubformComponent } from './instances/feature-model-instance-subform/feature-model-instance-subform.component';\r\nimport { MergeExpertModelsComponent } from './merge/merge-expert-models/merge-expert-models.component';\r\nimport { MergeIntoTreeComponent } from './merge/merge-into-tree/merge-into-tree.component';\r\nimport { MergeModelViewComponent } from './merge/merge-model-view/merge-model-view.component';\r\nimport { MergeTreeComponent } from './merge/merge-tree/merge-tree.component';\r\nimport { TraceModalComponent } from './merge/trace-modal/trace-modal.component';\r\nimport { CrossTreeRelationshipFormComponent } from './relationships/cross-tree-relationship-form/cross-tree-relationship-form.component';\r\nimport { CrossTreeRelationshipModalComponent } from './relationships/cross-tree-relationship-modal/cross-tree-relationship-modal.component';\r\nimport { DeleteFeatureConfirmComponent } from './feature-model/delete-feature-confirm/delete-feature-confirm.component';\r\nimport { FeatureFormComponent } from './feature-model/feature-form/feature-form.component';\r\nimport { FeatureModelComponent } from './feature-model/feature-model/feature-model.component';\r\nimport { FeatureBuildingBlockComponent } from './feature-model/feature-building-block/feature-building-block.component';\r\nimport { ExpertModelComponent } from './expert-model/expert-model/expert-model.component';\r\nimport { ExpertModelsComponent } from './expert-model/expert-models/expert-models.component';\r\nimport { ModelListComponent } from './feature-model/model-list/model-list.component';\r\nimport { ModelImportViewComponent } from './feature-model/model-import-view/model-import-view.component';\r\nimport { ExpertModelEditComponent } from './expert-model/expert-model-edit/expert-model-edit.component';\r\nimport { FeatureModelEditComponent } from './feature-model/feature-model-edit/feature-model-edit.component';\r\nimport { FeatureTreeComponent } from './feature-model/feature-tree/feature-tree.component';\r\nimport { FeatureModelFormComponent } from './feature-model/feature-model-form/feature-model-form.component';\r\nimport { InstanceListComponent } from './instances/instance-list/instance-list.component';\r\nimport { InstanceComponent } from './instances/instance/instance.component';\r\nimport { PatternComponent } from './instances/pattern/pattern.component';\r\nimport { DeleteDecisionModalComponent } from './instances/delete-decision-modal/delete-decision-modal.component';\r\nimport { AddDecisionModalComponent } from './instances/add-decision-modal/add-decision-modal.component';\r\nimport { InstanceInfoBoxComponent } from './instances/instance-info-box/instance-info-box.component';\r\nimport { InstanceFormComponent } from './instances/instance-form/instance-form.component';\r\nimport { CanvasBuildingBlockComponent } from './instances/canvas-building-block/canvas-building-block.component';\r\nimport { ExampleComponent } from './instances/example/example.component';\r\nimport { ModelInfoBoxComponent } from './feature-model/model-info-box/model-info-box.component';\r\nimport { CompanyModelEditComponent } from './company-model/company-model-edit/company-model-edit.component';\r\nimport { CompanyModelsComponent } from './company-model/company-models/company-models.component';\r\nimport { CompanyModelComponent } from './company-model/company-model/company-model.component';\r\nimport { CreateCanvasConfigurationComponent } from './api/create-canvas-configuration/create-canvas-configuration.component';\r\nimport { CreateCanvasComponent } from './api/create-canvas/create-canvas.component';\r\nimport { EditCanvasComponent } from './api/edit-canvas/edit-canvas.component';\r\nimport { CanvasDefinitionsComponent } from './canvas-definition/canvas-definitions/canvas-definitions.component';\r\nimport { CanvasDefinitionComponent } from './canvas-definition/canvas-definition/canvas-definition.component';\r\nimport { CanvasComponent } from './instances/canvas/canvas.component';\r\nimport { SelectCanvasDefinitionConfigurationComponent } from './api/select-canvas-definition-configuration/select-canvas-definition-configuration.component';\r\nimport { CompanyModelSelectExpertKnowledgeComponent } from './company-model/company-model-select-expert-knowledge/company-model-select-expert-knowledge.component';\r\nimport { CompareComponent } from './api/compare/compare.component';\r\nimport { InstanceCompareFormComponent } from './instances/instance-compare-form/instance-compare-form.component';\r\nimport { CreateCompetitorCanvasComponent } from './api/create-competitor-canvas/create-competitor-canvas.component';\r\nimport { EditCompetitorCanvasComponent } from './api/edit-competitor-canvas/edit-competitor-canvas.component';\r\nimport { EditCompetitorsComponent } from './api/edit-competitors/edit-competitors.component';\r\nimport { RefineCanvasComponent } from './api/refine-canvas/refine-canvas.component';\r\nimport { InstanceSelectPatternFormComponent } from './instances/instance-select-pattern-form/instance-select-pattern-form.component';\r\nimport { ViewCanvasComponent } from './api/view-canvas/view-canvas.component';\r\nimport { EditModelComponent } from './api/edit-model/edit-model.component';\r\nimport { CanvasDefinitionFormComponent } from './canvas-definition/canvas-definition-form/canvas-definition-form.component';\r\nimport { CanvasDefinitionRowFormComponent } from './canvas-definition/canvas-definition-row-form/canvas-definition-row-form.component';\r\nimport { CanvasDefinitionRelationshipsFormComponent } from './canvas-definition/canvas-definition-relationships-form/canvas-definition-relationships-form.component';\r\nimport { CanvasElementsComponent } from './elements/canvas-elements/canvas-elements.component';\r\nimport { CanvasDefinitionOverviewComponent } from './canvas-definition/canvas-definition-overview/canvas-definition-overview.component';\r\nimport { PatternDescriptionModalComponent } from './instances/pattern-description-modal/pattern-description-modal.component';\r\nimport { PatternViewComponent } from './instances/pattern-view/pattern-view.component';\r\nimport { PatternHintComponent } from './instances/pattern-hint/pattern-hint.component';\r\n\r\n@NgModule({\r\n  providers: [\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: (canvasService: CanvasService) => (): void =>\r\n        canvasService.init(),\r\n      deps: [CanvasService],\r\n      multi: true,\r\n    },\r\n  ],\r\n  imports: [SharedModule, CanvasRoutingModule],\r\n  declarations: [\r\n    // api\r\n    CompareComponent,\r\n    CreateCanvasComponent,\r\n    CreateCanvasConfigurationComponent,\r\n    CreateCompetitorCanvasComponent,\r\n    EditCanvasComponent,\r\n    EditCompetitorCanvasComponent,\r\n    EditCompetitorsComponent,\r\n    EditModelComponent,\r\n    RefineCanvasComponent,\r\n    SelectCanvasDefinitionConfigurationComponent,\r\n    ViewCanvasComponent,\r\n\r\n    // canvas-definition\r\n    CanvasDefinitionComponent,\r\n    CanvasDefinitionFormComponent,\r\n    CanvasDefinitionOverviewComponent,\r\n    CanvasDefinitionRelationshipsFormComponent,\r\n    CanvasDefinitionRowFormComponent,\r\n    CanvasDefinitionsComponent,\r\n\r\n    // company-model\r\n    CompanyModelComponent,\r\n    CompanyModelEditComponent,\r\n    CompanyModelSelectExpertKnowledgeComponent,\r\n    CompanyModelsComponent,\r\n\r\n    // elements\r\n    CanvasElementsComponent,\r\n\r\n    // expert-model\r\n    ExpertModelComponent,\r\n    ExpertModelEditComponent,\r\n    ExpertModelsComponent,\r\n\r\n    // feature-model\r\n    DeleteFeatureConfirmComponent,\r\n    FeatureBuildingBlockComponent,\r\n    FeatureFormComponent,\r\n    FeatureModelComponent,\r\n    FeatureModelEditComponent,\r\n    FeatureModelFormComponent,\r\n    FeatureModelSubformComponent,\r\n    FeatureTreeComponent,\r\n    ModelImportViewComponent,\r\n    ModelInfoBoxComponent,\r\n    ModelListComponent,\r\n\r\n    // instances\r\n    AddDecisionModalComponent,\r\n    CanvasComponent,\r\n    CanvasBuildingBlockComponent,\r\n    DeleteDecisionModalComponent,\r\n    ExampleComponent,\r\n    FeatureModelInstanceSubformComponent,\r\n    InstanceComponent,\r\n    InstanceCompareFormComponent,\r\n    InstanceFormComponent,\r\n    InstanceInfoBoxComponent,\r\n    InstanceListComponent,\r\n    InstanceSelectPatternFormComponent,\r\n    PatternComponent,\r\n    PatternDescriptionModalComponent,\r\n    PatternHintComponent,\r\n    PatternViewComponent,\r\n\r\n    // merge\r\n    MergeExpertModelsComponent,\r\n    MergeIntoTreeComponent,\r\n    MergeModelViewComponent,\r\n    MergeTreeComponent,\r\n    TraceModalComponent,\r\n\r\n    // relationships\r\n    CrossTreeRelationshipFormComponent,\r\n    CrossTreeRelationshipModalComponent,\r\n  ],\r\n})\r\nexport class CanvasModule {}\r\n","import { Injectable } from '@angular/core';\r\nimport { ModuleService } from '../development-process-registry/module-api/module.service';\r\nimport { Module } from '../development-process-registry/module-api/module';\r\nimport { CompanyModel } from '../canvas-meta-model/company-model';\r\nimport { CompanyModelService } from '../canvas-meta-model/company-model.service';\r\nimport { CanvasApiService } from './canvas-api.service';\r\nimport { ExpertModelService } from '../canvas-meta-model/expert-model.service';\r\nimport { CreateCanvasConfigurationComponent } from './api/create-canvas-configuration/create-canvas-configuration.component';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { SelectCanvasDefinitionConfigurationComponent } from './api/select-canvas-definition-configuration/select-canvas-definition-configuration.component';\r\nimport { CanvasMetaModelService } from '../canvas-meta-model/canvas-meta-model.service';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { Router } from '@angular/router';\r\nimport { InstanceArtifactData } from '../canvas-meta-model/instance-artifact-data';\r\nimport { Reference } from '../development-process-registry/meta-model-definition';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasService {\r\n  constructor(\r\n    private canvasApiService: CanvasApiService,\r\n    private canvasMetaModelService: CanvasMetaModelService,\r\n    private companyModelService: CompanyModelService,\r\n    private expertModelService: ExpertModelService,\r\n    private fb: FormBuilder,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  init(): void {\r\n    const module = new Module();\r\n    module.list = 'Canvas Tools';\r\n    module.name = 'Canvas Module';\r\n    this.addMethods(module);\r\n    module.service = this.canvasApiService;\r\n    this.moduleService.registerModule(module);\r\n    console.log('Registered Canvas Module');\r\n    this.canvasMetaModelService.registerViewMethod(this.viewModel);\r\n    console.log('Registered Canvas Module as view method for canvas models');\r\n  }\r\n\r\n  async viewModel(\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ): Promise<void> {\r\n    const modelReference: InstanceArtifactData = model as InstanceArtifactData;\r\n    let queryParams: {\r\n      runningProcessId?: string;\r\n      executionId?: string;\r\n      artifactId?: string;\r\n      versionId?: number;\r\n    };\r\n    switch (reference.referenceType) {\r\n      case 'Process':\r\n        queryParams = {\r\n          runningProcessId: reference.runningProcessId,\r\n        };\r\n        break;\r\n      case 'Method':\r\n        queryParams = {\r\n          runningProcessId: reference.runningProcessId,\r\n          executionId: reference.executionId,\r\n        };\r\n        break;\r\n      case 'Artifact':\r\n        queryParams = {\r\n          artifactId: reference.artifactId,\r\n          versionId: reference.versionId,\r\n        };\r\n        break;\r\n    }\r\n    await router.navigate(\r\n      [\r\n        'canvas',\r\n        modelReference.id,\r\n        'instance',\r\n        modelReference.instanceId,\r\n        'view',\r\n      ],\r\n      {\r\n        queryParams,\r\n      }\r\n    );\r\n  }\r\n\r\n  private addMethods(module: Module): void {\r\n    const self = this;\r\n    module.addMethod({\r\n      name: 'createCanvas',\r\n      description: 'Creates a canvas',\r\n      input: [],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      configurationFormComponent: SelectCanvasDefinitionConfigurationComponent,\r\n      createConfigurationForm(predefinedInput: any): FormGroup {\r\n        return self.fb.group({\r\n          definitionId: [\r\n            predefinedInput ? predefinedInput.definitionId : null,\r\n            Validators.required,\r\n          ],\r\n        });\r\n      },\r\n      equalPredefinedInput(\r\n        predefinedInputA: any,\r\n        predefinedInputB: any\r\n      ): boolean {\r\n        if (predefinedInputA == null && predefinedInputB == null) {\r\n          return true;\r\n        }\r\n        if (predefinedInputA == null || predefinedInputB == null) {\r\n          return false;\r\n        }\r\n        return predefinedInputA.definitionId === predefinedInputB.definitionId;\r\n      },\r\n      decisionConfigurationFormComponent: CreateCanvasConfigurationComponent,\r\n      createDecisionConfigurationForm(predefinedInput: any): FormGroup {\r\n        if (predefinedInput == null) {\r\n          predefinedInput = {\r\n            companyModelId: null,\r\n          };\r\n        }\r\n        return self.fb.group({\r\n          companyModelId: [predefinedInput.companyModelId, Validators.required],\r\n        });\r\n      },\r\n    });\r\n    module.addMethod({\r\n      name: 'editCanvas',\r\n      description: 'Edit a canvas',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'refineCanvas',\r\n      description: 'Refine canvas through hints and patterns',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'compareCompetitors',\r\n      description: 'Compare competitors with the business model canvas',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'createCompetitors',\r\n      description: 'Add competitors to the model',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'manageCompetitors',\r\n      description: 'Edit and remove competitors of the model',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'viewCanvas',\r\n      description: 'View the canvas',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n    module.addMethod({\r\n      name: 'editModel',\r\n      description: 'Edit the company model',\r\n      input: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n      output: [{ name: 'Canvas', type: CompanyModel.typeName }],\r\n    });\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'companyModels']\">\r\n      Composed Models\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'companyModels', companyModel._id]\"\r\n    >\r\n      {{ companyModel.name }}\r\n    </a>\r\n    <a *ngIf=\"companyModel\" class=\"nav-link active\" [routerLink]=\"[]\">Edit</a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"companyModel\" role=\"main\" class=\"container\">\r\n  <app-feature-model-edit\r\n    [featureModel]=\"companyModel\"\r\n    (updateFeatureModel)=\"updateCompanyModel()\"\r\n  ></app-feature-model-edit>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CompanyModelLoaderService } from '../company-model-loader.service';\r\n\r\n@Component({\r\n  selector: 'app-company-model-edit',\r\n  templateUrl: './company-model-edit.component.html',\r\n  styleUrls: ['./company-model-edit.component.css'],\r\n  providers: [CompanyModelLoaderService],\r\n})\r\nexport class CompanyModelEditComponent {\r\n  constructor(\r\n    private companyModelLoaderService: CompanyModelLoaderService,\r\n    private companyModelService: CompanyModelService\r\n  ) {}\r\n\r\n  async updateCompanyModel() {\r\n    await this.companyModelService.save(this.companyModel);\r\n  }\r\n\r\n  get companyModel() {\r\n    return this.companyModelLoaderService.companyModel;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { CompanyModel } from '../../canvas-meta-model/company-model';\r\nimport { CompanyModelService } from '../../canvas-meta-model/company-model.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CompanyModelLoaderService extends ElementLoaderService {\r\n  companyModel: CompanyModel = null;\r\n\r\n  constructor(\r\n    private companyModelService: CompanyModelService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const companyModelId = paramMap.get('id');\r\n    this.changesFeed = this.companyModelService\r\n      .getChangesFeed(companyModelId)\r\n      .subscribe(() => this.loadCompanyModel(companyModelId));\r\n    void this.loadCompanyModel(companyModelId);\r\n  }\r\n\r\n  private async loadCompanyModel(companyModelId: string): Promise<void> {\r\n    this.companyModel = await this.companyModelService.get(companyModelId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"bmProcess && companyModel\">\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'bmprocess', 'bmprocessview', bmProcess._id]\"\r\n      >{{ bmProcess.name }}</a\r\n    >\r\n    <a\r\n      class=\"nav-link active\"\r\n      [routerLink]=\"[]\"\r\n      [queryParams]=\"{ bmProcessId: this.bmProcess._id }\"\r\n      >{{ companyModel.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"companyModel && bmProcess\" role=\"main\" class=\"container\">\r\n  <app-model-info-box [featureModel]=\"companyModel\"></app-model-info-box>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Domains</h6>\r\n    <ul class=\"list-group\">\r\n      <li class=\"list-group-item\" *ngFor=\"let domain of bmProcess.domains\">\r\n        {{ domain.name }}\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Select Canvas Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"selectedExpertModelForm\"\r\n        (ngSubmit)=\"selectExpertModel()\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"expertModelSelector\" class=\"col-sm-4 col-form-label\"\r\n            >Canvas Building Block</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select\r\n              id=\"expertModelSelector\"\r\n              formControlName=\"expertModelId\"\r\n              class=\"form-control\"\r\n            >\r\n              <option\r\n                *ngFor=\"let em of unselectedExpertModelList\"\r\n                [value]=\"em._id\"\r\n              >\r\n                {{ em.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!selectedExpertModelForm.valid\"\r\n            >\r\n              Add Canvas Building Block\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Selected Canvas Building Blocks\r\n    </h6>\r\n\r\n    <ul\r\n      *ngIf=\"selectedExpertModelList\"\r\n      class=\"list-group inner\"\r\n      style=\"margin: 5px\"\r\n    >\r\n      <li\r\n        *ngFor=\"let em of selectedExpertModelList\"\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-center\r\n        \"\r\n      >\r\n        <span>{{ em.name }}</span>\r\n        <span>\r\n          <button\r\n            type=\"button\"\r\n            (click)=\"mergeExpertModel(em._id)\"\r\n            class=\"btn btn-warning btn-xs mr-1\"\r\n          >\r\n            Merge\r\n          </button>\r\n          <button\r\n            (click)=\"unselectExpertModel(em._id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Unselect\r\n          </button>\r\n        </span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { BmProcess } from '../../../development-process-registry/bm-process/bm-process';\r\nimport { BmProcessService } from '../../../development-process-registry/bm-process/bm-process.service';\r\nimport { MergeService } from '../../merge/merge.service';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { ExpertModelEntry } from '../../../canvas-meta-model/expert-model';\r\n\r\n@Component({\r\n  selector: 'app-company-model-select-expert-knowledge',\r\n  templateUrl: './company-model-select-expert-knowledge.component.html',\r\n  styleUrls: ['./company-model-select-expert-knowledge.component.css'],\r\n})\r\nexport class CompanyModelSelectExpertKnowledgeComponent\r\n  implements OnInit, OnDestroy\r\n{\r\n  companyModel: CompanyModel;\r\n  bmProcess: BmProcess;\r\n\r\n  selectedExpertModelForm = this.fb.group({\r\n    expertModelId: [null, Validators.required],\r\n  });\r\n  selectedExpertModelList: ExpertModelEntry[];\r\n  unselectedExpertModelList: ExpertModelEntry[];\r\n\r\n  private querySubscription: Subscription;\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    private companyModelService: CompanyModelService,\r\n    private fb: FormBuilder,\r\n    private mergeService: MergeService,\r\n    private route: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.querySubscription = this.route.queryParamMap.subscribe((paramMap) => {\r\n      void this.loadBmProcess(paramMap.get('bmProcessId'));\r\n    });\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      void this.loadCompanyModel(paramMap.get('id'));\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.querySubscription) {\r\n      this.querySubscription.unsubscribe();\r\n    }\r\n    if (this.routeSubscription) {\r\n      this.routeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async loadCompanyModel(companyModelId: string): Promise<void> {\r\n    this.companyModel = await this.companyModelService.get(companyModelId);\r\n    await this.loadExpertModels(companyModelId);\r\n  }\r\n\r\n  async loadBmProcess(bmProcessId: string): Promise<void> {\r\n    this.bmProcess = await this.bmProcessService.get(bmProcessId);\r\n  }\r\n\r\n  async mergeExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate(\r\n      ['/merge', this.companyModel._id, expertModelId],\r\n      {\r\n        queryParams: {\r\n          bmProcessId: this.bmProcess._id,\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  async selectExpertModel(): Promise<void> {\r\n    await this.mergeService.selectExpertModel(\r\n      this.companyModel._id,\r\n      this.selectedExpertModelForm.value.expertModelId\r\n    );\r\n    this.selectedExpertModelForm.reset();\r\n    await this.loadExpertModels(this.companyModel._id);\r\n  }\r\n\r\n  async unselectExpertModel(expertModelId: string): Promise<void> {\r\n    await this.mergeService.unselectExpertModel(\r\n      this.companyModel._id,\r\n      expertModelId\r\n    );\r\n    await this.loadExpertModels(this.companyModel._id);\r\n  }\r\n\r\n  private async loadExpertModels(companyModelId: string): Promise<void> {\r\n    await this.loadSelectedExpertModels(companyModelId);\r\n    await this.loadUnselectedExpertModels(companyModelId);\r\n  }\r\n\r\n  private async loadSelectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    this.selectedExpertModelList =\r\n      await this.mergeService.getSelectedExpertModels(companyModelId);\r\n  }\r\n\r\n  private async loadUnselectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    const result = await this.mergeService.getUnselectedExpertModels(\r\n      companyModelId\r\n    );\r\n    if (this.bmProcess.domains.length > 0) {\r\n      this.unselectedExpertModelList = result.filter((model) =>\r\n        model.domains\r\n          ? model.domains.some((domain) =>\r\n              this.bmProcess.domains.some((d) => d._id === domain._id)\r\n            )\r\n          : false\r\n      );\r\n    } else {\r\n      this.unselectedExpertModelList = result;\r\n    }\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'companyModels']\">\r\n      Composed Models\r\n    </a>\r\n    <a *ngIf=\"companyModel\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ companyModel.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'companyModels', companyModel._id, 'edit']\"\r\n    >\r\n      Edit\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"companyModel\" role=\"main\" class=\"container\">\r\n  <app-model-info-box [featureModel]=\"companyModel\"></app-model-info-box>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Composed Model {{ companyModel.name }}\r\n    </h6>\r\n    <app-feature-model [featureModel]=\"companyModel\"></app-feature-model>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Edit Composed Model</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-feature-model-form\r\n        [featureModel]=\"companyModel\"\r\n        (submitFeatureModelForm)=\"update($event.value)\"\r\n      ></app-feature-model-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Edit Author Information</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-author-form\r\n        [author]=\"companyModel.author\"\r\n        (submitAuthorForm)=\"updateAuthor($event.value)\"\r\n      ></app-author-form>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- List expert models -->\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Selected Canvas Building Blocks\r\n    </h6>\r\n\r\n    <ul\r\n      *ngIf=\"selectedExpertModelList\"\r\n      class=\"list-group inner\"\r\n      style=\"margin: 5px\"\r\n    >\r\n      <li\r\n        *ngFor=\"let em of selectedExpertModelList\"\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-center\r\n        \"\r\n      >\r\n        <span>{{ em.name }}</span>\r\n        <span>\r\n          <button\r\n            type=\"button\"\r\n            (click)=\"mergeExpertModel(em._id)\"\r\n            class=\"btn btn-warning btn-xs\"\r\n          >\r\n            Merge</button\r\n          >&nbsp;\r\n          <button\r\n            (click)=\"viewExpertModel(em._id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs\"\r\n          >\r\n            View</button\r\n          >&nbsp;\r\n          <button\r\n            (click)=\"unselectExpertModel(em._id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Unselect\r\n          </button>\r\n        </span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <!-- Select expert model -->\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Select Canvas Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"selectedExpertModelForm\"\r\n        (ngSubmit)=\"selectExpertModel()\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"expertModelSelector\" class=\"col-sm-4 col-form-label\"\r\n            >Canvas Building Block</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select\r\n              id=\"expertModelSelector\"\r\n              formControlName=\"expertModelId\"\r\n              class=\"form-control\"\r\n            >\r\n              <option\r\n                *ngFor=\"let em of unselectedExpertModelList\"\r\n                [value]=\"em._id\"\r\n              >\r\n                {{ em.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!selectedExpertModelForm.valid\"\r\n            >\r\n              Add Canvas Building Block\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { ExpertModelEntry } from '../../../canvas-meta-model/expert-model';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { MergeService } from '../../merge/merge.service';\r\nimport { CompanyModelLoaderService } from '../company-model-loader.service';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\n\r\n@Component({\r\n  selector: 'app-company-model',\r\n  templateUrl: './company-model.component.html',\r\n  styleUrls: ['./company-model.component.css'],\r\n  providers: [CompanyModelLoaderService],\r\n})\r\nexport class CompanyModelComponent implements OnInit {\r\n  selectedExpertModelList: ExpertModelEntry[];\r\n  selectedExpertModelForm = this.fb.group({\r\n    expertModelId: [null, Validators.required],\r\n  });\r\n  unselectedExpertModelList: ExpertModelEntry[];\r\n\r\n  constructor(\r\n    private companyModelLoaderService: CompanyModelLoaderService,\r\n    private companyModelService: CompanyModelService,\r\n    private fb: FormBuilder,\r\n    private mergeService: MergeService,\r\n    private route: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.companyModelLoaderService.loaded.subscribe(() =>\r\n      this.loadExpertModels(this.companyModel._id)\r\n    );\r\n  }\r\n\r\n  async update(description: any): Promise<void> {\r\n    await this.companyModelService.update(this.companyModel._id, description);\r\n  }\r\n\r\n  async updateAuthor(authorInfo: any): Promise<void> {\r\n    await this.companyModelService.updateAuthor(\r\n      this.companyModel._id,\r\n      authorInfo\r\n    );\r\n  }\r\n\r\n  async selectExpertModel(): Promise<void> {\r\n    await this.mergeService.selectExpertModel(\r\n      this.companyModel._id,\r\n      this.selectedExpertModelForm.value.expertModelId\r\n    );\r\n    this.selectedExpertModelForm.reset();\r\n  }\r\n\r\n  async unselectExpertModel(expertModelId: string): Promise<void> {\r\n    await this.mergeService.unselectExpertModel(\r\n      this.companyModel._id,\r\n      expertModelId\r\n    );\r\n  }\r\n\r\n  async mergeExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate([\r\n      '/merge',\r\n      this.companyModel._id,\r\n      expertModelId,\r\n    ]);\r\n  }\r\n\r\n  async viewExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate(['/expertModels', expertModelId]);\r\n  }\r\n\r\n  /**\r\n   * Load selected and unselected expert models\r\n   *\r\n   * @param companyModelId the id of the company model\r\n   */\r\n  private async loadExpertModels(companyModelId: string): Promise<void> {\r\n    await this.loadSelectedExpertModels(companyModelId);\r\n    await this.loadUnselectedExpertModels(companyModelId);\r\n  }\r\n\r\n  /**\r\n   * Load all selected expert models\r\n   *\r\n   * @param companyModelId the id of the company model\r\n   */\r\n  private async loadSelectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    this.selectedExpertModelList =\r\n      await this.mergeService.getSelectedExpertModels(companyModelId);\r\n  }\r\n\r\n  /**\r\n   * Load all unselected expert models\r\n   *\r\n   * @param companyModelId the id of the company model\r\n   */\r\n  private async loadUnselectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    this.unselectedExpertModelList =\r\n      await this.mergeService.getUnselectedExpertModels(companyModelId);\r\n  }\r\n\r\n  get companyModel(): CompanyModel {\r\n    return this.companyModelLoaderService.companyModel;\r\n  }\r\n}\r\n","<ng-template #deleteCompanyModelModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteCompanyModel(modalCompanyModel._id); c()\"\r\n  >\r\n    <div modalTitle>Delete Composed Model {{ modalCompanyModel.name }}</div>\r\n    You are deleting the composed model {{ modalCompanyModel.name }}. This can\r\n    not be undone.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Composed Models</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\">\r\n    Composed Models are used to represent merged canvas building blocks.\r\n  </div>\r\n\r\n  <app-model-list\r\n    modelListTitle=\"Composed Models\"\r\n    modelFormTitle=\"Add Composed Model\"\r\n    (viewModel)=\"viewCompanyModel($event)\"\r\n    (editModel)=\"editCompanyModel($event)\"\r\n    (deleteModel)=\"openDeleteCompanyModelModal($event)\"\r\n    (addModel)=\"\r\n      addCompanyModel($event.definition, $event.name, $event.description)\r\n    \"\r\n  ></app-model-list>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport {\r\n  CompanyModel,\r\n  CompanyModelInit,\r\n} from '../../../canvas-meta-model/company-model';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { CanvasDefinition } from '../../../canvas-meta-model/canvas-definition';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../../shared/list.service';\r\nimport { ModelListComponent } from '../../feature-model/model-list/model-list.component';\r\nimport { ModelList } from '../../feature-model/model-list/model-list';\r\nimport { DbId } from '../../../database/database-entry';\r\n\r\n@Component({\r\n  selector: 'app-company-models',\r\n  templateUrl: './company-models.component.html',\r\n  styleUrls: ['./company-models.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: CompanyModelService },\r\n  ],\r\n})\r\nexport class CompanyModelsComponent {\r\n  modalCompanyModel: CompanyModel;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild(ModelListComponent) modelList: ModelList;\r\n  @ViewChild('deleteCompanyModelModal', { static: true })\r\n  deleteCompanyModelModal: unknown;\r\n\r\n  constructor(\r\n    private companyModelService: CompanyModelService,\r\n    private listService: ListService<CompanyModel, CompanyModelInit>,\r\n    private modalService: NgbModal,\r\n    private router: Router\r\n  ) {}\r\n\r\n  async addCompanyModel(\r\n    definition: CanvasDefinition,\r\n    name: string,\r\n    description: string\r\n  ): Promise<void> {\r\n    await this.listService.add(\r\n      this.companyModelService.createFeatureModel(\r\n        { name, description, $definition: definition },\r\n        definition\r\n      )\r\n    );\r\n    this.modelList.resetAddForm();\r\n  }\r\n\r\n  async viewCompanyModel(companyModelId: DbId): Promise<void> {\r\n    await this.router.navigate(['/companyModels', companyModelId]);\r\n  }\r\n\r\n  async editCompanyModel(companyModelId: DbId): Promise<void> {\r\n    await this.router.navigate(['/companyModels', companyModelId, 'edit']);\r\n  }\r\n\r\n  async openDeleteCompanyModelModal(featureModelId: DbId): Promise<void> {\r\n    this.modalCompanyModel = await this.companyModelService.get(featureModelId);\r\n    this.modalReference = this.modalService.open(this.deleteCompanyModelModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async deleteCompanyModel(featureModelId: DbId): Promise<void> {\r\n    await this.listService.delete(featureModelId);\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-canvas-elements',\r\n  templateUrl: './canvas-elements.component.html',\r\n  styleUrls: ['./canvas-elements.component.css'],\r\n})\r\nexport class CanvasElementsComponent {}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Canvas Elements</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\">\r\n    All canvas elements, except for domains, are directly defined while creating\r\n    canvas building blocks.\r\n  </div>\r\n\r\n  <app-list-wrapper listTitle=\"Canvas Elements\">\r\n    <div results class=\"list-group\">\r\n      <a\r\n        class=\"list-group-item list-group-item-action d-flex\"\r\n        [routerLink]=\"['/', 'domains']\"\r\n      >\r\n        <div>Domains</div>\r\n        <div class=\"ml-auto\">\r\n          <div class=\"btn btn-dark btn-xs\">View</div>\r\n        </div>\r\n      </a>\r\n    </div>\r\n  </app-list-wrapper>\r\n</main>\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'expertModels']\">\r\n      Canvas Building Blocks\r\n    </a>\r\n    <a\r\n      *ngIf=\"expertModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'expertModels', expertModel._id]\"\r\n    >\r\n      {{ expertModel.name }}\r\n    </a>\r\n    <a *ngIf=\"expertModel\" class=\"nav-link active\" [routerLink]=\"[]\">Edit</a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"expertModel\" role=\"main\" class=\"container\">\r\n  <app-feature-model-edit\r\n    [featureModel]=\"expertModel\"\r\n    (updateFeatureModel)=\"updateExpertModel()\"\r\n  ></app-feature-model-edit>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { ExpertModelLoaderService } from '../expert-model-loader.service';\r\n\r\n@Component({\r\n  selector: 'app-expert-model-edit',\r\n  templateUrl: './expert-model-edit.component.html',\r\n  styleUrls: ['./expert-model-edit.component.css'],\r\n  providers: [ExpertModelLoaderService],\r\n})\r\nexport class ExpertModelEditComponent {\r\n  constructor(\r\n    private expertModelLoaderService: ExpertModelLoaderService,\r\n    private expertModelService: ExpertModelService\r\n  ) {}\r\n\r\n  async updateExpertModel() {\r\n    await this.expertModelService.save(this.expertModel);\r\n  }\r\n\r\n  get expertModel() {\r\n    return this.expertModelLoaderService.expertModel;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { ExpertModel } from '../../canvas-meta-model/expert-model';\r\nimport { ExpertModelService } from '../../canvas-meta-model/expert-model.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class ExpertModelLoaderService extends ElementLoaderService {\r\n  expertModel: ExpertModel = null;\r\n\r\n  constructor(\r\n    private expertModelService: ExpertModelService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const expertModelId = paramMap.get('id');\r\n    this.changesFeed = this.expertModelService\r\n      .getChangesFeed(expertModelId)\r\n      .subscribe(() => this.loadExpertModel(expertModelId));\r\n    void this.loadExpertModel(expertModelId);\r\n  }\r\n\r\n  private async loadExpertModel(bmProcessId: string): Promise<void> {\r\n    this.expertModel = await this.expertModelService.get(bmProcessId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'expertModels']\">\r\n      Canvas Building Blocks\r\n    </a>\r\n    <a *ngIf=\"expertModel\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ expertModel.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"expertModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'expertModels', expertModel._id, 'edit']\"\r\n    >\r\n      Edit\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"expertModel\" role=\"main\" class=\"container\">\r\n  <app-model-info-box [featureModel]=\"expertModel\"></app-model-info-box>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Canvas Building Block {{ expertModel.name }}\r\n    </h6>\r\n    <app-feature-model [featureModel]=\"expertModel\"></app-feature-model>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Export Canvas Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              (click)=\"exportModel()\"\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n            >\r\n              Export Canvas Building Block\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Steps</h6>\r\n    <ul ngbNav #nav=\"ngbNav\" class=\"nav-pills nav-justified\">\r\n      <li ngbNavItem=\"stepDescribe\" #stepDescribe=\"ngbNavItem\">\r\n        <a ngbNavLink>1. Describe</a>\r\n        <ng-template ngbNavContent>\r\n          Describe the canvas building block\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem=\"stepEdit\" #stepEdit=\"ngbNavItem\">\r\n        <a ngbNavLink>2. Edit</a>\r\n        <ng-template ngbNavContent>\r\n          Edit the canvas building block\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem=\"stepCreateInstances\">\r\n        <a ngbNavLink>3. Create Patterns and Examples</a>\r\n        <ng-template ngbNavContent>\r\n          <p>\r\n            Create business model patterns and example instances of this canvas\r\n            building block.\r\n          </p>\r\n          <p class=\"mb-0\">\r\n            Business model patterns will be used to give users hints about\r\n            possible patterns and will be shown to the user if used in their\r\n            business model. Users can use examples to compare them with their\r\n            own business model.\r\n          </p>\r\n        </ng-template>\r\n      </li>\r\n    </ul>\r\n    <div class=\"mt-1\" [ngbNavOutlet]=\"nav\"></div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepDescribe.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Domains</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-domains-selection-form\r\n        [domains]=\"expertModel.domains\"\r\n        (submitDomainsForm)=\"updateDomains($event.value)\"\r\n      ></app-domains-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepDescribe.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Edit Canvas Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-feature-model-form\r\n        [featureModel]=\"expertModel\"\r\n        (submitFeatureModelForm)=\"update($event.value)\"\r\n      ></app-feature-model-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepDescribe.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Edit Author Information</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-author-form\r\n        [author]=\"expertModel.author\"\r\n        (submitAuthorForm)=\"updateFeatureModelAuthor($event.value)\"\r\n      ></app-author-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepEdit.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Edit canvas building block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <button\r\n        type=\"button\"\r\n        [routerLink]=\"['/expertModels', expertModel._id, 'edit']\"\r\n        class=\"btn btn-sm btn-dark btn-lg btn-block\"\r\n      >\r\n        Edit Canvas Building Block\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <app-instance-list\r\n    *ngIf=\"nav.activeId === 'stepCreateInstances'\"\r\n    formTitle=\"Add Pattern Instance\"\r\n    listTitle=\"Pattern Instances\"\r\n    [instances]=\"getPatternInstances()\"\r\n    [viewInstanceLink]=\"viewPattern\"\r\n    (addInstance)=\"addInstance($event, getPatternInstanceType())\"\r\n    (deleteInstance)=\"deleteInstance($event)\"\r\n  ></app-instance-list>\r\n\r\n  <app-instance-list\r\n    *ngIf=\"nav.activeId === 'stepCreateInstances'\"\r\n    formTitle=\"Add Example Instance\"\r\n    listTitle=\"Example Instances\"\r\n    [instances]=\"getExampleInstances()\"\r\n    [viewInstanceLink]=\"viewExample\"\r\n    (addInstance)=\"addInstance($event)\"\r\n    (deleteInstance)=\"deleteInstance($event)\"\r\n  ></app-instance-list>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { ImportExportService } from '../../feature-model/import-export.service';\r\nimport { Instance, InstanceType } from '../../../canvas-meta-model/instance';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { Domain } from '../../../development-process-registry/knowledge/domain';\r\nimport { ExpertModelLoaderService } from '../expert-model-loader.service';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\n\r\n@Component({\r\n  selector: 'app-expert-model',\r\n  templateUrl: './expert-model.component.html',\r\n  styleUrls: ['./expert-model.component.css'],\r\n  providers: [ExpertModelLoaderService],\r\n})\r\nexport class ExpertModelComponent {\r\n  constructor(\r\n    private expertModelLoaderService: ExpertModelLoaderService,\r\n    private expertModelService: ExpertModelService,\r\n    private importExportService: ImportExportService\r\n  ) {}\r\n\r\n  async exportModel(): Promise<void> {\r\n    await this.importExportService.exportExpertModel(this.expertModel._id);\r\n  }\r\n\r\n  async update(description: any): Promise<void> {\r\n    await this.expertModelService.update(this.expertModel._id, description);\r\n  }\r\n\r\n  async updateDomains(domains: Domain[]): Promise<void> {\r\n    await this.expertModelService.updateDomains(this.expertModel._id, domains);\r\n  }\r\n\r\n  async updateFeatureModelAuthor(authorInfo: any): Promise<void> {\r\n    await this.expertModelService.updateAuthor(\r\n      this.expertModel._id,\r\n      authorInfo\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add a new instance.\r\n   */\r\n  async addInstance(\r\n    instanceForm: FormGroup,\r\n    type = InstanceType.EXAMPLE\r\n  ): Promise<void> {\r\n    await this.expertModelService.addInstance(this.expertModel._id, {\r\n      name: instanceForm.value.name,\r\n      type,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Navigate to a single business model.\r\n   *\r\n   * @param instance the pattern instance\r\n   * @return the navigation link\r\n   */\r\n  viewExample = (instance: Instance): string[] => {\r\n    return [\r\n      '/',\r\n      'expertModels',\r\n      this.expertModel._id,\r\n      'examples',\r\n      instance.id.toString(),\r\n    ];\r\n  };\r\n\r\n  /**\r\n   * Navigate to a component to view the pattern\r\n   *\r\n   * @param instance the pattern instance\r\n   * @return the navigation link\r\n   */\r\n  viewPattern = (instance: Instance): string[] => {\r\n    return [\r\n      '/',\r\n      'expertModels',\r\n      this.expertModel._id,\r\n      'patterns',\r\n      instance.id.toString(),\r\n    ];\r\n  };\r\n\r\n  /**\r\n   * Delete an instance by id.\r\n   *\r\n   * @param instanceId id of the instance\r\n   */\r\n  async deleteInstance(instanceId: number): Promise<void> {\r\n    await this.expertModelService.removeInstance(\r\n      this.expertModel._id,\r\n      instanceId\r\n    );\r\n  }\r\n\r\n  getExampleInstances(): Instance[] {\r\n    return this.expertModel.instances.filter(\r\n      (instance) => instance.type === InstanceType.EXAMPLE\r\n    );\r\n  }\r\n\r\n  getPatternInstances(): Instance[] {\r\n    return this.expertModel.instances.filter(\r\n      (instance) => instance.type === InstanceType.PATTERN\r\n    );\r\n  }\r\n\r\n  getPatternInstanceType(): InstanceType {\r\n    return InstanceType.PATTERN;\r\n  }\r\n\r\n  get expertModel(): ExpertModel {\r\n    return this.expertModelLoaderService.expertModel;\r\n  }\r\n}\r\n","<ng-template #deleteExpertModelModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteExpertModel(modalExpertModel._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Canvas Building Block {{ modalExpertModel.name }}\r\n    </div>\r\n    You are deleting the canvas building block {{ modalExpertModel.name }}. This\r\n    can not be undone.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Canvas Building Blocks</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\">\r\n    Canvas building blocks are used to represent the knowledge of experts about\r\n    a certain domain.\r\n  </div>\r\n\r\n  <app-model-list\r\n    class=\"expert-model-list\"\r\n    modelListTitle=\"Canvas Building Blocks\"\r\n    modelFormTitle=\"Add Canvas Building Block\"\r\n    (viewModel)=\"viewExpertModel($event)\"\r\n    (editModel)=\"editExpertModel($event)\"\r\n    (deleteModel)=\"openDeleteExpertModelModal($event)\"\r\n    (addModel)=\"\r\n      addExpertModel($event.definition, $event.name, $event.description)\r\n    \"\r\n  ></app-model-list>\r\n\r\n  <app-model-import-view\r\n    formTitle=\"Import Canvas Building Block\"\r\n    [importExpertModel]=\"true\"\r\n    (imported)=\"reload()\"\r\n  ></app-model-import-view>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport {\r\n  ExpertModel,\r\n  ExpertModelInit,\r\n} from '../../../canvas-meta-model/expert-model';\r\nimport { Router } from '@angular/router';\r\nimport { CanvasDefinition } from '../../../canvas-meta-model/canvas-definition';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../../shared/list.service';\r\nimport { ModelListComponent } from '../../feature-model/model-list/model-list.component';\r\nimport { ModelList } from '../../feature-model/model-list/model-list';\r\n\r\n@Component({\r\n  selector: 'app-expert-models',\r\n  templateUrl: './expert-models.component.html',\r\n  styleUrls: ['./expert-models.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: ExpertModelService },\r\n  ],\r\n})\r\nexport class ExpertModelsComponent {\r\n  modalExpertModel: ExpertModel;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild(ModelListComponent) modelList: ModelList;\r\n  @ViewChild('deleteExpertModelModal', { static: true })\r\n  deleteExpertModelModal: unknown;\r\n\r\n  constructor(\r\n    private expertModelService: ExpertModelService,\r\n    private listService: ListService<ExpertModel, ExpertModelInit>,\r\n    private modalService: NgbModal,\r\n    private router: Router\r\n  ) {}\r\n\r\n  async addExpertModel(\r\n    definition: CanvasDefinition,\r\n    name: string,\r\n    description: string\r\n  ): Promise<void> {\r\n    const expertModel = await this.expertModelService.createFeatureModel(\r\n      { name, description, $definition: definition },\r\n      definition\r\n    );\r\n    await this.listService.add(expertModel);\r\n    this.modelList.resetAddForm();\r\n  }\r\n\r\n  async viewExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate(['/expertModels', expertModelId]);\r\n  }\r\n\r\n  async editExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate(['/expertModels', expertModelId, 'edit']);\r\n  }\r\n\r\n  async openDeleteExpertModelModal(featureModelId: string): Promise<void> {\r\n    this.modalExpertModel = await this.expertModelService.get(featureModelId);\r\n    this.modalReference = this.modalService.open(this.deleteExpertModelModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async reload(): Promise<void> {\r\n    await this.listService.load();\r\n  }\r\n\r\n  async deleteExpertModel(featureModelId: string): Promise<void> {\r\n    await this.listService.delete(featureModelId);\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-delete-feature-confirm',\r\n  templateUrl: './delete-feature-confirm.component.html',\r\n  styleUrls: ['./delete-feature-confirm.component.css'],\r\n})\r\nexport class DeleteFeatureConfirmComponent {\r\n  @Input() feature: Feature;\r\n\r\n  @Output() closeModal = new EventEmitter();\r\n  @Output() deletionResult = new EventEmitter<string>();\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\" id=\"modal-basic-title\">{{ feature.name }}</h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"closeModal.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <div class=\"alert alert-warning\" role=\"alert\">\r\n    <p>\r\n      You are trying to remove the feature \"{{ feature.name }}\". Please keep in\r\n      mind that you are removing also all subfeatures together with the\r\n      corresponding dependencies.\r\n    </p>\r\n    <p>Moreover, the feature is also removed from all business canvases.</p>\r\n    <p>\r\n      Additionally all traces to canvas building blocks of this feature will be\r\n      deleted.\r\n    </p>\r\n  </div>\r\n</div>\r\n<div class=\"modal-footer\">\r\n  <button\r\n    type=\"button\"\r\n    class=\"btn btn-block btn-warning\"\r\n    (click)=\"deletionResult.emit(feature.id)\"\r\n  >\r\n    Delete Feature\r\n  </button>\r\n</div>\r\n","<strong>{{ buildingBlockName }}</strong>\r\n<div class=\"list-group\">\r\n  <a\r\n    *ngFor=\"let f of features\"\r\n    class=\"list-group-item list-group-item-action p-2\"\r\n  >\r\n    <ng-container *ngIf=\"f.type === 'mandatory'\">\r\n      <i class=\"fa fa-circle mr-1\" aria-hidden=\"true\" title=\"mandatory\"></i>\r\n      <span class=\"sr-only\">mandatory</span>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"f.type === 'optional'\">\r\n      <i class=\"fa fa-circle-o mr-1\" aria-hidden=\"true\" title=\"optional\"></i>\r\n      <span class=\"sr-only\">optional</span>\r\n    </ng-container>\r\n    {{ f.name }}\r\n  </a>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-feature-building-block',\r\n  templateUrl: './feature-building-block.component.html',\r\n  styleUrls: ['./feature-building-block.component.css'],\r\n})\r\n/**\r\n * Internal class to display single features of the feature canvas.\r\n *\r\n * @author: Sebastian Gottschalk\r\n */\r\nexport class FeatureBuildingBlockComponent {\r\n  @Input() buildingBlockName: string;\r\n  @Input() features: Feature[];\r\n}\r\n","<form [formGroup]=\"featureForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Feature Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        [readonly]=\"feature && feature.parent === null\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\"\r\n      >Feature Description</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        [readonly]=\"feature && feature.parent === null\"\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n  <div *ngIf=\"!feature || feature.parent !== null\" class=\"form-group row\">\r\n    <label for=\"subfeatureOf\" class=\"col-sm-4 col-form-label\"\r\n      >Subfeature of</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"subfeatureOf\"\r\n        formControlName=\"subfeatureOf\"\r\n        class=\"form-control\"\r\n      >\r\n        <option\r\n          *ngFor=\"let fl of featureList\"\r\n          [disabled]=\"\r\n            disabledSubfeatures.includes(fl.id) ||\r\n            (enabledSubfeatures && !enabledSubfeatures.includes(fl.id))\r\n          \"\r\n          [ngValue]=\"fl.id\"\r\n        >\r\n          {{ fl.levelname }}\r\n        </option>\r\n      </select>\r\n      <div class=\"mt-1\" *ngIf=\"featureForm.get('subfeatureOf').disabled\">\r\n        Disabled, because this feature has a trace to a canvas building block\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <label for=\"type\" class=\"col-sm-4 col-form-label\">Mandatory Feature</label>\r\n    <div class=\"col-sm-8\">\r\n      <select id=\"type\" formControlName=\"type\" class=\"form-control\">\r\n        <option [ngValue]=\"'mandatory'\">Yes</option>\r\n        <option [ngValue]=\"'optional'\">No</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <label for=\"subfeatureConnections\" class=\"col-sm-4 col-form-label\"\r\n      >Subfeature Connections</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"subfeatureConnections\"\r\n        formControlName=\"subfeatureConnections\"\r\n        class=\"form-control\"\r\n      >\r\n        <option [ngValue]=\"null\">None</option>\r\n        <option [ngValue]=\"'xor'\">XOR</option>\r\n        <option [ngValue]=\"'or'\">OR</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-dark btn-block\"\r\n        [disabled]=\"!featureForm.valid\"\r\n      >\r\n        {{ submitButtonText }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-feature-form',\r\n  templateUrl: './feature-form.component.html',\r\n  styleUrls: ['./feature-form.component.css'],\r\n})\r\nexport class FeatureFormComponent implements OnInit, OnChanges {\r\n  @Input() feature: Feature = null;\r\n  @Input() featureList: { id: string; levelname: string }[];\r\n  @Input() disabledSubfeatures: string[] = [];\r\n  @Input() enabledSubfeatures: string[] = null;\r\n  @Input() submitButtonText = 'Update Feature';\r\n\r\n  @Output() submitFeatureForm = new EventEmitter<FormGroup>();\r\n\r\n  featureForm: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    if (this.feature === null) {\r\n      this.loadForm();\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.feature) {\r\n      this.loadForm(changes.feature.currentValue);\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitFeatureForm.emit(this.featureForm);\r\n    this.loadForm();\r\n  }\r\n\r\n  private loadForm(feature: Feature = null): void {\r\n    if (feature === null) {\r\n      if (this.featureList.length > 0) {\r\n        feature = new Feature(\r\n          undefined,\r\n          { name: '' },\r\n          undefined,\r\n          new Feature(\r\n            undefined,\r\n            { name: '' },\r\n            this.featureList[0].id,\r\n            undefined\r\n          )\r\n        );\r\n      } else {\r\n        feature = new Feature(undefined, { name: '' }, undefined, undefined);\r\n      }\r\n    }\r\n    this.featureForm = this.fb.group({\r\n      name: [feature.name, Validators.required],\r\n      description: feature.description,\r\n      type: feature.type,\r\n      subfeatureConnections: feature.subfeatureConnections,\r\n      subfeatureOf: feature.parent ? feature.parent.id : null,\r\n    });\r\n    if (Object.keys(feature.expertModelTrace).length > 0) {\r\n      this.featureForm.get('subfeatureOf').disable();\r\n    }\r\n  }\r\n}\r\n","<ng-template #deleteModal>\r\n  <app-delete-feature-confirm\r\n    [feature]=\"modalFeature\"\r\n    (deletionResult)=\"deleteFeature($event)\"\r\n    (closeModal)=\"closeModal()\"\r\n  ></app-delete-feature-confirm>\r\n</ng-template>\r\n\r\n<ng-template #dependencyModal>\r\n  <app-cross-tree-relationship-modal\r\n    [featureModel]=\"featureModel\"\r\n    [feature]=\"modalFeature\"\r\n    (closeModal)=\"closeModal()\"\r\n    (removeRelationship)=\"\r\n      removeRelationship($event.type, $event.fromFeatureId, $event.toFeatureId)\r\n    \"\r\n  ></app-cross-tree-relationship-modal>\r\n</ng-template>\r\n\r\n<ng-template #updateModal>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">{{ modalFeature.name }}</h4>\r\n    <button\r\n      type=\"button\"\r\n      class=\"close\"\r\n      aria-label=\"Close\"\r\n      (click)=\"closeModal()\"\r\n    >\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <app-feature-form\r\n        [feature]=\"modalFeature\"\r\n        [disabledSubfeatures]=\"modalSubfeatureIds\"\r\n        [featureList]=\"featureList\"\r\n        (submitFeatureForm)=\"updateFeature($event)\"\r\n      ></app-feature-form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"my-3 alert alert-info container\" role=\"alert\">\r\n  <p>View and edit the feature tree. You can:</p>\r\n  <ul>\r\n    <li>\r\n      at the bottom of the page\r\n      <ul>\r\n        <li>Check for problems (e.g. inconsistencies)</li>\r\n        <li>Add new features</li>\r\n        <li>Add Cross-Tree Relationships</li>\r\n      </ul>\r\n    </li>\r\n    <li>\r\n      in the feature tree\r\n      <ul>\r\n        <li>List and remove Cross-Tree Relationships</li>\r\n        <li>\r\n          Update features (e.g. change name/description, Tree relationship (XOR,\r\n          OR), &hellip;)\r\n        </li>\r\n        <li>Remove features</li>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n</div>\r\n\r\n<!-- List of Features -->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Feature tree</h6>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-sm-12\">\r\n      <app-feature-tree\r\n        *ngIf=\"featureModel && featureModel.features\"\r\n        (openDependenciesEmitter)=\"openDependenciesModal($event)\"\r\n        (updateFeatureEmitter)=\"updateFeatureModal($event)\"\r\n        (deleteFeatureEmitter)=\"deleteFeatureModal($event)\"\r\n        [features]=\"featureModel.features\"\r\n        [problemFeatureIds]=\"problemFeatureIds\"\r\n        [supportsHurtsProblemFeatureIds]=\"supportsHurtsProblemFeatureIds\"\r\n      >\r\n      </app-feature-tree>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-4\"><strong>Legend:</strong></div>\r\n    <div class=\"col-4\">\r\n      <i class=\"fa fa-circle\" aria-hidden=\"true\"></i\r\n      ><span class=\"sr-only\">mandatory</span>\r\n      Mandatory Feature\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <i class=\"fa fa-circle-o\" aria-hidden=\"true\"></i\r\n      ><span class=\"sr-only\">optional</span>\r\n      Optional Feature\r\n    </div>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"col-4\">&nbsp;</div>\r\n    <div class=\"col-4\">\r\n      <i class=\"fa fa-angle-up\" aria-hidden=\"true\"></i\r\n      ><span class=\"sr-only\">xor subfeatures</span>\r\n      Alternative (Xor)\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <i class=\"fa fa-caret-up\" aria-hidden=\"true\"></i\r\n      ><span class=\"sr-only\">or subfeatures</span>\r\n      Or\r\n    </div>\r\n  </div>\r\n  <div class=\"row\" *ngIf=\"problems\">\r\n    <div class=\"col-4\">&nbsp;</div>\r\n    <div class=\"col-4\">\r\n      <span class=\"text-warning\">Supports/Hurts error (see below)</span>\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <span class=\"text-danger\">Instantiation errors (see below)</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Check for problems</h6>\r\n  <div class=\"pt-3\">\r\n    <div>\r\n      <button\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        *ngIf=\"!problems\"\r\n        (click)=\"checkInstantiationPossible()\"\r\n      >\r\n        Activate check\r\n      </button>\r\n      <button\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        *ngIf=\"problems\"\r\n        (click)=\"deactivateInstantiationCheck()\"\r\n      >\r\n        Deactivate check\r\n      </button>\r\n    </div>\r\n    <div class=\"mt-4\" *ngIf=\"problems\">\r\n      <!-- TODO: maybe rename -->\r\n      <h6>Instantiation problems:</h6>\r\n      <p *ngIf=\"problems.length === 0\">No problems detected.</p>\r\n      <ul *ngIf=\"problems.length > 0\">\r\n        <li *ngFor=\"let problem of problems\">\r\n          {{ problem }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"mt-4\" *ngIf=\"supportsHurtsProblems\">\r\n      <h6>Supports/Hurts problems:</h6>\r\n      <p *ngIf=\"supportsHurtsProblems.length === 0\">No problems detected.</p>\r\n      <ul *ngIf=\"supportsHurtsProblems.length > 0\">\r\n        <li *ngFor=\"let problem of supportsHurtsProblems\">\r\n          {{ problem }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- Add a Feature-->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Feature</h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <app-feature-form\r\n      submitButtonText=\"Add Feature\"\r\n      [featureList]=\"featureList\"\r\n      (submitFeatureForm)=\"insertFeature($event)\"\r\n    ></app-feature-form>\r\n  </div>\r\n</div>\r\n\r\n<!-- Add a Relationship-->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n    Add Cross-Tree Relationship\r\n  </h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <app-cross-tree-relationship-form\r\n      [featureList]=\"featureList\"\r\n      [relationshipTypes]=\"featureModel.definition.relationshipTypes\"\r\n      (submitRelationshipForm)=\"addRelationship($event)\"\r\n    ></app-cross-tree-relationship-form>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { RelationshipType } from '../../../canvas-meta-model/relationships';\r\nimport { CanvasModelConsistencyService } from '../../../canvas-meta-model/canvas-model-consistency.service';\r\n\r\n@Component({\r\n  selector: 'app-feature-model-edit',\r\n  templateUrl: './feature-model-edit.component.html',\r\n  styleUrls: ['./feature-model-edit.component.css'],\r\n})\r\n/**\r\n * The FeatureModelDetailComponent shows the feature model and allow the adding/updating/deleting of features and dependencies.\r\n *\r\n * @author: Sebastian Gottschalk\r\n */\r\nexport class FeatureModelEditComponent implements OnChanges {\r\n  @Input() featureModel: FeatureModel;\r\n  @Output() updateFeatureModel = new EventEmitter<void>();\r\n\r\n  // Variables for the feature model representation\r\n  featureList: { id: string; levelname: string }[] = [];\r\n  // Variables for the modal representation\r\n  modalFeature: Feature;\r\n  modalReference: NgbModalRef;\r\n  modalSubfeatureIds: string[];\r\n  // References for modal children\r\n  @ViewChild('dependencyModal', { static: true }) dependencyModal: any;\r\n  @ViewChild('updateModal', { static: true }) updateModal: any;\r\n  @ViewChild('deleteModal', { static: true }) deleteModal: any;\r\n\r\n  // Instantiation check\r\n  problems: string[] = null;\r\n  problemFeatureIds: string[] = null;\r\n  possibleInstance: Instance = null;\r\n\r\n  // Supports / Hurts check\r\n  supportsHurtsProblems: string[] = null;\r\n  supportsHurtsProblemFeatureIds: string[] = null;\r\n\r\n  /**\r\n   * Creates a new instance of the FeatureModelDetailComponent.\r\n   *\r\n   * @param canvasModelConsistencyService the consistency service for the canvas model\r\n   * @param fb FormBuilder\r\n   * @param modalService NgbModal\r\n   */\r\n  constructor(\r\n    private canvasModelConsistencyService: CanvasModelConsistencyService,\r\n    private fb: FormBuilder,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.featureModel) {\r\n      if (changes.featureModel.currentValue != null) {\r\n        if (this.modalFeature) {\r\n          this.modalFeature = this.featureModel.getFeature(\r\n            this.modalFeature.id\r\n          );\r\n        }\r\n        this.featureList = this.featureModel.getFeatureList();\r\n        if (this.problems !== null) {\r\n          this.checkInstantiationPossible();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Opens the dependency modal of the current feature.\r\n   *\r\n   * @param featureId id of the current feature\r\n   */\r\n  openDependenciesModal(featureId) {\r\n    this.modalFeature = this.featureModel.getFeature(featureId);\r\n    this.modalReference = this.modalService.open(this.dependencyModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Opens the update modal of the current feature.\r\n   *\r\n   * @param featureId id of the current feature\r\n   */\r\n  updateFeatureModal(featureId) {\r\n    const feature = this.featureModel.getFeature(featureId);\r\n    this.modalFeature = feature;\r\n    this.modalSubfeatureIds = feature.getAllSubfeatures().map((f) => f.id);\r\n    this.modalSubfeatureIds.push(feature.id);\r\n    this.modalReference = this.modalService.open(this.updateModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Opens the modal of the current feature.\r\n   *\r\n   * @param featureId id of the current feature\r\n   */\r\n  deleteFeatureModal(featureId) {\r\n    this.modalFeature = this.featureModel.getFeature(featureId);\r\n    this.modalReference = this.modalService.open(this.deleteModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Closes the current modal.\r\n   */\r\n  closeModal() {\r\n    this.modalReference.close();\r\n    this.modalFeature = null;\r\n  }\r\n\r\n  /**\r\n   * Delete the relationship between two features.\r\n   *\r\n   * @param relationshipType type of the relationship\r\n   * @param fromFeatureId id of the first feature\r\n   * @param toFeatureId id of the second feature\r\n   */\r\n  removeRelationship(\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): void {\r\n    this.featureModel.removeRelationship(\r\n      relationshipType,\r\n      fromFeatureId,\r\n      toFeatureId\r\n    );\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  /**\r\n   * Update the current feature.\r\n   */\r\n  updateFeature(featureForm: FormGroup) {\r\n    this.featureModel.updateFeature(\r\n      this.modalFeature.id,\r\n      featureForm.get('subfeatureOf').value,\r\n      featureForm.value\r\n    );\r\n    this.updateFeatureModel.emit();\r\n    this.closeModal();\r\n  }\r\n\r\n  /**\r\n   * Delete the current feature.\r\n   *\r\n   * @param featureId id of the current feature\r\n   */\r\n  deleteFeature(featureId) {\r\n    this.featureModel.removeFeature(featureId);\r\n    this.updateFeatureModel.emit();\r\n    this.closeModal();\r\n  }\r\n\r\n  /**\r\n   * Insert a new feature.\r\n   */\r\n  insertFeature(featureForm: FormGroup): void {\r\n    this.featureModel.addFeature(\r\n      featureForm.value,\r\n      featureForm.get('subfeatureOf').value\r\n    );\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  /**\r\n   * Add a new relationship.\r\n   */\r\n  addRelationship(relationshipForm: FormGroup): void {\r\n    this.featureModel.addRelationship(\r\n      relationshipForm.value.relationshipType,\r\n      relationshipForm.value.fromFeatureId,\r\n      relationshipForm.value.toFeatureId\r\n    );\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  checkInstantiationPossible() {\r\n    const result = this.canvasModelConsistencyService.instanceIsPossible(\r\n      this.featureModel\r\n    );\r\n    this.problems = result.problems;\r\n    this.problemFeatureIds = result.problemFeatureIds;\r\n    this.possibleInstance = result.possibleInstance;\r\n    const supportsHurtsResult =\r\n      this.canvasModelConsistencyService.checkHurtsSupports(this.featureModel);\r\n    this.supportsHurtsProblems = supportsHurtsResult.problems;\r\n    this.supportsHurtsProblemFeatureIds = supportsHurtsResult.problemFeatureIds;\r\n  }\r\n\r\n  deactivateInstantiationCheck() {\r\n    this.problems = null;\r\n    this.problemFeatureIds = null;\r\n    this.possibleInstance = null;\r\n    this.supportsHurtsProblems = null;\r\n    this.supportsHurtsProblemFeatureIds = null;\r\n  }\r\n}\r\n","<form [formGroup]=\"featureModelForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\">Description</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\" *ngIf=\"featureModel.hasOwnProperty('version')\">\r\n    <label for=\"version\" class=\"col-sm-4 col-form-label\">Version</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"version\"\r\n        class=\"form-control\"\r\n        id=\"version\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"copyright\" class=\"col-sm-4 col-form-label\">Copyright</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"copyright\"\r\n        class=\"form-control\"\r\n        id=\"copyright\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!featureModelForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\ninterface FeatureModelFormValues {\r\n  name: string;\r\n  description: string;\r\n  version?: string;\r\n  copyright: string;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-feature-model-form',\r\n  templateUrl: './feature-model-form.component.html',\r\n  styleUrls: ['./feature-model-form.component.css'],\r\n})\r\nexport class FeatureModelFormComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() featureModel: FeatureModel = null;\r\n\r\n  @Output() submitFeatureModelForm = new EventEmitter<FormGroup>();\r\n\r\n  featureModelForm: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n    description: '',\r\n    version: '',\r\n    copyright: '',\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.featureModelForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed =\r\n              this.featureModel != null &&\r\n              !this.equals(this.featureModel, value))\r\n        )\r\n      )\r\n      .subscribe();\r\n    if (this.featureModel === null) {\r\n      this.loadForm();\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.featureModel) {\r\n      const oldFeatureModel: FeatureModel = changes.featureModel.previousValue;\r\n      const newFeatureModel: FeatureModel = changes.featureModel.currentValue;\r\n      if (!this.equals(oldFeatureModel, newFeatureModel)) {\r\n        this.loadForm(newFeatureModel);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitFeatureModelForm.emit(this.featureModelForm);\r\n    this.loadForm();\r\n  }\r\n\r\n  private equals(\r\n    featureModelA: FeatureModelFormValues,\r\n    featureModelB: FeatureModelFormValues\r\n  ): boolean {\r\n    if (featureModelA == null && featureModelB == null) {\r\n      return true;\r\n    }\r\n    if (featureModelA == null || featureModelB == null) {\r\n      return false;\r\n    }\r\n    if (\r\n      featureModelA.name !== featureModelB.name ||\r\n      featureModelA.description !== featureModelB.description ||\r\n      featureModelA.copyright !== featureModelB.copyright\r\n    ) {\r\n      return false;\r\n    }\r\n    if (\r\n      featureModelA.version === undefined ||\r\n      featureModelB.version === undefined\r\n    ) {\r\n      return true;\r\n    }\r\n    return featureModelA.version === featureModelB.version;\r\n  }\r\n\r\n  private loadForm(featureModel: FeatureModel = undefined): void {\r\n    if (featureModel == null) {\r\n      this.featureModelForm.reset();\r\n    } else {\r\n      this.featureModelForm.patchValue(featureModel);\r\n    }\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { ControlContainer, FormGroup } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-feature-model-subform',\r\n  templateUrl: './feature-model-subform.component.html',\r\n  styleUrls: ['./feature-model-subform.component.css'],\r\n})\r\nexport class FeatureModelSubformComponent {\r\n  constructor(private controlContainer: ControlContainer) {}\r\n\r\n  get formGroup() {\r\n    return this.controlContainer.control as FormGroup;\r\n  }\r\n\r\n  get nameControl() {\r\n    return this.formGroup.get('name');\r\n  }\r\n}\r\n","<ng-container [formGroup]=\"formGroup\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"nameControl.invalid\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\">\r\n      Description\r\n    </label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"copyright\" class=\"col-sm-4 col-form-label\">Copyright</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"copyright\"\r\n        class=\"form-control\"\r\n        id=\"copyright\"\r\n      />\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","<div *ngIf=\"featureModel\">\r\n  <table *ngIf=\"featureModel\" class=\"table table-bordered canvas-table\">\r\n    <tbody>\r\n      <tr *ngFor=\"let row of featureModel.definition.rows\">\r\n        <ng-container *ngFor=\"let cell of row\">\r\n          <td\r\n            class=\"canvas-table-cell\"\r\n            *ngIf=\"!cell.isSpacer\"\r\n            [colSpan]=\"cell.colspan\"\r\n            [rowSpan]=\"cell.rowspan\"\r\n          >\r\n            <div class=\"canvas-table-block\">\r\n              <app-feature-building-block\r\n                [buildingBlockName]=\"cell.name\"\r\n                [features]=\"asList(featureModel.features[cell.id].subfeatures)\"\r\n              ></app-feature-building-block>\r\n            </div>\r\n          </td>\r\n          <td\r\n            *ngIf=\"cell.isSpacer\"\r\n            [colSpan]=\"cell.colspan\"\r\n            [rowSpan]=\"cell.rowspan\"\r\n          ></td>\r\n        </ng-container>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n<div class=\"container\">\r\n  <div class=\"row\">\r\n    <div class=\"col-4\"><strong>Legend:</strong></div>\r\n    <div class=\"col-4\"><i class=\"fa fa-circle\"></i> Mandatory Feature</div>\r\n    <div class=\"col-4\"><i class=\"fa fa-circle-o\"></i> Optional Feature</div>\r\n  </div>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-feature-model',\r\n  templateUrl: './feature-model.component.html',\r\n  styleUrls: ['./feature-model.component.css'],\r\n})\r\nexport class FeatureModelComponent {\r\n  @Input() featureModel: FeatureModel;\r\n\r\n  asList(features: { [id: string]: Feature }): Feature[] {\r\n    return Object.values(features);\r\n  }\r\n}\r\n","<ul *ngIf=\"features\" class=\"list-group inner\" style=\"margin: 5px\">\r\n  <li\r\n    *ngFor=\"let f of getFeatures()\"\r\n    class=\"\r\n      d-flex\r\n      flex-wrap\r\n      list-group-item\r\n      justify-content-between\r\n      align-items-center\r\n    \"\r\n  >\r\n    <div class=\"d-flex\">\r\n      <div class=\"mr-1\">\r\n        <ng-container *ngIf=\"f.type === 'mandatory'\">\r\n          <i class=\"fa fa-circle\" aria-hidden=\"true\" title=\"mandatory\"></i>\r\n          <span class=\"sr-only\">mandatory</span>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"f.type === 'optional'\">\r\n          <i class=\"fa fa-circle-o\" aria-hidden=\"true\" title=\"optional\"></i>\r\n          <span class=\"sr-only\">optional</span>\r\n        </ng-container>\r\n      </div>\r\n\r\n      <div class=\"mr-1\">\r\n        <span\r\n          [class.text-danger]=\"\r\n            problemFeatureIds && problemFeatureIds.includes(f.id)\r\n          \"\r\n          [class.text-warning]=\"\r\n            supportsHurtsProblemFeatureIds &&\r\n            supportsHurtsProblemFeatureIds.includes(f.id)\r\n          \"\r\n          >{{ f.name\r\n          }}<span\r\n            *ngIf=\"problemFeatureIds && problemFeatureIds.includes(f.id)\"\r\n            class=\"sr-only\"\r\n          >\r\n            (instantiation error)</span\r\n          ><span\r\n            *ngIf=\"\r\n              supportsHurtsProblemFeatureIds &&\r\n              supportsHurtsProblemFeatureIds.includes(f.id)\r\n            \"\r\n            class=\"sr-only\"\r\n          >\r\n            (supports/hurts error)</span\r\n          ></span\r\n        >\r\n        <small class=\"text-muted\" *ngIf=\"f.description\">\r\n          {{ f.description }}</small\r\n        >\r\n      </div>\r\n\r\n      <div *ngIf=\"f.subfeatureConnections !== null\" class=\"mr-1\">\r\n        <ng-container *ngIf=\"f.subfeatureConnections === 'or'\">\r\n          <i\r\n            class=\"fa fa-caret-up\"\r\n            aria-hidden=\"true\"\r\n            title=\"or subfeatures\"\r\n          ></i>\r\n          <span class=\"sr-only\">or subfeatures</span>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"f.subfeatureConnections === 'xor'\">\r\n          <i\r\n            class=\"fa fa-angle-up\"\r\n            aria-hidden=\"true\"\r\n            title=\"xor subfeatures\"\r\n          ></i>\r\n          <span class=\"sr-only\">xor subfeatures</span>\r\n        </ng-container>\r\n      </div>\r\n\r\n      <div *ngIf=\"f.parent !== null && hasExpertTraces(f)\">\r\n        <span class=\"badge badge-dark\">from canvas building block</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div>\r\n      <button\r\n        type=\"button\"\r\n        *ngIf=\"!f.relationships.hasNoRelationships()\"\r\n        class=\"btn btn-dark btn-xs mr-1\"\r\n        (click)=\"openDependencies(f.id)\"\r\n      >\r\n        Show Dependencies\r\n      </button>\r\n      <button\r\n        (click)=\"updateFeature(f.id)\"\r\n        type=\"button\"\r\n        class=\"btn btn-warning btn-xs mr-1\"\r\n      >\r\n        Update\r\n      </button>\r\n      <button\r\n        [class.invisible]=\"f.parent === null\"\r\n        (click)=\"deleteFeature(f.id)\"\r\n        type=\"button\"\r\n        class=\"btn btn-danger btn-xs\"\r\n      >\r\n        Delete\r\n      </button>\r\n    </div>\r\n\r\n    <app-feature-tree\r\n      class=\"w-100\"\r\n      [features]=\"f.subfeatures\"\r\n      [problemFeatureIds]=\"problemFeatureIds\"\r\n      [supportsHurtsProblemFeatureIds]=\"supportsHurtsProblemFeatureIds\"\r\n      (openDependenciesEmitter)=\"openDependenciesForwardEmitter($event)\"\r\n      (updateFeatureEmitter)=\"updateFeatureForwardEmitter($event)\"\r\n      (deleteFeatureEmitter)=\"deleteFeatureForwardEmitter($event)\"\r\n    ></app-feature-tree>\r\n  </li>\r\n</ul>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-feature-tree',\r\n  templateUrl: './feature-tree.component.html',\r\n  styleUrls: ['./feature-tree.component.css'],\r\n})\r\n/**\r\n * Internal class to display single features of the feature tree.\r\n *\r\n * @author Sebastian Gottschalk\r\n */\r\nexport class FeatureTreeComponent {\r\n  @Input() features: { [id: string]: Feature };\r\n  @Input() problemFeatureIds: string[]; // problem feature ids of instantiation check\r\n  @Input() supportsHurtsProblemFeatureIds: string[];\r\n  @Output() openDependenciesEmitter = new EventEmitter<string>();\r\n  @Output() updateFeatureEmitter = new EventEmitter<string>();\r\n  @Output() deleteFeatureEmitter = new EventEmitter<string>();\r\n\r\n  /**\r\n   * Emit Event to open dependencies of current feature.\r\n   * @param featureId current feature\r\n   */\r\n  openDependencies(featureId: string) {\r\n    this.openDependenciesEmitter.emit(featureId);\r\n  }\r\n\r\n  /**\r\n   * Forward event emitter to open dependencies of current feature.\r\n   * @param featureId current feature\r\n   */\r\n  openDependenciesForwardEmitter(featureId: string) {\r\n    this.openDependencies(featureId);\r\n  }\r\n\r\n  /**\r\n   * Emit Event to update current feature.\r\n   * @param featureId current feature\r\n   */\r\n  updateFeature(featureId: string) {\r\n    this.updateFeatureEmitter.emit(featureId);\r\n  }\r\n\r\n  /**\r\n   * Forward event emitter to update current feature.\r\n   * @param featureId current feature\r\n   */\r\n  updateFeatureForwardEmitter(featureId: string) {\r\n    this.updateFeature(featureId);\r\n  }\r\n\r\n  /**\r\n   * Emit Event to delete current feature.\r\n   * @param featureId current feature\r\n   */\r\n  deleteFeature(featureId: string) {\r\n    this.deleteFeatureEmitter.emit(featureId);\r\n  }\r\n\r\n  /**\r\n   * Forward event emitter to delete current feature.\r\n   * @param featureId current feature\r\n   */\r\n  deleteFeatureForwardEmitter(featureId: string) {\r\n    this.deleteFeature(featureId);\r\n  }\r\n\r\n  getFeatures() {\r\n    return Object.values(this.features);\r\n  }\r\n\r\n  hasExpertTraces(feature: Feature) {\r\n    return Object.keys(feature.expertModelTrace).length > 0;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport Ajv from 'ajv';\r\nimport { ExpertModelService } from '../../canvas-meta-model/expert-model.service';\r\nimport { saveAs } from 'file-saver';\r\nimport { ExpertModel } from '../../canvas-meta-model/expert-model';\r\nimport schema from '../../../assets/schema_beta.json';\r\nimport { CanvasModelConsistencyService } from '../../canvas-meta-model/canvas-model-consistency.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ImportExportService {\r\n  private ajv = new Ajv();\r\n\r\n  constructor(\r\n    private expertModelService: ExpertModelService,\r\n    private canvasModelConsistencyService: CanvasModelConsistencyService\r\n  ) {}\r\n\r\n  /**\r\n   * Export a model to json\r\n   *\r\n   * @param expertModelId the id of the expert model\r\n   */\r\n  async exportExpertModel(expertModelId: string): Promise<void> {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    const json = new Blob([JSON.stringify(expertModel, null, 2)], {\r\n      type: 'application/json',\r\n    });\r\n    saveAs(json, expertModel.name + '.json');\r\n  }\r\n\r\n  /**\r\n   * Imports an expert model into pouchdb after checking the format and consistency\r\n   *\r\n   * @param file the file which includes the model as json\r\n   * @return promise of the new expert model\r\n   */\r\n  async importExpertModel(file): Promise<ExpertModel> {\r\n    const json = await this.importJson(file);\r\n    const expertModel = new ExpertModel(\r\n      undefined,\r\n      new ExpertModel(json, undefined)\r\n    );\r\n    this.canvasModelConsistencyService.checkFormalConsistency(expertModel);\r\n    await this.expertModelService.save(expertModel);\r\n    return this.expertModelService.get(expertModel._id);\r\n  }\r\n\r\n  /**\r\n   * Imports JSON from a file and checks against the schema for models.\r\n   *\r\n   * @param file the file to read the JSON from\r\n   */\r\n  private importJson(file): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      const validate = this.ajv.compile(schema);\r\n      const fileReader = new FileReader();\r\n      fileReader.addEventListener('error', () => {\r\n        reject('Error loading file');\r\n      });\r\n      fileReader.addEventListener('load', (event: any) => {\r\n        let json = null;\r\n        try {\r\n          json = JSON.parse(event.target.result);\r\n        } catch (error) {\r\n          reject(error);\r\n          return;\r\n        }\r\n        const valid = validate(json);\r\n        if (!valid) {\r\n          reject(validate.errors);\r\n        } else {\r\n          resolve(json);\r\n        }\r\n      });\r\n      fileReader.readAsText(file);\r\n    });\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport Ajv from 'ajv';\r\nimport { ImportExportService } from '../import-export.service';\r\n\r\n@Component({\r\n  selector: 'app-model-import-view',\r\n  templateUrl: './model-import-view.component.html',\r\n  styleUrls: ['./model-import-view.component.css'],\r\n})\r\nexport class ModelImportViewComponent {\r\n  @Input() importExpertModel: boolean;\r\n  @Input() formTitle: string;\r\n\r\n  @Output() imported = new EventEmitter<null>();\r\n\r\n  file = null;\r\n  form = this.fb.group({ file: null });\r\n  importError: string = null;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private importExportService: ImportExportService\r\n  ) {}\r\n\r\n  fileChange(event) {\r\n    this.importError = null;\r\n    this.file = event.target.files[0];\r\n  }\r\n\r\n  async submitForm() {\r\n    try {\r\n      await this.importExportService.importExpertModel(this.file);\r\n      this.form.reset();\r\n      this.file = null;\r\n      this.imported.emit();\r\n    } catch (e) {\r\n      console.log(e);\r\n      if (typeof e === 'string') {\r\n        this.importError = e;\r\n      } else if (e instanceof Error) {\r\n        this.importError = e.message;\r\n      } else if (Array.isArray(e)) {\r\n        const ajvError = e as Ajv.ErrorObject[];\r\n        this.importError = ajvError[0].message;\r\n      } else {\r\n        this.importError =\r\n          \"Unknown Error. See browser's console for more info.\";\r\n      }\r\n    }\r\n  }\r\n}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">{{ formTitle }}</h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n      <div class=\"form-group form-row\">\r\n        <label for=\"file\" class=\"col-sm-4 col-form-label\">File</label>\r\n        <div class=\"col-sm-8\">\r\n          <input\r\n            type=\"file\"\r\n            class=\"form-control\"\r\n            [class.is-invalid]=\"importError\"\r\n            id=\"file\"\r\n            aria-describedby=\"fileErrorDescription\"\r\n            formControlName=\"file\"\r\n            (change)=\"fileChange($event)\"\r\n          />\r\n          <div id=\"fileErrorDescription\" class=\"invalid-feedback\">\r\n            {{ importError }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group form-row\">\r\n        <div class=\"col-sm-12\">\r\n          <button\r\n            [disabled]=\"!file\"\r\n            type=\"submit\"\r\n            class=\"btn btn-sm btn-dark btn-block\"\r\n          >\r\n            {{ formTitle }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Info</h6>\r\n  <table class=\"table table-sm mb-0\" style=\"table-layout: fixed\">\r\n    <tbody>\r\n      <tr class=\"table-borderless\">\r\n        <th scope=\"row\" style=\"width: 250px\">Name</th>\r\n        <td>{{ featureModel.name }}</td>\r\n      </tr>\r\n      <tr>\r\n        <th scope=\"row\">Description</th>\r\n        <td>{{ featureModel.description }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.hasOwnProperty('version')\">\r\n        <th scope=\"row\">Version</th>\r\n        <td>{{ $any(featureModel).version }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.copyright\">\r\n        <th scope=\"row\">Copyright</th>\r\n        <td>{{ featureModel.copyright }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<div\r\n  *ngIf=\"featureModel.author && featureModel.author.name\"\r\n  class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n>\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Author Info</h6>\r\n  <table class=\"table table-sm mb-0\" style=\"table-layout: fixed\">\r\n    <tbody>\r\n      <tr class=\"table-borderless\">\r\n        <th scope=\"row\" style=\"width: 250px\">Name</th>\r\n        <td>{{ featureModel.author.name }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.author.company\">\r\n        <th scope=\"row\">Company</th>\r\n        <td>{{ featureModel.author.company }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.author.email\">\r\n        <th scope=\"row\">Email</th>\r\n        <td>{{ featureModel.author.email }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.author.website\">\r\n        <th scope=\"row\">Website</th>\r\n        <td>{{ featureModel.author.website }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\n\r\n@Component({\r\n  selector: 'app-model-info-box',\r\n  templateUrl: './model-info-box.component.html',\r\n  styleUrls: ['./model-info-box.component.css'],\r\n})\r\nexport class ModelInfoBoxComponent {\r\n  @Input() featureModel: FeatureModel;\r\n\r\n  constructor() {}\r\n}\r\n","<!-- model list -->\r\n<app-list-wrapper\r\n  [listTitle]=\"modelListTitle\"\r\n  [reloading]=\"reloading\"\r\n  [loading]=\"loading\"\r\n  [noResults]=\"noResults\"\r\n>\r\n  <div noResults>No entries.</div>\r\n  <ul results class=\"list-unstyled mb-0\">\r\n    <li\r\n      *ngFor=\"let model of modelList\"\r\n      class=\"model-list-item media text-muted pt-2 pb-2 border-bottom\"\r\n    >\r\n      <svg\r\n        class=\"align-self-center mr-2 rounded\"\r\n        width=\"32\"\r\n        height=\"32\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        preserveAspectRatio=\"xMidYMid slice\"\r\n        focusable=\"false\"\r\n        role=\"img\"\r\n        aria-label=\"Placeholder: 32x32\"\r\n      >\r\n        <title>Placeholder</title>\r\n        <rect width=\"100%\" height=\"100%\" fill=\"#6f42c1\" />\r\n      </svg>\r\n\r\n      <div class=\"media-body small\">\r\n        <div class=\"d-flex justify-content-between align-items-center\">\r\n          <div>\r\n            <div>\r\n              <strong\r\n                (click)=\"viewModel.emit(model._id)\"\r\n                class=\"text-gray-dark\"\r\n                >{{ model.name }}</strong\r\n              >\r\n              <span\r\n                class=\"text-muted\"\r\n                *ngIf=\"model.hasOwnProperty('version') && model['version']\"\r\n              >\r\n                ({{ model['version'] }})</span\r\n              >\r\n            </div>\r\n            <div>\r\n              <span>{{ model.description }}</span>\r\n            </div>\r\n            <div *ngIf=\"model.author && model.author.name\">\r\n              Author: {{ model.author.name }}\r\n              <ng-container *ngIf=\"model.author.email\">\r\n                ({{ model.author.email }})\r\n              </ng-container>\r\n              <ng-container *ngIf=\"model.author.company\">\r\n                from {{ model.author.company }}</ng-container\r\n              >\r\n            </div>\r\n            <div *ngIf=\"model.author.website\">\r\n              Website: {{ model.author.website }}\r\n            </div>\r\n            <div *ngIf=\"model.copyright\">Copyright: {{ model.copyright }}</div>\r\n          </div>\r\n          <div>\r\n            <button\r\n              (click)=\"viewModel.emit(model._id)\"\r\n              type=\"button\"\r\n              class=\"btn btn-dark btn-xs model-list-item-view mr-1 my-1\"\r\n            >\r\n              View\r\n            </button>\r\n            <button\r\n              (click)=\"editModel.emit(model._id)\"\r\n              type=\"button\"\r\n              class=\"btn btn-warning btn-xs model-list-item-edit mr-1 my-1\"\r\n            >\r\n              Edit\r\n            </button>\r\n            <button\r\n              (click)=\"deleteModel.emit(model._id)\"\r\n              type=\"button\"\r\n              class=\"btn btn-danger btn-xs model-list-item-delete my-1\"\r\n            >\r\n              Delete\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n</app-list-wrapper>\r\n\r\n<!-- Add model -->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">{{ modelFormTitle }}</h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <form [formGroup]=\"modelForm\" (ngSubmit)=\"addModelForwardEmitter()\">\r\n      <div class=\"form-group form-row\">\r\n        <label for=\"definitionSelector\" class=\"col-sm-4 col-form-label\"\r\n          >Canvas Model</label\r\n        >\r\n        <div class=\"col-sm-8\">\r\n          <select\r\n            id=\"definitionSelector\"\r\n            formControlName=\"definition\"\r\n            class=\"form-control\"\r\n            [class.is-invalid]=\"\r\n              definitionControl.invalid && definitionControl.touched\r\n            \"\r\n          >\r\n            <option\r\n              *ngFor=\"let definition of canvasDefinitions\"\r\n              [ngValue]=\"definition\"\r\n            >\r\n              {{ definition.name }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group form-row\">\r\n        <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n        <div class=\"col-sm-8\">\r\n          <input\r\n            type=\"text\"\r\n            formControlName=\"name\"\r\n            class=\"form-control\"\r\n            id=\"name\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group form-row\">\r\n        <label for=\"description\" class=\"col-sm-4 col-form-label\"\r\n          >Description</label\r\n        >\r\n        <div class=\"col-sm-8\">\r\n          <input\r\n            type=\"text\"\r\n            formControlName=\"description\"\r\n            class=\"form-control\"\r\n            id=\"description\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group form-row\">\r\n        <div class=\"col-sm-12\">\r\n          <button\r\n            type=\"submit\"\r\n            class=\"btn btn-sm btn-dark btn-block\"\r\n            [disabled]=\"!modelForm.valid\"\r\n          >\r\n            {{ modelFormTitle }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { FormBuilder, FormControl, Validators } from '@angular/forms';\r\nimport {\r\n  FeatureModel,\r\n  FeatureModelEntry,\r\n  FeatureModelInit,\r\n} from '../../../canvas-meta-model/feature-model';\r\nimport {\r\n  CanvasDefinition,\r\n  CanvasDefinitionEntry,\r\n} from '../../../canvas-meta-model/canvas-definition';\r\nimport { CanvasDefinitionService } from '../../../canvas-meta-model/canvas-definition.service';\r\nimport { ListService } from '../../../shared/list.service';\r\nimport { ModelList } from './model-list';\r\n\r\n@Component({\r\n  selector: 'app-model-list',\r\n  templateUrl: './model-list.component.html',\r\n  styleUrls: ['./model-list.component.css'],\r\n})\r\nexport class ModelListComponent implements OnInit, ModelList {\r\n  @Input() modelListTitle: string;\r\n  @Input() modelFormTitle: string;\r\n\r\n  @Output() viewModel = new EventEmitter<string>();\r\n  @Output() editModel = new EventEmitter<string>();\r\n  @Output() deleteModel = new EventEmitter<string>();\r\n  @Output() addModel = new EventEmitter<{\r\n    definition: CanvasDefinition;\r\n    name: string;\r\n    description: string;\r\n  }>();\r\n\r\n  canvasDefinitions: CanvasDefinitionEntry[] = [];\r\n\r\n  modelForm = this.fb.group({\r\n    definition: [null, Validators.required],\r\n    name: ['', Validators.required],\r\n    description: [],\r\n  });\r\n\r\n  constructor(\r\n    private canvasDefinitionService: CanvasDefinitionService,\r\n    private fb: FormBuilder,\r\n    private listService: ListService<FeatureModel, FeatureModelInit>\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadCanvasDefinitions();\r\n  }\r\n\r\n  resetAddForm(): void {\r\n    this.modelForm.reset();\r\n  }\r\n\r\n  addModelForwardEmitter(): void {\r\n    this.addModel.emit({\r\n      definition: new CanvasDefinition(\r\n        this.modelForm.value.definition,\r\n        undefined\r\n      ),\r\n      name: this.modelForm.value.name,\r\n      description: this.modelForm.value.description,\r\n    });\r\n  }\r\n\r\n  async loadCanvasDefinitions(): Promise<void> {\r\n    this.canvasDefinitions = await this.canvasDefinitionService.getList();\r\n  }\r\n\r\n  get definitionControl(): FormControl {\r\n    return this.modelForm.get('definition') as FormControl;\r\n  }\r\n\r\n  get modelList(): FeatureModelEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { CanvasDefinitionCell } from '../../canvas-meta-model/canvas-definition-cell';\r\n\r\nexport interface CanvasDefinitionCellFormValue {\r\n  isSpacer: boolean;\r\n  name?: string;\r\n  id?: string;\r\n  rowspan: number;\r\n  colspan: number;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CanvasDefinitionRowFormService {\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  createForm(canvasDefinitionRows: CanvasDefinitionCell[][] = null): FormArray {\r\n    let forms = [];\r\n    if (canvasDefinitionRows != null) {\r\n      forms = canvasDefinitionRows.map((row) =>\r\n        this.fb.array(\r\n          row.map((cell) => this.createCanvasDefinitionCellForm(cell))\r\n        )\r\n      );\r\n    }\r\n    return this.fb.array(forms);\r\n  }\r\n\r\n  createCanvasDefinitionCellForm(\r\n    canvasDefinitionCell: CanvasDefinitionCell = null\r\n  ): FormGroup {\r\n    const form = this.fb.group({\r\n      isSpacer: [false, Validators.required],\r\n      name: ['', Validators.required],\r\n      id: [''],\r\n      rowspan: [1, [Validators.required, Validators.min(1)]],\r\n      colspan: [1, [Validators.required, Validators.min(1)]],\r\n    });\r\n    if (canvasDefinitionCell != null) {\r\n      if (canvasDefinitionCell.isSpacer) {\r\n        form.removeControl('name');\r\n        form.removeControl('id');\r\n      }\r\n      form.patchValue(canvasDefinitionCell);\r\n    }\r\n    return form;\r\n  }\r\n\r\n  convertCanvasDefinitionCellForm(\r\n    canvasDefinitionCellForm: FormGroup,\r\n    spacer: boolean\r\n  ): void {\r\n    if (spacer) {\r\n      canvasDefinitionCellForm.removeControl('name');\r\n      canvasDefinitionCellForm.removeControl('id');\r\n    } else {\r\n      canvasDefinitionCellForm.setControl(\r\n        'name',\r\n        this.fb.control('', Validators.required)\r\n      );\r\n      canvasDefinitionCellForm.setControl('id', this.fb.control(''));\r\n    }\r\n  }\r\n\r\n  getCanvasDefinitionCellForm(\r\n    formValue: CanvasDefinitionCellFormValue\r\n  ): CanvasDefinitionCell {\r\n    if (formValue.isSpacer) {\r\n      return new CanvasDefinitionCell(undefined, {\r\n        isSpacer: formValue.isSpacer,\r\n        rowspan: formValue.rowspan,\r\n        colspan: formValue.colspan,\r\n      });\r\n    } else {\r\n      return new CanvasDefinitionCell(undefined, {\r\n        isSpacer: formValue.isSpacer,\r\n        name: formValue.name,\r\n        rowspan: formValue.rowspan,\r\n        colspan: formValue.colspan,\r\n        id: formValue.id,\r\n      });\r\n    }\r\n  }\r\n\r\n  get(formValue: CanvasDefinitionCellFormValue[][]): CanvasDefinitionCell[][] {\r\n    return formValue.map((row) =>\r\n      row.map((cell) => this.getCanvasDefinitionCellForm(cell))\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { FeatureModel } from '../../canvas-meta-model/feature-model';\r\n\r\nexport interface FeatureModelFormValue {\r\n  name: string;\r\n  description: string;\r\n  copyright: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class FeatureModelFormService {\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  createForm(featureModel: FeatureModel = null): FormGroup {\r\n    const form = this.fb.group({\r\n      name: ['', Validators.required],\r\n      description: '',\r\n      copyright: '',\r\n    });\r\n    if (featureModel) {\r\n      form.patchValue(featureModel);\r\n    }\r\n    return form;\r\n  }\r\n\r\n  get(formValue: FeatureModelFormValue): FeatureModelFormValue {\r\n    return {\r\n      name: formValue.name,\r\n      description: formValue.description,\r\n      copyright: formValue.copyright,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  Instance,\r\n  InstanceInit,\r\n  InstanceType,\r\n} from '../../canvas-meta-model/instance';\r\n\r\nexport interface InstanceFormValue {\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class FeatureModelInstanceFormService {\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  createForm(instance: Instance = null): FormGroup {\r\n    const form = this.fb.group({\r\n      name: ['', Validators.required],\r\n      description: [''],\r\n    });\r\n    if (instance) {\r\n      form.patchValue(instance);\r\n    }\r\n    return form;\r\n  }\r\n\r\n  get(formValue: InstanceFormValue): InstanceInit {\r\n    return {\r\n      name: formValue.name,\r\n      description: formValue.description,\r\n      type: InstanceType.EXAMPLE,\r\n    };\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\" id=\"modal-basic-title\">{{ feature.name }}</h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"closeModal.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n    <li class=\"list-group-item justify-content-between align-items-center\">\r\n      <i class=\"fas fa-plus-square\"></i>\r\n      Add existing business model decisions:\r\n      <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n        <li\r\n          class=\"list-group-item justify-content-between align-items-center\"\r\n          *ngFor=\"let f of unselectedFeatures\"\r\n        >\r\n          <span>\r\n            {{ f.name }}\r\n            <small class=\"text-muted\" *ngIf=\"f.description\">{{\r\n              f.description\r\n            }}</small>\r\n          </span>\r\n          <button\r\n            (click)=\"addBusinessModelDecision.emit(f.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-warning btn-xs bottom-right\"\r\n          >\r\n            Add\r\n          </button>\r\n        </li>\r\n        <li\r\n          class=\"list-group-item justify-content-between align-items-center\"\r\n          *ngIf=\"unselectedFeatures.length === 0\"\r\n        >\r\n          There are no existing business model decisions left to add.\r\n        </li>\r\n      </ul>\r\n    </li>\r\n    <li class=\"list-group-item justify-content-between align-items-center\">\r\n      <i class=\"fas fa-plus-square\"></i>\r\n      Add new business model decision:\r\n      <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n        <li class=\"list-group-item justify-content-between align-items-center\">\r\n          <form\r\n            [formGroup]=\"addFeatureForm\"\r\n            (ngSubmit)=\"submitAddFeatureForm()\"\r\n            class=\"form-inline\"\r\n          >\r\n            <label class=\"sr-only\" for=\"name\">Decision Name</label>\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control mb-2 mr-sm-2\"\r\n              id=\"name\"\r\n            />\r\n            <button type=\"submit\" class=\"btn btn-warning btn-xs bottom-right\">\r\n              Add\r\n            </button>\r\n          </form>\r\n        </li>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n</div>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { Feature, FeatureInit } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-add-decision-modal',\r\n  templateUrl: './add-decision-modal.component.html',\r\n  styleUrls: ['./add-decision-modal.component.css'],\r\n})\r\nexport class AddDecisionModalComponent {\r\n  @Input() instance: Instance;\r\n  @Input() feature: Feature;\r\n\r\n  @Output() closeModal = new EventEmitter<void>();\r\n  @Output() addBusinessModelDecision = new EventEmitter<string>();\r\n  @Output() addFeature = new EventEmitter<FeatureInit>();\r\n\r\n  addFeatureForm = this.fb.group({ name: ['', Validators.required] });\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  submitAddFeatureForm(): void {\r\n    this.addFeature.emit(this.addFeatureForm.value);\r\n    this.addFeatureForm.reset();\r\n  }\r\n\r\n  get unselectedFeatures(): Feature[] {\r\n    return Object.values(this.feature.subfeatures).filter(\r\n      (feature) => !this.instance.usedFeatures.includes(feature.id)\r\n    );\r\n  }\r\n}\r\n","<ul\r\n  [class.no-list]=\"levelDepth === 1\"\r\n  class=\"list-group\"\r\n  style=\"margin-top: 5px; margin-left: 5px\"\r\n>\r\n  <li>\r\n    <ng-container *ngIf=\"instance.usedFeatures.includes(feature.id)\">\r\n      <strong\r\n        *ngIf=\"levelDepth === 1\"\r\n        [class.text-success]=\"\r\n          (compareInstance &&\r\n            !compareInstance.usedFeatures.includes(feature.id)) ||\r\n          (showStrengths && conformance.strengthFeatureIds.includes(feature.id))\r\n        \"\r\n        [class.text-danger]=\"conformance.errorFeatureIds.includes(feature.id)\"\r\n        [class.text-warning]=\"\r\n          conformance.warningFeatureIds.includes(feature.id) && showWarnings\r\n        \"\r\n      >\r\n        {{ feature.name }}\r\n      </strong>\r\n      <span\r\n        *ngIf=\"levelDepth !== 1\"\r\n        [class.text-success]=\"\r\n          (compareInstance &&\r\n            !compareInstance.usedFeatures.includes(feature.id)) ||\r\n          (showStrengths &&\r\n            conformance.strengthFeatureIds.includes(feature.id)) ||\r\n          (patternInstance && patternInstance.usedFeatures.includes(feature.id))\r\n        \"\r\n        [class.text-danger]=\"conformance.errorFeatureIds.includes(feature.id)\"\r\n        [class.text-warning]=\"\r\n          conformance.warningFeatureIds.includes(feature.id) && showWarnings\r\n        \"\r\n        >{{ feature.name }}</span\r\n      >\r\n      <i\r\n        class=\"fas fa-plus-square ml-2\"\r\n        *ngIf=\"editable\"\r\n        (click)=\"addFeature(feature.id)\"\r\n      ></i>\r\n      <i\r\n        class=\"fas fa-minus-square ml-2\"\r\n        *ngIf=\"feature.parent !== null && editable\"\r\n        (click)=\"deleteFeature(feature.id)\"\r\n      ></i>\r\n      <small\r\n        *ngIf=\"\r\n          percentages &&\r\n          asList(feature.subfeatures).length > 0 &&\r\n          compareInstance &&\r\n          compareInstance.usedFeatures.includes(feature.id) &&\r\n          instance.usedFeatures.includes(feature.id)\r\n        \"\r\n        class=\"text-muted ml-1\"\r\n        >{{ percentages[feature.id] | number: '.2-2' }}&nbsp;%</small\r\n      >\r\n    </ng-container>\r\n    <em\r\n      *ngIf=\"!instance.usedFeatures.includes(feature.id)\"\r\n      [class.text-danger]=\"\r\n        conformance.errorFeatureIds.includes(feature.id) ||\r\n        (compareInstance &&\r\n          compareInstance.usedFeatures.includes(feature.id)) ||\r\n        (patternInstance && patternInstance.usedFeatures.includes(feature.id))\r\n      \"\r\n      [class.text-success]=\"\r\n        conformance.hintFeatureIds.includes(feature.id) && showHints\r\n      \"\r\n      [class.text-muted]=\"\r\n        conformance.patternHintFeatureIds.includes(feature.id) &&\r\n        showPatternHints\r\n      \"\r\n      >{{ feature.name }}</em\r\n    >\r\n    <span *ngFor=\"let f of asList(feature.subfeatures)\">\r\n      <app-canvas-building-block\r\n        [feature]=\"f\"\r\n        [instance]=\"instance\"\r\n        *ngIf=\"\r\n          instance.usedFeatures.includes(f.id) ||\r\n          conformance.errorFeatureIds.includes(f.id) ||\r\n          (conformance.warningFeatureIds.includes(f.id) && showWarnings) ||\r\n          (conformance.strengthFeatureIds.includes(f.id) && showStrengths) ||\r\n          (conformance.hintFeatureIds.includes(f.id) && showHints) ||\r\n          (conformance.patternHintFeatureIds.includes(f.id) &&\r\n            showPatternHints) ||\r\n          (compareInstance && compareInstance.usedFeatures.includes(f.id)) ||\r\n          (patternInstance && patternInstance.usedFeatures.includes(f.id))\r\n        \"\r\n        [levelDepth]=\"levelDepth + 1\"\r\n        [conformance]=\"conformance\"\r\n        [showWarnings]=\"showWarnings\"\r\n        [showStrengths]=\"showStrengths\"\r\n        [showHints]=\"showHints\"\r\n        [showPatternHints]=\"showPatternHints\"\r\n        [compareInstance]=\"compareInstance\"\r\n        [percentages]=\"percentages\"\r\n        [patternInstance]=\"patternInstance\"\r\n        [editable]=\"editable\"\r\n        (addFeatureEmitter)=\"addFeatureForwardEmitter($event)\"\r\n        (deleteFeatureEmitter)=\"deleteFeatureForwardEmitter($event)\"\r\n      ></app-canvas-building-block>\r\n    </span>\r\n  </li>\r\n</ul>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\n\r\n@Component({\r\n  selector: 'app-canvas-building-block',\r\n  templateUrl: './canvas-building-block.component.html',\r\n  styleUrls: ['./canvas-building-block.component.css'],\r\n})\r\n/**\r\n * Internal class to display single business model decisions of the business model canvas.\r\n *\r\n * @author Sebastian Gottschalk\r\n */\r\nexport class CanvasBuildingBlockComponent {\r\n  @Input() feature: Feature;\r\n  @Input() levelDepth = 1;\r\n  @Input() instance: Instance;\r\n  @Input() conformance: ConformanceReport;\r\n  @Input() showWarnings: boolean;\r\n  @Input() showStrengths: boolean;\r\n  @Input() showHints: boolean;\r\n  @Input() showPatternHints: boolean;\r\n  @Input() compareInstance: Instance = null;\r\n  @Input() percentages: { [id: string]: number } = null;\r\n  @Input() patternInstance: Instance = null;\r\n  @Input() editable: boolean;\r\n\r\n  @Output() addFeatureEmitter = new EventEmitter<string>();\r\n  @Output() deleteFeatureEmitter = new EventEmitter<string>();\r\n\r\n  /**\r\n   * Create a new instance of the CanvasBuildingBlockComponent.\r\n   */\r\n  constructor() {}\r\n\r\n  /**\r\n   * Emit Event to add feature.\r\n   * @param featureId current feature\r\n   */\r\n  addFeature(featureId: string) {\r\n    this.addFeatureEmitter.emit(featureId);\r\n  }\r\n\r\n  /**\r\n   * Emit Event to delete feature.\r\n   * @param featureId current feature\r\n   */\r\n  deleteFeature(featureId: string) {\r\n    this.deleteFeatureEmitter.emit(featureId);\r\n  }\r\n\r\n  /**\r\n   * Forward event emitter to add feature.\r\n   * @param featureId current feature\r\n   */\r\n  addFeatureForwardEmitter(featureId: string) {\r\n    this.addFeature(featureId);\r\n  }\r\n\r\n  /**\r\n   * Forward event emitter to delete feature.\r\n   * @param featureId featureId\r\n   */\r\n  deleteFeatureForwardEmitter(featureId: string) {\r\n    this.deleteFeature(featureId);\r\n  }\r\n\r\n  asList(map: { [id: string]: Feature }): Feature[] {\r\n    return Object.values(map);\r\n  }\r\n}\r\n","<table *ngIf=\"featureModel\" class=\"table table-bordered canvas-table\">\r\n  <tbody>\r\n    <tr *ngFor=\"let row of featureModel.definition.rows\">\r\n      <ng-container *ngFor=\"let cell of row\">\r\n        <td\r\n          class=\"canvas-table-cell\"\r\n          *ngIf=\"!cell.isSpacer\"\r\n          [colSpan]=\"cell.colspan\"\r\n          [rowSpan]=\"cell.rowspan\"\r\n          [ngStyle]=\"getHeatmapStyle(cell.id)\"\r\n        >\r\n          <div class=\"canvas-table-block\">\r\n            <app-canvas-building-block\r\n              [feature]=\"featureModel.features[cell.id]\"\r\n              [instance]=\"instance\"\r\n              [conformance]=\"conformance\"\r\n              [showWarnings]=\"conformanceOptions.showWarnings\"\r\n              [showStrengths]=\"conformanceOptions.showStrengths\"\r\n              [showHints]=\"conformanceOptions.showHints\"\r\n              [showPatternHints]=\"conformanceOptions.showPatternHints\"\r\n              [compareInstance]=\"compareInstance\"\r\n              [percentages]=\"percentages\"\r\n              [patternInstance]=\"patternInstance\"\r\n              [editable]=\"editable\"\r\n              (addFeatureEmitter)=\"addFeatureModal.emit($event)\"\r\n              (deleteFeatureEmitter)=\"deleteFeatureModal.emit($event)\"\r\n            ></app-canvas-building-block>\r\n          </div>\r\n        </td>\r\n        <td\r\n          *ngIf=\"cell.isSpacer\"\r\n          [colSpan]=\"cell.colspan\"\r\n          [rowSpan]=\"cell.rowspan\"\r\n        ></td>\r\n      </ng-container>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\n\r\n@Component({\r\n  selector: 'app-canvas',\r\n  templateUrl: './canvas.component.html',\r\n  styleUrls: ['./canvas.component.css'],\r\n})\r\nexport class CanvasComponent {\r\n  @Input() featureModel: FeatureModel;\r\n  @Input() instance: Instance;\r\n\r\n  @Input() conformance: ConformanceReport = new ConformanceReport();\r\n  @Input() conformanceOptions: {\r\n    showWarnings: boolean;\r\n    showStrengths: boolean;\r\n    showHints: boolean;\r\n    showPatternHints: boolean;\r\n  } = {\r\n    showHints: false,\r\n    showPatternHints: false,\r\n    showStrengths: false,\r\n    showWarnings: false,\r\n  };\r\n\r\n  @Input() compareInstance: Instance = null;\r\n  @Input() percentages: { [id: string]: number } = null;\r\n\r\n  @Input() patternInstance: Instance = null;\r\n\r\n  @Input() editable = true;\r\n\r\n  @Output() addFeatureModal = new EventEmitter<string>();\r\n  @Output() deleteFeatureModal = new EventEmitter<string>();\r\n\r\n  getHeatmapStyle(featureId: string) {\r\n    return this.percentages\r\n      ? {\r\n          'background-color':\r\n            'hsla(' +\r\n            (this.percentages[featureId] / 100) * 120 +\r\n            ', 100%, 66%, 0.3)',\r\n        }\r\n      : {};\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-delete-decision-modal',\r\n  templateUrl: './delete-decision-modal.component.html',\r\n  styleUrls: ['./delete-decision-modal.component.css'],\r\n})\r\nexport class DeleteDecisionModalComponent {\r\n  @Input() feature: Feature;\r\n\r\n  @Output() closeModal = new EventEmitter<void>();\r\n  @Output() deleteBusinessModelDecision = new EventEmitter<string>();\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\" id=\"modal-basic-title\">{{ feature.name }}</h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"closeModal.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <div class=\"alert alert-warning\" role=\"alert\">\r\n    <p>\r\n      You are trying to remove the decision \"{{ feature.name }}\". Please keep in\r\n      mind that you are removing also all subdecisions.\r\n    </p>\r\n  </div>\r\n</div>\r\n<div class=\"modal-footer\">\r\n  <button\r\n    type=\"button\"\r\n    class=\"btn btn-block btn-warning\"\r\n    (click)=\"deleteBusinessModelDecision.emit(feature.id)\"\r\n  >\r\n    Delete Decision\r\n  </button>\r\n</div>\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'expertModels']\">\r\n      Canvas Building Blocks\r\n    </a>\r\n    <a\r\n      *ngIf=\"expertModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'expertModels', expertModel._id]\"\r\n    >\r\n      {{ expertModel.name }}\r\n    </a>\r\n    <a *ngIf=\"expertModel\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ example.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"expertModel\" role=\"main\" class=\"container\">\r\n  <app-instance\r\n    [featureModel]=\"expertModel\"\r\n    [instance]=\"example\"\r\n    [conformance]=\"conformance\"\r\n    [conformanceIsChecked]=\"conformanceIsChecked\"\r\n    [conformanceOptions]=\"conformanceOptionsForm.value\"\r\n    [compareInstance]=\"compareInstance\"\r\n    [percentages]=\"percentages\"\r\n    [patternInstance]=\"patternInstance\"\r\n    [editable]=\"activeId !== 'stepView'\"\r\n    (updateFeatureModel)=\"updateExpertModel()\"\r\n    (createAdaptation)=\"createAdaptation()\"\r\n  ></app-instance>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Steps</h6>\r\n    <ul\r\n      ngbNav\r\n      #nav=\"ngbNav\"\r\n      [(activeId)]=\"activeId\"\r\n      (navChange)=\"switchView($event)\"\r\n      class=\"nav-pills nav-justified\"\r\n    >\r\n      <li ngbNavItem=\"stepCreate\" #stepCreate=\"ngbNavItem\">\r\n        <a ngbNavLink>1. Creation & Conformance</a>\r\n        <ng-template ngbNavContent>\r\n          Create the example and check the conformance with the conformance\r\n          checker\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem=\"stepHints\" #stepHints=\"ngbNavItem\">\r\n        <a ngbNavLink>2. Hints</a>\r\n        <ng-template ngbNavContent> Adapt the example with hints</ng-template>\r\n      </li>\r\n      <li ngbNavItem=\"stepCompare\" #stepCompare=\"ngbNavItem\">\r\n        <a ngbNavLink>3. Compare & Adaption</a>\r\n        <ng-template ngbNavContent>\r\n          Compare the example with other examples and adapt it as needed\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem=\"stepView\">\r\n        <a ngbNavLink>4. View</a>\r\n        <ng-template ngbNavContent> Just view the example</ng-template>\r\n      </li>\r\n    </ul>\r\n    <div class=\"mt-1\" [ngbNavOutlet]=\"nav\"></div>\r\n  </div>\r\n\r\n  <div\r\n    class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    *ngIf=\"stepCreate.active || stepHints.active\"\r\n  >\r\n    <h6 *ngIf=\"stepCreate.active\" class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Conformance Check\r\n    </h6>\r\n    <h6 *ngIf=\"stepHints.active\" class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Hints\r\n    </h6>\r\n    <div class=\"container\">\r\n      <div class=\"row\" style=\"margin-top: 20px\">\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"!conformanceIsChecked\"\r\n          (click)=\"checkConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          <span *ngIf=\"stepCreate.active\"\r\n            >Activate Conformance Checking of Business Model</span\r\n          >\r\n          <span *ngIf=\"stepHints.active\">Show Hints of Business Model</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"conformanceIsChecked\"\r\n          (click)=\"uncheckConformance()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          <span *ngIf=\"stepCreate.active\"\r\n            >Deactivate Conformance Checking of Business Model</span\r\n          >\r\n          <span *ngIf=\"stepHints.active\">Hide Hints of Business Model</span>\r\n        </button>\r\n      </div>\r\n      <div *ngIf=\"conformanceIsChecked\" style=\"margin-top: 20px\">\r\n        <form [formGroup]=\"conformanceOptionsForm\" *ngIf=\"stepHints.active\">\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showWarnings\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"optionShowWarnings\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"optionShowWarnings\">\r\n              Show weaknesses\r\n              <small class=\"text-muted d-block\"\r\n                >Used features that have a hurt cross-tree relationship to other\r\n                used features</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showStrengths\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showStrengths\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showStrengths\">\r\n              Show strengths\r\n              <small class=\"text-muted d-block\"\r\n                >Used features that have a supports cross-tree relationship to\r\n                other used features</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showHints\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showHints\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showHints\">\r\n              Show hints\r\n              <small class=\"text-muted d-block\"\r\n                >Unused features that have a supports cross-tree relationship to\r\n                other used features and can be added without requirements and do\r\n                not lead to other errors</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showPatternHints\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showPatternHints\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showPatternHints\">\r\n              Show pattern hints\r\n              <small class=\"text-muted d-block\"\r\n                >A pattern is shown as a hint, if at least half of the pattern\r\n                is included in the current business model</small\r\n              >\r\n            </label>\r\n          </div>\r\n          <div class=\"custom-control custom-switch mb-2\">\r\n            <input\r\n              formControlName=\"showUsedPatterns\"\r\n              type=\"checkbox\"\r\n              class=\"custom-control-input\"\r\n              id=\"showUsedPatterns\"\r\n            />\r\n            <label class=\"custom-control-label\" for=\"showUsedPatterns\">\r\n              Show used patterns\r\n              <small class=\"text-muted d-block\"\r\n                >A pattern is shown as used, if it is completely included in the\r\n                current business model</small\r\n              >\r\n            </label>\r\n          </div>\r\n        </form>\r\n        <div class=\"row\">\r\n          <div class=\"col\">\r\n            <h6>Errors</h6>\r\n            <ul>\r\n              <li *ngFor=\"let error of conformance.errors\">{{ error }}</li>\r\n            </ul>\r\n          </div>\r\n          <div\r\n            class=\"col border-left\"\r\n            *ngIf=\"\r\n              conformanceOptionsForm.value.showWarnings ||\r\n              conformanceOptionsForm.value.showStrengths\r\n            \"\r\n          >\r\n            <div *ngIf=\"conformanceOptionsForm.value.showWarnings\">\r\n              <h6>Weaknesses</h6>\r\n              <ul>\r\n                <li *ngFor=\"let warning of conformance.warnings\">\r\n                  {{ warning }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showStrengths\">\r\n              <h6>Strengths</h6>\r\n              <ul>\r\n                <li *ngFor=\"let strength of conformance.strengths\">\r\n                  {{ strength }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"col border-left\"\r\n            *ngIf=\"\r\n              conformanceOptionsForm.value.showHints ||\r\n              conformanceOptionsForm.value.showPatternHints ||\r\n              conformanceOptionsForm.value.showUsedPatterns\r\n            \"\r\n          >\r\n            <div *ngIf=\"conformanceOptionsForm.value.showHints\">\r\n              <h6>Hints</h6>\r\n              <ul>\r\n                <li *ngFor=\"let hint of conformance.hints\">{{ hint }}</li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showPatternHints\">\r\n              <h6>Pattern Hints</h6>\r\n              <ul>\r\n                <li *ngFor=\"let hint of conformance.patternHints\">\r\n                  <app-pattern-hint [patternHint]=\"hint\"></app-pattern-hint>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div *ngIf=\"conformanceOptionsForm.value.showUsedPatterns\">\r\n              <h6>Used Patterns</h6>\r\n              <ul>\r\n                <li *ngFor=\"let pattern of conformance.usedPatterns\">\r\n                  <app-pattern-view [pattern]=\"pattern\"></app-pattern-view>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepCompare.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Patterns</h6>\r\n    <div class=\"container\">\r\n      <div class=\"row\" style=\"margin-top: 20px\">\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"!usedPatterns\"\r\n          (click)=\"showUsedPatterns()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          Show used Patterns of Business Model\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"usedPatterns\"\r\n          (click)=\"hideUsedPatterns()\"\r\n          class=\"btn btn-dark btn-sm btn-block\"\r\n        >\r\n          Hide used Patterns of Business Model\r\n        </button>\r\n      </div>\r\n      <div *ngIf=\"usedPatterns\" style=\"margin-top: 20px\">\r\n        <h6>Used Patterns</h6>\r\n        <ul>\r\n          <li *ngFor=\"let pattern of usedPatterns\">\r\n            <app-pattern-view [pattern]=\"pattern\"></app-pattern-view>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepCompare.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Compare</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"selectOtherInstanceForm\" (ngSubmit)=\"compare()\">\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"instance\" class=\"col-sm-4 col-form-label\"\r\n            >Business Model</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select\r\n              id=\"instance\"\r\n              formControlName=\"instance\"\r\n              class=\"form-control\"\r\n            >\r\n              <ng-container *ngFor=\"let instance of expertModel.getExamples()\">\r\n                <option\r\n                  *ngIf=\"instance.id !== example.id\"\r\n                  [ngValue]=\"instance.id\"\r\n                >\r\n                  {{ instance.name }}\r\n                </option>\r\n              </ng-container>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group form-row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              *ngIf=\"compareInstance === null\"\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!selectOtherInstanceForm.valid\"\r\n            >\r\n              Compare\r\n            </button>\r\n            <button\r\n              *ngIf=\"compareInstance !== null\"\r\n              type=\"button\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              (click)=\"clearCompare()\"\r\n            >\r\n              Clear Compare\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"stepCompare.active\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Show pattern</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"selectPatternForm\" (ngSubmit)=\"showPattern()\">\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"pattern\" class=\"col-sm-4 col-form-label\">Pattern</label>\r\n          <div class=\"col-sm-8\">\r\n            <select id=\"pattern\" formControlName=\"pattern\" class=\"form-control\">\r\n              <ng-container *ngFor=\"let instance of expertModel.getPatterns()\">\r\n                <option [ngValue]=\"instance\">\r\n                  {{ instance.name }}\r\n                </option>\r\n              </ng-container>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div\r\n          *ngIf=\"\r\n            (selectPatternForm.valid || patternInstance != null) &&\r\n            selectedPattern != null &&\r\n            selectedPattern.description\r\n          \"\r\n          class=\"form-group form-row\"\r\n        >\r\n          <label class=\"col-sm-4 col-form-label\">Description</label>\r\n          <div class=\"col-sm-8\">\r\n            {{ selectedPattern.description }}\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group form-row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              *ngIf=\"patternInstance === null\"\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!selectPatternForm.valid\"\r\n            >\r\n              Show\r\n            </button>\r\n            <button\r\n              *ngIf=\"patternInstance !== null\"\r\n              type=\"button\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              (click)=\"clearPattern()\"\r\n            >\r\n              Clear\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { InstanceService } from '../instance.service';\r\nimport { NgbNavChangeEvent } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\nimport { CanvasModelConsistencyService } from '../../../canvas-meta-model/canvas-model-consistency.service';\r\n\r\n@Component({\r\n  selector: 'app-example',\r\n  templateUrl: './example.component.html',\r\n  styleUrls: ['./example.component.css'],\r\n})\r\nexport class ExampleComponent implements OnInit {\r\n  expertModel: ExpertModel;\r\n  example: Instance;\r\n\r\n  // Conformance Checking\r\n  conformanceIsChecked: boolean;\r\n  conformance: ConformanceReport;\r\n  conformanceOptionsForm: FormGroup = this.fb.group({\r\n    showWarnings: true,\r\n    showStrengths: true,\r\n    showHints: false,\r\n    showPatternHints: false,\r\n    showUsedPatterns: false,\r\n  });\r\n\r\n  // used patterns\r\n  usedPatterns: Instance[] = null;\r\n\r\n  // Compare / Heatmap\r\n  selectOtherInstanceForm: FormGroup = this.fb.group({\r\n    instance: [null, Validators.required],\r\n  });\r\n  compareInstance: Instance = null;\r\n  percentages: { [id: string]: number } = null;\r\n\r\n  // Show pattern\r\n  selectPatternForm: FormGroup = this.fb.group({\r\n    pattern: [null, Validators.required],\r\n  });\r\n  patternInstance: Instance = null;\r\n\r\n  activeId: string;\r\n\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private canvasModelConsistencyService: CanvasModelConsistencyService,\r\n    private fb: FormBuilder,\r\n    private expertModelService: ExpertModelService,\r\n    private instanceService: InstanceService,\r\n    private route: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      const expertModelId = paramMap.get('id');\r\n      const exampleId = +paramMap.get('exampleId');\r\n\r\n      this.activeId = 'stepCreate';\r\n\r\n      this.clearView();\r\n      this.initConformanceOptionsForm(this.activeId);\r\n\r\n      void this.load(expertModelId, exampleId);\r\n    });\r\n  }\r\n\r\n  async load(expertModelId, exampleId): Promise<void> {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    this.expertModel = expertModel;\r\n    this.example = expertModel.getInstance(exampleId);\r\n    if (this.compareInstance) {\r\n      this.compare();\r\n    }\r\n    if (this.patternInstance) {\r\n      this.showPattern();\r\n    }\r\n    if (this.usedPatterns) {\r\n      this.showUsedPatterns();\r\n    }\r\n    if (this.conformanceIsChecked) {\r\n      this.checkConformance();\r\n    } else {\r\n      this.uncheckConformance();\r\n    }\r\n  }\r\n\r\n  async updateExpertModel(): Promise<void> {\r\n    await this.expertModelService.save(this.expertModel);\r\n    await this.load(this.expertModel._id, this.example.id);\r\n  }\r\n\r\n  /**\r\n   * Create adaptation of the business model.\r\n   */\r\n  async createAdaptation(): Promise<void> {\r\n    const adaptationName = this.instanceService.getAdaptionName(\r\n      this.example.name\r\n    );\r\n    this.expertModel.adaptInstance(this.example.id, adaptationName);\r\n    const instance =\r\n      this.expertModel.instances[this.expertModel.instances.length - 1];\r\n    await this.expertModelService.save(this.expertModel);\r\n    await this.router.navigate([\r\n      'expertModels',\r\n      this.expertModel._id,\r\n      'examples',\r\n      instance.id,\r\n    ]);\r\n  }\r\n\r\n  switchView(event: NgbNavChangeEvent): void {\r\n    this.clearView();\r\n    this.initConformanceOptionsForm(event.nextId);\r\n  }\r\n\r\n  private clearView(): void {\r\n    this.uncheckConformance();\r\n    this.clearCompare();\r\n    this.clearPattern();\r\n    this.hideUsedPatterns();\r\n  }\r\n\r\n  /**\r\n   * Uncheck the conformance.\r\n   */\r\n  uncheckConformance(): void {\r\n    this.conformanceIsChecked = false;\r\n    this.conformance = new ConformanceReport();\r\n  }\r\n\r\n  /**\r\n   * Check the conformance.\r\n   */\r\n  checkConformance(): void {\r\n    this.clearCompare();\r\n    this.clearPattern();\r\n    this.conformance =\r\n      this.canvasModelConsistencyService.checkConformanceOfInstance(\r\n        this.expertModel,\r\n        this.example.id,\r\n        this.expertModel.getPatterns()\r\n      );\r\n    this.conformanceIsChecked = true;\r\n  }\r\n\r\n  /**\r\n   * Compare this instance with another instance and generate a heatmap\r\n   */\r\n  compare(): void {\r\n    this.uncheckConformance();\r\n    this.clearPattern();\r\n    const id = this.selectOtherInstanceForm.value.instance;\r\n    this.compareInstance = this.expertModel.getInstance(id);\r\n    this.percentages = this.instanceService.compareInstances(\r\n      this.expertModel,\r\n      this.example,\r\n      this.compareInstance\r\n    );\r\n    this.selectOtherInstanceForm.get('instance').disable();\r\n  }\r\n\r\n  /**\r\n   * Clear comparison and remove heatmap\r\n   */\r\n  clearCompare(): void {\r\n    this.compareInstance = null;\r\n    this.percentages = null;\r\n    this.selectOtherInstanceForm.get('instance').enable();\r\n  }\r\n\r\n  /**\r\n   * Show pattern in business model canvas\r\n   */\r\n  showPattern(): void {\r\n    this.uncheckConformance();\r\n    this.clearCompare();\r\n    this.patternInstance = this.selectPatternForm.value.pattern;\r\n    this.selectPatternForm.get('pattern').disable();\r\n  }\r\n\r\n  /**\r\n   * Do not show pattern in business model canvas any longer\r\n   */\r\n  clearPattern(): void {\r\n    this.patternInstance = null;\r\n    this.selectPatternForm.get('pattern').enable();\r\n  }\r\n\r\n  showUsedPatterns(): void {\r\n    this.usedPatterns = this.canvasModelConsistencyService.getPatternHints(\r\n      this.expertModel,\r\n      this.example,\r\n      this.expertModel.getPatterns()\r\n    ).usedPatterns;\r\n  }\r\n\r\n  hideUsedPatterns(): void {\r\n    this.usedPatterns = null;\r\n  }\r\n\r\n  get selectedPattern(): Instance | undefined {\r\n    return this.selectPatternForm.value.pattern;\r\n  }\r\n\r\n  private initConformanceOptionsForm(activeId: string): void {\r\n    if (activeId === 'stepHints') {\r\n      this.conformanceOptionsForm.setValue({\r\n        showWarnings: true,\r\n        showStrengths: true,\r\n        showHints: true,\r\n        showPatternHints: true,\r\n        showUsedPatterns: false,\r\n      });\r\n    } else {\r\n      this.conformanceOptionsForm.setValue({\r\n        showWarnings: false,\r\n        showStrengths: false,\r\n        showHints: false,\r\n        showPatternHints: false,\r\n        showUsedPatterns: false,\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { ControlContainer, FormControl, FormGroup } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-feature-model-instance-subform',\r\n  templateUrl: './feature-model-instance-subform.component.html',\r\n  styleUrls: ['./feature-model-instance-subform.component.css'],\r\n})\r\nexport class FeatureModelInstanceSubformComponent {\r\n  constructor(private controlContainer: ControlContainer) {}\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.controlContainer.control as FormGroup;\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.formGroup.get('name') as FormControl;\r\n  }\r\n}\r\n","<ng-container [formGroup]=\"formGroup\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Artifact Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"nameControl.invalid\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\">\r\n      Artifact Description\r\n    </label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n      />\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","<form [formGroup]=\"selectOtherInstanceForm\" (ngSubmit)=\"submit()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"featureModel\" class=\"col-sm-4 col-form-label\"\r\n      >Compare with</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"featureModel\"\r\n        formControlName=\"featureModel\"\r\n        class=\"form-control\"\r\n      >\r\n        <option [ngValue]=\"companyModel._id\">Competitors</option>\r\n        <option\r\n          *ngFor=\"let expertModel of expertModels\"\r\n          [ngValue]=\"expertModel._id\"\r\n        >\r\n          Examples of {{ expertModel.name }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"form-group row\"\r\n    *ngIf=\"featureModelControl.value === companyModel._id\"\r\n  >\r\n    <label for=\"instance\" class=\"col-sm-4 col-form-label\">Competitor</label>\r\n    <div class=\"col-sm-8\">\r\n      <select id=\"instance\" formControlName=\"instance\" class=\"form-control\">\r\n        <ng-container *ngFor=\"let instance of competitors\">\r\n          <option [ngValue]=\"instance.id\">\r\n            {{ instance.name }}\r\n          </option>\r\n        </ng-container>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"form-group row\"\r\n    *ngIf=\"\r\n      featureModelControl.value != null &&\r\n      featureModelControl.value !== companyModel._id\r\n    \"\r\n  >\r\n    <label for=\"instanceExpertModel\" class=\"col-sm-4 col-form-label\"\r\n      >Example</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"instanceExpertModel\"\r\n        formControlName=\"instance\"\r\n        class=\"form-control\"\r\n      >\r\n        <option\r\n          *ngFor=\"let example of currentExpertModel.getExamples()\"\r\n          [ngValue]=\"example.id\"\r\n        >\r\n          {{ example.name }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        *ngIf=\"!currentlyComparing\"\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!selectOtherInstanceForm.valid\"\r\n      >\r\n        Compare\r\n      </button>\r\n      <button\r\n        *ngIf=\"currentlyComparing\"\r\n        type=\"button\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        (click)=\"clearCompare.emit()\"\r\n      >\r\n        Clear Compare\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { Subscription } from 'rxjs';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\n\r\n@Component({\r\n  selector: 'app-instance-compare-form',\r\n  templateUrl: './instance-compare-form.component.html',\r\n  styleUrls: ['./instance-compare-form.component.css'],\r\n})\r\nexport class InstanceCompareFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() currentlyComparing = false;\r\n  @Input() companyModel: CompanyModel;\r\n  @Input() competitors: Instance[];\r\n\r\n  @Output() compare = new EventEmitter<{\r\n    instance: Instance;\r\n    featureModelId: string;\r\n  }>();\r\n  @Output() clearCompare = new EventEmitter<void>();\r\n\r\n  expertModels: ExpertModel[];\r\n  currentExpertModel: ExpertModel;\r\n\r\n  selectOtherInstanceForm: FormGroup = this.fb.group({\r\n    featureModel: [null, Validators.required],\r\n    instance: [null, Validators.required],\r\n  });\r\n\r\n  private formSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private expertModelService: ExpertModelService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.formSubscription = this.featureModelControl.valueChanges.subscribe(\r\n      (value) => {\r\n        this.currentExpertModel = this.expertModels.find(\r\n          (expertModel) => expertModel._id === value\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.companyModel) {\r\n      void this.loadExpertModels();\r\n    }\r\n    if (changes.currentlyComparing) {\r\n      if (changes.currentlyComparing.currentValue) {\r\n        this.selectOtherInstanceForm.disable();\r\n      } else {\r\n        this.selectOtherInstanceForm.enable();\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.formSubscription) {\r\n      this.formSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submit() {\r\n    const featureModel: FeatureModel = this.currentExpertModel\r\n      ? this.currentExpertModel\r\n      : this.companyModel;\r\n    this.compare.emit({\r\n      instance: featureModel.getInstance(this.instanceControl.value),\r\n      featureModelId: featureModel._id,\r\n    });\r\n  }\r\n\r\n  async loadExpertModels() {\r\n    const expertModels: ExpertModel[] = [];\r\n    for (const expertModelId of this.companyModel.expertModelIds) {\r\n      const expertModel = await this.expertModelService.get(expertModelId);\r\n      const featureIds = expertModel\r\n        .getFeatureList()\r\n        .map((feature) => feature.id);\r\n      if (\r\n        featureIds.every(\r\n          (id) =>\r\n            id in\r\n            this.companyModel.expertModelTraces[expertModel._id]\r\n              .expertFeatureIdMap\r\n        ) &&\r\n        expertModel.getExamples().length > 0\r\n      ) {\r\n        expertModels.push(expertModel);\r\n      }\r\n    }\r\n    this.expertModels = expertModels;\r\n  }\r\n\r\n  get featureModelControl(): FormControl {\r\n    return this.selectOtherInstanceForm.get('featureModel') as FormControl;\r\n  }\r\n\r\n  get instanceControl(): FormControl {\r\n    return this.selectOtherInstanceForm.get('instance') as FormControl;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\n\r\n@Component({\r\n  selector: 'app-instance-form',\r\n  templateUrl: './instance-form.component.html',\r\n  styleUrls: ['./instance-form.component.css'],\r\n})\r\nexport class InstanceFormComponent implements OnChanges {\r\n  @Input() instance: Instance;\r\n\r\n  @Output() submitInstanceForm = new EventEmitter<FormGroup>();\r\n\r\n  instanceForm: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.instance) {\r\n      this.loadForm(changes.instance.currentValue);\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitInstanceForm.emit(this.instanceForm);\r\n    this.loadForm(this.instance);\r\n  }\r\n\r\n  private loadForm(instance: Instance) {\r\n    this.instanceForm = this.fb.group({\r\n      name: [instance.name, Validators.required],\r\n      description: [instance.description ? instance.description : ''],\r\n    });\r\n  }\r\n}\r\n","<form [formGroup]=\"instanceForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Instance Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"description\" class=\"col-sm-4 col-form-label\"\r\n      >Instance Description</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"description\"\r\n        class=\"form-control\"\r\n        id=\"description\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!instanceForm.valid\"\r\n      >\r\n        Update Instance\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Info</h6>\r\n  <table class=\"table table-sm mb-0\" style=\"table-layout: fixed\">\r\n    <tbody>\r\n      <tr class=\"table-borderless\">\r\n        <th scope=\"row\" style=\"width: 250px\">Name</th>\r\n        <td>{{ instance.name }}</td>\r\n      </tr>\r\n      <tr>\r\n        <th scope=\"row\">Description</th>\r\n        <td>{{ instance.description }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"featureModel.type === expertModelTypeName()\">\r\n        <th scope=\"row\">Type</th>\r\n        <td>{{ instance.type }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\n\r\n@Component({\r\n  selector: 'app-instance-info-box',\r\n  templateUrl: './instance-info-box.component.html',\r\n  styleUrls: ['./instance-info-box.component.css'],\r\n})\r\nexport class InstanceInfoBoxComponent {\r\n  @Input() featureModel: FeatureModel;\r\n  @Input() instance: Instance;\r\n\r\n  expertModelTypeName(): string {\r\n    return ExpertModel.typeName;\r\n  }\r\n}\r\n","<!-- View instances -->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">{{ listTitle }}</h6>\r\n\r\n  <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n    <li *ngFor=\"let instance of instances\" class=\"list-group-item\">\r\n      <app-results-list-item\r\n        [viewLink]=\"viewInstanceLink(instance)\"\r\n        (delete)=\"deleteInstance.emit(instance.id)\"\r\n      >\r\n        <ng-container itemTitle>\r\n          {{ instance.name }}\r\n        </ng-container>\r\n        <ng-container itemDescription>\r\n          {{ instance.description }}\r\n        </ng-container>\r\n      </app-results-list-item>\r\n    </li>\r\n  </ul>\r\n</div>\r\n\r\n<!-- Add instance -->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">{{ formTitle }}</h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <form [formGroup]=\"instanceForm\" (ngSubmit)=\"addInstanceForwardEmitter()\">\r\n      <div class=\"form-group row\">\r\n        <label for=\"name\" class=\"col-sm-4 col-form-label\">Instance Name</label>\r\n        <div class=\"col-sm-8\">\r\n          <input\r\n            type=\"text\"\r\n            formControlName=\"name\"\r\n            class=\"form-control\"\r\n            id=\"name\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group row\">\r\n        <div class=\"col-sm-12\">\r\n          <button\r\n            type=\"submit\"\r\n            class=\"btn btn-sm btn-dark btn-block\"\r\n            [disabled]=\"!instanceForm.valid\"\r\n          >\r\n            {{ formTitle }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\n\r\n@Component({\r\n  selector: 'app-instance-list',\r\n  templateUrl: './instance-list.component.html',\r\n  styleUrls: ['./instance-list.component.css'],\r\n})\r\nexport class InstanceListComponent implements OnInit {\r\n  @Input() formTitle: string;\r\n  @Input() listTitle: string;\r\n  @Input() instances: Instance[];\r\n\r\n  @Input() viewInstanceLink: (instance: Instance) => string[];\r\n\r\n  @Output() addInstance = new EventEmitter<FormGroup>();\r\n  @Output() deleteInstance = new EventEmitter<number>();\r\n\r\n  instanceForm: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit() {\r\n    this.loadForm();\r\n  }\r\n\r\n  addInstanceForwardEmitter() {\r\n    this.addInstance.emit(this.instanceForm);\r\n    this.loadForm();\r\n  }\r\n\r\n  private loadForm() {\r\n    this.instanceForm = this.fb.group({ name: ['', Validators.required] });\r\n  }\r\n}\r\n","<form [formGroup]=\"selectPatternForm\" (ngSubmit)=\"submit()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"featureModel\" class=\"col-sm-4 col-form-label\"\r\n      >Patterns of</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"featureModel\"\r\n        formControlName=\"featureModel\"\r\n        class=\"form-control\"\r\n      >\r\n        <option\r\n          *ngFor=\"let expertModel of expertModels\"\r\n          [ngValue]=\"expertModel\"\r\n        >\r\n          {{ expertModel.name }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"instance\" class=\"col-sm-4 col-form-label\">Pattern</label>\r\n    <div class=\"col-sm-8\">\r\n      <select id=\"instance\" formControlName=\"instance\" class=\"form-control\">\r\n        <option\r\n          *ngFor=\"let instance of expertModel ? expertModel.getPatterns() : []\"\r\n          [ngValue]=\"instance\"\r\n        >\r\n          {{ instance.name }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n  <div\r\n    *ngIf=\"\r\n      (selectPatternForm.valid || showsPattern) &&\r\n      instance != null &&\r\n      instance.description\r\n    \"\r\n    class=\"form-group form-row\"\r\n  >\r\n    <label class=\"col-sm-4 col-form-label\">Description</label>\r\n    <div class=\"col-sm-8\">\r\n      {{ instance.description }}\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        *ngIf=\"!showsPattern\"\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!selectPatternForm.valid\"\r\n      >\r\n        Show\r\n      </button>\r\n      <button\r\n        *ngIf=\"showsPattern\"\r\n        type=\"button\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        (click)=\"clearPattern.emit()\"\r\n      >\r\n        Clear\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\n\r\n@Component({\r\n  selector: 'app-instance-select-pattern-form',\r\n  templateUrl: './instance-select-pattern-form.component.html',\r\n  styleUrls: ['./instance-select-pattern-form.component.css'],\r\n})\r\nexport class InstanceSelectPatternFormComponent implements OnChanges {\r\n  @Input() expertModels: ExpertModel[] = [];\r\n  @Input() showsPattern = false;\r\n\r\n  @Output() showPattern = new EventEmitter<{\r\n    instance: Instance;\r\n    featureModelId: string;\r\n  }>();\r\n  @Output() clearPattern = new EventEmitter<void>();\r\n\r\n  selectPatternForm: FormGroup = this.fb.group({\r\n    featureModel: [null, Validators.required],\r\n    instance: [null, Validators.required],\r\n  });\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.showsPattern) {\r\n      if (changes.showsPattern.currentValue) {\r\n        this.selectPatternForm.disable();\r\n      } else {\r\n        this.selectPatternForm.enable();\r\n      }\r\n    }\r\n  }\r\n\r\n  submit() {\r\n    this.showPattern.emit({\r\n      instance: this.instance,\r\n      featureModelId: this.expertModel._id,\r\n    });\r\n  }\r\n\r\n  get expertModel(): ExpertModel | undefined {\r\n    return this.featureModelControl.value;\r\n  }\r\n\r\n  get instance(): Instance | undefined {\r\n    return this.instanceControl.value;\r\n  }\r\n\r\n  get featureModelControl(): FormControl {\r\n    return this.selectPatternForm.get('featureModel') as FormControl;\r\n  }\r\n\r\n  get instanceControl(): FormControl {\r\n    return this.selectPatternForm.get('instance') as FormControl;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FeatureModel } from '../../canvas-meta-model/feature-model';\r\nimport { Instance } from '../../canvas-meta-model/instance';\r\nimport { Feature } from '../../canvas-meta-model/feature';\r\nimport { CompanyModel } from '../../canvas-meta-model/company-model';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class InstanceService {\r\n  /**\r\n   * Generates a name for an adaption of an instance from the current name\r\n   *\r\n   * @param currentName the current name\r\n   * @return the adapted name\r\n   */\r\n  getAdaptionName(currentName: string): string {\r\n    const nameSplit = currentName.split(' - Adaptation#');\r\n    let adaptationName;\r\n    if (\r\n      nameSplit.length > 1 &&\r\n      !isNaN(parseInt(nameSplit[nameSplit.length - 1], 10))\r\n    ) {\r\n      adaptationName =\r\n        nameSplit[0] +\r\n        ' - Adaptation#' +\r\n        (parseInt(nameSplit[nameSplit.length - 1], 10) + 1);\r\n    } else {\r\n      adaptationName = nameSplit[0] + ' - Adaptation#1';\r\n    }\r\n    return adaptationName;\r\n  }\r\n\r\n  /**\r\n   * Compare two instances and get a feature map with comparison percentages per feature\r\n   *\r\n   * @param featureModel the feature model of the instances\r\n   * @param instanceA the id of the first instance\r\n   * @param instanceB the id of the second instance\r\n   * @return a mapping with feature id to percentage\r\n   */\r\n  compareInstances(\r\n    featureModel: FeatureModel,\r\n    instanceA: Instance,\r\n    instanceB: Instance\r\n  ): { [id: string]: number } {\r\n    const features: Feature[] = [];\r\n    featureModel.iterateFeatures((feature) => {\r\n      features.unshift(feature);\r\n      return false;\r\n    });\r\n    const map: { [id: string]: number } = {};\r\n    const outMap: { [id: string]: number } = {};\r\n    for (const feature of features) {\r\n      const inA = instanceA.usedFeatures.includes(feature.id);\r\n      const inB = instanceB.usedFeatures.includes(feature.id);\r\n      if (inA === inB) {\r\n        if (inA) {\r\n          const subfeatures = Object.keys(feature.subfeatures).filter(\r\n            (id) => id in map\r\n          );\r\n          if (subfeatures.length > 0) {\r\n            const count = subfeatures\r\n              .map((id) => outMap[id])\r\n              .reduce((agg, f) => agg + f, 0);\r\n            map[feature.id] = count / subfeatures.length;\r\n            outMap[feature.id] = (count + 100) / (subfeatures.length + 1);\r\n          } else {\r\n            map[feature.id] = 100;\r\n            outMap[feature.id] = 100;\r\n          }\r\n        }\r\n      } else {\r\n        map[feature.id] = 0;\r\n        outMap[feature.id] = 0;\r\n      }\r\n    }\r\n    return map;\r\n  }\r\n\r\n  /**\r\n   * Convert an expert instance to a company model instance. Requires that all features of the expert model are merged.\r\n   *\r\n   * @param companyModel the company model\r\n   * @param expertModelId the id of the expert model\r\n   * @param expertInstance the instance of the expert model\r\n   * @return the converted instance\r\n   */\r\n  convertExpertInstance(\r\n    companyModel: CompanyModel,\r\n    expertModelId: string,\r\n    expertInstance: Instance\r\n  ): Instance {\r\n    const instance = new Instance(undefined, expertInstance);\r\n    instance.usedFeatures = instance.usedFeatures.map(\r\n      (expertFeatureId) =>\r\n        companyModel.expertModelTraces[expertModelId].expertFeatureIdMap[\r\n          expertFeatureId\r\n        ]\r\n    );\r\n\r\n    // Add missing main features to instance\r\n    companyModel.iterateFeatures((feature) => {\r\n      if (instance.usedFeatures.includes(feature.id)) {\r\n        let parent = feature.parent;\r\n        while (parent !== null) {\r\n          if (!instance.usedFeatures.includes(parent.id)) {\r\n            instance.usedFeatures.push(parent.id);\r\n            parent = parent.parent;\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n\r\n    return instance;\r\n  }\r\n}\r\n","<ng-template #deleteModal>\r\n  <app-delete-decision-modal\r\n    [feature]=\"modalFeature\"\r\n    (closeModal)=\"closeModal()\"\r\n    (deleteBusinessModelDecision)=\"deleteDecision($event)\"\r\n  ></app-delete-decision-modal>\r\n</ng-template>\r\n\r\n<ng-template #addModal>\r\n  <app-add-decision-modal\r\n    [feature]=\"modalFeature\"\r\n    [instance]=\"instance\"\r\n    (closeModal)=\"closeModal()\"\r\n    (addBusinessModelDecision)=\"addDecision($event)\"\r\n    (addFeature)=\"addFeature($event)\"\r\n  ></app-add-decision-modal>\r\n</ng-template>\r\n\r\n<app-instance-info-box\r\n  [featureModel]=\"featureModel\"\r\n  [instance]=\"instance\"\r\n></app-instance-info-box>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">\r\n    {{ instance.name }} of {{ featureModel.name }}\r\n  </h6>\r\n\r\n  <!-- Build Business Model Canvas -->\r\n  <app-canvas\r\n    [patternInstance]=\"patternInstance\"\r\n    [percentages]=\"percentages\"\r\n    [compareInstance]=\"compareInstance\"\r\n    [featureModel]=\"featureModel\"\r\n    [conformance]=\"conformance\"\r\n    [conformanceOptions]=\"conformanceOptions\"\r\n    [instance]=\"instance\"\r\n    [editable]=\"editable\"\r\n    (addFeatureModal)=\"openAddDecisionModal($event)\"\r\n    (deleteFeatureModal)=\"openDeleteDecisionModal($event)\"\r\n  ></app-canvas>\r\n\r\n  <div class=\"container\">\r\n    <div class=\"row\">\r\n      <div class=\"col-2\"><strong>Legend:</strong></div>\r\n      <div class=\"col-2\">Modification:</div>\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-plus-square\"></i> Add Business Model Decision\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-minus-square\"></i> Delete Business Model Decision\r\n      </div>\r\n    </div>\r\n    <ng-container *ngIf=\"conformanceIsChecked\">\r\n      <div class=\"row\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">Conformance:</div>\r\n        <div class=\"col-4\">\r\n          <span class=\"text-danger\">Conformance Error (see below)</span>\r\n        </div>\r\n        <div class=\"col-4\" *ngIf=\"conformanceOptions.showWarnings\">\r\n          <span class=\"text-warning\">Weakness (see below)</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-4\">\r\n          <em class=\"text-danger\">Missing Mandatory Decision</em>\r\n        </div>\r\n        <div class=\"col-4\" *ngIf=\"conformanceOptions.showStrengths\">\r\n          <span class=\"text-success\">Strength (see below)</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\" *ngIf=\"conformanceOptions.showHints\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-4\">&nbsp;</div>\r\n        <div class=\"col-4\">\r\n          <em class=\"text-success\">Hint (see below)</em>\r\n        </div>\r\n      </div>\r\n      <div class=\"row\" *ngIf=\"conformanceOptions.showPatternHints\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-4\">&nbsp;</div>\r\n        <div class=\"col-4\">\r\n          <em class=\"text-muted\">Pattern Hint (see below)</em>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"compareInstance\">\r\n      <div class=\"row\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">Compare:</div>\r\n        <div class=\"col-4\">\r\n          <em class=\"text-danger\">Feature only in other model</em>\r\n        </div>\r\n        <div class=\"col-4\">\r\n          <span class=\"text-success\">Feature only in this model</span>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"patternInstance\">\r\n      <div class=\"row\">\r\n        <div class=\"col-2\">&nbsp;</div>\r\n        <div class=\"col-2\">Pattern:</div>\r\n        <div class=\"col-4\"><em class=\"text-danger\">Feature missing</em></div>\r\n        <div class=\"col-4\"><span class=\"text-success\">Feature used</span></div>\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"adaptable\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Adapt Instance</h6>\r\n  <div class=\"container\">\r\n    <div class=\"row\" style=\"margin-top: 20px\">\r\n      <button\r\n        type=\"button\"\r\n        (click)=\"createAdaptation.emit()\"\r\n        class=\"btn btn-dark btn-sm btn-block\"\r\n      >\r\n        Create New Instance Adaptation\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"updatable\">\r\n  <h6 class=\"border-bottom border-gray pb-2 mb-0\">Update Instance</h6>\r\n\r\n  <div class=\"text-muted pt-3\">\r\n    <app-instance-form\r\n      [instance]=\"instance\"\r\n      (submitInstanceForm)=\"update($event.value)\"\r\n    ></app-instance-form>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  Output,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { Feature, FeatureInit } from '../../../canvas-meta-model/feature';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { InstanceService } from '../instance.service';\r\nimport { ConformanceReport } from '../../../canvas-meta-model/conformance-report';\r\n\r\n@Component({\r\n  selector: 'app-instance',\r\n  templateUrl: './instance.component.html',\r\n  styleUrls: ['./instance.component.css'],\r\n})\r\nexport class InstanceComponent {\r\n  @Input() featureModel: FeatureModel;\r\n  @Input() instance: Instance;\r\n\r\n  @Input() editable = true;\r\n  @Input() adaptable = true;\r\n  @Input() updatable = true;\r\n\r\n  @Input() conformanceIsChecked = false;\r\n  @Input() conformance: ConformanceReport = new ConformanceReport();\r\n  @Input() conformanceOptions: {\r\n    showWarnings: boolean;\r\n    showStrengths: boolean;\r\n    showHints: boolean;\r\n    showPatternHints: boolean;\r\n  } = {\r\n    showHints: false,\r\n    showPatternHints: false,\r\n    showStrengths: false,\r\n    showWarnings: false,\r\n  };\r\n\r\n  @Input() patternInstance: Instance;\r\n\r\n  @Input() compareInstance: Instance;\r\n  @Input() percentages: { [id: string]: number } = null;\r\n\r\n  @Output() updateFeatureModel = new EventEmitter<void>();\r\n  @Output() createAdaptation = new EventEmitter<void>();\r\n\r\n  private modalReference: NgbModalRef;\r\n  modalFeature: Feature;\r\n\r\n  @ViewChild('addModal', { static: true }) addModal: unknown;\r\n  @ViewChild('deleteModal', { static: true }) deleteModal: unknown;\r\n\r\n  constructor(\r\n    private instanceService: InstanceService,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  /**\r\n   * Opens the add modal to add a decision.\r\n   *\r\n   * @param featureId id of the parent feature\r\n   */\r\n  openAddDecisionModal(featureId: string): void {\r\n    this.modalFeature = this.featureModel.getFeature(featureId);\r\n    this.modalReference = this.modalService.open(this.addModal, { size: 'lg' });\r\n  }\r\n\r\n  /**\r\n   * Add feature and add as decision\r\n   *\r\n   * @param feature the feature to add (values will be copied to a new object)\r\n   */\r\n  addFeature(feature: FeatureInit): void {\r\n    const addedFeature = this.featureModel.addFeature(\r\n      feature,\r\n      this.modalFeature.id\r\n    );\r\n    this.featureModel.addFeatureToInstance(this.instance.id, addedFeature.id);\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  /**\r\n   * Add a decision\r\n   *\r\n   * @param featureId id of the feature to add\r\n   */\r\n  addDecision(featureId: string): void {\r\n    this.featureModel.addFeatureToInstance(this.instance.id, featureId);\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  /**\r\n   * Opens the delete modal to delete a decision.\r\n   *\r\n   * @param featureId id of the feature to delete\r\n   */\r\n  openDeleteDecisionModal(featureId: string): void {\r\n    this.modalFeature = this.featureModel.getFeature(featureId);\r\n    this.modalReference = this.modalService.open(this.deleteModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Delete a decision\r\n   *\r\n   * @param featureId id of the feature to delete\r\n   */\r\n  deleteDecision(featureId: string): void {\r\n    this.featureModel.removeFeatureFromInstance(this.instance.id, featureId);\r\n    this.updateFeatureModel.emit();\r\n    this.closeModal();\r\n  }\r\n\r\n  update(patternInfo: Partial<Instance>): void {\r\n    this.featureModel.updateInstance(this.instance.id, patternInfo);\r\n    this.updateFeatureModel.emit();\r\n  }\r\n\r\n  closeModal(): void {\r\n    this.modalReference.close();\r\n    this.modalFeature = null;\r\n    this.modalReference = null;\r\n  }\r\n}\r\n","import { Component, Input } from '@angular/core';\r\nimport { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\n\r\n@Component({\r\n  selector: 'app-pattern-description-modal',\r\n  templateUrl: './pattern-description-modal.component.html',\r\n  styleUrls: ['./pattern-description-modal.component.css'],\r\n})\r\nexport class PatternDescriptionModalComponent {\r\n  @Input() pattern: Instance;\r\n\r\n  constructor(private activeModal: NgbActiveModal) {}\r\n\r\n  dismiss(): void {\r\n    this.activeModal.dismiss();\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">Description of pattern {{ pattern.name }}</h4>\r\n  <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"dismiss()\">\r\n    <span aria-hidden=\"true\">&times;</span>\r\n    <span class=\"sr-only\">Close Window</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  {{ pattern.description }}\r\n</div>\r\n<div class=\"modal-footer d-flex\">\r\n  <button type=\"button\" class=\"btn btn-dark ml-auto\" (click)=\"dismiss()\">\r\n    Close\r\n  </button>\r\n</div>\r\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { PatternHint } from '../../../canvas-meta-model/conformance-report';\r\n\r\n@Component({\r\n  selector: 'app-pattern-hint',\r\n  templateUrl: './pattern-hint.component.html',\r\n  styleUrls: ['./pattern-hint.component.css'],\r\n})\r\nexport class PatternHintComponent implements OnChanges {\r\n  @Input() patternHint: PatternHint;\r\n\r\n  missingFeaturesInfo: string;\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.patternHint) {\r\n      this.buildMissingFeaturesInfo();\r\n    }\r\n  }\r\n\r\n  private buildMissingFeaturesInfo(): void {\r\n    this.missingFeaturesInfo = this.patternHint.missingFeatures\r\n      .map((feature) => feature.name)\r\n      .join(', ');\r\n  }\r\n}\r\n","You could add the pattern\r\n<app-pattern-view [pattern]=\"patternHint.pattern\"></app-pattern-view> by adding\r\nthe following features: {{ missingFeaturesInfo }}\r\n","import { Component, Input } from '@angular/core';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { PatternDescriptionModalComponent } from '../pattern-description-modal/pattern-description-modal.component';\r\n\r\n@Component({\r\n  selector: 'app-pattern-view',\r\n  templateUrl: './pattern-view.component.html',\r\n  styleUrls: ['./pattern-view.component.css'],\r\n})\r\nexport class PatternViewComponent {\r\n  @Input() pattern: Instance;\r\n\r\n  constructor(private modalService: NgbModal) {}\r\n\r\n  openDescription(): void {\r\n    const modal = this.modalService.open(PatternDescriptionModalComponent, {\r\n      size: 'lg',\r\n    });\r\n    modal.componentInstance.pattern = this.pattern;\r\n  }\r\n}\r\n","<span\r\n  class=\"btn btn-link p-0 border-0 align-baseline\"\r\n  (click)=\"openDescription()\"\r\n  >{{ pattern.name }}</span\r\n>\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'expertModels']\">\r\n      Canvas Building Blocks\r\n    </a>\r\n    <a\r\n      *ngIf=\"expertModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'expertModels', expertModel._id]\"\r\n    >\r\n      {{ expertModel.name }}\r\n    </a>\r\n    <a *ngIf=\"expertModel\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ pattern.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"expertModel\" role=\"main\" class=\"container\">\r\n  <app-instance\r\n    [featureModel]=\"expertModel\"\r\n    [instance]=\"pattern\"\r\n    (updateFeatureModel)=\"updateExpertModel()\"\r\n    (createAdaptation)=\"createAdaptation()\"\r\n  ></app-instance>\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Instance } from '../../../canvas-meta-model/instance';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { InstanceService } from '../instance.service';\r\n\r\n@Component({\r\n  selector: 'app-pattern',\r\n  templateUrl: './pattern.component.html',\r\n  styleUrls: ['./pattern.component.css'],\r\n})\r\nexport class PatternComponent implements OnInit {\r\n  expertModel: ExpertModel;\r\n  pattern: Instance;\r\n\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private expertModelService: ExpertModelService,\r\n    private instanceService: InstanceService,\r\n    private modalService: NgbModal,\r\n    private route: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      const expertModelId = paramMap.get('id');\r\n      const patternId = +paramMap.get('patternId');\r\n\r\n      void this.load(expertModelId, patternId);\r\n    });\r\n  }\r\n\r\n  async load(expertModelId, patternId) {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    this.expertModel = expertModel;\r\n    this.pattern = expertModel.getInstance(patternId);\r\n  }\r\n\r\n  async updateExpertModel() {\r\n    await this.expertModelService.save(this.expertModel);\r\n    await this.load(this.expertModel._id, this.pattern.id);\r\n  }\r\n\r\n  /**\r\n   * Create adaptation of the pattern\r\n   */\r\n  async createAdaptation() {\r\n    const adaptationName = this.instanceService.getAdaptionName(\r\n      this.pattern.name\r\n    );\r\n    this.expertModel.adaptInstance(this.pattern.id, adaptationName);\r\n    const instance =\r\n      this.expertModel.instances[this.expertModel.instances.length - 1];\r\n    await this.expertModelService.save(this.expertModel);\r\n    await this.router.navigate([\r\n      'expertModels',\r\n      this.expertModel._id,\r\n      'patterns',\r\n      instance.id,\r\n    ]);\r\n  }\r\n}\r\n","<main class=\"container\">\r\n  <!-- List expert models -->\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Selected Canvas Building Blocks\r\n    </h6>\r\n\r\n    <ul\r\n      *ngIf=\"selectedExpertModelList\"\r\n      class=\"list-group inner\"\r\n      style=\"margin: 5px\"\r\n    >\r\n      <li\r\n        *ngFor=\"let em of selectedExpertModelList\"\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-center\r\n        \"\r\n      >\r\n        <span>{{ em.name }}</span>\r\n        <span>\r\n          <button\r\n            type=\"button\"\r\n            (click)=\"mergeExpertModel(em._id)\"\r\n            class=\"btn btn-warning btn-xs\"\r\n          >\r\n            Merge</button\r\n          >&nbsp;\r\n          <button\r\n            (click)=\"viewExpertModel(em._id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs\"\r\n          >\r\n            View</button\r\n          >&nbsp;\r\n          <button\r\n            (click)=\"unselectExpertModel(em._id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Unselect\r\n          </button>\r\n        </span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <!-- Select expert model -->\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Select Canvas Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"selectedExpertModelForm\"\r\n        (ngSubmit)=\"selectExpertModel()\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"expertModelSelector\" class=\"col-sm-4 col-form-label\"\r\n            >Canvas Building Block</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select\r\n              id=\"expertModelSelector\"\r\n              formControlName=\"expertModelId\"\r\n              class=\"form-control\"\r\n            >\r\n              <option\r\n                *ngFor=\"let em of unselectedExpertModelList\"\r\n                [value]=\"em._id\"\r\n              >\r\n                {{ em.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!selectedExpertModelForm.valid\"\r\n            >\r\n              Add Canvas Building Block\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { MergeService } from '../merge.service';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Subscription } from 'rxjs';\r\nimport { ExpertModelEntry } from '../../../canvas-meta-model/expert-model';\r\n\r\n@Component({\r\n  selector: 'app-merge-expert-models',\r\n  templateUrl: './merge-expert-models.component.html',\r\n  styleUrls: ['./merge-expert-models.component.css'],\r\n})\r\nexport class MergeExpertModelsComponent implements OnInit, OnDestroy {\r\n  companyModelId: string;\r\n\r\n  selectedExpertModelList: ExpertModelEntry[];\r\n  selectedExpertModelForm = this.fb.group({\r\n    expertModelId: [null, Validators.required],\r\n  });\r\n  unselectedExpertModelList: ExpertModelEntry[];\r\n\r\n  private routeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private expertModelService: ExpertModelService,\r\n    private fb: FormBuilder,\r\n    private mergeService: MergeService,\r\n    private router: Router,\r\n    private route: ActivatedRoute\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.routeSubscription = this.route.paramMap.subscribe((paramMap) => {\r\n      this.companyModelId = paramMap.get('companyModelId');\r\n      void this.loadExpertModels(this.companyModelId);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.routeSubscription) {\r\n      this.routeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async selectExpertModel(): Promise<void> {\r\n    await this.mergeService.selectExpertModel(\r\n      this.companyModelId,\r\n      this.selectedExpertModelForm.value.expertModelId\r\n    );\r\n    this.selectedExpertModelForm.reset();\r\n    await this.loadExpertModels(this.companyModelId);\r\n  }\r\n\r\n  async unselectExpertModel(expertModelId: string): Promise<void> {\r\n    await this.mergeService.unselectExpertModel(\r\n      this.companyModelId,\r\n      expertModelId\r\n    );\r\n    await this.loadExpertModels(this.companyModelId);\r\n  }\r\n\r\n  async viewExpertModel(expertModelId: string): Promise<void> {\r\n    await this.router.navigate(['/expertModels', expertModelId]);\r\n  }\r\n\r\n  async mergeExpertModel(expertModelId: string): Promise<void> {\r\n    void this.router.navigate(['/merge', this.companyModelId, expertModelId]);\r\n  }\r\n\r\n  private async loadExpertModels(companyModelId: string): Promise<void> {\r\n    await this.loadSelectedExpertModels(companyModelId);\r\n    await this.loadUnselectedExpertModels(companyModelId);\r\n  }\r\n\r\n  private async loadSelectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    this.selectedExpertModelList =\r\n      await this.mergeService.getSelectedExpertModels(companyModelId);\r\n  }\r\n\r\n  private async loadUnselectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<void> {\r\n    this.unselectedExpertModelList =\r\n      await this.mergeService.getUnselectedExpertModels(companyModelId);\r\n  }\r\n}\r\n","<ngb-accordion\r\n  *ngIf=\"features\"\r\n  class=\"list-group inner\"\r\n  style=\"margin: 5px\"\r\n  (panelChange)=\"panelChange($event.panelId, $event.nextState)\"\r\n  [activeIds]=\"openPanels\"\r\n>\r\n  <ngb-panel\r\n    *ngFor=\"let f of asList(features)\"\r\n    [id]=\"f.fixId\"\r\n    class=\"list-group-item justify-content-between align-items-center\"\r\n  >\r\n    <ng-template ngbPanelHeader>\r\n      <div class=\"d-flex justify-content-between align-items-center\">\r\n        <div class=\"d-flex align-items-baseline\">\r\n          <ng-container *ngIf=\"f.type === 'mandatory'\">\r\n            <i\r\n              class=\"fa fa-circle mr-1\"\r\n              aria-hidden=\"true\"\r\n              title=\"mandatory\"\r\n            ></i>\r\n            <span class=\"sr-only\">mandatory</span>\r\n          </ng-container>\r\n          <ng-container *ngIf=\"f.type === 'optional'\">\r\n            <i\r\n              class=\"fa fa-circle-o mr-1\"\r\n              aria-hidden=\"true\"\r\n              title=\"optional\"\r\n            ></i>\r\n            <span class=\"sr-only\">optional</span>\r\n          </ng-container>\r\n          <button\r\n            *ngIf=\"asList(f.subfeatures).length > 0\"\r\n            class=\"btn btn-link p-0 mr-1\"\r\n            ngbPanelToggle\r\n          >\r\n            {{ f.name }}\r\n          </button>\r\n          <button\r\n            *ngIf=\"asList(f.subfeatures).length === 0\"\r\n            class=\"btn p-0 mr-1\"\r\n          >\r\n            {{ f.name }}\r\n          </button>\r\n          <small class=\"text-muted mr-1\" *ngIf=\"f.description\">{{\r\n            f.description\r\n          }}</small>\r\n          <ng-container *ngIf=\"f.subfeatureConnections === 'or'\">\r\n            <i\r\n              class=\"fa fa-caret-up\"\r\n              aria-hidden=\"true\"\r\n              title=\"or subfeatures\"\r\n            ></i>\r\n            <span class=\"sr-only\">or subfeatures</span>\r\n          </ng-container>\r\n          <ng-container *ngIf=\"f.subfeatureConnections === 'xor'\">\r\n            <i\r\n              class=\"fa fa-angle-up\"\r\n              aria-hidden=\"true\"\r\n              title=\"xor subfeatures\"\r\n            ></i>\r\n            <span class=\"sr-only\">xor subfeatures</span>\r\n          </ng-container>\r\n        </div>\r\n\r\n        <div>\r\n          <button\r\n            type=\"button\"\r\n            *ngIf=\"!f.relationships.hasNoRelationships()\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n            (click)=\"openDependencies.emit(f.id)\"\r\n          >\r\n            Show Dependencies\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-primary btn-xs mr-1\"\r\n            *ngIf=\"f.expertModelTrace[expertModelId]\"\r\n            (click)=\"openTrace.emit(f.id)\"\r\n          >\r\n            Show Trace\r\n          </button>\r\n          <button\r\n            (click)=\"updateFeature.emit(f.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-warning btn-xs mr-1\"\r\n          >\r\n            Update\r\n          </button>\r\n          <button\r\n            *ngIf=\"f.parent !== null\"\r\n            (click)=\"deleteFeature.emit(f.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs mr-1\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <ng-template ngbPanelContent>\r\n      <app-merge-into-tree\r\n        [features]=\"f.subfeatures\"\r\n        [expertModelId]=\"expertModelId\"\r\n        [openPanels]=\"openPanels\"\r\n        (openDependencies)=\"openDependencies.emit($event)\"\r\n        (openTrace)=\"openTrace.emit($event)\"\r\n        (updateFeature)=\"updateFeature.emit($event)\"\r\n        (deleteFeature)=\"deleteFeature.emit($event)\"\r\n      ></app-merge-into-tree>\r\n    </ng-template>\r\n  </ngb-panel>\r\n</ngb-accordion>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-merge-into-tree',\r\n  templateUrl: './merge-into-tree.component.html',\r\n  styleUrls: ['./merge-into-tree.component.css'],\r\n})\r\nexport class MergeIntoTreeComponent {\r\n  @Input() expertModelId: string;\r\n  @Input() features: { [id: string]: Feature };\r\n\r\n  @Output() openTrace = new EventEmitter<string>();\r\n  @Output() openDependencies = new EventEmitter<string>();\r\n  @Output() updateFeature = new EventEmitter<string>();\r\n  @Output() deleteFeature = new EventEmitter<string>();\r\n\r\n  @Input() openPanels: string[];\r\n\r\n  panelChange(id: string, state: boolean) {\r\n    if (state && !this.openPanels.includes(id)) {\r\n      this.openPanels.push(id);\r\n    } else if (!state && this.openPanels.includes(id)) {\r\n      this.openPanels.splice(this.openPanels.indexOf(id), 1);\r\n    }\r\n  }\r\n\r\n  asList(map: { [id: string]: Feature }): Feature[] {\r\n    return Object.values(map);\r\n  }\r\n}\r\n","<ng-template #deleteModal>\r\n  <app-delete-feature-confirm\r\n    [feature]=\"modalFeature\"\r\n    (deletionResult)=\"deleteFeature($event)\"\r\n    (closeModal)=\"closeModal()\"\r\n  ></app-delete-feature-confirm>\r\n</ng-template>\r\n\r\n<ng-template #updateModal>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">{{ modalFeature.name }}</h4>\r\n    <button\r\n      type=\"button\"\r\n      class=\"close\"\r\n      aria-label=\"Close\"\r\n      (click)=\"closeModal()\"\r\n    >\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <app-feature-form\r\n        [feature]=\"modalFeature\"\r\n        [disabledSubfeatures]=\"modalSubfeatureIds\"\r\n        [featureList]=\"companyFeatureList\"\r\n        (submitFeatureForm)=\"updateFeature($event)\"\r\n      ></app-feature-form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #dependencyModal>\r\n  <app-cross-tree-relationship-modal\r\n    [feature]=\"modalFeature\"\r\n    [featureModel]=\"modalFeatureModel\"\r\n    [companyModel]=\"\r\n      modalFeatureModel._id === expertModel._id ? companyModel : null\r\n    \"\r\n    (addRelationshipOnCompanyModel)=\"\r\n      addDependency($event.type, $event.fromFeatureId, $event.toFeatureId)\r\n    \"\r\n    (closeModal)=\"closeModal()\"\r\n    (removeRelationship)=\"\r\n      deleteDependency($event.type, $event.fromFeatureId, $event.toFeatureId)\r\n    \"\r\n  ></app-cross-tree-relationship-modal>\r\n</ng-template>\r\n\r\n<ng-template #traceModal>\r\n  <app-trace-modal\r\n    [feature]=\"modalFeature\"\r\n    [tracedFeature]=\"modalTracedFeature\"\r\n    (closeModal)=\"closeModal()\"\r\n    (deleteTrace)=\"deleteTrace()\"\r\n  ></app-trace-modal>\r\n</ng-template>\r\n\r\n<ng-template #mergeModal>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">{{ modalFeature.name }}</h4>\r\n    <button\r\n      type=\"button\"\r\n      class=\"close\"\r\n      aria-label=\"Close\"\r\n      (click)=\"closeModal()\"\r\n    >\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <app-feature-form\r\n        [feature]=\"modalFeature\"\r\n        [featureList]=\"companyFeatureList\"\r\n        [enabledSubfeatures]=\"modalSubfeatureIds\"\r\n        submitButtonText=\"Merge Feature\"\r\n        (submitFeatureForm)=\"mergeFeature($event)\"\r\n      ></app-feature-form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #addAllModal>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Add all subfeatures of\r\n      {{ modalFeature ? modalFeature.name : 'the model' }}\r\n    </h4>\r\n    <button\r\n      type=\"button\"\r\n      class=\"close\"\r\n      aria-label=\"Close\"\r\n      (click)=\"closeModal()\"\r\n    >\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"alert alert-warning\" role=\"alert\">\r\n      This will add all subfeatures of\r\n      {{ modalFeature ? modalFeature.name : 'the model' }} to the composed model\r\n      as new features if they are not merged yet.\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"modal-footer\">\r\n    <button\r\n      type=\"button\"\r\n      class=\"btn btn-block btn-warning\"\r\n      (click)=\"addAll(modalFeature ? modalFeature.id : null)\"\r\n    >\r\n      Add all\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #selectModal>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">{{ modalFeature.name }}</h4>\r\n    <button\r\n      type=\"button\"\r\n      class=\"close\"\r\n      aria-label=\"Close\"\r\n      (click)=\"closeModal()\"\r\n    >\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"modalSelectFeatureForm\"\r\n        (ngSubmit)=\"mergeIntoSelected()\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"feature\" class=\"col-sm-4 col-form-label\"\r\n            >Select feature</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select id=\"feature\" formControlName=\"feature\" class=\"form-control\">\r\n              <option\r\n                *ngFor=\"let fl of companyFeatureList; let i = index\"\r\n                [disabled]=\"!modalSubfeatureIds.includes(fl.id)\"\r\n                [ngValue]=\"fl.id\"\r\n              >\r\n                {{ fl.levelname }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-dark btn-block\"\r\n              [disabled]=\"!modalSelectFeatureForm.valid\"\r\n            >\r\n              Merge Feature\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #featurerow let-id=\"id\">\r\n  <div class=\"row\">\r\n    <div class=\"col-sm-6\">\r\n      <app-merge-tree\r\n        *ngIf=\"expertModel && expertModel.features\"\r\n        [features]=\"{ id: expertModel.features[id] }\"\r\n        [trace]=\"companyModel.expertModelTraces[expertModelId]\"\r\n        (addTrace)=\"openMergeModal($event)\"\r\n        (openDependencies)=\"openDependenciesModalExpertModel($event)\"\r\n        (selectFeature)=\"openSelectModal($event)\"\r\n        (addAll)=\"openAddAllModal($event)\"\r\n        (openTrace)=\"openExpertTraceModal($event)\"\r\n      ></app-merge-tree>\r\n    </div>\r\n    <div class=\"col-sm-6\">\r\n      <app-merge-into-tree\r\n        *ngIf=\"companyModel && companyModel.features\"\r\n        [expertModelId]=\"expertModelId\"\r\n        [openPanels]=\"companyOpenPanels\"\r\n        [features]=\"{ id: companyModel.features[id] }\"\r\n        (openDependencies)=\"openDependenciesModalCompanyModel($event)\"\r\n        (openTrace)=\"openTraceModal($event)\"\r\n        (updateFeature)=\"openUpdateFeatureModal($event)\"\r\n        (deleteFeature)=\"openDeleteFeatureModal($event)\"\r\n      ></app-merge-into-tree>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"bmProcessGiven && bmProcess != null\">\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'bmprocess', 'bmprocessview', bmProcess._id]\"\r\n    >\r\n      {{ bmProcess.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'companyModels', companyModel._id, 'select']\"\r\n      [queryParams]=\"{ bmProcessId: this.bmProcess._id }\"\r\n    >\r\n      {{ companyModel.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel && expertModel\"\r\n      class=\"nav-link active\"\r\n      [routerLink]=\"[]\"\r\n      [queryParams]=\"{ bmProcessId: this.bmProcess._id }\"\r\n    >\r\n      Merge {{ expertModel.name }}\r\n    </a>\r\n  </nav>\r\n  <nav *ngIf=\"!bmProcessGiven\" class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'companyModels']\">\r\n      Composed Models\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'companyModels', companyModel._id]\"\r\n    >\r\n      {{ companyModel.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"companyModel && expertModel\"\r\n      class=\"nav-link active\"\r\n      [routerLink]=\"[]\"\r\n    >\r\n      Merge {{ expertModel.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"expertModel && companyModel\" role=\"main\">\r\n  <!-- List of Features -->\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Merge Feature Tree</h6>\r\n\r\n    <div class=\"alert alert-info container\" role=\"alert\">\r\n      <p>\r\n        Merge all features from the canvas building block on the left into the\r\n        composed model on the right. This can be done in three different ways:\r\n      </p>\r\n      <ul>\r\n        <li>\r\n          Add all: Add all subfeatures that are not yet merged to the composed\r\n          model.\r\n        </li>\r\n        <li>\r\n          Add: Add the feature to the composed model. Opens a pre filled feature\r\n          form to adjust the feature.\r\n        </li>\r\n        <li>\r\n          Select: Select the corresponding feature in the composed model. This\r\n          just creates a trace.\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div\r\n      class=\"alert alert-warning container\"\r\n      role=\"alert\"\r\n      *ngIf=\"!isFullyMerged\"\r\n    >\r\n      Not all features are merged yet.\r\n    </div>\r\n\r\n    <div\r\n      class=\"alert alert-success container\"\r\n      role=\"alert\"\r\n      *ngIf=\"isFullyMerged\"\r\n    >\r\n      All features are merged.\r\n    </div>\r\n\r\n    <button\r\n      type=\"button\"\r\n      class=\"btn btn-warning btn-xs mr-1\"\r\n      (click)=\"openAddAllModal(null)\"\r\n    >\r\n      Add all\r\n    </button>\r\n\r\n    <ng-container *ngFor=\"let id of asKeys(companyModel.features)\">\r\n      <ng-container\r\n        *ngTemplateOutlet=\"featurerow; context: { id: id }\"\r\n      ></ng-container>\r\n    </ng-container>\r\n\r\n    <div class=\"row\">\r\n      <div class=\"col-4\"><strong>Legend:</strong></div>\r\n      <div class=\"col-4\"><i class=\"fa fa-circle\"></i> Mandatory Feature</div>\r\n      <div class=\"col-4\"><i class=\"fa fa-circle-o\"></i> Optional Feature</div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">&nbsp;</div>\r\n      <div class=\"col-4\"><i class=\"fa fa-caret-up\"></i> Or</div>\r\n      <div class=\"col-4\"><i class=\"fa fa-angle-up\"></i> Alternative (Xor)</div>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { ExpertModel } from '../../../canvas-meta-model/expert-model';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\nimport { CompanyModelService } from '../../../canvas-meta-model/company-model.service';\r\nimport { ExpertModelService } from '../../../canvas-meta-model/expert-model.service';\r\nimport { RelationshipType } from '../../../canvas-meta-model/relationships';\r\nimport { MergeService } from '../merge.service';\r\nimport { BmProcessService } from '../../../development-process-registry/bm-process/bm-process.service';\r\nimport { BmProcess } from '../../../development-process-registry/bm-process/bm-process';\r\n\r\n@Component({\r\n  selector: 'app-merge-model-view',\r\n  templateUrl: './merge-model-view.component.html',\r\n  styleUrls: ['./merge-model-view.component.css'],\r\n})\r\nexport class MergeModelViewComponent implements OnInit, OnDestroy {\r\n  @ViewChild('dependencyModal', { static: true }) dependencyModal: unknown;\r\n  @ViewChild('mergeModal', { static: true }) mergeModal: unknown;\r\n  @ViewChild('addAllModal', { static: true }) addAllModal: unknown;\r\n  @ViewChild('updateModal', { static: true }) updateModal: unknown;\r\n  @ViewChild('traceModal', { static: true }) traceModal: unknown;\r\n  @ViewChild('selectModal', { static: true }) selectModal: unknown;\r\n  @ViewChild('deleteModal', { static: true }) deleteModal: unknown;\r\n\r\n  expertModel: ExpertModel;\r\n  companyModel: CompanyModel;\r\n\r\n  bmProcessGiven = false;\r\n  bmProcess?: BmProcess;\r\n\r\n  companyFeatureList: { id: string; levelname: string }[] = [];\r\n\r\n  companyModelId: string;\r\n  expertModelId: string;\r\n\r\n  private querySubscription: Subscription;\r\n  private paramSubscription: Subscription;\r\n\r\n  modalFeatureModel: FeatureModel;\r\n  modalFeature: Feature;\r\n  modalTracedFeature: Feature;\r\n  modalReference: NgbModalRef;\r\n  modalSubfeatureIds: string[];\r\n  modalSelectFeatureForm: FormGroup;\r\n\r\n  companyOpenPanels: string[] = null;\r\n\r\n  isFullyMerged = false;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    private fb: FormBuilder,\r\n    private mergeService: MergeService,\r\n    private modalService: NgbModal,\r\n    private companyModelService: CompanyModelService,\r\n    private expertModelService: ExpertModelService,\r\n    private route: ActivatedRoute\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.querySubscription = this.route.queryParamMap.subscribe((paramMap) => {\r\n      if (paramMap.has('bmProcessId')) {\r\n        this.bmProcessGiven = true;\r\n        void this.loadBmProcess(paramMap.get('bmProcessId'));\r\n      } else {\r\n        this.bmProcess = undefined;\r\n        this.bmProcessGiven = false;\r\n      }\r\n    });\r\n    this.paramSubscription = this.route.paramMap.subscribe((params) => {\r\n      this.companyModelId = params.get('companyModelId');\r\n      this.expertModelId = params.get('expertModelId');\r\n      void this.loadModels();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.querySubscription !== null) {\r\n      this.querySubscription.unsubscribe();\r\n    }\r\n    if (this.paramSubscription !== null) {\r\n      this.paramSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async loadBmProcess(bmProcessId: string): Promise<void> {\r\n    this.bmProcess = await this.bmProcessService.get(bmProcessId);\r\n  }\r\n\r\n  async loadModels(): Promise<void> {\r\n    await Promise.all([this.loadExpertModel(), this.loadCompanyModel()]);\r\n    this.isFullyMerged = this.checkIsFullyMerged();\r\n  }\r\n\r\n  async loadExpertModel(): Promise<void> {\r\n    this.expertModel = await this.expertModelService.get(this.expertModelId);\r\n  }\r\n\r\n  async loadCompanyModel(): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(\r\n      this.companyModelId\r\n    );\r\n    if (this.companyOpenPanels === null) {\r\n      this.companyOpenPanels = Object.values(companyModel.features).reduce(\r\n        (acc, feature) => {\r\n          acc.push(feature.fixId);\r\n          acc.push(\r\n            ...feature\r\n              .getAllSubfeatures()\r\n              .filter((f) => Object.values(f.subfeatures).length > 0)\r\n              .map((f) => f.fixId)\r\n          );\r\n          return acc;\r\n        },\r\n        []\r\n      );\r\n    }\r\n    this.companyModel = companyModel;\r\n    this.companyFeatureList = companyModel.getFeatureList();\r\n  }\r\n\r\n  openDependenciesModalExpertModel(featureId: string): void {\r\n    this.openDependenciesModal(this.expertModel, featureId);\r\n  }\r\n\r\n  openDependenciesModalCompanyModel(featureId: string): void {\r\n    this.openDependenciesModal(this.companyModel, featureId);\r\n  }\r\n\r\n  openDependenciesModal(featureModel: FeatureModel, featureId: string): void {\r\n    const feature = featureModel.getFeature(featureId);\r\n    this.modalFeatureModel = featureModel;\r\n    this.modalFeature = feature;\r\n    this.modalReference = this.modalService.open(this.dependencyModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openTraceModal(featureId): void {\r\n    this.modalFeatureModel = this.companyModel;\r\n    this.modalFeature = this.companyModel.getFeature(featureId);\r\n    this.modalTracedFeature = this.expertModel.getFeature(\r\n      this.modalFeature.expertModelTrace[this.expertModelId]\r\n    );\r\n    this.modalReference = this.modalService.open(this.traceModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openExpertTraceModal(featureId): void {\r\n    this.modalFeatureModel = this.expertModel;\r\n    this.modalFeature = this.expertModel.getFeature(featureId);\r\n    this.modalTracedFeature = this.companyModel.getFeature(\r\n      this.companyModel.expertModelTraces[this.expertModelId]\r\n        .expertFeatureIdMap[featureId]\r\n    );\r\n    this.modalReference = this.modalService.open(this.traceModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openMergeModal(featureId: string): void {\r\n    const expertFeature = this.expertModel.getFeature(featureId);\r\n    const parentId =\r\n      this.companyModel.expertModelTraces[this.expertModelId]\r\n        .expertFeatureIdMap[expertFeature.parent.id];\r\n    this.modalSubfeatureIds = this.companyModel\r\n      .getFeature(parentId)\r\n      .getAllSubfeatures()\r\n      .map((feature) => feature.id);\r\n    this.modalSubfeatureIds.push(parentId);\r\n    const companyModelFeatureParentId =\r\n      this.companyModel.expertModelTraces[this.expertModelId]\r\n        .expertFeatureIdMap[expertFeature.parent.id];\r\n    this.modalFeature = new Feature(\r\n      undefined,\r\n      expertFeature,\r\n      expertFeature.id,\r\n      new Feature(\r\n        undefined,\r\n        { name: '' },\r\n        companyModelFeatureParentId,\r\n        undefined\r\n      )\r\n    );\r\n    this.modalReference = this.modalService.open(this.mergeModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openAddAllModal(featureId: string): void {\r\n    this.modalFeature = featureId\r\n      ? this.expertModel.getFeature(featureId)\r\n      : null;\r\n    this.modalReference = this.modalService.open(this.addAllModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openSelectModal(featureId: string): void {\r\n    this.modalFeature = this.expertModel.getFeature(featureId);\r\n    this.modalSubfeatureIds = this.companyModel\r\n      .getFeature(\r\n        this.companyModel.expertModelTraces[this.expertModelId]\r\n          .expertFeatureIdMap[this.modalFeature.parent.id]\r\n      )\r\n      .getAllSubfeatures()\r\n      .map((feature) => feature.id);\r\n    const selectedIds = Object.values(\r\n      this.companyModel.expertModelTraces[this.expertModelId].expertFeatureIdMap\r\n    );\r\n    this.modalSubfeatureIds = this.modalSubfeatureIds.filter(\r\n      (id) => !selectedIds.includes(id)\r\n    );\r\n    this.modalSelectFeatureForm = this.fb.group({\r\n      feature: null,\r\n    });\r\n    this.modalReference = this.modalService.open(this.selectModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openDeleteFeatureModal(featureId: string): void {\r\n    this.modalFeature = this.companyModel.getFeature(featureId);\r\n    this.modalReference = this.modalService.open(this.deleteModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openUpdateFeatureModal(featureId: string): void {\r\n    const feature = this.companyModel.getFeature(featureId);\r\n    this.modalFeature = feature;\r\n    this.modalSubfeatureIds = feature.getAllSubfeatures().map((f) => f.id);\r\n    this.modalSubfeatureIds.push(feature.id);\r\n    this.modalReference = this.modalService.open(this.updateModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Closes the current modal.\r\n   */\r\n  async closeModal(): Promise<void> {\r\n    this.modalReference.close();\r\n    this.modalFeature = null;\r\n    await this.loadModels();\r\n  }\r\n\r\n  async mergeFeature(featureForm: FormGroup): Promise<void> {\r\n    await this.mergeService.addFeatureMerge(\r\n      this.companyModelId,\r\n      featureForm.value,\r\n      featureForm.get('subfeatureOf').value,\r\n      this.expertModelId,\r\n      this.modalFeature.id\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async addAll(featureId: string): Promise<void> {\r\n    await this.mergeService.addAllSubfeaturesMerge(\r\n      this.companyModelId,\r\n      this.expertModelId,\r\n      featureId\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async mergeIntoSelected(): Promise<void> {\r\n    await this.mergeService.addTrace(\r\n      this.companyModelId,\r\n      this.modalSelectFeatureForm.value.feature,\r\n      this.expertModelId,\r\n      this.modalFeature.id\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async deleteTrace(): Promise<void> {\r\n    if (this.modalFeatureModel === this.companyModel) {\r\n      await this.deleteCompanyTrace();\r\n    } else {\r\n      await this.deleteExpertTrace();\r\n    }\r\n  }\r\n\r\n  async deleteCompanyTrace(): Promise<void> {\r\n    await this.mergeService.deleteTrace(\r\n      this.companyModelId,\r\n      this.modalFeature.id,\r\n      this.expertModelId\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async deleteExpertTrace(): Promise<void> {\r\n    await this.mergeService.deleteTrace(\r\n      this.companyModelId,\r\n      this.modalTracedFeature.id,\r\n      this.expertModelId\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async deleteFeature(featureId): Promise<void> {\r\n    await this.mergeService.deleteFeature(this.companyModelId, featureId);\r\n    await this.closeModal();\r\n  }\r\n\r\n  async addDependency(\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): Promise<void> {\r\n    await this.mergeService.addRelationship(\r\n      this.companyModelId,\r\n      relationshipType,\r\n      fromFeatureId,\r\n      toFeatureId\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  async deleteDependency(\r\n    relationshipType: RelationshipType,\r\n    fromId: string,\r\n    toId: string\r\n  ): Promise<void> {\r\n    await this.mergeService.removeRelationship(\r\n      this.companyModelId,\r\n      relationshipType,\r\n      fromId,\r\n      toId\r\n    );\r\n    await this.loadModels();\r\n    this.modalFeature = this.companyModel.getFeature(this.modalFeature.id);\r\n  }\r\n\r\n  async updateFeature(featureForm: FormGroup): Promise<void> {\r\n    await this.mergeService.updateFeature(\r\n      this.companyModelId,\r\n      this.modalFeature.id,\r\n      featureForm.value,\r\n      featureForm.get('subfeatureOf').value\r\n    );\r\n    await this.closeModal();\r\n  }\r\n\r\n  asKeys(map: { [id: string]: Feature }): string[] {\r\n    return Object.keys(map);\r\n  }\r\n\r\n  private checkIsFullyMerged(): boolean {\r\n    return this.expertModel\r\n      .getFeatureList()\r\n      .every(\r\n        (feature) =>\r\n          !!this.companyModel.expertModelTraces[this.expertModel._id]\r\n            .expertFeatureIdMap[feature.id]\r\n      );\r\n  }\r\n}\r\n","<ul *ngIf=\"features\" class=\"list-group inner\" style=\"margin: 5px\">\r\n  <li\r\n    *ngFor=\"let f of asList(features)\"\r\n    class=\"list-group-item justify-content-between align-items-center\"\r\n  >\r\n    <div class=\"d-flex justify-content-between align-items-center\">\r\n      <div class=\"d-flex\">\r\n        <div class=\"mr-1\">\r\n          <ng-container *ngIf=\"f.type === 'mandatory'\">\r\n            <i class=\"fa fa-circle\" aria-hidden=\"true\" title=\"mandatory\"></i>\r\n            <span class=\"sr-only\">mandatory</span>\r\n          </ng-container>\r\n          <ng-container *ngIf=\"f.type === 'optional'\">\r\n            <i class=\"fa fa-circle-o\" aria-hidden=\"true\" title=\"optional\"></i>\r\n            <span class=\"sr-only\">optional</span>\r\n          </ng-container>\r\n        </div>\r\n\r\n        <div class=\"mr-1\">\r\n          {{ f.name }}\r\n          <small class=\"text-muted\" *ngIf=\"f.description\">{{\r\n            f.description\r\n          }}</small>\r\n        </div>\r\n\r\n        <div>\r\n          <ng-container *ngIf=\"f.subfeatureConnections === 'or'\">\r\n            <i\r\n              class=\"fa fa-caret-up\"\r\n              aria-hidden=\"true\"\r\n              title=\"or subfeatures\"\r\n            ></i>\r\n            <span class=\"sr-only\">or subfeatures</span>\r\n          </ng-container>\r\n          <ng-container *ngIf=\"f.subfeatureConnections === 'xor'\">\r\n            <i\r\n              class=\"fa fa-angle-up\"\r\n              aria-hidden=\"true\"\r\n              title=\"xor subfeatures\"\r\n            ></i>\r\n            <span class=\"sr-only\">xor subfeatures</span>\r\n          </ng-container>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <button\r\n          type=\"button\"\r\n          *ngIf=\"!f.relationships.hasNoRelationships()\"\r\n          class=\"btn btn-dark btn-xs mr-1\"\r\n          (click)=\"openDependencies.emit(f.id)\"\r\n        >\r\n          Show Dependencies\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-warning btn-xs mr-1\"\r\n          *ngIf=\"\r\n            !trace.expertFeatureIdMap[f.id] &&\r\n            f.parent &&\r\n            trace.expertFeatureIdMap[f.parent.id]\r\n          \"\r\n          (click)=\"addTrace.emit(f.id)\"\r\n        >\r\n          Add\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-warning btn-xs mr-1\"\r\n          *ngIf=\"\r\n            !trace.expertFeatureIdMap[f.id] &&\r\n            f.parent &&\r\n            trace.expertFeatureIdMap[f.parent.id]\r\n          \"\r\n          (click)=\"selectFeature.emit(f.id)\"\r\n        >\r\n          Select\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-warning btn-xs mr-1\"\r\n          *ngIf=\"trace.expertFeatureIdMap[f.id]\"\r\n          (click)=\"addAll.emit(f.id)\"\r\n        >\r\n          Add all\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-primary btn-xs mr-1\"\r\n          *ngIf=\"trace.expertFeatureIdMap[f.id]\"\r\n          (click)=\"openTrace.emit(f.id)\"\r\n        >\r\n          Show Trace\r\n        </button>\r\n        <ng-container *ngIf=\"trace.expertFeatureIdMap[f.id]\">\r\n          <i class=\"fa fa-check\" aria-hidden=\"true\" title=\"Merged\"></i>\r\n          <span class=\"sr-only\">(Merged)</span>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"!trace.expertFeatureIdMap[f.id]\">\r\n          <i\r\n            class=\"fa fa-exclamation-triangle\"\r\n            aria-hidden=\"true\"\r\n            title=\"Unmerged\"\r\n          ></i>\r\n          <span class=\"sr-only\">(Unmerged)</span>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n\r\n    <app-merge-tree\r\n      [features]=\"f.subfeatures\"\r\n      [trace]=\"trace\"\r\n      (openDependencies)=\"openDependencies.emit($event)\"\r\n      (addTrace)=\"addTrace.emit($event)\"\r\n      (selectFeature)=\"selectFeature.emit($event)\"\r\n      (addAll)=\"addAll.emit($event)\"\r\n      (openTrace)=\"openTrace.emit($event)\"\r\n    ></app-merge-tree>\r\n  </li>\r\n</ul>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\nimport { Trace } from '../../../canvas-meta-model/trace';\r\n\r\n@Component({\r\n  selector: 'app-merge-tree',\r\n  templateUrl: './merge-tree.component.html',\r\n  styleUrls: ['./merge-tree.component.css'],\r\n})\r\nexport class MergeTreeComponent {\r\n  @Input() features: { [id: string]: Feature };\r\n  @Input() trace: Trace;\r\n\r\n  @Output() addTrace = new EventEmitter<string>();\r\n  @Output() selectFeature = new EventEmitter<string>();\r\n  @Output() openDependencies = new EventEmitter<string>();\r\n  @Output() addAll = new EventEmitter<string>();\r\n  @Output() openTrace = new EventEmitter<string>();\r\n\r\n  asList(map: { [id: string]: Feature }): Feature[] {\r\n    return Object.values(map);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ExpertModelService } from '../../canvas-meta-model/expert-model.service';\r\nimport { CompanyModelService } from '../../canvas-meta-model/company-model.service';\r\nimport { Feature, FeatureInit } from '../../canvas-meta-model/feature';\r\nimport { RelationshipType } from '../../canvas-meta-model/relationships';\r\nimport { ExpertModelEntry } from '../../canvas-meta-model/expert-model';\r\nimport {\r\n  CanvasDefinition,\r\n  CanvasDefinitionEntry,\r\n} from '../../canvas-meta-model/canvas-definition';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class MergeService {\r\n  constructor(\r\n    private companyModelService: CompanyModelService,\r\n    private expertModelService: ExpertModelService\r\n  ) {}\r\n\r\n  async selectExpertModel(\r\n    companyModelId: string,\r\n    expertModelId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(companyModelId);\r\n    companyModel.addExpertModel(expertModelId);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async unselectExpertModel(\r\n    companyModelId: string,\r\n    expertModelId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(companyModelId);\r\n    companyModel.removeExpertModel(expertModelId);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async getSelectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<ExpertModelEntry[]> {\r\n    const companyModel = await this.companyModelService.get(companyModelId);\r\n    return this.expertModelService.getList({\r\n      _id: { $in: Object.keys(companyModel.expertModelTraces) },\r\n    });\r\n  }\r\n\r\n  async getUnselectedExpertModels(\r\n    companyModelId: string\r\n  ): Promise<ExpertModelEntry[]> {\r\n    const companyModel = await this.companyModelService.get(companyModelId);\r\n    const getRootFeatureIds = (\r\n      canvasDefinition: CanvasDefinition | CanvasDefinitionEntry\r\n    ): string[] => {\r\n      const rootFeatureIds: string[] = [];\r\n      canvasDefinition.rows.forEach((row) =>\r\n        row\r\n          .filter((cell) => !cell.isSpacer)\r\n          .forEach((cell) => {\r\n            rootFeatureIds.push(cell.id);\r\n          })\r\n      );\r\n      return rootFeatureIds;\r\n    };\r\n    const definitionIds = getRootFeatureIds(companyModel.definition);\r\n    return (\r\n      await this.expertModelService.getList({\r\n        $not: {\r\n          _id: { $in: Object.keys(companyModel.expertModelTraces) },\r\n        },\r\n      })\r\n    ).filter((expertModel: ExpertModelEntry) => {\r\n      const ids = getRootFeatureIds(expertModel.$definition);\r\n      return (\r\n        ids.length === definitionIds.length &&\r\n        ids.every((id) => definitionIds.includes(id))\r\n      );\r\n    });\r\n  }\r\n\r\n  async addFeatureMerge(\r\n    featureModelId: string,\r\n    feature: FeatureInit,\r\n    subfeatureOf: string,\r\n    expertModelId: string,\r\n    expertModelFeatureId: string\r\n  ): Promise<void> {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    const newFeature = companyModel.addFeature(feature, subfeatureOf);\r\n    companyModel.addExpertModelTrace(\r\n      expertModel,\r\n      expertModelFeatureId,\r\n      newFeature.id\r\n    );\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async addAllSubfeaturesMerge(\r\n    featureModelId: string,\r\n    expertModelId: string,\r\n    expertModelFeatureId: string\r\n  ): Promise<void> {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    let subfeatures: Feature[];\r\n    if (expertModelFeatureId) {\r\n      const expertFeature = expertModel.getFeature(expertModelFeatureId);\r\n      subfeatures = expertFeature.getAllSubfeatures();\r\n    } else {\r\n      subfeatures = Object.values(expertModel.getFeatureMap());\r\n    }\r\n    subfeatures\r\n      .filter(\r\n        (feature) =>\r\n          !companyModel.expertModelTraces[expertModelId].expertFeatureIdMap[\r\n            feature.id\r\n          ]\r\n      )\r\n      .forEach((feature) => {\r\n        const newFeature = companyModel.addFeature(\r\n          {\r\n            name: feature.name,\r\n            description: feature.description,\r\n            type: feature.type,\r\n            subfeatureConnections: feature.subfeatureConnections,\r\n          },\r\n          companyModel.expertModelTraces[expertModelId].expertFeatureIdMap[\r\n            feature.parent.id\r\n          ]\r\n        );\r\n        companyModel.addExpertModelTrace(\r\n          expertModel,\r\n          feature.id,\r\n          newFeature.id\r\n        );\r\n      });\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async addTrace(\r\n    featureModelId: string,\r\n    featureId: string,\r\n    expertModelId: string,\r\n    expertModelFeatureId: string\r\n  ): Promise<void> {\r\n    const expertModel = await this.expertModelService.get(expertModelId);\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.addExpertModelTrace(\r\n      expertModel,\r\n      expertModelFeatureId,\r\n      featureId\r\n    );\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async deleteTrace(\r\n    featureModelId: string,\r\n    featureId: string,\r\n    expertModelId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.removeTrace(featureId, expertModelId);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async updateFeature(\r\n    featureModelId: string,\r\n    featureId: string,\r\n    feature: Partial<Feature>,\r\n    subfeatureOf: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.updateFeature(featureId, subfeatureOf, feature);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async deleteFeature(\r\n    featureModelId: string,\r\n    featureId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.removeFeature(featureId);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async addRelationship(\r\n    featureModelId: string,\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.addRelationship(relationshipType, fromFeatureId, toFeatureId);\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n\r\n  async removeRelationship(\r\n    featureModelId: string,\r\n    relationshipType: RelationshipType,\r\n    fromFeatureId: string,\r\n    toFeatureId: string\r\n  ): Promise<void> {\r\n    const companyModel = await this.companyModelService.get(featureModelId);\r\n    companyModel.removeRelationship(\r\n      relationshipType,\r\n      fromFeatureId,\r\n      toFeatureId\r\n    );\r\n    await this.companyModelService.save(companyModel);\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">{{ feature.name }}</h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"closeModal.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n    <li class=\"list-group-item justify-content-between align-items-center\">\r\n      Connected to:\r\n      <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n        <li class=\"list-group-item justify-content-between align-items-center\">\r\n          {{ tracedFeature.name }}\r\n          <button\r\n            (click)=\"deleteTrace.emit()\"\r\n            *ngIf=\"feature.parent !== null\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs bottom-right\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </li>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n</div>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\n\r\n@Component({\r\n  selector: 'app-trace-modal',\r\n  templateUrl: './trace-modal.component.html',\r\n  styleUrls: ['./trace-modal.component.css'],\r\n})\r\nexport class TraceModalComponent {\r\n  @Input() feature: Feature;\r\n  @Input() tracedFeature: Feature;\r\n\r\n  @Output() closeModal = new EventEmitter<null>();\r\n  @Output() deleteTrace = new EventEmitter<null>();\r\n}\r\n","<form [formGroup]=\"relationshipForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"relationshipType\" class=\"col-sm-4 col-form-label\"\r\n      >Type of Relationship</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"relationshipType\"\r\n        formControlName=\"relationshipType\"\r\n        class=\"form-control\"\r\n      >\r\n        <option\r\n          *ngFor=\"let relationshipType of relationshipTypes\"\r\n          [ngValue]=\"relationshipType\"\r\n        >\r\n          A {{ relationshipType }} B\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <label for=\"fromFeatureId\" class=\"col-sm-4 col-form-label\">Feature A</label>\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"fromFeatureId\"\r\n        formControlName=\"fromFeatureId\"\r\n        class=\"form-control\"\r\n      >\r\n        <option *ngFor=\"let fl of featureList; let i = index\" [ngValue]=\"fl.id\">\r\n          {{ fl.levelname }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <label for=\"toFeatureId\" class=\"col-sm-4 col-form-label\">Feature B</label>\r\n    <div class=\"col-sm-8\">\r\n      <select\r\n        id=\"toFeatureId\"\r\n        formControlName=\"toFeatureId\"\r\n        class=\"form-control\"\r\n      >\r\n        <option *ngFor=\"let fl of featureList; let i = index\" [ngValue]=\"fl.id\">\r\n          {{ fl.levelname }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!relationshipForm.valid\"\r\n      >\r\n        Add Cross-Tree Relationship\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-cross-tree-relationship-form',\r\n  templateUrl: './cross-tree-relationship-form.component.html',\r\n  styleUrls: ['./cross-tree-relationship-form.component.css'],\r\n})\r\nexport class CrossTreeRelationshipFormComponent implements OnInit {\r\n  @Input() featureList: { id: string; levelname: string }[];\r\n  @Input() relationshipTypes: string[];\r\n\r\n  @Output() submitRelationshipForm = new EventEmitter<FormGroup>();\r\n\r\n  relationshipForm: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadForm();\r\n  }\r\n\r\n  private loadForm(): void {\r\n    this.relationshipForm = this.fb.group({\r\n      relationshipType: [null, Validators.required],\r\n      fromFeatureId: [\r\n        this.featureList.length > 0 ? this.featureList[0].id : null,\r\n        Validators.required,\r\n      ],\r\n      toFeatureId: [\r\n        this.featureList.length > 1 ? this.featureList[1].id : null,\r\n        Validators.required,\r\n      ],\r\n    });\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitRelationshipForm.emit(this.relationshipForm);\r\n    this.loadForm();\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\" id=\"modal-basic-title\">{{ feature.name }}</h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"closeModal.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n  </button>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n  <div\r\n    *ngIf=\"feature.relationships.hasNoRelationships()\"\r\n    class=\"alert alert-info\"\r\n    role=\"alert\"\r\n  >\r\n    There are no dependencies left to remove.\r\n  </div>\r\n\r\n  <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n    <ng-container *ngFor=\"let relationship of relationships\">\r\n      <li\r\n        class=\"list-group-item justify-content-between align-items-center\"\r\n        *ngIf=\"relationship.features.length !== 0\"\r\n      >\r\n        <i class=\"fa fa-arrow-right\"></i> {{ relationship.name }}:\r\n        <ul class=\"list-group inner\" style=\"margin: 5px\">\r\n          <li\r\n            class=\"list-group-item justify-content-between align-items-center\"\r\n            *ngFor=\"let f of relationship.features\"\r\n          >\r\n            {{ f.name }}\r\n            <button\r\n              *ngIf=\"\r\n                companyModel &&\r\n                relationshipDoesNotExistInCompanyModel(relationship.type, f.id)\r\n              \"\r\n              type=\"button\"\r\n              class=\"btn btn-warning btn-xs bottom-right\"\r\n              (click)=\"add(relationship.type, f.id)\"\r\n            >\r\n              Add\r\n            </button>\r\n            <button\r\n              *ngIf=\"!companyModel\"\r\n              (click)=\"remove(relationship.type, f.id)\"\r\n              type=\"button\"\r\n              class=\"btn btn-warning btn-xs bottom-right\"\r\n            >\r\n              Delete\r\n            </button>\r\n          </li>\r\n        </ul>\r\n      </li>\r\n    </ng-container>\r\n  </ul>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { Feature } from '../../../canvas-meta-model/feature';\r\nimport { RelationshipType } from '../../../canvas-meta-model/relationships';\r\nimport { CompanyModel } from '../../../canvas-meta-model/company-model';\r\nimport { FeatureModel } from '../../../canvas-meta-model/feature-model';\r\n\r\n@Component({\r\n  selector: 'app-cross-tree-relationship-modal',\r\n  templateUrl: './cross-tree-relationship-modal.component.html',\r\n  styleUrls: ['./cross-tree-relationship-modal.component.css'],\r\n})\r\nexport class CrossTreeRelationshipModalComponent implements OnChanges {\r\n  @Input() featureModel: FeatureModel;\r\n  @Input() feature: Feature;\r\n  @Input() companyModel: CompanyModel = null;\r\n\r\n  @Output() closeModal = new EventEmitter<null>();\r\n  @Output() addRelationshipOnCompanyModel = new EventEmitter<{\r\n    type: RelationshipType;\r\n    fromFeatureId: string;\r\n    toFeatureId: string;\r\n  }>();\r\n  @Output() removeRelationship = new EventEmitter<{\r\n    type: RelationshipType;\r\n    fromFeatureId: string;\r\n    toFeatureId: string;\r\n  }>();\r\n\r\n  relationships: {\r\n    name: string;\r\n    type: RelationshipType;\r\n    features: Feature[];\r\n  }[];\r\n  tracedFeature: Feature;\r\n\r\n  constructor() {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.feature) {\r\n      this.load(changes.feature.currentValue);\r\n    }\r\n  }\r\n\r\n  add(type: RelationshipType, toExpertFeatureId: string): void {\r\n    const toCompanyFeatureId =\r\n      this.companyModel.expertModelTraces[this.featureModel._id]\r\n        .expertFeatureIdMap[toExpertFeatureId];\r\n    this.addRelationshipOnCompanyModel.emit({\r\n      type,\r\n      fromFeatureId: this.feature.id,\r\n      toFeatureId: toCompanyFeatureId,\r\n    });\r\n  }\r\n\r\n  remove(type: RelationshipType, toFeatureId: string): void {\r\n    this.removeRelationship.emit({\r\n      type,\r\n      fromFeatureId: this.feature.id,\r\n      toFeatureId,\r\n    });\r\n  }\r\n\r\n  private load(feature: Feature): void {\r\n    this.relationships = [];\r\n    this.tracedFeature = null;\r\n    const featureMap = this.featureModel.getFeatureMap();\r\n    const relationshipTypes = this.featureModel.definition.relationshipTypes;\r\n    relationshipTypes.forEach((type) =>\r\n      this.loadRelationship(\r\n        type,\r\n        type,\r\n        feature.relationships.getRelationships(type),\r\n        featureMap\r\n      )\r\n    );\r\n    if (this.companyModel) {\r\n      const tracedFeatureId =\r\n        this.companyModel.expertModelTraces[this.featureModel._id]\r\n          .expertFeatureIdMap[this.feature.id];\r\n      if (tracedFeatureId) {\r\n        this.tracedFeature = this.companyModel.getFeature(tracedFeatureId);\r\n      }\r\n    }\r\n  }\r\n\r\n  private loadRelationship(\r\n    name: string,\r\n    type: RelationshipType,\r\n    features: string[],\r\n    featureMap: { [p: string]: Feature }\r\n  ): void {\r\n    this.relationships.push({\r\n      name,\r\n      type,\r\n      features: features.map((featureId) => featureMap[featureId]),\r\n    });\r\n  }\r\n\r\n  relationshipDoesNotExistInCompanyModel(\r\n    type: RelationshipType,\r\n    toExpertFeatureId: string\r\n  ): boolean {\r\n    const toCompanyFeatureId =\r\n      this.companyModel.expertModelTraces[this.featureModel._id]\r\n        .expertFeatureIdMap[toExpertFeatureId];\r\n    if (toCompanyFeatureId) {\r\n      return !this.tracedFeature.relationships.hasRelationship(\r\n        type,\r\n        toCompanyFeatureId\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","<form [formGroup]=\"passwordForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"inputPassword\" class=\"col-sm-4 col-form-label\">Password</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"password\"\r\n        class=\"form-control\"\r\n        id=\"inputPassword\"\r\n        formControlName=\"password\"\r\n        aria-describedby=\"validationPassword\"\r\n        [class.is-invalid]=\"passwordControl.invalid && passwordControl.touched\"\r\n      />\r\n      <div id=\"validationPassword\" class=\"invalid-feedback\">\r\n        <ng-container *ngIf=\"passwordControl.hasError('minlength')\">\r\n          The password must be at least 10 characters long.\r\n        </ng-container>\r\n        <ng-container *ngIf=\"passwordControl.hasError('required')\">\r\n          This field is required.\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"inputConfirm\" class=\"col-sm-4 col-form-label\">Confirm</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"password\"\r\n        class=\"form-control\"\r\n        id=\"inputConfirm\"\r\n        formControlName=\"confirm\"\r\n        aria-describedby=\"validationConfirm\"\r\n        [class.is-invalid]=\"passwordForm.invalid && confirmControl.touched\"\r\n      />\r\n      <div\r\n        id=\"validationConfirm\"\r\n        class=\"invalid-feedback\"\r\n        *ngIf=\"passwordForm.hasError('passwordNotConfirmed')\"\r\n      >\r\n        The passwords do not match.\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-dark btn-sm btn-block\"\r\n        [disabled]=\"!passwordForm.valid\"\r\n      >\r\n        Change Password\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import { Component, EventEmitter, Output } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-change-password-form',\r\n  templateUrl: './change-password-form.component.html',\r\n  styleUrls: ['./change-password-form.component.css'],\r\n})\r\nexport class ChangePasswordFormComponent {\r\n  @Output() changePassword = new EventEmitter<string>();\r\n\r\n  passwordForm: FormGroup = this.fb.group(\r\n    {\r\n      password: this.fb.control('', [\r\n        Validators.required,\r\n        Validators.minLength(10),\r\n      ]),\r\n      confirm: this.fb.control(''),\r\n    },\r\n    {\r\n      validators: (group) => {\r\n        if (group.get('password').value !== group.get('confirm').value) {\r\n          return { passwordNotConfirmed: true };\r\n        }\r\n        return null;\r\n      },\r\n    }\r\n  );\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  submitForm() {\r\n    this.changePassword.emit(this.passwordControl.value);\r\n    this.passwordForm.reset();\r\n  }\r\n\r\n  get passwordControl() {\r\n    return this.passwordForm.get('password');\r\n  }\r\n\r\n  get confirmControl() {\r\n    return this.passwordForm.get('confirm');\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  CanActivate,\r\n  Router,\r\n  RouterStateSnapshot,\r\n  UrlTree,\r\n} from '@angular/router';\r\nimport { Observable } from 'rxjs';\r\nimport { AuthService } from './auth.service';\r\n\r\n@Injectable()\r\nexport class AuthGuard implements CanActivate {\r\n  constructor(private authService: AuthService, private router: Router) {}\r\n\r\n  canActivate(\r\n    route: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ):\r\n    | Observable<boolean | UrlTree>\r\n    | Promise<boolean | UrlTree>\r\n    | boolean\r\n    | UrlTree {\r\n    if (this.authService.isLoggedIn()) {\r\n      return true;\r\n    } else {\r\n      this.authService.redirectTo = state.url;\r\n      return this.router.createUrlTree(['/', 'login']);\r\n    }\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\n\r\nexport abstract class AuthService {\r\n  abstract set redirectTo(redirectTo: string | undefined);\r\n\r\n  abstract get username(): string | undefined;\r\n\r\n  abstract get group(): string | undefined;\r\n\r\n  abstract init(): Observable<void> | Promise<void>;\r\n\r\n  abstract login(username: string, password: string): Observable<void>;\r\n\r\n  abstract logout(): Observable<void>;\r\n\r\n  abstract changePassword(newPassword: string): Observable<void>;\r\n\r\n  abstract isLoggedIn(): boolean;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  HttpClient,\r\n  HttpErrorResponse,\r\n  HttpStatusCode,\r\n} from '@angular/common/http';\r\nimport { defer, from, Observable, of, pipe, UnaryFunction } from 'rxjs';\r\nimport { catchError, map, mapTo, switchMap, tap } from 'rxjs/operators';\r\nimport { Router } from '@angular/router';\r\nimport { PouchdbService } from './pouchdb.service';\r\nimport { AuthService } from './auth.service';\r\n\r\nexport enum AuthErrors {\r\n  NOT_AUTHENTICATED = 'You need to be logged in to perform this action',\r\n  NOT_ACTIVATED = 'Your account is not yet activated.',\r\n  NOT_AVAILABLE = 'Database is not available',\r\n  SERVER_MAINTENANCE = 'The database is in maintenance',\r\n}\r\n\r\n@Injectable()\r\nexport class CouchdbAuthService implements AuthService {\r\n  redirectTo: string | undefined;\r\n\r\n  private loggedIn = false;\r\n\r\n  private _username?: string = undefined;\r\n  get username(): string | undefined {\r\n    return this._username;\r\n  }\r\n\r\n  private _group?: string = undefined;\r\n  get group(): string | undefined {\r\n    return this._group;\r\n  }\r\n\r\n  private readonly upUrl = new URL('/database/_up', location.origin).href;\r\n  private readonly url = new URL('/database/_session', location.origin).href;\r\n  private userUrl?: string = undefined;\r\n  private databaseUrl?: string = undefined;\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private pouchdbService: PouchdbService,\r\n    private router: Router\r\n  ) {}\r\n\r\n  init(): Observable<void> {\r\n    return this.http\r\n      .get(this.url, {\r\n        headers: {\r\n          'X-CouchDB-WWW-Authenticate': 'Cookie',\r\n        },\r\n      })\r\n      .pipe(\r\n        tap((response: any) =>\r\n          this.initUser(response.userCtx.name, response.userCtx.roles)\r\n        ),\r\n        this.checkAndLogin(),\r\n        catchError(() => of()),\r\n        mapTo(undefined)\r\n      );\r\n  }\r\n\r\n  /**\r\n   * Login the user\r\n   *\r\n   * @param username the username\r\n   * @param password the password\r\n   */\r\n  login(username: string, password: string): Observable<void> {\r\n    return this.http\r\n      .post(this.url, {\r\n        username,\r\n        password,\r\n      })\r\n      .pipe(\r\n        tap((response: any) => this.initUser(response.name, response.roles)),\r\n        this.checkAndLogin(),\r\n        tap(() => this.redirect()),\r\n        mapTo(undefined)\r\n      );\r\n  }\r\n\r\n  /**\r\n   * Logout the current user\r\n   */\r\n  logout(): Observable<void> {\r\n    return defer(() => from(this.pouchdbService.closeDb())).pipe(\r\n      tap(() => this.clearUser()),\r\n      switchMap(() =>\r\n        this.http.delete(this.url, {\r\n          headers: {\r\n            'X-CouchDB-WWW-Authenticate': 'Cookie',\r\n          },\r\n        })\r\n      ),\r\n      switchMap(() => from(this.router.navigate(['/', 'login']))),\r\n      mapTo(undefined)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Change the password of the current user\r\n   *\r\n   * @param newPassword the new password of the user\r\n   */\r\n  changePassword(newPassword: string): Observable<void> {\r\n    if (this.userUrl == null) {\r\n      throw new Error(AuthErrors.NOT_AUTHENTICATED);\r\n    }\r\n    const userUrl = this.userUrl;\r\n    return this.http\r\n      .get(userUrl, {\r\n        headers: {\r\n          'X-CouchDB-WWW-Authenticate': 'Cookie',\r\n        },\r\n      })\r\n      .pipe(\r\n        switchMap((user: any) => {\r\n          const newUser = {\r\n            _id: user._id,\r\n            _rev: user._rev,\r\n            name: user.name,\r\n            roles: user.roles,\r\n            type: user.type,\r\n            password: newPassword,\r\n          };\r\n          return this.http.put(userUrl, newUser, {\r\n            headers: {\r\n              'X-CouchDB-WWW-Authenticate': 'Cookie',\r\n            },\r\n          });\r\n        }),\r\n        switchMap(async () => {\r\n          this.redirectTo = this.router.url;\r\n          await this.pouchdbService.closeDb();\r\n          this.clearUser();\r\n          return this.router.navigate(['/', 'login'], {\r\n            queryParams: { passwordChanged: true },\r\n          });\r\n        }),\r\n        mapTo(undefined)\r\n      );\r\n  }\r\n\r\n  private async redirect(): Promise<void> {\r\n    if (this.redirectTo) {\r\n      await this.router.navigateByUrl(this.redirectTo);\r\n    } else {\r\n      await this.router.navigate(['/']);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the user after logging in\r\n   *\r\n   * @param username the username of the user\r\n   * @param roles the roles of the user\r\n   */\r\n  private initUser(username: string, roles: string[]): void {\r\n    this._group = this.getGroup(roles);\r\n    this._username = username;\r\n    if (this.group == null) {\r\n      throw new Error(AuthErrors.NOT_ACTIVATED);\r\n    }\r\n    this.userUrl = new URL(\r\n      '/database/_users/org.couchdb.user:' + this.username,\r\n      location.origin\r\n    ).href;\r\n    this.databaseUrl = new URL('/database/' + this.group, location.origin).href;\r\n  }\r\n\r\n  /**\r\n   * Checks whether the user is able to log in.\r\n   * Assumes that the group and databaseUrl are set.\r\n   *\r\n   * @return whether the user is able to log in\r\n   */\r\n  private checkAndLogin(): UnaryFunction<\r\n    Observable<unknown>,\r\n    Observable<unknown>\r\n  > {\r\n    return pipe(\r\n      switchMap(() => this.checkServerAvailable()),\r\n      map((available) => {\r\n        if (available) {\r\n          return;\r\n        } else {\r\n          throw new Error(AuthErrors.SERVER_MAINTENANCE);\r\n        }\r\n      }),\r\n      switchMap(() => this.checkDatabaseAvailable()),\r\n      map((available) => {\r\n        if (available) {\r\n          return;\r\n        } else {\r\n          throw new Error(AuthErrors.NOT_AVAILABLE);\r\n        }\r\n      }),\r\n      tap(() => {\r\n        this.pouchdbService.init(\r\n          this.group!,\r\n          () => this.sessionExpired(),\r\n          () => this.dbError()\r\n        );\r\n        this.loggedIn = true;\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Called if the session is expired\r\n   */\r\n  private async sessionExpired(): Promise<void> {\r\n    this.redirectTo = this.router.url;\r\n    await this.pouchdbService.closeDb();\r\n    this.clearUser();\r\n    await this.router.navigate(['/', 'login'], {\r\n      queryParams: {\r\n        expired: true,\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Called on critical error in db\r\n   */\r\n  private async dbError(): Promise<void> {\r\n    this.redirectTo = this.router.url;\r\n    await this.pouchdbService.closeDb();\r\n    this.clearUser();\r\n    await this.router.navigate(['/', 'login'], {\r\n      queryParams: {\r\n        dbError: true,\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear all user related fields\r\n   */\r\n  private clearUser(): void {\r\n    this._group = undefined;\r\n    this._username = undefined;\r\n    this.userUrl = undefined;\r\n    this.databaseUrl = undefined;\r\n    this.loggedIn = false;\r\n  }\r\n\r\n  /**\r\n   * Get the group of this user from the roles array\r\n   *\r\n   * @param roles the roles array\r\n   * @return the group the user belongs to\r\n   */\r\n  private getGroup(roles: string[]): string | undefined {\r\n    return roles.find((role) => /^group[0-9]+$/.test(role));\r\n  }\r\n\r\n  /**\r\n   * Checks whether the database is available\r\n   *\r\n   * @return whether the database is available\r\n   */\r\n  private checkDatabaseAvailable(): Observable<boolean> {\r\n    return this.http.head(this.databaseUrl!).pipe(\r\n      mapTo(true),\r\n      catchError((error: HttpErrorResponse) => {\r\n        if (error.status === HttpStatusCode.NotFound) {\r\n          return of(false);\r\n        } else {\r\n          throw error;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether the server is available or in maintenance mode\r\n   *\r\n   * @return whether the server is up\r\n   */\r\n  private checkServerAvailable(): Observable<boolean> {\r\n    return this.http.get(this.upUrl).pipe(\r\n      mapTo(true),\r\n      catchError((error: HttpErrorResponse) => {\r\n        if (error.status === HttpStatusCode.NotFound) {\r\n          return of(false);\r\n        } else {\r\n          throw error;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Check whether the user is currently logged in or not\r\n   *\r\n   * @return true if the user is logged in\r\n   */\r\n  isLoggedIn(): boolean {\r\n    return this.loggedIn;\r\n  }\r\n}\r\n","import { DatabaseModelPart } from './database-model-part';\r\nimport { Equality } from '../shared/equality';\r\nimport { DatabaseRootEntry, DatabaseRootInit, DbType } from './database-entry';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport class DatabaseModel\r\n  implements DatabaseRootInit, DatabaseModelPart, Equality<DatabaseModel>\r\n{\r\n  _id: string;\r\n  _rev?: string;\r\n\r\n  readonly type: string;\r\n\r\n  protected constructor(\r\n    entry: DatabaseRootEntry | undefined,\r\n    init: DatabaseRootInit | undefined,\r\n    type: DbType\r\n  ) {\r\n    if (entry != null) {\r\n      this._id = entry._id;\r\n      this._rev = entry._rev;\r\n      this.type = entry.type;\r\n    } else if (init != null) {\r\n      this._id = init._id ?? DatabaseModel.getId();\r\n      this.type = type;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  toDb(): DatabaseRootEntry {\r\n    return {\r\n      type: this.type,\r\n      _id: this._id,\r\n      _rev: this._rev,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Reset the models database state and add it as a new model if pushed to pouchdb\r\n   */\r\n  resetDatabaseState(): void {\r\n    this._id = DatabaseModel.getId();\r\n    this._rev = undefined;\r\n  }\r\n\r\n  /**\r\n   * Check if two pouchdb models are equal by their id and revision\r\n   *\r\n   * @param other the other pouchdb model\r\n   * @return true if the id and revision are equal\r\n   */\r\n  equals(other: DatabaseModel): boolean {\r\n    if (other == null) {\r\n      return false;\r\n    }\r\n    return this._id === other._id && this._rev === other._rev;\r\n  }\r\n\r\n  private static getId(): string {\r\n    return String(Date.now()) + uuidv4();\r\n  }\r\n}\r\n","import { APP_INITIALIZER, NgModule, Optional, SkipSelf } from '@angular/core';\r\nimport { PouchdbService } from './pouchdb.service';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { CouchdbAuthService } from './couchdb-auth.service';\r\nimport { AuthGuard } from './auth.guard';\r\nimport { AuthService } from './auth.service';\r\nimport { environment } from '../../environments/environment';\r\nimport { LocalAuthService } from './local-auth.service';\r\nimport { LoginGuard } from './login.guard';\r\nimport { Observable } from 'rxjs';\r\n\r\n@NgModule({\r\n  providers: [\r\n    AuthGuard,\r\n    LoginGuard,\r\n    PouchdbService,\r\n    {\r\n      provide: AuthService,\r\n      useClass: environment.localDatabase\r\n        ? LocalAuthService\r\n        : CouchdbAuthService,\r\n    },\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory:\r\n        (authService: AuthService) => (): Observable<void> | Promise<void> =>\r\n          authService.init(),\r\n      deps: [AuthService],\r\n      multi: true,\r\n    },\r\n  ],\r\n  imports: [HttpClientModule],\r\n})\r\nexport class DatabaseModule {\r\n  // see https://angular.io/guide/singleton-services#prevent-reimport-of-the-greetingmodule\r\n  constructor(@Optional() @SkipSelf() databaseModule?: DatabaseModule) {\r\n    if (databaseModule) {\r\n      throw new Error(\r\n        'DatabaseModule is already loaded. Import it in the AppModule only.'\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { PouchdbService } from './pouchdb.service';\r\nimport { Observable } from 'rxjs';\r\nimport { ElementService } from './element.service';\r\nimport { DatabaseModel } from './database-model';\r\nimport { DatabaseRevision, DatabaseRootInit } from './database-entry';\r\nimport { DatabaseConstructor, EntryType } from './database-model-part';\r\n\r\n@Injectable()\r\nexport abstract class DefaultElementService<\r\n  T extends DatabaseModel,\r\n  S extends DatabaseRootInit\r\n> implements ElementService<T, S>\r\n{\r\n  protected abstract get typeName(): string;\r\n\r\n  protected abstract get elementConstructor(): DatabaseConstructor<T, S>;\r\n\r\n  constructor(protected pouchdbService: PouchdbService) {}\r\n\r\n  async add(element: S): Promise<void> {\r\n    await this.pouchdbService.post(\r\n      new this.elementConstructor(undefined, element)\r\n    );\r\n  }\r\n\r\n  async getList(): Promise<EntryType<T>[]> {\r\n    return this.pouchdbService.find<EntryType<T>>(this.typeName, {\r\n      selector: {},\r\n    });\r\n  }\r\n\r\n  async get(id: string): Promise<T & DatabaseRevision> {\r\n    return new this.elementConstructor(\r\n      await this.pouchdbService.get<EntryType<T>>(id),\r\n      undefined\r\n    ) as T & DatabaseRevision;\r\n  }\r\n\r\n  /**\r\n   * Get the changes of a domain\r\n   *\r\n   * @param id the id of the domain\r\n   * @return the changes feed\r\n   */\r\n  getChangesFeed(id: string): Observable<void> {\r\n    return this.pouchdbService.getChangesFeed(id);\r\n  }\r\n\r\n  async delete(id: string): Promise<void> {\r\n    await this.pouchdbService.remove(await this.get(id));\r\n  }\r\n\r\n  protected async save(element: T): Promise<void> {\r\n    await this.pouchdbService.put(element);\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  asapScheduler,\r\n  Observable,\r\n  ReplaySubject,\r\n  Subject,\r\n  Subscription,\r\n} from 'rxjs';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { subscribeOn, tap } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport abstract class ElementLoaderService implements OnDestroy {\r\n  private readonly _loadedObservable: Observable<void>;\r\n  private readonly _loaded: Subject<void>;\r\n  get loaded(): Observable<void> {\r\n    return this._loadedObservable;\r\n  }\r\n\r\n  private readonly routeSubscription: Subscription;\r\n  private _changesFeed?: Subscription;\r\n  protected set changesFeed(changesFeed: Subscription) {\r\n    this._changesFeed = changesFeed;\r\n  }\r\n\r\n  protected constructor(private route: ActivatedRoute) {\r\n    this._loaded = new ReplaySubject<void>(1);\r\n    this._loadedObservable = this._loaded.asObservable();\r\n    this.routeSubscription = this.route.paramMap\r\n      .pipe(\r\n        tap(() => this.checkUnsubscribeChangesFeed()),\r\n        subscribeOn(asapScheduler) // needs to subscribe after the initialization of the subclass\r\n      )\r\n      .subscribe((paramMap) => this.initParams(paramMap));\r\n  }\r\n\r\n  /**\r\n   * Called if the param map observable has new values\r\n   *\r\n   * @param paramMap the param map\r\n   */\r\n  protected abstract initParams(paramMap: ParamMap): void;\r\n\r\n  ngOnDestroy(): void {\r\n    this.checkUnsubscribeChangesFeed();\r\n    this.routeSubscription.unsubscribe();\r\n    this._loaded.complete();\r\n  }\r\n\r\n  private checkUnsubscribeChangesFeed(): void {\r\n    if (this._changesFeed) {\r\n      this._changesFeed.unsubscribe();\r\n      this._changesFeed = undefined;\r\n    }\r\n  }\r\n\r\n  protected elementLoaded(): void {\r\n    this._loaded.next();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { PouchdbService } from './pouchdb.service';\r\n\r\ninterface ImportExportContent {\r\n  identifier: string;\r\n  docs: any[];\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ImportExportService {\r\n  private static identifier = 'SBMD-v1';\r\n\r\n  constructor(private pouchdbService: PouchdbService) {}\r\n\r\n  /**\r\n   * Get the blob that represents the database content.\r\n   */\r\n  async exportDatabase(): Promise<Blob> {\r\n    const allDocs = await this.pouchdbService.getAllDocs();\r\n    const exportContent = allDocs as ImportExportContent;\r\n    exportContent.docs.forEach((doc) => delete doc._rev);\r\n    exportContent.identifier = ImportExportService.identifier;\r\n    return new Blob([JSON.stringify(allDocs, null, 2)], {\r\n      type: 'application/json',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear the current database and import the file\r\n   *\r\n   * @param file the file to import\r\n   */\r\n  async importDatabase(file: File): Promise<void> {\r\n    console.log('Load file');\r\n    const content = await this.importJson(file);\r\n    console.log('File loaded');\r\n    console.log('Check file');\r\n    const docs = this.convertContentToDocs(content);\r\n    console.log('File check');\r\n    console.log('Delete database');\r\n    await this.pouchdbService.clearDatabase();\r\n    console.log('Database deleted');\r\n    console.log('Import docs');\r\n    await this.pouchdbService.importDocs(docs);\r\n    console.log('Docs imported');\r\n    console.log('Finished');\r\n  }\r\n\r\n  /**\r\n   * Check whether the file has the correct content.\r\n   * Throws an error if the file can not be imported.\r\n   *\r\n   * @return the docs to be imported\r\n   */\r\n  private convertContentToDocs(content: unknown): any[] {\r\n    if (\r\n      typeof content === 'object' &&\r\n      'identifier' in content! &&\r\n      'docs' in content\r\n    ) {\r\n      const importContent = content as ImportExportContent;\r\n      if (importContent.identifier === ImportExportService.identifier) {\r\n        return importContent.docs;\r\n      }\r\n    }\r\n    throw new Error('Content has not the correct form. Database not deleted.');\r\n  }\r\n\r\n  /**\r\n   * Imports JSON from a file.\r\n   *\r\n   * @param file the file to read the JSON from\r\n   */\r\n  private importJson(file: File): Promise<unknown> {\r\n    return new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.addEventListener('error', () => {\r\n        reject('Error loading file');\r\n      });\r\n      fileReader.addEventListener(\r\n        'load',\r\n        (event: ProgressEvent<FileReader>) => {\r\n          let json = null;\r\n          try {\r\n            json = JSON.parse(event.target!.result as string);\r\n          } catch (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n          resolve(json);\r\n        }\r\n      );\r\n      fileReader.readAsText(file);\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { AuthService } from './auth.service';\r\nimport { PouchdbService } from './pouchdb.service';\r\nimport { environment } from '../../environments/environment';\r\n\r\n@Injectable()\r\nexport class LocalAuthService implements AuthService {\r\n  constructor(private pouchdbService: PouchdbService) {}\r\n\r\n  set redirectTo(redirectTo: string) {}\r\n\r\n  get username(): undefined {\r\n    return undefined;\r\n  }\r\n\r\n  get group(): undefined {\r\n    return undefined;\r\n  }\r\n\r\n  async init(): Promise<void> {\r\n    this.pouchdbService.init('bmdlFeatureModeler');\r\n    const info = await this.pouchdbService.getDatabaseInfo();\r\n    if (info.doc_count === 0 && environment.exampleData) {\r\n      console.log('No docs detected. Adding default data.');\r\n      await this.pouchdbService.addDefaultData();\r\n    }\r\n  }\r\n\r\n  isLoggedIn(): boolean {\r\n    return true;\r\n  }\r\n\r\n  login(username: string, password: string): Observable<void> {\r\n    return of();\r\n  }\r\n\r\n  logout(): Observable<void> {\r\n    return of();\r\n  }\r\n\r\n  changePassword(newPassword: string): Observable<void> {\r\n    throw new Error('Not implemented');\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  CanActivate,\r\n  Router,\r\n  RouterStateSnapshot,\r\n  UrlTree,\r\n} from '@angular/router';\r\nimport { AuthService } from './auth.service';\r\n\r\n@Injectable()\r\nexport class LoginGuard implements CanActivate {\r\n  constructor(private authService: AuthService, private router: Router) {}\r\n\r\n  canActivate(\r\n    route: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): boolean | UrlTree {\r\n    if (this.authService.isLoggedIn()) {\r\n      return this.router.createUrlTree(['/']);\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n}\r\n","import { Injectable, NgZone } from '@angular/core';\r\nimport PouchDB from 'pouchdb-browser';\r\nimport PouchDBFind from 'pouchdb-find';\r\nimport { DatabaseModel } from './database-model';\r\nimport examples from '../../examples';\r\nimport { from, Observable, Subject } from 'rxjs';\r\nimport { catchError, finalize } from 'rxjs/operators';\r\nimport { environment } from '../../environments/environment';\r\nimport {\r\n  DatabaseRevision,\r\n  DatabaseRootEntry,\r\n  DbId,\r\n  DbType,\r\n} from './database-entry';\r\n\r\nexport enum DatabaseErrors {\r\n  INVALID_NAME = 'Name of database may only contain characters or numbers.',\r\n  MISSING_NAME = 'Database name is missing.',\r\n}\r\n\r\ninterface CouchDBFindResponse {\r\n  docs: unknown[];\r\n  bookmark?: string;\r\n}\r\n\r\n// noinspection JSVoidFunctionReturnValueUsed\r\n@Injectable()\r\nexport class PouchdbService {\r\n  private db?: PouchDB.Database<DatabaseRootEntry>;\r\n  private expired?: () => Promise<void>;\r\n  private error?: () => Promise<void>;\r\n\r\n  constructor(private zone: NgZone) {\r\n    PouchDB.plugin(PouchDBFind);\r\n  }\r\n\r\n  init(\r\n    name: string,\r\n    expired?: () => Promise<void>,\r\n    error?: () => Promise<void>\r\n  ): void {\r\n    if (this.db) {\r\n      void this.db.close();\r\n    }\r\n    this.db = this.getDatabase(name);\r\n    this.expired = expired;\r\n    this.error = error;\r\n  }\r\n\r\n  /**\r\n   * Close the connection to the current database\r\n   */\r\n  async closeDb(): Promise<void> {\r\n    await this.getDb().close();\r\n    this.db = undefined;\r\n    this.expired = undefined;\r\n    this.error = undefined;\r\n  }\r\n\r\n  /**\r\n   * Get the database to connect to\r\n   *\r\n   * @param name the name of the database\r\n   */\r\n  private getDatabase(name: string): PouchDB.Database<DatabaseRootEntry> {\r\n    if (name == null) {\r\n      throw new Error(DatabaseErrors.MISSING_NAME);\r\n    }\r\n    if (!/^[a-zA-Z0-9]+$/.test(name)) {\r\n      throw new Error(DatabaseErrors.INVALID_NAME);\r\n    }\r\n    if (environment.localDatabase) {\r\n      return new PouchDB<DatabaseRootEntry>(name);\r\n    } else {\r\n      const options: PouchDB.Configuration.DatabaseConfiguration = {\r\n        fetch: (fetchUrl, fetchOptions) => {\r\n          (fetchOptions!.headers as Headers).set(\r\n            'X-CouchDB-WWW-Authenticate',\r\n            'Cookie'\r\n          );\r\n          return PouchDB.fetch(fetchUrl, fetchOptions);\r\n        },\r\n        skip_setup: true,\r\n      };\r\n      const url = new URL('/database/' + name, location.origin).href;\r\n      return new PouchDB<DatabaseRootEntry>(url, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get info about the database\r\n   */\r\n  getDatabaseInfo(): Promise<PouchDB.Core.DatabaseInfo> {\r\n    return this.getDb()\r\n      .info()\r\n      .catch((error) => this.handleError(error));\r\n  }\r\n\r\n  async find<T extends DatabaseRootEntry>(\r\n    type: DbType,\r\n    request: PouchDB.Find.FindRequest<T>\r\n  ): Promise<T[]> {\r\n    try {\r\n      let result: PouchDB.Find.FindResponse<T>;\r\n      if (Object.keys(request.selector).length > 0) {\r\n        result = (await this._find({\r\n          ...request,\r\n          selector: {\r\n            $and: [request.selector, { type }],\r\n          },\r\n        })) as PouchDB.Find.FindResponse<T>;\r\n      } else {\r\n        result = (await this._find({\r\n          ...request,\r\n          selector: {\r\n            type,\r\n          },\r\n        })) as PouchDB.Find.FindResponse<T>;\r\n      }\r\n      return result.docs;\r\n    } catch (error) {\r\n      return this.handleError(error);\r\n    }\r\n  }\r\n\r\n  async get<T extends DatabaseRootEntry>(\r\n    id: DbId\r\n  ): Promise<T & DatabaseRevision> {\r\n    try {\r\n      return await this.getDb().get<T>(id);\r\n    } catch (error) {\r\n      return this.handleError(error);\r\n    }\r\n  }\r\n\r\n  async post(model: DatabaseModel): Promise<void> {\r\n    try {\r\n      await this.getDb().post(model.toDb());\r\n    } catch (error) {\r\n      await this.handleError(error);\r\n    }\r\n  }\r\n\r\n  async put<T extends DatabaseModel>(model: T): Promise<void> {\r\n    try {\r\n      await this.getDb().put(model.toDb());\r\n    } catch (error) {\r\n      await this.handleError(error);\r\n    }\r\n  }\r\n\r\n  async remove(model: DatabaseRevision): Promise<void> {\r\n    try {\r\n      await this.getDb().remove(model);\r\n    } catch (error) {\r\n      await this.handleError(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all changes of a specific model\r\n   *\r\n   * @param id the id of the model\r\n   * @return the changes feed, needs to be canceled to stop receiving changes\r\n   */\r\n  getChangesFeed(id: DbId): Observable<void> {\r\n    const subject = new Subject<void>();\r\n    const changes = this.getDb()\r\n      .changes({\r\n        since: 'now',\r\n        live: true,\r\n        doc_ids: [id],\r\n      })\r\n      .on('change', () => this.zone.run(() => subject.next()))\r\n      .on('error', (error) => this.zone.run(() => subject.error(error)));\r\n    return subject.pipe(\r\n      catchError((error) => from(this.handleError(error))),\r\n      finalize(() => changes.cancel())\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Called on error\r\n   */\r\n  private async handleError(error: PouchDB.Core.Error): Promise<never> {\r\n    if (\r\n      error.status === 401 &&\r\n      error.error === 'unauthorized' &&\r\n      this.expired != null\r\n    ) {\r\n      await this.expired();\r\n    }\r\n    if (\r\n      error.status === 500 &&\r\n      error.error === 'internal_server_error' &&\r\n      this.error != null\r\n    ) {\r\n      await this.error();\r\n    }\r\n    throw error;\r\n  }\r\n\r\n  /**\r\n   * Add default data to the database.\r\n   */\r\n  async addDefaultData(): Promise<void> {\r\n    try {\r\n      await this.getDb().bulkDocs(examples as DatabaseRootEntry[]);\r\n    } catch (error) {\r\n      return this.handleError(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all documents from the database\r\n   */\r\n  async clearDatabase(): Promise<void> {\r\n    try {\r\n      const allDocs = await this.getDb().allDocs();\r\n      const toBeDeleted = allDocs.rows.map((row) => {\r\n        return {\r\n          _id: row.id,\r\n          _rev: row.value.rev,\r\n          _deleted: true,\r\n        };\r\n      });\r\n      await this.getDb().bulkDocs(\r\n        toBeDeleted as unknown[] as DatabaseRootEntry[]\r\n      );\r\n    } catch (error) {\r\n      await this.handleError(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export the complete database\r\n   */\r\n  async getAllDocs(): Promise<PouchDB.Find.FindResponse<DatabaseRootEntry>> {\r\n    const docCount = (await this.getDatabaseInfo()).doc_count;\r\n    const allDocs = await this._find({ selector: {} });\r\n    if (docCount !== allDocs.docs.length) {\r\n      throw new Error('Doc count does not match export size');\r\n    }\r\n    return allDocs as PouchDB.Find.FindResponse<DatabaseRootEntry>;\r\n  }\r\n\r\n  async importDocs(docs: DatabaseRootEntry[]): Promise<void> {\r\n    try {\r\n      await this.getDb().bulkDocs(docs);\r\n    } catch (error) {\r\n      await this.handleError(error);\r\n    }\r\n  }\r\n\r\n  private async _find(\r\n    request: PouchDB.Find.FindRequest<{}>\r\n  ): Promise<PouchDB.Find.FindResponse<{}>> {\r\n    const response = await this.getDb().find(request);\r\n    if ('bookmark' in response) {\r\n      const couchDbResponse = response as CouchDBFindResponse;\r\n      let docCount = couchDbResponse.docs.length;\r\n      while (docCount > 0 && couchDbResponse.bookmark != null) {\r\n        const nextPage = await this.getDb().find({\r\n          ...request,\r\n          bookmark: couchDbResponse.bookmark,\r\n        } as never);\r\n        docCount = nextPage.docs.length;\r\n        couchDbResponse.docs = couchDbResponse.docs.concat(nextPage.docs);\r\n        if ('bookmark' in response) {\r\n          const couchDbNextPage = nextPage as CouchDBFindResponse;\r\n          couchDbResponse.bookmark = couchDbNextPage.bookmark;\r\n        } else {\r\n          couchDbResponse.bookmark = undefined;\r\n        }\r\n      }\r\n    }\r\n    return response;\r\n  }\r\n\r\n  /**\r\n   * Get the database, but check whether it is available.\r\n   */\r\n  private getDb(): PouchDB.Database<DatabaseRootEntry> {\r\n    if (this.db == null) {\r\n      throw new Error('Database is not initialized');\r\n    }\r\n    return this.db;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { PouchdbService } from '../../database/pouchdb.service';\r\nimport { BmProcess, BmProcessInit } from './bm-process';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport {\r\n  SituationalFactor,\r\n  SituationalFactorEntry,\r\n  SituationalFactorInit,\r\n} from '../method-elements/situational-factor/situational-factor';\r\nimport { ModuleService } from '../module-api/module.service';\r\nimport { Decision } from './decision';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\nimport { DbId } from '../../database/database-entry';\r\nimport { Domain } from '../knowledge/domain';\r\nimport { Selection, SelectionInit } from '../development-method/selection';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class BmProcessService extends DefaultElementService<\r\n  BmProcess,\r\n  BmProcessInit\r\n> {\r\n  protected readonly typeName = BmProcess.typeName;\r\n\r\n  protected readonly elementConstructor = BmProcess;\r\n\r\n  constructor(\r\n    private moduleService: ModuleService,\r\n    pouchdbService: PouchdbService\r\n  ) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  /**\r\n   * Finish the initialization process of a bm process, i.e.,\r\n   * the context selection is finished.\r\n   *\r\n   * @param id the id of the bm process\r\n   */\r\n  async finishInitialization(id: DbId): Promise<void> {\r\n    const dbProcess = await this.get(id);\r\n    dbProcess.finishInitialization();\r\n    await this.save(dbProcess);\r\n  }\r\n\r\n  /**\r\n   * Update the domains of the bm process\r\n   *\r\n   * @param id the id of the bm process to update\r\n   * @param domains the domains to set for the bm process\r\n   */\r\n  async updateDomains(id: DbId, domains: Domain[]): Promise<void> {\r\n    const dbProcess = await this.get(id);\r\n    dbProcess.domains = domains;\r\n    await this.save(dbProcess);\r\n  }\r\n\r\n  async updateSituationalFactors(\r\n    id: DbId,\r\n    situationalFactors: SelectionInit<SituationalFactorInit>[]\r\n  ): Promise<void> {\r\n    const dbProcess = await this.get(id);\r\n    dbProcess.situationalFactors = situationalFactors.map(\r\n      (selection) =>\r\n        new Selection<SituationalFactor>(\r\n          undefined,\r\n          selection,\r\n          SituationalFactor\r\n        )\r\n    );\r\n    await this.save(dbProcess);\r\n  }\r\n\r\n  /**\r\n   * Save the bm process diagram, maybe together with new decisions.\r\n   *\r\n   * @param id the id of the bm process\r\n   * @param processDiagram the process diagram\r\n   * @param decisions the decisions\r\n   */\r\n  async saveBmProcessDiagram(\r\n    id: DbId,\r\n    processDiagram: string,\r\n    decisions?: { [elementId: string]: Decision }\r\n  ): Promise<void> {\r\n    const dbProcess = await this.get(id);\r\n    dbProcess.processDiagram = processDiagram;\r\n    if (decisions != null) {\r\n      dbProcess.updateDecisions(decisions);\r\n    }\r\n    await this.save(dbProcess);\r\n  }\r\n\r\n  /**\r\n   * Calculate the distance of a process context to provided situational factors\r\n   *\r\n   * @param process the bm process\r\n   * @param provided the provided situational factors\r\n   * @return the distance\r\n   */\r\n  distanceToContext(\r\n    process: BmProcess,\r\n    provided: (SituationalFactor | SituationalFactorEntry)[]\r\n  ): number {\r\n    const map = SituationalFactor.createMap(provided);\r\n    const { missing, incorrect, low } = process.checkMatchByFactor(map);\r\n    let distance = incorrect.length;\r\n    low.forEach((factor) => {\r\n      const internalDistance =\r\n        factor.factor.values.indexOf(factor.value) -\r\n        factor.factor.values.indexOf(\r\n          map[factor.factor.list][factor.factor.name]\r\n        );\r\n      distance += internalDistance / factor.factor.values.length;\r\n    });\r\n    const correct =\r\n      process.situationalFactors.length -\r\n      missing.length -\r\n      incorrect.length -\r\n      low.length;\r\n    return distance - correct;\r\n  }\r\n\r\n  /**\r\n   * Check whether the step decisions of a step of a decision are all correctly filled in.\r\n   *\r\n   * @param decision the decision\r\n   * @return whether the step decisions are all correctly filled in\r\n   */\r\n  checkDecisionStepArtifacts(decision: Decision): boolean {\r\n    for (let i = 0; i < decision.method.executionSteps.length; i++) {\r\n      const step = decision.method.executionSteps[i];\r\n      const method = this.moduleService.getModuleMethod(\r\n        step.module,\r\n        step.method\r\n      );\r\n      if (method.createDecisionConfigurationForm != null) {\r\n        const form = method.createDecisionConfigurationForm(\r\n          decision.stepDecisions[i]\r\n        );\r\n        if (!form.valid) {\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import { DatabaseModel } from '../../database/database-model';\r\nimport {\r\n  SituationalFactor,\r\n  SituationalFactorEntry,\r\n} from '../method-elements/situational-factor/situational-factor';\r\nimport { DevelopmentMethod } from '../development-method/development-method';\r\nimport { Decision, DecisionEntry, DecisionInit } from './decision';\r\nimport { Domain, DomainEntry, DomainInit } from '../knowledge/domain';\r\nimport { Selection, SelectionEntry } from '../development-method/selection';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\n\r\nexport interface BmProcessInit extends DatabaseRootInit {\r\n  initial?: boolean;\r\n  name: string;\r\n  processDiagram?: string;\r\n  domains?: DomainInit[];\r\n  situationalFactors?: Selection<SituationalFactor>[];\r\n  decisions?: { [elementId: string]: Decision };\r\n}\r\n\r\nexport interface BmProcessEntry extends DatabaseRootEntry {\r\n  initial: boolean;\r\n  name: string;\r\n  processDiagram: string;\r\n  domains: DomainEntry[];\r\n  situationalFactors: SelectionEntry<SituationalFactorEntry>[];\r\n  decisions: { [elementId: string]: DecisionEntry };\r\n}\r\n\r\nexport class BmProcess extends DatabaseModel {\r\n  static readonly typeName = 'BmProcess';\r\n\r\n  initial = true;\r\n\r\n  name: string;\r\n\r\n  processDiagram: string;\r\n\r\n  domains: Domain[] = [];\r\n  situationalFactors: Selection<SituationalFactor>[] = [];\r\n\r\n  decisions: { [elementId: string]: Decision } = {};\r\n\r\n  constructor(\r\n    entry: BmProcessEntry | undefined,\r\n    init: BmProcessInit | undefined\r\n  ) {\r\n    super(entry, init, BmProcess.typeName);\r\n    const element = entry ?? init;\r\n    this.initial = element.initial ?? this.initial;\r\n    this.name = element.name;\r\n    this.processDiagram = element.processDiagram;\r\n    if (entry != null) {\r\n      this.domains =\r\n        entry.domains?.map((domain) => new Domain(domain, undefined)) ??\r\n        this.domains;\r\n      this.situationalFactors =\r\n        entry.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              selection,\r\n              undefined,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n      if (entry.decisions) {\r\n        Object.entries(entry.decisions).forEach(\r\n          ([elementId, decision]) =>\r\n            (this.decisions[elementId] = new Decision(decision, undefined))\r\n        );\r\n      }\r\n    } else if (init != null) {\r\n      this.domains =\r\n        init.domains?.map((domain) => new Domain(undefined, domain)) ??\r\n        this.domains;\r\n      this.situationalFactors =\r\n        init.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              undefined,\r\n              selection,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n      if (init.decisions) {\r\n        Object.entries(init.decisions).forEach(\r\n          ([elementId, decision]) =>\r\n            (this.decisions[elementId] = new Decision(undefined, decision))\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  checkMatchByFactor(factorMap: {\r\n    [listName: string]: { [factorName: string]: string };\r\n  }): {\r\n    missing: SituationalFactor[];\r\n    low: SituationalFactor[];\r\n    incorrect: SituationalFactor[];\r\n  } {\r\n    const result: {\r\n      missing: SituationalFactor[];\r\n      low: SituationalFactor[];\r\n      incorrect: SituationalFactor[];\r\n    } = {\r\n      missing: [],\r\n      low: [],\r\n      incorrect: [],\r\n    };\r\n    this.situationalFactors\r\n      .map((element) => element.element)\r\n      .forEach((factor) => {\r\n        if (\r\n          factor.factor.list in factorMap &&\r\n          factor.factor.name in factorMap[factor.factor.list]\r\n        ) {\r\n          const value = factorMap[factor.factor.list][factor.factor.name];\r\n          if (factor.value !== value) {\r\n            if (factor.factor.ordered) {\r\n              if (\r\n                factor.factor.values.indexOf(factor.value) >\r\n                factor.factor.values.indexOf(value)\r\n              ) {\r\n                result.low.push(factor);\r\n              }\r\n            } else {\r\n              result.incorrect.push(factor);\r\n            }\r\n          }\r\n        } else {\r\n          result.missing.push(factor);\r\n        }\r\n      });\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Check for match between context and given factors\r\n   *\r\n   * @param factorMap the given factors that should fulfill the context of this process\r\n   * @returns factor names that are missing, have too low or incorrect values\r\n   */\r\n  checkMatch(factorMap: {\r\n    [listName: string]: { [factorName: string]: string };\r\n  }): { missing: string[]; low: string[]; incorrect: string[] } {\r\n    const result = this.checkMatchByFactor(factorMap);\r\n    return {\r\n      low: result.low.map((factor) => factor.factor.name),\r\n      incorrect: result.incorrect.map((factor) => factor.factor.name),\r\n      missing: result.missing.map((factor) => factor.factor.name),\r\n    };\r\n  }\r\n\r\n  addDecision(id: string, method: DevelopmentMethod): void {\r\n    this.decisions[id] = new Decision(undefined, {\r\n      method: method,\r\n      stakeholders: {},\r\n      inputArtifacts: {},\r\n      outputArtifacts: {},\r\n      tools: {},\r\n      stepDecisions: method.executionSteps.map(() => null),\r\n    });\r\n  }\r\n\r\n  removeDecision(id: string): void {\r\n    delete this.decisions[id];\r\n  }\r\n\r\n  /**\r\n   * Finish the initialization process of a bm process, i.e.,\r\n   * the context selection is finished.\r\n   */\r\n  finishInitialization(): void {\r\n    this.initial = false;\r\n  }\r\n\r\n  /**\r\n   * Update the decisions of this bm process.\r\n   *\r\n   * @param decisions the new decisions\r\n   */\r\n  updateDecisions(decisions: { [elementId: string]: DecisionInit }): void {\r\n    this.decisions = {};\r\n    Object.entries(decisions).forEach(\r\n      ([elementId, decision]) =>\r\n        (this.decisions[elementId] = new Decision(undefined, decision))\r\n    );\r\n  }\r\n\r\n  toDb(): BmProcessEntry {\r\n    const decisions: { [elementId: string]: DecisionEntry } = {};\r\n    Object.entries(this.decisions).forEach(([id, decision]) => {\r\n      decisions[id] = decision.toDb();\r\n    });\r\n    return {\r\n      ...super.toDb(),\r\n      initial: this.initial,\r\n      name: this.name,\r\n      processDiagram: this.processDiagram,\r\n      domains: this.domains.map((domain) => domain.toDb()),\r\n      situationalFactors: this.situationalFactors.map((selection) =>\r\n        selection.toDb()\r\n      ),\r\n      decisions,\r\n    };\r\n  }\r\n}\r\n","import {\r\n  DevelopmentMethod,\r\n  DevelopmentMethodEntry,\r\n} from '../development-method/development-method';\r\nimport { Artifact, ArtifactEntry } from '../method-elements/artifact/artifact';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderEntry,\r\n} from '../method-elements/stakeholder/stakeholder';\r\nimport { Tool, ToolEntry } from '../method-elements/tool/tool';\r\nimport {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-elements/method-element';\r\nimport { MultipleSelection } from '../development-method/multiple-selection';\r\nimport { Equality } from '../../shared/equality';\r\nimport { equalsList } from '../../shared/utils';\r\nimport {\r\n  DatabaseConstructor,\r\n  DatabaseModelPart,\r\n  EntryType,\r\n  InitType,\r\n} from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface ElementSummary<T extends MethodElement> {\r\n  list: string;\r\n  elements: T[];\r\n  multiple: boolean;\r\n  multipleElements: boolean;\r\n}\r\n\r\nexport class GroupSummary<T extends MethodElement> {\r\n  elements: ElementSummary<T>[];\r\n}\r\n\r\nexport interface GroupSelectionInit<T extends MethodElementInit>\r\n  extends DatabaseInit {\r\n  selectedGroup?: number;\r\n  elements?: T[][];\r\n}\r\n\r\nexport interface GroupSelectionEntry<T extends MethodElementEntry>\r\n  extends DatabaseEntry {\r\n  selectedGroup: number;\r\n  elements: T[][];\r\n}\r\n\r\nexport class GroupSelection<T extends MethodElement>\r\n  implements\r\n    GroupSelectionInit<T>,\r\n    Equality<GroupSelection<T>>,\r\n    DatabaseModelPart\r\n{\r\n  selectedGroup: number = null;\r\n  elements: T[][] = null;\r\n\r\n  constructor(\r\n    entry: GroupSelectionEntry<EntryType<T>>,\r\n    init: GroupSelectionInit<InitType<T> & MethodElementInit>,\r\n    databaseConstructor: DatabaseConstructor<T>\r\n  ) {\r\n    this.selectedGroup = (entry ?? init).selectedGroup ?? this.selectedGroup;\r\n    if (entry != null) {\r\n      this.elements =\r\n        entry.elements?.map(\r\n          (element) =>\r\n            element?.map((e) =>\r\n              e ? new databaseConstructor(e, undefined) : undefined\r\n            ) ?? undefined\r\n        ) ?? this.elements;\r\n    } else if (init != null) {\r\n      this.elements =\r\n        init.elements?.map(\r\n          (element) =>\r\n            element?.map((e) =>\r\n              e ? new databaseConstructor(undefined, e) : undefined\r\n            ) ?? undefined\r\n        ) ?? this.elements;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  update(\r\n    groupSelection: Partial<GroupSelection<T>>,\r\n    createElement: (element: Partial<T>) => T\r\n  ): void {\r\n    Object.assign(this, groupSelection);\r\n    this.elements = this.elements\r\n      ? this.elements.map((element) =>\r\n          element ? element.map((e) => (e ? createElement(e) : null)) : null\r\n        )\r\n      : null;\r\n  }\r\n\r\n  isComplete(providedByMethod: MultipleSelection<T>[][]): boolean {\r\n    if (providedByMethod.length === 0) {\r\n      return true;\r\n    }\r\n    if (this.selectedGroup === null || this.selectedGroup === undefined) {\r\n      return false;\r\n    }\r\n    const group = providedByMethod[this.selectedGroup];\r\n    return group.every((element, index) => {\r\n      if (element.element || element.multiple) {\r\n        return true;\r\n      }\r\n      return this.elements[index] && !!this.elements[index][0];\r\n    });\r\n  }\r\n\r\n  getList(providedByMethod: MultipleSelection<T>[][]): GroupSummary<T> {\r\n    const summary: GroupSummary<T> = {\r\n      elements: [],\r\n    };\r\n    if (this.selectedGroup === null || this.selectedGroup === undefined) {\r\n      return summary;\r\n    }\r\n    const group = providedByMethod[this.selectedGroup];\r\n    summary.elements = group.map((element, index) => {\r\n      const part = {\r\n        list: element.list,\r\n        elements: [],\r\n        multiple: element.multiple,\r\n        multipleElements: element.multipleElements,\r\n      };\r\n      if (element.element) {\r\n        part.elements = [element.element];\r\n      } else if (this.elements) {\r\n        part.elements = this.elements[index];\r\n      }\r\n      return part;\r\n    });\r\n    return summary;\r\n  }\r\n\r\n  toDb(): GroupSelectionEntry<ReturnType<T['toDb']>> {\r\n    return {\r\n      selectedGroup: this.selectedGroup,\r\n      elements: this.elements\r\n        ? this.elements.map((element) =>\r\n            element\r\n              ? element.map((e) =>\r\n                  e ? (e.toDb() as ReturnType<T['toDb']>) : null\r\n                )\r\n              : null\r\n          )\r\n        : null,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Checks whether this group selection equals another\r\n   *\r\n   * @param other the other group selection\r\n   * @return whether they are equal\r\n   */\r\n  equals(other: GroupSelection<T>): boolean {\r\n    if (other == null || other.selectedGroup !== this.selectedGroup) {\r\n      return false;\r\n    }\r\n    if (other.elements === null && this.elements === null) {\r\n      return true;\r\n    }\r\n    if (other.elements === null || this.elements === null) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < this.elements.length; i++) {\r\n      const thisElementGroup = this.elements[i];\r\n      const otherElementGroup = other.elements[i];\r\n      if (!equalsList(thisElementGroup, otherElementGroup)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\nexport interface DecisionInit extends DatabaseInit {\r\n  method: DevelopmentMethod;\r\n  inputArtifacts: GroupSelectionInit<Artifact>;\r\n  outputArtifacts: GroupSelectionInit<Artifact>;\r\n  stakeholders: GroupSelectionInit<Stakeholder>;\r\n  tools: GroupSelectionInit<Tool>;\r\n\r\n  stepDecisions: any[];\r\n}\r\n\r\nexport interface DecisionEntry extends DatabaseEntry {\r\n  method: DevelopmentMethodEntry;\r\n  inputArtifacts: GroupSelectionEntry<ArtifactEntry>;\r\n  outputArtifacts: GroupSelectionEntry<ArtifactEntry>;\r\n  stakeholders: GroupSelectionEntry<StakeholderEntry>;\r\n  tools: GroupSelectionEntry<ToolEntry>;\r\n  stepDecisions: any[];\r\n}\r\n\r\nexport class Decision implements DatabaseModelPart {\r\n  method: DevelopmentMethod;\r\n  inputArtifacts: GroupSelection<Artifact>;\r\n  outputArtifacts: GroupSelection<Artifact>;\r\n  stakeholders: GroupSelection<Stakeholder>;\r\n  tools: GroupSelection<Tool>;\r\n\r\n  stepDecisions: any[];\r\n\r\n  constructor(entry: DecisionEntry, init: DecisionInit) {\r\n    if (entry != null) {\r\n      this.method = new DevelopmentMethod(entry.method, undefined);\r\n      this.inputArtifacts = new GroupSelection<Artifact>(\r\n        entry.inputArtifacts,\r\n        undefined,\r\n        Artifact\r\n      );\r\n      this.outputArtifacts = new GroupSelection<Artifact>(\r\n        entry.outputArtifacts,\r\n        undefined,\r\n        Artifact\r\n      );\r\n      this.stakeholders = new GroupSelection<Stakeholder>(\r\n        entry.stakeholders,\r\n        undefined,\r\n        Stakeholder\r\n      );\r\n      this.tools = new GroupSelection<Tool>(entry.tools, undefined, Tool);\r\n    } else if (init != null) {\r\n      this.method = new DevelopmentMethod(undefined, init.method);\r\n      this.inputArtifacts = new GroupSelection<Artifact>(\r\n        undefined,\r\n        init.inputArtifacts,\r\n        Artifact\r\n      );\r\n      this.outputArtifacts = new GroupSelection<Artifact>(\r\n        undefined,\r\n        init.outputArtifacts,\r\n        Artifact\r\n      );\r\n      this.stakeholders = new GroupSelection<Stakeholder>(\r\n        undefined,\r\n        init.stakeholders,\r\n        Stakeholder\r\n      );\r\n      this.tools = new GroupSelection<Tool>(undefined, init.tools, Tool);\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n    this.stepDecisions = (entry ?? init).stepDecisions;\r\n  }\r\n\r\n  update(decision: Partial<Decision>): void {\r\n    Object.assign(this, decision);\r\n    this.method = new DevelopmentMethod(undefined, this.method);\r\n    this.inputArtifacts = new GroupSelection<Artifact>(\r\n      undefined,\r\n      this.inputArtifacts,\r\n      Artifact\r\n    );\r\n    this.outputArtifacts = new GroupSelection<Artifact>(\r\n      undefined,\r\n      this.outputArtifacts,\r\n      Artifact\r\n    );\r\n    this.stakeholders = new GroupSelection<Stakeholder>(\r\n      undefined,\r\n      this.stakeholders,\r\n      Stakeholder\r\n    );\r\n    this.tools = new GroupSelection<Tool>(undefined, this.tools, Tool);\r\n  }\r\n\r\n  isComplete(): boolean {\r\n    return (\r\n      this.inputArtifacts.isComplete(this.method.inputArtifacts) &&\r\n      this.outputArtifacts.isComplete(this.method.outputArtifacts) &&\r\n      this.stakeholders.isComplete(this.method.stakeholders) &&\r\n      this.tools.isComplete(this.method.tools)\r\n    );\r\n  }\r\n\r\n  getSummary(): {\r\n    inputArtifacts: GroupSummary<Artifact>;\r\n    outputArtifacts: GroupSummary<Artifact>;\r\n    stakeholders: GroupSummary<Stakeholder>;\r\n    tools: GroupSummary<Tool>;\r\n  } {\r\n    return {\r\n      inputArtifacts: this.inputArtifacts.getList(this.method.inputArtifacts),\r\n      outputArtifacts: this.outputArtifacts.getList(\r\n        this.method.outputArtifacts\r\n      ),\r\n      stakeholders: this.stakeholders.getList(this.method.stakeholders),\r\n      tools: this.tools.getList(this.method.tools),\r\n    };\r\n  }\r\n\r\n  toDb(): DecisionEntry {\r\n    return {\r\n      method: this.method.toDb(),\r\n      inputArtifacts: this.inputArtifacts.toDb(),\r\n      outputArtifacts: this.outputArtifacts.toDb(),\r\n      stakeholders: this.stakeholders.toDb(),\r\n      tools: this.tools.toDb(),\r\n      stepDecisions: this.stepDecisions,\r\n    };\r\n  }\r\n}\r\n","import { Equality } from '../../shared/equality';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface ArtifactMappingInit extends DatabaseInit {\r\n  output: boolean;\r\n  step?: number;\r\n  group?: number;\r\n  artifact: number;\r\n}\r\n\r\nexport interface ArtifactMappingEntry extends DatabaseEntry {\r\n  output: boolean;\r\n  step?: number;\r\n  group?: number;\r\n  artifact: number;\r\n}\r\n\r\nexport class ArtifactMapping\r\n  implements ArtifactMappingInit, Equality<ArtifactMapping>, DatabaseModelPart\r\n{\r\n  output: boolean;\r\n  step?: number;\r\n  group?: number;\r\n  artifact: number;\r\n\r\n  constructor(\r\n    entry: ArtifactMappingEntry | undefined,\r\n    init: ArtifactMappingInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.output = element.output;\r\n    this.step = element.step;\r\n    this.group = element.group;\r\n    this.artifact = element.artifact;\r\n  }\r\n\r\n  toDb(): ArtifactMappingEntry {\r\n    const pouchDb: ArtifactMappingEntry = {\r\n      artifact: this.artifact,\r\n      output: this.output,\r\n    };\r\n    if (!this.output) {\r\n      pouchDb.step = this.step;\r\n    } else {\r\n      pouchDb.group = this.group;\r\n    }\r\n    return pouchDb;\r\n  }\r\n\r\n  equals(other: ArtifactMapping): boolean {\r\n    if (other == null || this.output !== other.output) {\r\n      return false;\r\n    }\r\n    if (this.output) {\r\n      return this.group === other.group && this.artifact === other.artifact;\r\n    } else {\r\n      return this.step === other.step && this.artifact === other.artifact;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  DevelopmentMethod,\r\n  DevelopmentMethodEntry,\r\n  DevelopmentMethodInit,\r\n} from './development-method';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { Type } from '../method-elements/type/type';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\nimport { PouchdbService } from '../../database/pouchdb.service';\r\nimport { ModuleService } from '../module-api/module.service';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class DevelopmentMethodService extends DefaultElementService<\r\n  DevelopmentMethod,\r\n  DevelopmentMethodInit\r\n> {\r\n  protected readonly typeName = DevelopmentMethod.typeName;\r\n\r\n  protected readonly elementConstructor = DevelopmentMethod;\r\n\r\n  constructor(\r\n    private moduleService: ModuleService,\r\n    pouchdbService: PouchdbService\r\n  ) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  /**\r\n   * Get a list of development methods that have the needed types, but not the forbidden ones.\r\n   *\r\n   * @param needed needed types\r\n   * @param forbidden forbidden types\r\n   */\r\n  async getValidDevelopmentMethods(\r\n    needed: { list: string; element: { _id: string; name: string } }[],\r\n    forbidden: { list: string; element: { _id: string; name: string } }[]\r\n  ): Promise<DevelopmentMethodEntry[]> {\r\n    return (\r\n      await this.pouchdbService.find<DevelopmentMethodEntry>(\r\n        DevelopmentMethod.typeName,\r\n        {\r\n          selector: {},\r\n        }\r\n      )\r\n    ).filter((method) => Type.validTypes(method.types, needed, forbidden));\r\n  }\r\n\r\n  /**\r\n   * Update the development method.\r\n   *\r\n   * @param id id of the development method\r\n   * @param developmentMethod the new values of the object (values will be copied)\r\n   */\r\n  async update(\r\n    id: string,\r\n    developmentMethod: Partial<DevelopmentMethod>\r\n  ): Promise<void> {\r\n    const method = await this.get(id);\r\n    method.update(developmentMethod);\r\n    await this.save(method);\r\n  }\r\n\r\n  /**\r\n   * Checks whether the development method is correctly defined\r\n   *\r\n   * @param developmentMethod the development method to check\r\n   * @return true if the development method is correctly defined and can\r\n   * be used in processes\r\n   */\r\n  isCorrectlyDefined(developmentMethod: DevelopmentMethod): boolean {\r\n    return this.isExecutionStepsCorrectlyDefined(developmentMethod);\r\n  }\r\n\r\n  /**\r\n   * Checks whether the execution steps of the development method are\r\n   * correctly defined\r\n   *\r\n   * @param developmentMethod the development method to check\r\n   * @return true if the development method's execution steps are correctly\r\n   * defined\r\n   */\r\n  isExecutionStepsCorrectlyDefined(\r\n    developmentMethod: DevelopmentMethod\r\n  ): boolean {\r\n    return developmentMethod.executionSteps.every((executionStep, index) =>\r\n      this.isExecutionStepCorrectlyDefined(developmentMethod, index)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether a single execution step is correctly defined\r\n   *\r\n   * @param developmentMethod the development method to check\r\n   * @param step the step to check\r\n   * @return true if the execution step is correctly defined\r\n   */\r\n  isExecutionStepCorrectlyDefined(\r\n    developmentMethod: DevelopmentMethod,\r\n    step: number\r\n  ): boolean {\r\n    return (\r\n      this.hasInputArtifactForStep(developmentMethod, step) &&\r\n      this.isPredefinedInputDefined(developmentMethod, step)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether a single execution step has predefined input defined\r\n   * or does not need it\r\n   *\r\n   * @param developmentMethod the development method to check\r\n   * @param step the step to check\r\n   * @return true if the execution step has predefined input defined or does not\r\n   * need it\r\n   */\r\n  isPredefinedInputDefined(\r\n    developmentMethod: DevelopmentMethod,\r\n    step: number\r\n  ): boolean {\r\n    const executionStep = developmentMethod.executionSteps[step];\r\n    const method = this.moduleService.getModuleMethod(\r\n      executionStep.module,\r\n      executionStep.method\r\n    );\r\n    if (method.createConfigurationForm != null) {\r\n      const form = method.createConfigurationForm(\r\n        executionStep.predefinedInput\r\n      );\r\n      return form.valid;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Checks whether all input artifacts can be gathered through any input group\r\n   * or a previous step\r\n   *\r\n   * @param developmentMethod the development method to check\r\n   * @param step the step to check\r\n   * @return true if the execution step will have input artifacts available\r\n   */\r\n  hasInputArtifactForStep(\r\n    developmentMethod: DevelopmentMethod,\r\n    step: number\r\n  ): boolean {\r\n    const executionStep = developmentMethod.executionSteps[step];\r\n    const method = this.moduleService.getModuleMethod(\r\n      executionStep.module,\r\n      executionStep.method\r\n    );\r\n    const artifactInputs = developmentMethod.checkStepInputArtifacts(\r\n      step,\r\n      method.input.length\r\n    );\r\n    return artifactInputs.every((artifactInput) => {\r\n      if (artifactInput.length === 0) {\r\n        return false;\r\n      }\r\n      return (\r\n        artifactInput\r\n          .filter((input) => input.isStep)\r\n          .some((input) => input.index < step) ||\r\n        developmentMethod.inputArtifacts.every(\r\n          (group, index) =>\r\n            artifactInput.filter(\r\n              (input) => !input.isStep && input.index === index\r\n            ).length > 0\r\n        )\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { DatabaseModel } from '../../database/database-model';\r\nimport { Author, AuthorEntry, AuthorInit } from '../../model/author';\r\nimport {\r\n  SituationalFactor,\r\n  SituationalFactorEntry,\r\n  SituationalFactorInit,\r\n} from '../method-elements/situational-factor/situational-factor';\r\nimport {\r\n  Artifact,\r\n  ArtifactEntry,\r\n  ArtifactInit,\r\n} from '../method-elements/artifact/artifact';\r\nimport { Type, TypeEntry, TypeInit } from '../method-elements/type/type';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderEntry,\r\n  StakeholderInit,\r\n} from '../method-elements/stakeholder/stakeholder';\r\nimport { Tool, ToolEntry, ToolInit } from '../method-elements/tool/tool';\r\nimport {\r\n  MultipleSelection,\r\n  MultipleSelectionEntry,\r\n  MultipleSelectionInit,\r\n} from './multiple-selection';\r\nimport {\r\n  ExecutionStep,\r\n  ExecutionStepEntry,\r\n  ExecutionStepInit,\r\n} from './execution-step';\r\nimport {\r\n  MultipleMappingSelection,\r\n  MultipleMappingSelectionEntry,\r\n  MultipleMappingSelectionInit,\r\n} from './multiple-mapping-selection';\r\nimport { Selection, SelectionEntry, SelectionInit } from './selection';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\n\r\nexport interface DevelopmentMethodInit extends DatabaseRootInit {\r\n  name: string;\r\n  description?: string;\r\n  examples?: string[];\r\n  author: AuthorInit;\r\n\r\n  types?: SelectionInit<TypeInit>[];\r\n  situationalFactors?: SelectionInit<SituationalFactorInit>[];\r\n\r\n  inputArtifacts?: MultipleMappingSelectionInit<ArtifactInit>[][];\r\n  outputArtifacts?: MultipleSelectionInit<ArtifactInit>[][];\r\n  stakeholders?: MultipleSelectionInit<StakeholderInit>[][];\r\n  tools?: MultipleSelectionInit<ToolInit>[][];\r\n\r\n  executionSteps?: ExecutionStepInit[];\r\n}\r\n\r\nexport interface DevelopmentMethodEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  description: string;\r\n  examples: string[];\r\n  author: AuthorEntry;\r\n\r\n  types: SelectionEntry<TypeEntry>[];\r\n  situationalFactors: SelectionEntry<SituationalFactorEntry>[];\r\n\r\n  inputArtifacts: MultipleMappingSelectionEntry<ArtifactEntry>[][];\r\n  outputArtifacts: MultipleSelectionEntry<ArtifactEntry>[][];\r\n  stakeholders: MultipleSelectionEntry<StakeholderEntry>[][];\r\n  tools: MultipleSelectionEntry<ToolEntry>[][];\r\n\r\n  executionSteps: ExecutionStepEntry[];\r\n}\r\n\r\nexport class DevelopmentMethod\r\n  extends DatabaseModel\r\n  implements DevelopmentMethodInit\r\n{\r\n  static readonly typeName = 'DevelopmentMethod';\r\n\r\n  name: string;\r\n  description: string;\r\n  examples: string[] = [];\r\n  author: Author;\r\n\r\n  types: Selection<Type>[] = [];\r\n  situationalFactors: Selection<SituationalFactor>[] = [];\r\n\r\n  inputArtifacts: MultipleMappingSelection<Artifact>[][] = [];\r\n  outputArtifacts: MultipleSelection<Artifact>[][] = [];\r\n  stakeholders: MultipleSelection<Stakeholder>[][] = [];\r\n  tools: MultipleSelection<Tool>[][] = [];\r\n\r\n  executionSteps: ExecutionStep[] = [];\r\n\r\n  constructor(\r\n    entry: DevelopmentMethodEntry | undefined,\r\n    init: DevelopmentMethodInit | undefined\r\n  ) {\r\n    super(entry, init, DevelopmentMethod.typeName);\r\n    const element = entry ?? init;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n    this.examples = element.examples ?? this.examples;\r\n    if (entry != null) {\r\n      this.author = new Author(entry.author, undefined);\r\n      this.types =\r\n        entry.types?.map(\r\n          (selection) => new Selection<Type>(selection, undefined, Type)\r\n        ) ?? this.types;\r\n      this.situationalFactors =\r\n        entry.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              selection,\r\n              undefined,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n      this.inputArtifacts =\r\n        entry.inputArtifacts?.map((group) =>\r\n          group.map(\r\n            (inputArtifact) =>\r\n              new MultipleMappingSelection(inputArtifact, undefined, Artifact)\r\n          )\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        entry.outputArtifacts?.map((group) =>\r\n          group.map(\r\n            (outputArtifact) =>\r\n              new MultipleSelection(outputArtifact, undefined, Artifact)\r\n          )\r\n        ) ?? this.outputArtifacts;\r\n      this.stakeholders =\r\n        entry.stakeholders?.map((group) =>\r\n          group.map(\r\n            (stakeholder) =>\r\n              new MultipleSelection(stakeholder, undefined, Stakeholder)\r\n          )\r\n        ) ?? this.stakeholders;\r\n      this.tools =\r\n        entry.tools?.map((group) =>\r\n          group.map((tool) => new MultipleSelection(tool, undefined, Tool))\r\n        ) ?? this.tools;\r\n      this.executionSteps =\r\n        entry.executionSteps?.map(\r\n          (executionStep) => new ExecutionStep(executionStep, undefined)\r\n        ) ?? this.executionSteps;\r\n    } else {\r\n      this.author = new Author(undefined, init.author);\r\n      this.types =\r\n        init.types?.map(\r\n          (selection) => new Selection<Type>(undefined, selection, Type)\r\n        ) ?? this.types;\r\n      this.situationalFactors =\r\n        init.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              undefined,\r\n              selection,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n      this.inputArtifacts =\r\n        init.inputArtifacts?.map((group) =>\r\n          group.map(\r\n            (inputArtifact) =>\r\n              new MultipleMappingSelection(undefined, inputArtifact, Artifact)\r\n          )\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        init.outputArtifacts?.map((group) =>\r\n          group.map(\r\n            (outputArtifact) =>\r\n              new MultipleSelection(undefined, outputArtifact, Artifact)\r\n          )\r\n        ) ?? this.outputArtifacts;\r\n      this.stakeholders =\r\n        init.stakeholders?.map((group) =>\r\n          group.map(\r\n            (stakeholder) =>\r\n              new MultipleSelection(undefined, stakeholder, Stakeholder)\r\n          )\r\n        ) ?? this.stakeholders;\r\n      this.tools =\r\n        init.tools?.map((group) =>\r\n          group.map((tool) => new MultipleSelection(undefined, tool, Tool))\r\n        ) ?? this.tools;\r\n      this.executionSteps =\r\n        init.executionSteps?.map(\r\n          (executionStep) => new ExecutionStep(undefined, executionStep)\r\n        ) ?? this.executionSteps;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update this development method with new values\r\n   *\r\n   * @param developmentMethod the new values of this development method (values will be copied to the current object)\r\n   */\r\n  update(developmentMethod: Partial<DevelopmentMethod>): void {\r\n    Object.assign(this, developmentMethod);\r\n    this.author = new Author(undefined, this.author);\r\n    this.types = this.types.map(\r\n      (selection) => new Selection(undefined, selection, Type)\r\n    );\r\n    this.situationalFactors = this.situationalFactors.map(\r\n      (selection) => new Selection(undefined, selection, SituationalFactor)\r\n    );\r\n    this.inputArtifacts = this.inputArtifacts.map((group) =>\r\n      group.map(\r\n        (artifact) =>\r\n          new MultipleMappingSelection<Artifact>(undefined, artifact, Artifact)\r\n      )\r\n    );\r\n    this.outputArtifacts = this.outputArtifacts.map((group) =>\r\n      group.map(\r\n        (artifact) =>\r\n          new MultipleSelection<Artifact>(undefined, artifact, Artifact)\r\n      )\r\n    );\r\n    this.stakeholders = this.stakeholders.map((group) =>\r\n      group.map(\r\n        (stakeholder) =>\r\n          new MultipleSelection<Stakeholder>(\r\n            undefined,\r\n            stakeholder,\r\n            Stakeholder\r\n          )\r\n      )\r\n    );\r\n    this.tools = this.tools.map((group) =>\r\n      group.map((tool) => new MultipleSelection<Tool>(undefined, tool, Tool))\r\n    );\r\n    this.executionSteps = this.executionSteps.map(\r\n      (step) => new ExecutionStep(undefined, step)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Check whether this step has all input artifacts available\r\n   *\r\n   * @param step the step to check\r\n   * @param size the size of the input artifacts\r\n   */\r\n  checkStepInputArtifacts(\r\n    step: number,\r\n    size: number\r\n  ): { isStep: boolean; index: number; artifact: number }[][] {\r\n    const artifactDefined: {\r\n      isStep: boolean;\r\n      index: number;\r\n      artifact: number;\r\n    }[][] = [];\r\n    artifactDefined.length = size;\r\n    artifactDefined.fill([]);\r\n\r\n    // check step mappings\r\n    for (let i = 0; i < this.executionSteps.length; i++) {\r\n      const executionStep = this.executionSteps[i];\r\n      for (let j = 0; j < executionStep.outputMappings.length; j++) {\r\n        const outputArtifact = executionStep.outputMappings[j];\r\n        for (const mapping of outputArtifact) {\r\n          if (\r\n            mapping.output === false &&\r\n            mapping.step === step &&\r\n            mapping.artifact < artifactDefined.length\r\n          ) {\r\n            artifactDefined[mapping.artifact].push({\r\n              isStep: true,\r\n              index: i,\r\n              artifact: j,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // check input groups\r\n    for (let i = 0; i < this.inputArtifacts.length; i++) {\r\n      const inputGroup = this.inputArtifacts[i];\r\n      for (let j = 0; j < inputGroup.length; j++) {\r\n        const artifact = inputGroup[j];\r\n        for (const mapping of artifact.mapping) {\r\n          if (mapping.output === false && mapping.step === step) {\r\n            artifactDefined[mapping.artifact].push({\r\n              isStep: false,\r\n              index: i,\r\n              artifact: j,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return artifactDefined;\r\n  }\r\n\r\n  /**\r\n   * Get all tool names no matter in which group they are\r\n   */\r\n  getAllToolNames(): Set<string> {\r\n    const tools: Set<string> = new Set<string>();\r\n    this.tools.forEach((toolGroup) =>\r\n      toolGroup.forEach((tool) => {\r\n        if (tool.element != null) {\r\n          tools.add(tool.element.name);\r\n        }\r\n      })\r\n    );\r\n    return tools;\r\n  }\r\n\r\n  toDb(): DevelopmentMethodEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      description: this.description,\r\n      examples: this.examples,\r\n      author: this.author.toDb(),\r\n      types: this.types.map((type) => type.toDb()),\r\n      situationalFactors: this.situationalFactors.map((factor) =>\r\n        factor.toDb()\r\n      ),\r\n      inputArtifacts: this.inputArtifacts.map((group) =>\r\n        group.map((artifact) => artifact.toDb())\r\n      ),\r\n      outputArtifacts: this.outputArtifacts.map((group) =>\r\n        group.map((artifact) => artifact.toDb())\r\n      ),\r\n      stakeholders: this.stakeholders.map((group) =>\r\n        group.map((element) => element.toDb())\r\n      ),\r\n      tools: this.tools.map((group) => group.map((tool) => tool.toDb())),\r\n      executionSteps: this.executionSteps.map((step) => step.toDb()),\r\n    };\r\n  }\r\n}\r\n","import {\r\n  ArtifactMapping,\r\n  ArtifactMappingEntry,\r\n  ArtifactMappingInit,\r\n} from './artifact-mapping';\r\nimport { Equality } from '../../shared/equality';\r\nimport { equalsListOfLists } from '../../shared/utils';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface ExecutionStepInit extends DatabaseInit {\r\n  module?: string;\r\n  method?: string;\r\n  predefinedInput?: any;\r\n  outputMappings?: ArtifactMappingInit[][];\r\n}\r\n\r\nexport interface ExecutionStepEntry extends DatabaseEntry {\r\n  module: string;\r\n  method: string;\r\n  predefinedInput: any;\r\n  outputMappings: ArtifactMappingEntry[][];\r\n}\r\n\r\nexport class ExecutionStep\r\n  implements ExecutionStepInit, Equality<ExecutionStep>, DatabaseModelPart\r\n{\r\n  module: string;\r\n  method: string;\r\n  predefinedInput: any;\r\n  outputMappings: ArtifactMapping[][] = [];\r\n\r\n  constructor(\r\n    entry: ExecutionStepEntry | undefined,\r\n    init: ExecutionStepInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.module = element.module;\r\n    this.method = element.method;\r\n    this.predefinedInput = element.predefinedInput;\r\n    if (entry != null) {\r\n      this.outputMappings =\r\n        entry.outputMappings?.map((mappings) =>\r\n          mappings.map((mapping) => new ArtifactMapping(mapping, undefined))\r\n        ) ?? this.outputMappings;\r\n    } else if (init != null) {\r\n      this.outputMappings =\r\n        init.outputMappings?.map((mappings) =>\r\n          mappings.map((mapping) => new ArtifactMapping(undefined, mapping))\r\n        ) ?? this.outputMappings;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  toDb(): ExecutionStepEntry {\r\n    return {\r\n      module: this.module,\r\n      method: this.method,\r\n      predefinedInput: this.predefinedInput,\r\n      outputMappings: this.outputMappings.map((mappings) =>\r\n        mappings.map((mapping) => mapping.toDb())\r\n      ),\r\n    };\r\n  }\r\n\r\n  equals(other: ExecutionStep): boolean {\r\n    if (other == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      this.module === other.module &&\r\n      this.method === other.method &&\r\n      equalsListOfLists(this.outputMappings, other.outputMappings)\r\n    );\r\n  }\r\n}\r\n","import {\r\n  MultipleSelection,\r\n  MultipleSelectionEntry,\r\n  MultipleSelectionInit,\r\n} from './multiple-selection';\r\nimport {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n} from '../method-elements/method-element';\r\nimport {\r\n  ArtifactMapping,\r\n  ArtifactMappingEntry,\r\n  ArtifactMappingInit,\r\n} from './artifact-mapping';\r\nimport { equalsList } from '../../shared/utils';\r\nimport { DatabaseInit } from '../../database/database-entry';\r\nimport {\r\n  DatabaseConstructor,\r\n  EntryType,\r\n  InitType,\r\n} from '../../database/database-model-part';\r\n\r\nexport interface MultipleMappingSelectionInit<T extends DatabaseInit>\r\n  extends MultipleSelectionInit<T> {\r\n  mapping?: ArtifactMappingInit[];\r\n}\r\n\r\nexport interface MultipleMappingSelectionEntry<T extends MethodElementEntry>\r\n  extends MultipleSelectionEntry<T> {\r\n  mapping: ArtifactMappingEntry[];\r\n}\r\n\r\nexport class MultipleMappingSelection<T extends MethodElement>\r\n  extends MultipleSelection<T>\r\n  implements MultipleMappingSelectionInit<T>\r\n{\r\n  mapping: ArtifactMapping[] = [];\r\n\r\n  constructor(\r\n    entry: MultipleMappingSelectionEntry<EntryType<T>> | undefined,\r\n    init: MultipleMappingSelectionInit<InitType<T>> | undefined,\r\n    databaseConstructor: DatabaseConstructor<T>\r\n  ) {\r\n    super(entry, init, databaseConstructor);\r\n    if (entry != null) {\r\n      this.mapping =\r\n        entry.mapping?.map(\r\n          (mapping) => new ArtifactMapping(mapping, undefined)\r\n        ) ?? this.mapping;\r\n    } else if (init != null) {\r\n      this.mapping =\r\n        init.mapping?.map(\r\n          (mapping) => new ArtifactMapping(undefined, mapping)\r\n        ) ?? this.mapping;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  update(\r\n    selection: MultipleMappingSelection<T>,\r\n    createElement: (element: Partial<T>) => T\r\n  ): void {\r\n    this.mapping = [];\r\n    super.update(selection, createElement);\r\n    this.element = this.element ? createElement(this.element) : null;\r\n    this.mapping = this.mapping.map(\r\n      (mapping) => new ArtifactMapping(undefined, mapping)\r\n    );\r\n  }\r\n\r\n  toDb(): MultipleMappingSelectionEntry<ReturnType<T['toDb']>> {\r\n    return {\r\n      ...super.toDb(),\r\n      mapping: this.mapping.map((mapping) => mapping.toDb()),\r\n    };\r\n  }\r\n\r\n  equals(other: MultipleSelection<T>): boolean {\r\n    if (!('mapping' in other)) {\r\n      return false;\r\n    }\r\n    return (\r\n      super.equals(other) &&\r\n      equalsList(this.mapping, (other as MultipleMappingSelection<T>).mapping)\r\n    );\r\n  }\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n} from '../method-elements/method-element';\r\nimport { Equality } from '../../shared/equality';\r\nimport {\r\n  DatabaseConstructor,\r\n  DatabaseModelPart,\r\n  EntryType,\r\n  InitType,\r\n} from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface MultipleSelectionInit<T extends DatabaseInit>\r\n  extends DatabaseInit {\r\n  list: string;\r\n  element?: T;\r\n  multiple?: boolean;\r\n  multipleElements?: boolean;\r\n}\r\n\r\nexport interface MultipleSelectionEntry<T extends MethodElementEntry>\r\n  extends DatabaseEntry {\r\n  list: string;\r\n  element?: T;\r\n  multiple: boolean;\r\n  multipleElements: boolean;\r\n}\r\n\r\nexport class MultipleSelection<T extends MethodElement>\r\n  implements\r\n    MultipleSelectionInit<T>,\r\n    Equality<MultipleSelection<T>>,\r\n    DatabaseModelPart\r\n{\r\n  list: string;\r\n  element?: T;\r\n  multiple = false;\r\n  multipleElements = false;\r\n\r\n  constructor(\r\n    entry: MultipleSelectionEntry<EntryType<T>> | undefined,\r\n    init: MultipleSelectionInit<InitType<T>> | undefined,\r\n    databaseConstructor: DatabaseConstructor<T>\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.list = element.list;\r\n    this.multiple = element.multiple ?? this.multiple;\r\n    this.multipleElements = element.multipleElements ?? this.multipleElements;\r\n    if (entry != null) {\r\n      this.element =\r\n        entry.element != null\r\n          ? new databaseConstructor(entry.element, undefined)\r\n          : undefined;\r\n    } else if (init != null) {\r\n      this.element =\r\n        init.element != null\r\n          ? new databaseConstructor(undefined, init.element)\r\n          : undefined;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  update(\r\n    selection: MultipleSelection<T>,\r\n    createElement: (element: Partial<T>) => T\r\n  ): void {\r\n    Object.assign(this, selection);\r\n    this.element = this.element ? createElement(this.element) : null;\r\n  }\r\n\r\n  toDb(): MultipleSelectionEntry<ReturnType<T['toDb']>> {\r\n    return {\r\n      list: this.list,\r\n      element: this.element\r\n        ? (this.element.toDb() as ReturnType<T['toDb']>)\r\n        : null,\r\n      multiple: this.multiple,\r\n      multipleElements: this.multipleElements,\r\n    };\r\n  }\r\n\r\n  equals(other: MultipleSelection<T>): boolean {\r\n    if (other == null || this.list !== other.list) {\r\n      return false;\r\n    }\r\n    if (this.element == null && other.element == null) {\r\n      return true;\r\n    }\r\n    if (this.element == null || other.element == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      this.element.equals(other.element) &&\r\n      this.multiple === other.multiple &&\r\n      this.multipleElements === other.multipleElements\r\n    );\r\n  }\r\n}\r\n","import { Equality } from '../../shared/equality';\r\nimport {\r\n  DatabaseConstructor,\r\n  DatabaseModelPart,\r\n  EntryType,\r\n  InitType,\r\n} from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface SelectionInit<T extends DatabaseInit> extends DatabaseInit {\r\n  list: string;\r\n  element?: T;\r\n}\r\n\r\nexport interface SelectionEntry<T extends DatabaseEntry> extends DatabaseEntry {\r\n  list: string;\r\n  element?: T;\r\n}\r\n\r\n/**\r\n * Represents a selection of a situational factor or type.\r\n */\r\nexport class Selection<T extends DatabaseModelPart & Equality<T>>\r\n  implements SelectionInit<T>, Equality<Selection<T>>, DatabaseModelPart\r\n{\r\n  list: string;\r\n  element?: T;\r\n\r\n  constructor(\r\n    entry: SelectionEntry<EntryType<T>> | undefined,\r\n    init: SelectionInit<InitType<T>> | undefined,\r\n    databaseConstructor: DatabaseConstructor<T>\r\n  ) {\r\n    if (entry != null) {\r\n      this.list = entry.list;\r\n      this.element =\r\n        entry.element != null\r\n          ? new databaseConstructor(entry.element, undefined)\r\n          : undefined;\r\n    } else if (init != null) {\r\n      this.list = init.list;\r\n      this.element =\r\n        init.element != null\r\n          ? new databaseConstructor(undefined, init.element)\r\n          : undefined;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  update(\r\n    selection: Selection<T>,\r\n    createElement: (element: Partial<T>) => T\r\n  ): void {\r\n    Object.assign(this, selection);\r\n    this.element = this.element ? createElement(this.element) : null;\r\n  }\r\n\r\n  toDb(): SelectionEntry<EntryType<T>> {\r\n    return {\r\n      list: this.list,\r\n      element: this.element ? (this.element.toDb() as EntryType<T>) : null,\r\n    };\r\n  }\r\n\r\n  equals(other: Selection<T>): boolean {\r\n    if (other == null || this.list !== other.list) {\r\n      return false;\r\n    }\r\n    if (this.element == null && other.element == null) {\r\n      return true;\r\n    }\r\n    if (this.element == null || other.element == null) {\r\n      return false;\r\n    }\r\n    return this.element.equals(other.element);\r\n  }\r\n}\r\n","import { NgModule, Optional, SkipSelf } from '@angular/core';\r\n\r\n@NgModule()\r\nexport class DevelopmentProcessRegistryModule {\r\n  // see https://angular.io/guide/singleton-services#prevent-reimport-of-the-greetingmodule\r\n  constructor(\r\n    @Optional()\r\n    @SkipSelf()\r\n    developmentProcessRegistryModule: DevelopmentProcessRegistryModule\r\n  ) {\r\n    if (developmentProcessRegistryModule) {\r\n      throw new Error(\r\n        'DevelopmentProcessRegistryModule is already loaded. Import it in the AppModule only.'\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Domain, DomainInit } from './domain';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class DomainService extends DefaultElementService<Domain, DomainInit> {\r\n  protected readonly typeName = Domain.typeName;\r\n\r\n  protected readonly elementConstructor = Domain;\r\n\r\n  /**\r\n   * Update a domain.\r\n   *\r\n   * @param id id of the domain\r\n   * @param domain the new values of the object (values will be copied)\r\n   */\r\n  async update(id: string, domain: Partial<Domain>): Promise<void> {\r\n    const dbDomain = await this.get(id);\r\n    dbDomain.update(domain);\r\n    await this.save(dbDomain);\r\n  }\r\n}\r\n","import { DatabaseModel } from '../../database/database-model';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\n\r\nexport interface DomainInit extends DatabaseRootInit {\r\n  name: string;\r\n  description?: string;\r\n}\r\n\r\nexport interface DomainEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  description?: string;\r\n}\r\n\r\nexport class Domain extends DatabaseModel implements DomainInit {\r\n  static readonly typeName = 'Domain';\r\n\r\n  name: string;\r\n  description?: string;\r\n\r\n  constructor(entry: DomainEntry | undefined, init: DomainInit | undefined) {\r\n    super(entry, init, Domain.typeName);\r\n    const element = entry ?? init;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n  }\r\n\r\n  /**\r\n   * Update this domain with new values\r\n   *\r\n   * @param domain the new values of this domain (values will be copied to the current object)\r\n   */\r\n  update(domain: Partial<Domain>): void {\r\n    this.name = domain.name ?? this.name;\r\n    this.description = domain.description ?? this.description;\r\n  }\r\n\r\n  toDb(): DomainEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      description: this.description,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DevelopmentProcessRegistryModule } from './development-process-registry.module';\r\nimport {\r\n  MetaModelApi,\r\n  MetaModelDefinition,\r\n  MetaModelType,\r\n} from './meta-model-definition';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class MetaModelService {\r\n  metaModels: MetaModelDefinition[] = [];\r\n\r\n  registerMetaModel(definition: MetaModelDefinition): void {\r\n    this.metaModels.push(definition);\r\n  }\r\n\r\n  getMetaModelApi(metaModelType: MetaModelType): MetaModelApi {\r\n    return this.getMetaModelDefinition(metaModelType).api;\r\n  }\r\n\r\n  getMetaModelDefinition(metaModelType: MetaModelType): MetaModelDefinition {\r\n    return this.metaModels.find(\r\n      (metaModelDefinition) => metaModelDefinition.type === metaModelType\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MethodElementService } from '../method-element.service';\r\nimport { Artifact, ArtifactInit } from './artifact';\r\nimport { DevelopmentProcessRegistryModule } from '../../development-process-registry.module';\r\nimport { PouchdbService } from '../../../database/pouchdb.service';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ArtifactService extends MethodElementService<\r\n  Artifact,\r\n  ArtifactInit\r\n> {\r\n  protected readonly typeName = Artifact.typeName;\r\n\r\n  constructor(pouchdbService: PouchdbService) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  protected readonly elementConstructor = Artifact;\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-element';\r\nimport { MetaModelIdentifier } from '../../meta-model-definition';\r\n\r\nexport interface ArtifactInit extends MethodElementInit {\r\n  internalArtifact?: boolean;\r\n  metaModel?: MetaModelIdentifier;\r\n}\r\n\r\nexport interface ArtifactEntry extends MethodElementEntry {\r\n  internalArtifact: boolean;\r\n  metaModel?: MetaModelIdentifier;\r\n}\r\n\r\nexport class Artifact extends MethodElement implements ArtifactInit {\r\n  static readonly typeName = 'Artifact';\r\n\r\n  internalArtifact = false;\r\n  metaModel?: MetaModelIdentifier = undefined;\r\n\r\n  constructor(\r\n    entry: ArtifactEntry | undefined,\r\n    init: ArtifactInit | undefined\r\n  ) {\r\n    super(entry, init, Artifact.typeName);\r\n    const element = entry ?? init;\r\n    this.internalArtifact = element.internalArtifact ?? this.internalArtifact;\r\n    this.metaModel = element.metaModel;\r\n  }\r\n\r\n  /**\r\n   * Update this artifact with new values\r\n   *\r\n   * @param artifact the new values of this artifact (values will be copied to the current object)\r\n   */\r\n  update(artifact: Partial<ArtifactInit>): void {\r\n    Object.assign(this, artifact);\r\n  }\r\n\r\n  toDb(): ArtifactEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      internalArtifact: this.internalArtifact,\r\n      metaModel: this.metaModel\r\n        ? {\r\n            name: this.metaModel.name,\r\n            type: this.metaModel.type,\r\n          }\r\n        : undefined,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MethodElement, MethodElementInit } from './method-element';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\nimport { EntryType } from '../../database/database-model-part';\r\n\r\n@Injectable()\r\nexport abstract class MethodElementService<\r\n  T extends MethodElement,\r\n  S extends MethodElementInit\r\n> extends DefaultElementService<T, S> {\r\n  /**\r\n   * Get all method elements in their lists\r\n   */\r\n  async getLists(): Promise<{ listName: string; elements: EntryType<T>[] }[]> {\r\n    const list = await this.getList();\r\n    const elementListMap: { [listName: string]: EntryType<T>[] } = {};\r\n    list.forEach((element) => {\r\n      if (element.list in elementListMap) {\r\n        elementListMap[element.list].push(element);\r\n      } else {\r\n        elementListMap[element.list] = [element];\r\n      }\r\n    });\r\n    const elementLists: { listName: string; elements: EntryType<T>[] }[] = [];\r\n    Object.entries(elementListMap).forEach(([listName, elements]) => {\r\n      elementLists.push({ listName, elements });\r\n    });\r\n    return elementLists;\r\n  }\r\n\r\n  /**\r\n   * Update a method element\r\n   *\r\n   * @param id the id of the method element to update\r\n   * @param element the new data of the element\r\n   */\r\n  async update(id: string, element: S): Promise<void> {\r\n    const currentElement = await this.get(id);\r\n    currentElement.update(element);\r\n    return this.save(currentElement);\r\n  }\r\n}\r\n","import { DatabaseModel } from '../../database/database-model';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n  DbType,\r\n} from '../../database/database-entry';\r\n\r\nexport interface MethodElementInit extends DatabaseRootInit {\r\n  list: string;\r\n  name: string;\r\n  description?: string;\r\n}\r\n\r\nexport interface MethodElementEntry extends DatabaseRootEntry {\r\n  list: string;\r\n  name: string;\r\n  description?: string;\r\n}\r\n\r\nexport abstract class MethodElement\r\n  extends DatabaseModel\r\n  implements MethodElementInit\r\n{\r\n  list: string;\r\n  name: string;\r\n  description?: string;\r\n\r\n  protected constructor(\r\n    entry: MethodElementEntry | undefined,\r\n    init: MethodElementInit | undefined,\r\n    type: DbType\r\n  ) {\r\n    super(entry, init, type);\r\n    const element = entry ?? init;\r\n    this.list = element.list;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n  }\r\n\r\n  abstract update(element: MethodElementInit);\r\n\r\n  toDb(): MethodElementEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      list: this.list,\r\n      name: this.name,\r\n      description: this.description,\r\n    };\r\n  }\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-element';\r\n\r\nexport interface SituationalFactorDefinitionInit extends MethodElementInit {\r\n  values?: string[];\r\n  ordered?: boolean;\r\n}\r\n\r\nexport interface SituationalFactorDefinitionEntry extends MethodElementEntry {\r\n  values: string[];\r\n  ordered: boolean;\r\n}\r\n\r\nexport class SituationalFactorDefinition\r\n  extends MethodElement\r\n  implements SituationalFactorDefinitionInit\r\n{\r\n  static readonly typeName = 'SituationalFactorDefinition';\r\n\r\n  values: string[] = [];\r\n  ordered = false;\r\n\r\n  constructor(\r\n    entry: SituationalFactorDefinitionEntry | undefined,\r\n    init: SituationalFactorDefinitionInit | undefined\r\n  ) {\r\n    super(entry, init, SituationalFactorDefinition.typeName);\r\n    const element = entry ?? init;\r\n    this.values = element.values ?? this.values;\r\n    this.ordered = element.ordered ?? this.ordered;\r\n  }\r\n\r\n  toDb(): SituationalFactorDefinitionEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      values: this.values,\r\n      ordered: this.ordered,\r\n    };\r\n  }\r\n\r\n  update(\r\n    situationalFactorDefinition: Partial<SituationalFactorDefinition>\r\n  ): void {\r\n    Object.assign(this, situationalFactorDefinition);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionInit,\r\n} from './situational-factor-definition';\r\nimport { DevelopmentProcessRegistryModule } from '../../development-process-registry.module';\r\nimport { MethodElementService } from '../method-element.service';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class SituationalFactorService extends MethodElementService<\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionInit\r\n> {\r\n  protected readonly typeName = SituationalFactorDefinition.typeName;\r\n\r\n  protected readonly elementConstructor = SituationalFactorDefinition;\r\n}\r\n","import {\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionEntry,\r\n  SituationalFactorDefinitionInit,\r\n} from './situational-factor-definition';\r\nimport { Equality } from '../../../shared/equality';\r\nimport { DatabaseModelPart } from '../../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../../database/database-entry';\r\n\r\nexport interface SituationalFactorInit extends DatabaseInit {\r\n  factor: SituationalFactorDefinitionInit;\r\n  value: string;\r\n}\r\n\r\nexport interface SituationalFactorEntry extends DatabaseEntry {\r\n  factor: SituationalFactorDefinitionEntry;\r\n  value: string;\r\n}\r\n\r\nexport class SituationalFactor\r\n  implements\r\n    SituationalFactorInit,\r\n    Equality<SituationalFactor>,\r\n    DatabaseModelPart\r\n{\r\n  factor: SituationalFactorDefinition;\r\n  value: string;\r\n\r\n  /**\r\n   * Create a map from situational factors\r\n   *\r\n   * @param situationalFactors the situational factors\r\n   * @returns the situational factors map factor list to name to factor value\r\n   */\r\n  static createMap(\r\n    situationalFactors: (SituationalFactor | SituationalFactorEntry)[]\r\n  ): {\r\n    [listName: string]: { [factorName: string]: string };\r\n  } {\r\n    const map = {};\r\n    situationalFactors.forEach((factor) => {\r\n      if (!(factor.factor.list in map)) {\r\n        map[factor.factor.list] = {};\r\n      }\r\n      map[factor.factor.list][factor.factor.name] = factor.value;\r\n    });\r\n    return map;\r\n  }\r\n\r\n  constructor(\r\n    entry: SituationalFactorEntry | undefined,\r\n    init: SituationalFactorInit | undefined\r\n  ) {\r\n    if (entry != null) {\r\n      this.factor = new SituationalFactorDefinition(entry.factor, undefined);\r\n      this.value = entry.value;\r\n    } else if (init != null) {\r\n      this.factor = new SituationalFactorDefinition(undefined, init.factor);\r\n      this.value = init.value;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  toDb(): SituationalFactorEntry {\r\n    return {\r\n      factor: this.factor.toDb(),\r\n      value: this.value,\r\n    };\r\n  }\r\n\r\n  equals(other: SituationalFactor): boolean {\r\n    if (other == null) {\r\n      return false;\r\n    }\r\n    return other.value === this.value && this.factor.equals(other.factor);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MethodElementService } from '../method-element.service';\r\nimport { Stakeholder, StakeholderInit } from './stakeholder';\r\nimport { DevelopmentProcessRegistryModule } from '../../development-process-registry.module';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class StakeholderService extends MethodElementService<\r\n  Stakeholder,\r\n  StakeholderInit\r\n> {\r\n  protected readonly typeName = Stakeholder.typeName;\r\n\r\n  protected readonly elementConstructor = Stakeholder;\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-element';\r\n\r\nexport interface StakeholderInit extends MethodElementInit {}\r\n\r\nexport interface StakeholderEntry extends MethodElementEntry {}\r\n\r\nexport class Stakeholder extends MethodElement implements StakeholderInit {\r\n  static readonly typeName = 'Stakeholder';\r\n\r\n  constructor(\r\n    entry: StakeholderEntry | undefined,\r\n    init: StakeholderInit | undefined\r\n  ) {\r\n    super(entry, init, Stakeholder.typeName);\r\n  }\r\n\r\n  /**\r\n   * Update this stakeholder with new values\r\n   *\r\n   * @param stakeholder the new values of this stakeholder (values will be copied to the current object)\r\n   */\r\n  update(stakeholder: Partial<Stakeholder>): void {\r\n    Object.assign(this, stakeholder);\r\n  }\r\n\r\n  toDb(): StakeholderEntry {\r\n    return {\r\n      ...super.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MethodElementService } from '../method-element.service';\r\nimport { Tool, ToolInit } from './tool';\r\nimport { DevelopmentProcessRegistryModule } from '../../development-process-registry.module';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ToolService extends MethodElementService<Tool, ToolInit> {\r\n  protected readonly typeName = Tool.typeName;\r\n\r\n  protected readonly elementConstructor = Tool;\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-element';\r\n\r\nexport interface ToolInit extends MethodElementInit {}\r\n\r\nexport interface ToolEntry extends MethodElementEntry {}\r\n\r\nexport class Tool extends MethodElement {\r\n  static readonly typeName = 'Tool';\r\n\r\n  constructor(entry: ToolEntry | undefined, init: ToolInit | undefined) {\r\n    super(entry, init, Tool.typeName);\r\n  }\r\n\r\n  /**\r\n   * Update this tool with new values\r\n   *\r\n   * @param tool the new values of this tool (values will be copied to the current object)\r\n   */\r\n  update(tool: Partial<Tool>): void {\r\n    Object.assign(this, tool);\r\n  }\r\n\r\n  toDb(): ToolEntry {\r\n    return {\r\n      ...super.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MethodElementService } from '../method-element.service';\r\nimport { Type, TypeInit } from './type';\r\nimport { DevelopmentProcessRegistryModule } from '../../development-process-registry.module';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class TypeService extends MethodElementService<Type, TypeInit> {\r\n  protected readonly typeName = Type.typeName;\r\n\r\n  protected readonly elementConstructor = Type;\r\n}\r\n","import {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n  MethodElementInit,\r\n} from '../method-element';\r\n\r\nexport interface TypeInit extends MethodElementInit {}\r\n\r\nexport interface TypeEntry extends MethodElementEntry {}\r\n\r\nexport class Type extends MethodElement {\r\n  static readonly typeName = 'Type';\r\n\r\n  static validTypes(\r\n    types: { list: string; element?: Type | TypeEntry }[],\r\n    needed: { list: string; element?: { _id: string; name: string } }[],\r\n    forbidden: { list: string; element?: { _id: string; name: string } }[]\r\n  ): boolean {\r\n    const hasType = (type: {\r\n      list: string;\r\n      element: { _id: string; name: string };\r\n    }): boolean => {\r\n      if (type.element) {\r\n        const ids = types\r\n          .map((t) => t.element)\r\n          .filter((t) => t)\r\n          .map((t) => t._id);\r\n        return ids.includes(type.element._id);\r\n      } else {\r\n        const listNames = types.map((t) => t.list).filter((l) => l);\r\n        return listNames.includes(type.list);\r\n      }\r\n    };\r\n    const hasNeeded = needed.some(hasType);\r\n    const hasForbidden = forbidden.some(hasType);\r\n    return hasNeeded && !hasForbidden;\r\n  }\r\n\r\n  constructor(entry: TypeEntry | undefined, init: TypeInit | undefined) {\r\n    super(entry, init, Type.typeName);\r\n  }\r\n\r\n  /**\r\n   * Update this type with new values\r\n   *\r\n   * @param type the new values of this type (values will be copied to the current object)\r\n   */\r\n  update(type: Partial<Type>): void {\r\n    Object.assign(this, type);\r\n  }\r\n\r\n  toDb(): TypeEntry {\r\n    return {\r\n      ...super.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { Module } from './module';\r\nimport { ModuleMethod } from './module-method';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ModuleService {\r\n  modules: Module[] = [];\r\n\r\n  registerModule(module: Module): void {\r\n    this.modules.push(module);\r\n  }\r\n\r\n  getModule(module: string): Module {\r\n    return this.modules.find((m) => m.name === module);\r\n  }\r\n\r\n  /**\r\n   * Get all modules in their lists\r\n   */\r\n  getLists(): { listName: string; elements: Module[] }[] {\r\n    const moduleListMap: { [listName: string]: Module[] } = {};\r\n    this.modules.forEach((module) => {\r\n      if (module.list in moduleListMap) {\r\n        moduleListMap[module.list].push(module);\r\n      } else {\r\n        moduleListMap[module.list] = [module];\r\n      }\r\n    });\r\n    const moduleLists = [];\r\n    Object.entries(moduleListMap).forEach(([listName, elements]) => {\r\n      moduleLists.push({ listName, elements });\r\n    });\r\n    return moduleLists;\r\n  }\r\n\r\n  getModuleMethod(module: string, method: string): ModuleMethod {\r\n    const realModule = this.modules.find((m) => m.name === module);\r\n    if (!realModule) {\r\n      return null;\r\n    }\r\n    return realModule.methods[method];\r\n  }\r\n}\r\n","import { ModuleMethod } from './module-method';\r\nimport { ModuleApiService } from './module-api-service';\r\n\r\nexport class Module {\r\n  list: string;\r\n  name: string;\r\n  methods: { [name: string]: ModuleMethod } = {};\r\n  service: ModuleApiService;\r\n\r\n  addMethod(method: ModuleMethod): void {\r\n    this.methods[method.name] = method;\r\n  }\r\n\r\n  get methodNames(): string[] {\r\n    return Object.keys(this.methods);\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { Observable, Subject, Subscription } from 'rxjs';\r\nimport { RunningProcess } from '../running-process/running-process';\r\nimport { RunningMethod } from '../running-process/running-method';\r\nimport { StepInfo } from './step-info';\r\nimport { RunningProcessService } from '../running-process/running-process.service';\r\n\r\n/**\r\n * Helper for components to know which process is currently executed.\r\n * Should be included as provider in api components.\r\n */\r\n@Injectable()\r\nexport class ProcessApiService implements OnDestroy {\r\n  private _loadedObservable: Observable<void>;\r\n  private _loaded: Subject<void>;\r\n  get loaded(): Observable<void> {\r\n    return this._loadedObservable;\r\n  }\r\n\r\n  runningProcess: RunningProcess = null;\r\n  runningMethod: RunningMethod = null;\r\n  errorLoading = false;\r\n\r\n  stepInfo: StepInfo = null;\r\n\r\n  private querySubscription: Subscription = null;\r\n  private changesFeed: Subscription = null;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private runningProcessService: RunningProcessService\r\n  ) {\r\n    this.init();\r\n  }\r\n\r\n  private init(): void {\r\n    this._loaded = new Subject<void>();\r\n    this._loadedObservable = this._loaded.asObservable();\r\n    this.querySubscription = this.route.queryParamMap.subscribe((params) => {\r\n      this.stepInfo = {\r\n        step: params.has('step') ? +params.get('step') : undefined,\r\n        runningProcessId: params.has('runningProcessId')\r\n          ? params.get('runningProcessId')\r\n          : undefined,\r\n        executionId: params.has('executionId')\r\n          ? params.get('executionId')\r\n          : undefined,\r\n      };\r\n      this.checkUnsubscribeChangesFeed();\r\n      if (this.stepInfo.runningProcessId != null) {\r\n        this.changesFeed = this.runningProcessService\r\n          .getChangesFeed(this.stepInfo.runningProcessId)\r\n          .subscribe(() => this.loadProcessInfo());\r\n        void this.loadProcessInfo();\r\n      }\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.checkUnsubscribeChangesFeed();\r\n    this.querySubscription.unsubscribe();\r\n    this._loaded.complete();\r\n  }\r\n\r\n  isInitialized(): boolean {\r\n    return this.runningProcess != null;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.runningMethod.currentStepNumber === this.stepInfo.step;\r\n  }\r\n\r\n  get queryParams(): {\r\n    step: number;\r\n    runningProcessId: string;\r\n    executionId: string;\r\n  } {\r\n    return {\r\n      step: this.stepInfo.step != null ? this.stepInfo.step : undefined,\r\n      runningProcessId: this.runningProcess\r\n        ? this.runningProcess._id\r\n        : undefined,\r\n      executionId:\r\n        this.runningMethod != null ? this.runningMethod.executionId : undefined,\r\n    };\r\n  }\r\n\r\n  private async loadProcessInfo(): Promise<void> {\r\n    try {\r\n      this.runningProcess = await this.runningProcessService.get(\r\n        this.stepInfo.runningProcessId\r\n      );\r\n    } catch (error) {\r\n      console.error(error);\r\n      this.errorLoading = true;\r\n      this.runningProcess = null;\r\n      this.runningMethod = null;\r\n      return;\r\n    }\r\n    this.runningMethod = this.runningProcess.getRunningMethod(\r\n      this.stepInfo.executionId\r\n    );\r\n    if (this.runningMethod == null) {\r\n      this.errorLoading = true;\r\n      this.runningMethod = null;\r\n    } else {\r\n      this._loaded.next();\r\n    }\r\n  }\r\n\r\n  private checkUnsubscribeChangesFeed(): void {\r\n    if (this.changesFeed) {\r\n      this.changesFeed.unsubscribe();\r\n      this.changesFeed = null;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ProcessPattern,\r\n  ProcessPatternEntry,\r\n  ProcessPatternInit,\r\n} from './process-pattern';\r\nimport { Type } from '../method-elements/type/type';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ProcessPatternService extends DefaultElementService<\r\n  ProcessPattern,\r\n  ProcessPatternInit\r\n> {\r\n  protected readonly typeName = ProcessPattern.typeName;\r\n\r\n  protected readonly elementConstructor = ProcessPattern;\r\n\r\n  /**\r\n   * Get a list of process patterns that have the needed types, but not the forbidden ones.\r\n   *\r\n   * @param needed needed types\r\n   * @param forbidden forbidden types\r\n   */\r\n  async getValidProcessPatterns(\r\n    needed: { list: string; element: { _id: string; name: string } }[],\r\n    forbidden: { list: string; element: { _id: string; name: string } }[]\r\n  ): Promise<ProcessPatternEntry[]> {\r\n    return (\r\n      await this.pouchdbService.find<ProcessPatternEntry>(\r\n        ProcessPattern.typeName,\r\n        {\r\n          selector: {},\r\n        }\r\n      )\r\n    ).filter((pattern) => Type.validTypes(pattern.types, needed, forbidden));\r\n  }\r\n\r\n  /**\r\n   * Update the process pattern.\r\n   *\r\n   * @param id id of the process pattern\r\n   * @param processPattern the new values of the object (values will be copied)\r\n   */\r\n  async update(\r\n    id: string,\r\n    processPattern: Partial<ProcessPattern>\r\n  ): Promise<void> {\r\n    const dbProcessPattern = await this.get(id);\r\n    dbProcessPattern.update(processPattern);\r\n    await this.save(dbProcessPattern);\r\n  }\r\n\r\n  /**\r\n   * Get process patterns by their ids\r\n   *\r\n   * @param ids the ids to query\r\n   */\r\n  async getProcessPatterns(ids: string[]): Promise<ProcessPattern[]> {\r\n    return (\r\n      await this.pouchdbService.find<ProcessPatternEntry>(\r\n        ProcessPattern.typeName,\r\n        {\r\n          selector: {\r\n            _id: {\r\n              $in: ids,\r\n            },\r\n          },\r\n        }\r\n      )\r\n    ).map((pattern) => new ProcessPattern(pattern, undefined));\r\n  }\r\n}\r\n","import { DatabaseModel } from '../../database/database-model';\r\nimport { Author, AuthorEntry, AuthorInit } from '../../model/author';\r\nimport {\r\n  SituationalFactor,\r\n  SituationalFactorEntry,\r\n  SituationalFactorInit,\r\n} from '../method-elements/situational-factor/situational-factor';\r\nimport { Type, TypeEntry, TypeInit } from '../method-elements/type/type';\r\nimport {\r\n  Selection,\r\n  SelectionEntry,\r\n  SelectionInit,\r\n} from '../development-method/selection';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\n\r\nexport interface ProcessPatternInit extends DatabaseRootInit {\r\n  name: string;\r\n  description?: string;\r\n  author?: AuthorInit;\r\n\r\n  pattern?: string;\r\n\r\n  types?: SelectionInit<TypeInit>[];\r\n  situationalFactors?: SelectionInit<SituationalFactorInit>[];\r\n}\r\n\r\nexport interface ProcessPatternEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  description: string;\r\n  author: AuthorEntry;\r\n\r\n  pattern: string;\r\n\r\n  types: SelectionEntry<TypeEntry>[];\r\n  situationalFactors: SelectionEntry<SituationalFactorEntry>[];\r\n}\r\n\r\nexport class ProcessPattern\r\n  extends DatabaseModel\r\n  implements ProcessPatternInit\r\n{\r\n  static readonly typeName = 'ProcessPattern';\r\n\r\n  name: string;\r\n  description: string;\r\n  author: Author;\r\n\r\n  pattern: string;\r\n\r\n  types: Selection<Type>[] = [];\r\n  situationalFactors: Selection<SituationalFactor>[] = [];\r\n\r\n  constructor(\r\n    entry: ProcessPatternEntry | undefined,\r\n    init: ProcessPatternInit | undefined\r\n  ) {\r\n    super(entry, init, ProcessPattern.typeName);\r\n    const element = entry ?? init;\r\n    this.name = element.name;\r\n    this.description = element.description;\r\n    this.pattern = element.pattern;\r\n\r\n    if (entry != null) {\r\n      this.author = new Author(entry.author, undefined);\r\n      this.types =\r\n        entry.types?.map(\r\n          (selection) => new Selection<Type>(selection, undefined, Type)\r\n        ) ?? this.types;\r\n      this.situationalFactors =\r\n        entry.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              selection,\r\n              undefined,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n    } else {\r\n      this.author = new Author(undefined, init.author ?? {});\r\n      this.types =\r\n        init.types?.map(\r\n          (selection) => new Selection<Type>(undefined, selection, Type)\r\n        ) ?? this.types;\r\n      this.situationalFactors =\r\n        init.situationalFactors?.map(\r\n          (selection) =>\r\n            new Selection<SituationalFactor>(\r\n              undefined,\r\n              selection,\r\n              SituationalFactor\r\n            )\r\n        ) ?? this.situationalFactors;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update this process pattern with new values\r\n   *\r\n   * @param processPattern the new values of this process pattern (values will be copied to the current object)\r\n   */\r\n  update(processPattern: Partial<ProcessPattern>): void {\r\n    Object.assign(this, processPattern);\r\n    this.author = new Author(undefined, this.author);\r\n    this.types = this.types.map(\r\n      (selection) => new Selection(undefined, selection, Type)\r\n    );\r\n    this.situationalFactors = this.situationalFactors.map(\r\n      (selection) => new Selection(undefined, selection, SituationalFactor)\r\n    );\r\n  }\r\n\r\n  toDb(): ProcessPatternEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      description: this.description,\r\n      author: this.author.toDb(),\r\n      pattern: this.pattern,\r\n      types: this.types.map((selection) => selection.toDb()),\r\n      situationalFactors: this.situationalFactors.map((selection) =>\r\n        selection.toDb()\r\n      ),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport {\r\n  ArtifactData,\r\n  ArtifactDataReference,\r\n  ArtifactDataType,\r\n} from './artifact-data';\r\nimport { MetaModelService } from '../meta-model.service';\r\n\r\nexport enum ArtifactDataErrors {\r\n  WRONG_ARTIFACT_TYPE = 'You can only delete reference artifacts',\r\n}\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ArtifactDataService {\r\n  constructor(private metaModelService: MetaModelService) {}\r\n\r\n  /**\r\n   * Removes an artifact reference\r\n   *\r\n   * @param artifact the artifact to remove\r\n   */\r\n  async remove(artifact: ArtifactData): Promise<void> {\r\n    if (artifact.type !== ArtifactDataType.REFERENCE) {\r\n      throw new Error(ArtifactDataErrors.WRONG_ARTIFACT_TYPE);\r\n    }\r\n    const reference: ArtifactDataReference = artifact.data;\r\n    const api = this.metaModelService.getMetaModelApi(reference.type);\r\n    try {\r\n      await api.remove(reference);\r\n    } catch (error) {\r\n      if (\r\n        error.status === 404 &&\r\n        error.name === 'not_found' &&\r\n        error.reason === 'deleted'\r\n      ) {\r\n        console.log(reference.id + ' (' + reference.type + ') already deleted');\r\n      } else {\r\n        throw error;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Copy an artifact reference\r\n   *\r\n   * @param artifact the artifact to copy\r\n   * @return the copied artifact\r\n   */\r\n  async copy(artifact: ArtifactData): Promise<ArtifactData> {\r\n    if (artifact.type !== ArtifactDataType.REFERENCE) {\r\n      throw new Error(ArtifactDataErrors.WRONG_ARTIFACT_TYPE);\r\n    }\r\n    const reference: ArtifactDataReference = artifact.data;\r\n    const api = this.metaModelService.getMetaModelApi(reference.type);\r\n    return new ArtifactData(undefined, {\r\n      ...artifact,\r\n      data: await api.copy(reference),\r\n    });\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport enum ArtifactDataType {\r\n  CUSTOM,\r\n  STRING,\r\n  REFERENCE,\r\n}\r\n\r\nexport interface ArtifactDataReference {\r\n  id: string;\r\n  type: string;\r\n}\r\n\r\nexport interface ArtifactDataInit extends DatabaseInit {\r\n  type?: ArtifactDataType;\r\n  data?: any;\r\n}\r\n\r\nexport interface ArtifactDataEntry extends DatabaseEntry {\r\n  type: ArtifactDataType;\r\n  data: any;\r\n}\r\n\r\nexport class ArtifactData implements ArtifactDataInit, DatabaseModelPart {\r\n  type: ArtifactDataType = ArtifactDataType.STRING;\r\n  data: any;\r\n\r\n  constructor(\r\n    entry: ArtifactDataEntry | undefined,\r\n    init: ArtifactDataInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.type = element.type ?? this.type;\r\n    this.data = element.data;\r\n  }\r\n\r\n  toDb(): ArtifactDataEntry {\r\n    return {\r\n      type: this.type,\r\n      data: this.data,\r\n    };\r\n  }\r\n}\r\n","import {\r\n  ArtifactData,\r\n  ArtifactDataEntry,\r\n  ArtifactDataInit,\r\n} from './artifact-data';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface ArtifactVersionInit extends DatabaseInit {\r\n  time?: number;\r\n  createdBy: 'manual' | 'imported' | string;\r\n  importName?: string;\r\n  executedBy: string;\r\n  data?: ArtifactDataInit;\r\n}\r\n\r\nexport interface ArtifactVersionEntry extends DatabaseEntry {\r\n  time: number;\r\n  createdBy: 'manual' | 'imported' | string;\r\n  importName?: string;\r\n  executedBy: string;\r\n  data: ArtifactDataEntry;\r\n}\r\n\r\nexport class ArtifactVersion implements DatabaseModelPart {\r\n  time: number;\r\n  createdBy: 'manual' | 'imported' | string;\r\n  importName?: string;\r\n  executedBy: string;\r\n  data: ArtifactData;\r\n\r\n  constructor(\r\n    entry: ArtifactVersionEntry | undefined,\r\n    init: ArtifactVersionInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.time = element.time ?? Date.now();\r\n    this.createdBy = element.createdBy;\r\n    this.importName = element.importName;\r\n    this.executedBy = element.executedBy;\r\n    if (entry != null) {\r\n      this.data = new ArtifactData(entry.data, undefined);\r\n    } else if (init != null) {\r\n      this.data = new ArtifactData(undefined, init.data ?? {});\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  toDb(): ArtifactVersionEntry {\r\n    return {\r\n      time: this.time,\r\n      createdBy: this.createdBy,\r\n      importName: this.importName,\r\n      executedBy: this.executedBy,\r\n      data: this.data.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface CommentInit extends DatabaseInit {\r\n  id?: string;\r\n  time?: number;\r\n  userName: string;\r\n  title: string;\r\n  comment: string;\r\n}\r\n\r\nexport interface CommentEntry extends DatabaseEntry {\r\n  id: string;\r\n  time: number;\r\n  userName: string;\r\n  title: string;\r\n  comment: string;\r\n}\r\n\r\nexport class Comment implements CommentInit, DatabaseModelPart {\r\n  id: string;\r\n  time: number;\r\n  userName: string;\r\n  title: string;\r\n  comment: string;\r\n\r\n  constructor(entry: CommentEntry | undefined, init: CommentInit | undefined) {\r\n    const element = entry ?? init;\r\n    this.id = element.id ?? uuidv4();\r\n    this.time = element.time ?? Date.now();\r\n    this.userName = element.userName;\r\n    this.title = element.title;\r\n    this.comment = element.comment;\r\n  }\r\n\r\n  update(comment: Partial<Comment>): void {\r\n    Object.assign(this, comment);\r\n  }\r\n\r\n  toDb(): CommentEntry {\r\n    return {\r\n      id: this.id,\r\n      time: this.time,\r\n      userName: this.userName,\r\n      title: this.title,\r\n      comment: this.comment,\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { PouchdbService } from '../../database/pouchdb.service';\r\nimport { Observable } from 'rxjs';\r\nimport {\r\n  RunningArtifact,\r\n  RunningArtifactEntry,\r\n  RunningArtifactInit,\r\n} from './running-artifact';\r\nimport { ArtifactDataType } from './artifact-data';\r\nimport { ArtifactVersion } from './artifact-version';\r\nimport { ArtifactDataService } from './artifact-data.service';\r\nimport { ElementService } from '../../database/element.service';\r\nimport { DatabaseRevision, DbId } from '../../database/database-entry';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ConcreteArtifactService\r\n  implements ElementService<RunningArtifact, RunningArtifactInit>\r\n{\r\n  constructor(\r\n    private artifactDataService: ArtifactDataService,\r\n    private pouchdbService: PouchdbService\r\n  ) {}\r\n\r\n  async add(artifact: RunningArtifactInit): Promise<void> {\r\n    await this.pouchdbService.post(new RunningArtifact(undefined, artifact));\r\n  }\r\n\r\n  /**\r\n   * Update the artifact identifier\r\n   *\r\n   * @param id the id of the artifact\r\n   * @param identifier the identifier of the artifact\r\n   */\r\n  async updateIdentifier(id: DbId, identifier: string): Promise<void> {\r\n    const artifact = await this.get(id);\r\n    artifact.identifier = identifier;\r\n    await this.save(artifact);\r\n  }\r\n\r\n  /**\r\n   * Exports an artifact from a running process.\r\n   * Copies it sets the identifier and sets created by to the import name.\r\n   *\r\n   * @param identifier the identifier\r\n   * @param artifact the artifact to export\r\n   * @param importName the import name for other processes\r\n   */\r\n  async export(\r\n    identifier: string,\r\n    artifact: RunningArtifact,\r\n    importName: string\r\n  ): Promise<RunningArtifact> {\r\n    artifact = await this.copy(artifact);\r\n    artifact.identifier = identifier;\r\n    artifact.versions.forEach((version) => {\r\n      version.createdBy = 'imported';\r\n      if (version.importName == null) {\r\n        version.importName = importName;\r\n      }\r\n    });\r\n    await this.add(artifact);\r\n    return artifact;\r\n  }\r\n\r\n  async getList(): Promise<RunningArtifactEntry[]> {\r\n    return this.pouchdbService.find<RunningArtifactEntry>(\r\n      RunningArtifact.typeName,\r\n      {\r\n        selector: {},\r\n      }\r\n    );\r\n  }\r\n\r\n  async get(id: string): Promise<RunningArtifact & DatabaseRevision> {\r\n    return new RunningArtifact(\r\n      await this.pouchdbService.get<RunningArtifactEntry>(id),\r\n      undefined\r\n    ) as RunningArtifact & DatabaseRevision;\r\n  }\r\n\r\n  /**\r\n   * Get the changes of a domain\r\n   *\r\n   * @param id the id of the domain\r\n   * @return the changes feed\r\n   */\r\n  getChangesFeed(id: string): Observable<void> {\r\n    return this.pouchdbService.getChangesFeed(id);\r\n  }\r\n\r\n  async delete(id: string): Promise<void> {\r\n    const result = await this.get(id);\r\n    for (const version of result.versions) {\r\n      if (version.data.type === ArtifactDataType.REFERENCE) {\r\n        await this.artifactDataService.remove(version.data);\r\n      }\r\n    }\r\n    await this.pouchdbService.remove(result);\r\n  }\r\n\r\n  async save(runningArtifact: RunningArtifact): Promise<void> {\r\n    await this.pouchdbService.put(runningArtifact);\r\n  }\r\n\r\n  /**\r\n   * Makes a deep copy of the running artifact by also copying the objects\r\n   * behind references.\r\n   *\r\n   * @param runningArtifact the artifact to copy\r\n   * @return the copy\r\n   */\r\n  async copy(runningArtifact: RunningArtifact): Promise<RunningArtifact> {\r\n    const artifact = new RunningArtifact(undefined, runningArtifact);\r\n    artifact.resetDatabaseState();\r\n    artifact.versions = await Promise.all(\r\n      artifact.versions.map(async (version) => {\r\n        if (version.data.type === ArtifactDataType.REFERENCE) {\r\n          return new ArtifactVersion(undefined, {\r\n            ...version,\r\n            data: await this.artifactDataService.copy(version.data),\r\n          });\r\n        }\r\n        return version;\r\n      })\r\n    );\r\n    return artifact;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RunningProcess } from './running-process';\r\nimport { StepArtifact } from './step-artifact';\r\nimport { ArtifactDataType } from './artifact-data';\r\nimport { ModuleService } from '../module-api/module.service';\r\nimport { Router } from '@angular/router';\r\nimport { RunningMethod } from './running-method';\r\nimport { StepInputArtifact } from './step-input-artifact';\r\nimport { Decision } from '../bm-process/decision';\r\nimport { MethodExecutionOutput } from '../module-api/method-execution-output';\r\nimport { MethodExecutionInput } from '../module-api/method-execution-input';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { ArtifactDataService } from './artifact-data.service';\r\nimport { OutputArtifactMapping } from './output-artifact-mapping';\r\n\r\nexport enum MethodExecutionErrors {\r\n  NO_METHOD = 'The node has no method defined',\r\n  NO_STEPS_LEFT = 'There are no steps left to be executed in the method',\r\n  NOT_DEFINED = 'A method with this execution id is not in the todo list',\r\n  NOT_EXECUTING = 'The execution id is currently not executed',\r\n  NOT_PREPARED = 'The execution of this step is not yet prepared',\r\n  ALREADY_EXECUTING = 'This node is currently already executed.',\r\n  ALREADY_PREPARED = 'The execution of this step is already prepared',\r\n  STEPS_LEFT = 'There are steps left in this method',\r\n  WRONG_STEP = 'Trying to finish the wrong step',\r\n  MISSING_OUTPUT = 'The output artifacts are not correctly mapped',\r\n}\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class MethodExecutionService {\r\n  constructor(\r\n    private artifactDataService: ArtifactDataService,\r\n    private moduleService: ModuleService,\r\n    private router: Router\r\n  ) {}\r\n\r\n  /**\r\n   * Add a method to a running process that is executed out of the defined process\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param decision the method decisions\r\n   */\r\n  addMethod(runningProcess: RunningProcess, decision: Decision): void {\r\n    runningProcess.addTodoMethod(\r\n      new RunningMethod(undefined, {\r\n        decision,\r\n        steps: decision.method.executionSteps.map(() => {\r\n          return {};\r\n        }),\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Remove a method from a running process that is executed out of the defined process\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the method to remove\r\n   */\r\n  removeMethod(runningProcess: RunningProcess, executionId: string): void {\r\n    runningProcess.removeTodoMethod(executionId);\r\n  }\r\n\r\n  /**\r\n   * Start the execution of a method\r\n   * Does not check whether the node has enough tokens to be executed\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param nodeId the node id of the task which includes the method\r\n   * @return the added running method\r\n   */\r\n  startMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    nodeId: string\r\n  ): RunningMethod {\r\n    if (runningProcess.getRunningMethodByNode(nodeId) != null) {\r\n      throw new Error(MethodExecutionErrors.ALREADY_EXECUTING);\r\n    }\r\n    if (!runningProcess.isExecutable(nodeId)) {\r\n      throw new Error(MethodExecutionErrors.NO_METHOD);\r\n    }\r\n    return runningProcess.addRunningMethodOfProcess(nodeId);\r\n  }\r\n\r\n  /**\r\n   * Start the execution of a todomethod\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the execution id of the todomethod\r\n   */\r\n  startTodoMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): void {\r\n    const method = runningProcess.getTodoMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_DEFINED);\r\n    }\r\n    runningProcess.addRunningMethod(method);\r\n    runningProcess.removeTodoMethod(executionId);\r\n  }\r\n\r\n  /**\r\n   * Select the input artifacts\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   * @param inputArtifactMapping the input artifact mapping\r\n   */\r\n  selectInputArtifacts(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    inputArtifactMapping: { artifact: number; version: number }[]\r\n  ): void {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    method.inputArtifacts = inputArtifactMapping.map((mapping) => {\r\n      const artifact = runningProcess.artifacts[mapping.artifact];\r\n      const version = artifact.versions[mapping.version];\r\n      return new StepInputArtifact(undefined, {\r\n        identifier: artifact.identifier,\r\n        artifact: artifact.artifact,\r\n        data: version.data,\r\n        versionInfo: {\r\n          number: mapping.version,\r\n          createdBy: version.createdBy,\r\n          time: version.time,\r\n        },\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check whether the next execution step is already prepared\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   * @return true if the execution step is already prepared\r\n   */\r\n  isExecutionStepPrepared(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): boolean {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    return this._isExecutionStepPrepared(method);\r\n  }\r\n\r\n  /**\r\n   * Check whether the next execution step is already prepared\r\n   *\r\n   * @param method the method to check\r\n   * @return true if the execution step is already prepared\r\n   */\r\n  private _isExecutionStepPrepared(method: RunningMethod): boolean {\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    if (!method.hasStepsLeft()) {\r\n      throw new Error(MethodExecutionErrors.NO_STEPS_LEFT);\r\n    }\r\n    return method.isPrepared();\r\n  }\r\n\r\n  /**\r\n   * Prepare the execution of a step of the currently running method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async prepareExecuteStep(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    if (!method.hasStepsLeft()) {\r\n      throw new Error(MethodExecutionErrors.NO_STEPS_LEFT);\r\n    }\r\n    const currentStep = method.currentStep;\r\n    const module = this.moduleService.getModule(currentStep.module);\r\n    const moduleMethod = module.methods[currentStep.method];\r\n    if (method.isPrepared()) {\r\n      throw new Error(MethodExecutionErrors.ALREADY_PREPARED);\r\n    }\r\n    const stepInput = method.getStepArtifacts(\r\n      method.currentStepNumber,\r\n      moduleMethod.input.length\r\n    );\r\n    const stepArtifacts: StepArtifact[] = await this.copyStepArtifacts(\r\n      stepInput\r\n    );\r\n    method.setInternalStepArtifacts(stepArtifacts);\r\n  }\r\n\r\n  /**\r\n   * Execute a step of the currently running method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async executeStep(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (!this._isExecutionStepPrepared(method)) {\r\n      throw new Error(MethodExecutionErrors.NOT_PREPARED);\r\n    }\r\n    const currentStep = method.currentStep;\r\n    const module = this.moduleService.getModule(currentStep.module);\r\n    const moduleMethodDefinition = module.methods[currentStep.method];\r\n    const moduleService = module.service;\r\n    const internalStepArtifacts = method.getInternalStepArtifacts();\r\n    const input: MethodExecutionInput = {\r\n      router: this.router,\r\n      runningProcess,\r\n      runningMethod: method,\r\n      predefinedInput: method.currentStep.predefinedInput,\r\n      inputStepArtifacts: internalStepArtifacts,\r\n    };\r\n    moduleService.executeMethod(moduleMethodDefinition.name, input);\r\n  }\r\n\r\n  /**\r\n   * Finish the execution of a step\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   * @param step the step in the method\r\n   * @param output the output of the method of the module\r\n   */\r\n  finishExecuteStep(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    step: number,\r\n    output: MethodExecutionOutput\r\n  ): void {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (!this._isExecutionStepPrepared(method)) {\r\n      throw new Error(MethodExecutionErrors.NOT_PREPARED);\r\n    }\r\n    if (method.currentStepNumber !== step) {\r\n      throw new Error(MethodExecutionErrors.WRONG_STEP);\r\n    }\r\n    const currentStep = method.currentStep;\r\n    const module = this.moduleService.getModule(currentStep.module);\r\n    const moduleMethodDefinition = module.methods[currentStep.method];\r\n    const artifacts = output.outputArtifactData;\r\n    method.finishStepExecution(\r\n      artifacts.map(\r\n        (artifactData, index) =>\r\n          new StepArtifact(undefined, {\r\n            identifier: undefined,\r\n            artifact: {\r\n              name: undefined,\r\n              list: undefined,\r\n              metaModel: {\r\n                name: undefined,\r\n                type: moduleMethodDefinition.output[index].type,\r\n              },\r\n            },\r\n            data: artifactData,\r\n          })\r\n      )\r\n    );\r\n    void this.router.navigate([\r\n      'runningprocess',\r\n      'runningprocessview',\r\n      runningProcess._id,\r\n      'method',\r\n      executionId,\r\n    ]);\r\n  }\r\n\r\n  /**\r\n   * Update the output artifact mapping of a method.\r\n   *\r\n   * @param runningProcess the running Process\r\n   * @param executionId the id of the executed method\r\n   * @param outputArtifacts the mapping of the artifacts\r\n   */\r\n  updateOutputArtifacts(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    outputArtifacts: OutputArtifactMapping[]\r\n  ): void {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    if (method.hasStepsLeft()) {\r\n      throw new Error(MethodExecutionErrors.STEPS_LEFT);\r\n    }\r\n    method.updateOutputArtifacts(outputArtifacts);\r\n  }\r\n\r\n  /**\r\n   * Add the output artifacts\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   * @param outputArtifactsMapping the mapping of the artifacts\r\n   */\r\n  private async addOutputArtifacts(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    outputArtifactsMapping: OutputArtifactMapping[]\r\n  ): Promise<void> {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    if (method.hasStepsLeft()) {\r\n      throw new Error(MethodExecutionErrors.STEPS_LEFT);\r\n    }\r\n    const artifacts = method.getProcessOutputArtifacts();\r\n    const methodOutputArtifacts = await this.copyStepArtifacts(\r\n      method.getOutputArtifacts()\r\n    );\r\n    for (let i = 0; i < methodOutputArtifacts.length; i++) {\r\n      if (methodOutputArtifacts[i] != null) {\r\n        outputArtifactsMapping[i].data = methodOutputArtifacts[i].data;\r\n      }\r\n    }\r\n    runningProcess.addOutputArtifacts(\r\n      executionId,\r\n      artifacts,\r\n      outputArtifactsMapping\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Stop the execution of a method after it is finished\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async stopMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    if (method.hasStepsLeft()) {\r\n      throw new Error(MethodExecutionErrors.STEPS_LEFT);\r\n    }\r\n    if (!method.hasOutputArtifactsCorrectlyDefined()) {\r\n      throw new Error(MethodExecutionErrors.MISSING_OUTPUT);\r\n    }\r\n    await this.addOutputArtifacts(\r\n      runningProcess,\r\n      executionId,\r\n      method.outputArtifacts ?? []\r\n    );\r\n    await this.removeUnusedArtifacts(method);\r\n    runningProcess.addExecutedMethod({\r\n      nodeId: method.nodeId,\r\n      executionId: method.executionId,\r\n      methodName: method.methodName,\r\n      comments: method.comments,\r\n    });\r\n    runningProcess.removeRunningMethod(executionId);\r\n  }\r\n\r\n  /**\r\n   * Abort the execution of a method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async abortMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const method = runningProcess.getRunningMethod(executionId);\r\n    if (method == null) {\r\n      throw new Error(MethodExecutionErrors.NOT_EXECUTING);\r\n    }\r\n    await this.removeUnusedArtifacts(method);\r\n    runningProcess.removeRunningMethod(executionId);\r\n  }\r\n\r\n  /**\r\n   * Copy the step artifacts\r\n   *\r\n   * @param stepArtifacts the step artifacts\r\n   * @return the copied step artifacts\r\n   */\r\n  private async copyStepArtifacts(\r\n    stepArtifacts: StepArtifact[]\r\n  ): Promise<StepArtifact[]> {\r\n    return Promise.all(\r\n      stepArtifacts.map(async (artifact) => {\r\n        if (artifact.data.type === ArtifactDataType.REFERENCE) {\r\n          return new StepArtifact(undefined, {\r\n            ...artifact,\r\n            data: await this.artifactDataService.copy(artifact.data),\r\n          });\r\n        }\r\n        return new StepArtifact(undefined, artifact);\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Remove all step artifacts in steps\r\n   *\r\n   * @param method the running method\r\n   */\r\n  private async removeUnusedArtifacts(method: RunningMethod): Promise<void> {\r\n    const artifacts = method.getAllStepArtifacts();\r\n    const toRemove = artifacts.filter(\r\n      (artifact) => artifact.data.type === ArtifactDataType.REFERENCE\r\n    );\r\n    for (const artifact of toRemove) {\r\n      await this.artifactDataService.remove(artifact.data);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  ArtifactData,\r\n  ArtifactDataEntry,\r\n  ArtifactDataInit,\r\n} from './artifact-data';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface OutputArtifactMappingInit extends DatabaseInit {\r\n  isDefinition: boolean;\r\n  artifact?: number;\r\n  artifactName?: string;\r\n  data: ArtifactDataInit;\r\n}\r\n\r\nexport interface OutputArtifactMappingEntry extends DatabaseEntry {\r\n  isDefinition: boolean;\r\n  artifact?: number;\r\n  artifactName?: string;\r\n  data: ArtifactDataEntry;\r\n}\r\n\r\nexport class OutputArtifactMapping\r\n  implements OutputArtifactMappingInit, DatabaseModelPart\r\n{\r\n  isDefinition: boolean;\r\n  artifact?: number;\r\n  artifactName?: string;\r\n  data: ArtifactData;\r\n\r\n  constructor(\r\n    entry: OutputArtifactMappingEntry | undefined,\r\n    init: OutputArtifactMappingInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.isDefinition = element.isDefinition;\r\n    this.artifact = element.artifact;\r\n    this.artifactName = element.artifactName;\r\n    if (entry != null) {\r\n      this.data = new ArtifactData(entry.data, undefined);\r\n    } else if (init != null) {\r\n      this.data = new ArtifactData(undefined, init.data);\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  toDb(): OutputArtifactMappingEntry {\r\n    return {\r\n      isDefinition: this.isDefinition,\r\n      artifact: this.artifact,\r\n      artifactName: this.artifactName,\r\n      data: this.data.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport bmdl from '../../../assets/bpmn_bmdl.json';\r\nimport rbmp from '../../../assets/bpmn_running_process.json';\r\nimport BpmnModeler from 'bpmn-js/lib/Modeler';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { isLabel } from 'bpmn-js/lib/util/LabelUtil';\r\nimport { RunningProcess } from './running-process';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ProcessExecutionModelerService {\r\n  /**\r\n   * Get a BpmnModeler with the imported running process\r\n   *\r\n   * @param runningProcess the running process to import\r\n   * @return the bpmnModeler\r\n   */\r\n  async initModeling(runningProcess: RunningProcess): Promise<BpmnModeler> {\r\n    const processModeler = this.getRunningProcessModeler();\r\n    await processModeler.importXML(runningProcess.process.processDiagram);\r\n    return processModeler;\r\n  }\r\n\r\n  /**\r\n   * End the modeling and update the diagram of the running process\r\n   *\r\n   * @param runningProcess the running process to update\r\n   * @param modeler the modeler\r\n   */\r\n  async endModeling(\r\n    runningProcess: RunningProcess,\r\n    modeler: BpmnModeler\r\n  ): Promise<void> {\r\n    const result = await modeler.saveXML();\r\n    runningProcess.process.processDiagram = result.xml;\r\n    modeler.destroy();\r\n  }\r\n\r\n  /**\r\n   * Destroy the modeler\r\n   *\r\n   * @param modeler the modeler\r\n   */\r\n  abortModeling(modeler: BpmnModeler): void {\r\n    modeler.destroy();\r\n  }\r\n\r\n  /**\r\n   * Get a BpmnModeler with customizations to manage running processes\r\n   *\r\n   * @return a bpmnModeler\r\n   */\r\n  private getRunningProcessModeler(): BpmnModeler {\r\n    return new BpmnModeler({\r\n      additionalModules: [],\r\n      moddleExtensions: {\r\n        bmdl,\r\n        rbmp,\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Filter nodes of the modeler\r\n   *\r\n   * @param modeler the modeler\r\n   * @param filter the filter function\r\n   * @return the list of the filtered nodes\r\n   */\r\n  filterNodes(modeler: BpmnModeler, filter: (node) => boolean): any[] {\r\n    return modeler.get('elementRegistry').filter(filter);\r\n  }\r\n\r\n  /**\r\n   * Get a node from a node id\r\n   *\r\n   * @param modeler the modeler\r\n   * @param nodeId the id of the node\r\n   * @return the node\r\n   */\r\n  getNode(modeler: BpmnModeler, nodeId: string): any {\r\n    return modeler.get('elementRegistry').get(nodeId);\r\n  }\r\n\r\n  /**\r\n   * Get the start event that has the process as a parent\r\n   *\r\n   * @param modeler the modeler\r\n   * @return the start event node\r\n   */\r\n  getStartNode(modeler: BpmnModeler): any {\r\n    return modeler\r\n      .get('elementRegistry')\r\n      .find(\r\n        (node) =>\r\n          is(node, 'bpmn:StartEvent') &&\r\n          is(node.parent, 'bpmn:Process') &&\r\n          !isLabel(node)\r\n      );\r\n  }\r\n\r\n  /**\r\n   * Get how many tokens this node stores\r\n   *\r\n   * @param node the node to check\r\n   * @return the token count\r\n   */\r\n  getTokens(node): number {\r\n    return node.businessObject.get('tokens');\r\n  }\r\n\r\n  /**\r\n   * Get all incoming flows of a node\r\n   *\r\n   * @param node the node\r\n   * @return the incoming flows\r\n   */\r\n  getIncomingFlows(node): any[] {\r\n    return node.incoming;\r\n  }\r\n\r\n  /**\r\n   * Get all target flows of a node, subprocess adjusted\r\n   *\r\n   * @param node the node\r\n   * @return the target flows\r\n   */\r\n  getTargetFlows(node): any[] {\r\n    let currentNode;\r\n    let outgoingFlows;\r\n    for (\r\n      currentNode = node, outgoingFlows = currentNode.outgoing;\r\n      outgoingFlows.length === 0;\r\n      currentNode = currentNode.parent, outgoingFlows = currentNode.outgoing\r\n    ) {\r\n      if (is(currentNode.parent, 'bpmn:Process')) {\r\n        return [];\r\n      }\r\n    }\r\n    return outgoingFlows;\r\n  }\r\n\r\n  /**\r\n   * Get the target node of a flow\r\n   *\r\n   * @param flow the flow to analyse\r\n   * @return the target node\r\n   */\r\n  getTargetNode(flow): any {\r\n    const target = flow.target;\r\n    if (is(target, 'bpmn:SubProcess')) {\r\n      return target.children.find((element) => is(element, 'bpmn:StartEvent'));\r\n    }\r\n    return target;\r\n  }\r\n\r\n  /**\r\n   * Checks whether the node is a common node, i.e. a gateway or end or start event\r\n   *\r\n   * @param node the node to check\r\n   * @return true if the node is a common node\r\n   */\r\n  isCommonNode(node): boolean {\r\n    return (\r\n      (is(node, 'bpmn:StartEvent') ||\r\n        is(node, 'bpmn:EndEvent') ||\r\n        is(node, 'bpmn:ExclusiveGateway') ||\r\n        is(node, 'bpmn:ParallelGateway')) &&\r\n      !isLabel(node)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether the node is an exclusive gateway\r\n   *\r\n   * @param node the node to check\r\n   * @return true if the node is an exclusive gateway\r\n   */\r\n  isExclusiveGateway(node): boolean {\r\n    return is(node, 'bpmn:ExclusiveGateway') && !isLabel(node);\r\n  }\r\n\r\n  /**\r\n   * Checks whether the node is a parallel gateway\r\n   *\r\n   * @param node the node to check\r\n   * @return true if the node is a parallel gateway\r\n   */\r\n  isParallelGateway(node): boolean {\r\n    return is(node, 'bpmn:ParallelGateway') && !isLabel(node);\r\n  }\r\n\r\n  /**\r\n   * Checks whether the node is executable, i.e. a task or method\r\n   *\r\n   * @param node the node to check\r\n   * @return true if the node is executable\r\n   */\r\n  isExecutable(node): boolean {\r\n    return (\r\n      (is(node, 'bpmn:Task') || is(node, 'bpmn:CallActivity')) && !isLabel(node)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether the node is a sub process\r\n   *\r\n   * @param node the node to check\r\n   * @return true if the node is a sub process\r\n   */\r\n  isSubProcess(node): boolean {\r\n    return is(node, 'bpmn:SubProcess') && !isLabel(node);\r\n  }\r\n\r\n  /**\r\n   * Set the node to executed\r\n   *\r\n   * @param modeler the modeler\r\n   * @param node the node\r\n   * @param value whether the node is executed or not\r\n   */\r\n  setExecuted(modeler: BpmnModeler, node, value: boolean = true): void {\r\n    modeler.get('modeling').updateProperties(node, { executed: value });\r\n  }\r\n\r\n  /**\r\n   * Set the flow to used\r\n   *\r\n   * @param modeler the modeler\r\n   * @param flow the flow\r\n   * @param value whether the flow is used or not\r\n   */\r\n  setUsed(modeler: BpmnModeler, flow, value: boolean = true): void {\r\n    modeler.get('modeling').updateProperties(flow, { used: value });\r\n  }\r\n\r\n  /**\r\n   * Update the token number\r\n   *\r\n   * @param modeler the modeler\r\n   * @param node the node to update\r\n   * @param delta the delta of tokens\r\n   */\r\n  updateTokens(modeler: BpmnModeler, node, delta: number): void {\r\n    const modeling = modeler.get('modeling');\r\n    let current = node;\r\n    while (current && !is(current, 'bpmn:Process')) {\r\n      modeling.updateProperties(current, {\r\n        tokens: this.getTokens(current) + delta,\r\n      });\r\n      current = current.parent;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RunningProcess } from './running-process';\r\nimport { ProcessExecutionModelerService } from './process-execution-modeler.service';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\n\r\nexport enum ExecutionErrors {\r\n  MULTIPLE_OPTIONS = 'No outgoing flow selected for exclusive gateway.',\r\n  NOT_ENOUGH_TOKENS = 'Element has not enough tokens to be executed.',\r\n  NODE_NOT_FOUND = 'Node not found',\r\n  INCORRECT_NODE = 'Node can not be used with this method',\r\n}\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class ProcessExecutionService {\r\n  constructor(\r\n    private processExecutionModelerService: ProcessExecutionModelerService\r\n  ) {}\r\n\r\n  /**\r\n   * Initialize a running process and add the first token\r\n   *\r\n   * @param runningProcess the running process\r\n   */\r\n  async initRunningProcess(runningProcess: RunningProcess): Promise<void> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const startNode = this.processExecutionModelerService.getStartNode(modeler);\r\n    this.processExecutionModelerService.updateTokens(modeler, startNode, 1);\r\n    await this.processExecutionModelerService.endModeling(\r\n      runningProcess,\r\n      modeler\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Move to the next node from current node\r\n   * Node has to be a common node, not a task or method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param nodeId the id of the node\r\n   * @param flowId the id of the flow to take if the node is a XOR node with multiple outgoing nodes\r\n   */\r\n  async moveToNextStep(\r\n    runningProcess: RunningProcess,\r\n    nodeId: string,\r\n    flowId: string = null\r\n  ): Promise<void> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const node = this.processExecutionModelerService.getNode(modeler, nodeId);\r\n    if (node == null) {\r\n      throw new Error(ExecutionErrors.NODE_NOT_FOUND);\r\n    }\r\n    if (\r\n      !this.processExecutionModelerService.isCommonNode(node) &&\r\n      runningProcess.isExecutable(nodeId)\r\n    ) {\r\n      throw new Error(ExecutionErrors.INCORRECT_NODE);\r\n    }\r\n    this._moveToNextStep(modeler, node, flowId);\r\n    await this.processExecutionModelerService.endModeling(\r\n      runningProcess,\r\n      modeler\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Move to the next node from current node\r\n   * Node has to be a common node, not a task or method\r\n   *\r\n   * @param modeler the modeler\r\n   * @param node the node\r\n   * @param flowId the id of the flow to take if the node is a XOR node with multiple outgoing nodes\r\n   */\r\n  private _moveToNextStep(\r\n    modeler: any,\r\n    node: any,\r\n    flowId: string = null\r\n  ): void {\r\n    if (!this.hasEnoughTokens(node)) {\r\n      throw new Error(ExecutionErrors.NOT_ENOUGH_TOKENS);\r\n    }\r\n    let targetFlows = this.processExecutionModelerService.getTargetFlows(node);\r\n    if (\r\n      this.processExecutionModelerService.isExclusiveGateway(node) &&\r\n      targetFlows.length > 1 &&\r\n      (flowId == null || !targetFlows.map((flow) => flow.id).includes(flowId))\r\n    ) {\r\n      throw new Error(ExecutionErrors.MULTIPLE_OPTIONS);\r\n    }\r\n    if (\r\n      this.processExecutionModelerService.isExclusiveGateway(node) &&\r\n      targetFlows.length > 1 &&\r\n      flowId != null\r\n    ) {\r\n      targetFlows = [targetFlows.find((flow) => flow.id === flowId)];\r\n    }\r\n    this.processExecutionModelerService.setExecuted(modeler, node);\r\n    this.followFlows(modeler, targetFlows);\r\n    this.processExecutionModelerService.updateTokens(\r\n      modeler,\r\n      node,\r\n      -this.getMinimumNeededTokens(node)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Move to the next node after the execution of a method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param nodeId the id of the node\r\n   */\r\n  async moveToNextMethod(\r\n    runningProcess: RunningProcess,\r\n    nodeId: string\r\n  ): Promise<void> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const node = this.processExecutionModelerService.getNode(modeler, nodeId);\r\n    if (node == null) {\r\n      throw new Error(ExecutionErrors.NODE_NOT_FOUND);\r\n    }\r\n    if (\r\n      !this.processExecutionModelerService.isExecutable(node) ||\r\n      !runningProcess.isExecutable(nodeId)\r\n    ) {\r\n      throw new Error(ExecutionErrors.INCORRECT_NODE);\r\n    }\r\n    this.processExecutionModelerService.setExecuted(modeler, node);\r\n    const targetFlows =\r\n      this.processExecutionModelerService.getTargetFlows(node);\r\n    this.followFlows(modeler, targetFlows);\r\n    this.processExecutionModelerService.updateTokens(\r\n      modeler,\r\n      node,\r\n      -this.getMinimumNeededTokens(node)\r\n    );\r\n    await this.processExecutionModelerService.endModeling(\r\n      runningProcess,\r\n      modeler\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Jump until there are only methods to be executed\r\n   *\r\n   * @param runningProcess the running process\r\n   */\r\n  async jumpToNextMethod(runningProcess: RunningProcess): Promise<void> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const ignoredIds = new Set<string>();\r\n    const filterCommonNodes = (node): boolean =>\r\n      !ignoredIds.has(node.id) &&\r\n      (this.processExecutionModelerService.isCommonNode(node) ||\r\n        (!runningProcess.isExecutable(node.id) &&\r\n          this.processExecutionModelerService.isExecutable(node)));\r\n    for (\r\n      let nodes = this._getExecutableNodes(modeler).filter(filterCommonNodes);\r\n      nodes.length > 0;\r\n      nodes = this._getExecutableNodes(modeler).filter(filterCommonNodes)\r\n    ) {\r\n      for (const node of nodes) {\r\n        try {\r\n          this._moveToNextStep(modeler, node);\r\n        } catch (e) {\r\n          if (e.message === ExecutionErrors.MULTIPLE_OPTIONS) {\r\n            ignoredIds.add(node.id);\r\n          } else {\r\n            throw e;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    await this.processExecutionModelerService.endModeling(\r\n      runningProcess,\r\n      modeler\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Follow the flows to the next nodes\r\n   *\r\n   * @param modeler the current modeler\r\n   * @param targetFlows the target flows\r\n   */\r\n  private followFlows(modeler: any, targetFlows: any[]): void {\r\n    targetFlows.forEach((flow) =>\r\n      this.processExecutionModelerService.setUsed(modeler, flow)\r\n    );\r\n    const targets = targetFlows.map(\r\n      this.processExecutionModelerService.getTargetNode\r\n    );\r\n    targets.forEach((target) => {\r\n      this.processExecutionModelerService.setExecuted(modeler, target, false);\r\n      this.processExecutionModelerService.updateTokens(modeler, target, 1);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check whether it is possible to execute the node\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param nodeId the id of the node to execute\r\n   * @return true if the node can be executed\r\n   */\r\n  async canExecuteNode(\r\n    runningProcess: RunningProcess,\r\n    nodeId: string\r\n  ): Promise<boolean> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const node = this.processExecutionModelerService.getNode(modeler, nodeId);\r\n    if (node == null) {\r\n      throw new Error(ExecutionErrors.NODE_NOT_FOUND);\r\n    }\r\n    if (\r\n      !this.processExecutionModelerService.isExecutable(node) ||\r\n      !runningProcess.isExecutable(nodeId)\r\n    ) {\r\n      throw new Error(ExecutionErrors.INCORRECT_NODE);\r\n    }\r\n    if (!this.hasEnoughTokens(node)) {\r\n      throw new Error(ExecutionErrors.NOT_ENOUGH_TOKENS);\r\n    }\r\n    this.processExecutionModelerService.abortModeling(modeler);\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Get all nodes that can be executed, i.e. have enough tokens and are not subprocesses\r\n   *\r\n   * @param runningProcess the running process\r\n   * @return the nodes that have enough tokens to be executed\r\n   */\r\n  async getExecutableNodes(runningProcess: RunningProcess): Promise<any[]> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const nodes = this._getExecutableNodes(modeler);\r\n    this.processExecutionModelerService.abortModeling(modeler);\r\n    return nodes;\r\n  }\r\n\r\n  /**\r\n   * Get all decision nodes that are executable and need a decision\r\n   *\r\n   * @param runningProcess the running process\r\n   * @return the decision nodes\r\n   */\r\n  async getExecutableDecisionNodes(\r\n    runningProcess: RunningProcess\r\n  ): Promise<any[]> {\r\n    const modeler = await this.processExecutionModelerService.initModeling(\r\n      runningProcess\r\n    );\r\n    const nodes = this.processExecutionModelerService.filterNodes(\r\n      modeler,\r\n      (node) =>\r\n        this.hasEnoughTokens(node) &&\r\n        this.processExecutionModelerService.isExclusiveGateway(node) &&\r\n        this.processExecutionModelerService.getTargetFlows(node).length > 1\r\n    );\r\n    this.processExecutionModelerService.abortModeling(modeler);\r\n    return nodes;\r\n  }\r\n\r\n  /**\r\n   * Get all nodes that can be executed, i.e. have enough tokens and are not subprocesses\r\n   *\r\n   * @param modeler the modeler\r\n   * @return the nodes that have enough tokens to be executed\r\n   */\r\n  private _getExecutableNodes(modeler: any): any[] {\r\n    return this.processExecutionModelerService.filterNodes(\r\n      modeler,\r\n      (node) =>\r\n        !this.processExecutionModelerService.isSubProcess(node) &&\r\n        this.hasEnoughTokens(node)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get the number of tokens needed to execute this node\r\n   *\r\n   * @param node the node to execute\r\n   * @return number of tokens needed to execute the node\r\n   */\r\n  private getMinimumNeededTokens(node): number {\r\n    if (\r\n      this.processExecutionModelerService.isParallelGateway(node) ||\r\n      this.processExecutionModelerService.isExecutable(node)\r\n    ) {\r\n      return this.processExecutionModelerService.getIncomingFlows(node).length;\r\n    }\r\n    return 1;\r\n  }\r\n\r\n  /**\r\n   * Checks whether a node has enough tokens to be executed\r\n   *\r\n   * @param node the node to execute\r\n   * @return true if the node has enough tokens to be executed\r\n   */\r\n  private hasEnoughTokens(node): boolean {\r\n    return (\r\n      this.getMinimumNeededTokens(node) <=\r\n      this.processExecutionModelerService.getTokens(node)\r\n    );\r\n  }\r\n}\r\n","import {\r\n  Artifact,\r\n  ArtifactEntry,\r\n  ArtifactInit,\r\n} from '../method-elements/artifact/artifact';\r\nimport {\r\n  ArtifactVersion,\r\n  ArtifactVersionEntry,\r\n  ArtifactVersionInit,\r\n} from './artifact-version';\r\nimport { DatabaseModel } from '../../database/database-model';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\n\r\nexport interface RunningArtifactInit extends DatabaseRootInit {\r\n  identifier: string;\r\n  artifact: ArtifactInit;\r\n  versions?: ArtifactVersionInit[];\r\n}\r\n\r\nexport interface RunningArtifactEntry extends DatabaseRootEntry {\r\n  identifier: string;\r\n  artifact: ArtifactEntry;\r\n  versions: ArtifactVersionEntry[];\r\n}\r\n\r\nexport class RunningArtifact\r\n  extends DatabaseModel\r\n  implements RunningArtifactInit\r\n{\r\n  static readonly typeName = 'RunningArtifact';\r\n\r\n  identifier: string;\r\n  artifact: Artifact;\r\n  versions: ArtifactVersion[] = [];\r\n\r\n  constructor(\r\n    entry: RunningArtifactEntry | undefined,\r\n    init: RunningArtifactInit | undefined\r\n  ) {\r\n    super(entry, init, RunningArtifact.typeName);\r\n    const element = entry ?? init;\r\n    this.identifier = element.identifier;\r\n    if (entry != null) {\r\n      this.artifact = new Artifact(entry.artifact, undefined);\r\n      this.versions =\r\n        entry.versions?.map(\r\n          (version) => new ArtifactVersion(version, undefined)\r\n        ) ?? this.versions;\r\n    } else {\r\n      this.artifact = new Artifact(undefined, init.artifact);\r\n      this.versions =\r\n        init.versions?.map(\r\n          (version) => new ArtifactVersion(undefined, version)\r\n        ) ?? this.versions;\r\n    }\r\n  }\r\n\r\n  addVersion(version: ArtifactVersionInit): void {\r\n    this.versions.push(new ArtifactVersion(undefined, version));\r\n  }\r\n\r\n  toDb(): RunningArtifactEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      identifier: this.identifier,\r\n      artifact: this.artifact.toDb(),\r\n      versions: this.versions.map((version) => version.toDb()),\r\n    };\r\n  }\r\n}\r\n","import { Step, StepEntry, StepInit } from './step';\r\nimport { StepArtifact } from './step-artifact';\r\nimport { RunningMethodInfo } from './running-method-info';\r\nimport { Decision, DecisionEntry, DecisionInit } from '../bm-process/decision';\r\nimport { ExecutionStep } from '../development-method/execution-step';\r\nimport { ArtifactMapping } from '../development-method/artifact-mapping';\r\nimport { Artifact } from '../method-elements/artifact/artifact';\r\nimport {\r\n  StepInputArtifact,\r\n  StepInputArtifactEntry,\r\n  StepInputArtifactInit,\r\n} from './step-input-artifact';\r\nimport { Comment, CommentEntry, CommentInit } from './comment';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport {\r\n  OutputArtifactMapping,\r\n  OutputArtifactMappingEntry,\r\n  OutputArtifactMappingInit,\r\n} from './output-artifact-mapping';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport interface RunningMethodInit extends DatabaseInit {\r\n  nodeId?: string;\r\n  executionId?: string;\r\n  comments?: CommentInit[];\r\n  decision: DecisionInit;\r\n\r\n  currentStepNumber?: number;\r\n  steps?: StepInit[];\r\n  inputArtifacts?: StepInputArtifactInit[];\r\n  outputArtifacts?: OutputArtifactMappingInit[];\r\n}\r\n\r\nexport interface RunningMethodEntry extends DatabaseEntry {\r\n  nodeId?: string;\r\n  executionId: string;\r\n  comments: CommentEntry[];\r\n  decision: DecisionEntry;\r\n\r\n  currentStepNumber: number;\r\n  steps: StepEntry[];\r\n  inputArtifacts: StepInputArtifactEntry[];\r\n  outputArtifacts?: OutputArtifactMappingEntry[];\r\n}\r\n\r\nexport class RunningMethod\r\n  implements RunningMethodInit, RunningMethodInfo, DatabaseModelPart\r\n{\r\n  nodeId?: string = null;\r\n  executionId: string;\r\n  comments: Comment[] = [];\r\n  decision: Decision;\r\n\r\n  currentStepNumber = 0;\r\n  steps: Step[] = [];\r\n\r\n  inputArtifacts: StepInputArtifact[] = null;\r\n  outputArtifacts?: OutputArtifactMapping[];\r\n\r\n  constructor(\r\n    entry: RunningMethodEntry | undefined,\r\n    init: RunningMethodInit | undefined\r\n  ) {\r\n    const element = entry ?? init;\r\n    this.nodeId = element.nodeId;\r\n    this.executionId = element.executionId ?? uuidv4();\r\n    this.currentStepNumber =\r\n      element.currentStepNumber ?? this.currentStepNumber;\r\n    if (entry != null) {\r\n      this.comments =\r\n        entry.comments?.map((comment) => new Comment(comment, undefined)) ??\r\n        this.comments;\r\n      this.decision = new Decision(entry.decision, undefined);\r\n      this.steps =\r\n        entry.steps?.map((step) => new Step(step, undefined)) ?? this.steps;\r\n      this.inputArtifacts =\r\n        entry.inputArtifacts?.map(\r\n          (artifact) => new StepInputArtifact(artifact, undefined)\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        entry.outputArtifacts?.map(\r\n          (artifact) => new OutputArtifactMapping(artifact, undefined)\r\n        ) ?? this.outputArtifacts;\r\n    } else if (init != null) {\r\n      this.comments =\r\n        init.comments?.map((comment) => new Comment(undefined, comment)) ??\r\n        this.comments;\r\n      this.decision = new Decision(undefined, init.decision);\r\n      this.steps =\r\n        init.steps?.map((step) => new Step(undefined, step)) ?? this.steps;\r\n      this.inputArtifacts =\r\n        init.inputArtifacts?.map(\r\n          (artifact) => new StepInputArtifact(undefined, artifact)\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        init.outputArtifacts?.map(\r\n          (artifact) => new OutputArtifactMapping(undefined, artifact)\r\n        ) ?? this.outputArtifacts;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Finish the step execution by setting the setp artifacts as output\r\n   *\r\n   * @param output the output of the module method\r\n   */\r\n  finishStepExecution(output: StepArtifact[]): void {\r\n    this.steps[this.currentStepNumber].finish(output);\r\n    this.currentStepNumber += 1;\r\n  }\r\n\r\n  /**\r\n   * Checks whether there are steps left to be executed\r\n   *\r\n   * @return true if the method has steps to execute left, false otherwise\r\n   */\r\n  hasStepsLeft(): boolean {\r\n    return this.currentStepNumber < this.steps.length;\r\n  }\r\n\r\n  /**\r\n   * Checks whether this method has steps that can be executed\r\n   *\r\n   * @return true if the method has steps, false otherwise\r\n   */\r\n  hasSteps(): boolean {\r\n    return this.steps.length > 0;\r\n  }\r\n\r\n  /**\r\n   * Checks whether the next execution step is prepared\r\n   *\r\n   * @return true if the next execution step is prepared\r\n   */\r\n  isPrepared(): boolean {\r\n    return this.steps[this.currentStepNumber].inputArtifacts != null;\r\n  }\r\n\r\n  /**\r\n   * Set the internal step artifacts for the next execution step and prepare the next step by doing this\r\n   *\r\n   * @param stepArtifacts the step artifacts\r\n   */\r\n  setInternalStepArtifacts(stepArtifacts: StepArtifact[]): void {\r\n    this.steps[this.currentStepNumber].inputArtifacts = stepArtifacts;\r\n  }\r\n\r\n  /**\r\n   * Get the internal step artifacts for the next execution step\r\n   *\r\n   * @return the step artifacts\r\n   */\r\n  getInternalStepArtifacts(): StepArtifact[] {\r\n    return this.steps[this.currentStepNumber].inputArtifacts;\r\n  }\r\n\r\n  /**\r\n   * Get the output artifacts of the process definition\r\n   *\r\n   * @return the output artifacts of the process\r\n   */\r\n  getProcessOutputArtifacts(): Artifact[] {\r\n    const currentDecision = this.decision;\r\n    const artifacts: Artifact[] = [];\r\n    currentDecision.outputArtifacts\r\n      .getList(currentDecision.method.outputArtifacts)\r\n      .elements.forEach((element) => artifacts.push(...element.elements));\r\n    return artifacts;\r\n  }\r\n\r\n  /**\r\n   * Get all input artifacts of all steps\r\n   *\r\n   * @return a list of all step artifacts\r\n   */\r\n  getAllStepArtifacts(): StepArtifact[] {\r\n    const artifacts: StepArtifact[] = [];\r\n    this.steps.forEach((step) => {\r\n      if (step.inputArtifacts != null) {\r\n        artifacts.push(...step.inputArtifacts);\r\n      }\r\n      if (step.outputArtifacts != null) {\r\n        artifacts.push(...step.outputArtifacts);\r\n      }\r\n    });\r\n    return artifacts;\r\n  }\r\n\r\n  /**\r\n   * Get all input artifacts for a specific step by iterating over all artifacts and selecting them based on their mapping\r\n   *\r\n   * @param step the step for which to get the artifacts\r\n   * @param size the number of artifacts for that step\r\n   * @return the list of artifacts\r\n   */\r\n  getStepArtifacts(step: number, size: number): StepArtifact[] {\r\n    return this.iterateMappings(\r\n      size,\r\n      (mapping) => mapping.output === false && mapping.step === step\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get all output artifacts for this method by iterating over all artifacts and selecting them based on their mapping\r\n   *\r\n   * @return the list of artifacts\r\n   */\r\n  getOutputArtifacts(): StepArtifact[] {\r\n    const group = this.decision.outputArtifacts.selectedGroup;\r\n    if (group == null) {\r\n      return [];\r\n    }\r\n    return this.iterateMappings(\r\n      this.decision.method.outputArtifacts[group].length,\r\n      (mapping) => mapping.output === true && mapping.group === group\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Iterate over all artifacts and select them based on their mapping\r\n   *\r\n   * @param artifactLength the length of the resulting artifacts list\r\n   * @param filter the function to select the artifacts based on their mapping\r\n   * @return the artifacts list\r\n   */\r\n  private iterateMappings(\r\n    artifactLength: number,\r\n    filter: (mapping: ArtifactMapping) => boolean\r\n  ): StepArtifact[] {\r\n    const artifacts = [];\r\n    artifacts.length = artifactLength;\r\n    this.iterateInputMappings(artifacts, filter);\r\n    this.iterateExecutionStepMappings(artifacts, filter);\r\n    return artifacts;\r\n  }\r\n\r\n  /**\r\n   * Iterate over the input artifacts and add them to the artifacts list\r\n   *\r\n   * @param artifacts the artifacts list, will be changed\r\n   * @param filter the filter function to select input artifacts based on their mapping\r\n   */\r\n  private iterateInputMappings(\r\n    artifacts: StepArtifact[],\r\n    filter: (mapping: ArtifactMapping) => boolean\r\n  ): void {\r\n    const method = this.decision.method;\r\n    const inputGroup = this.decision.inputArtifacts.selectedGroup;\r\n    if (inputGroup != null) {\r\n      const artifactInputGroup = method.inputArtifacts[inputGroup];\r\n      for (let i = 0; i < artifactInputGroup.length; i++) {\r\n        const artifact = artifactInputGroup[i];\r\n        for (const mapping of artifact.mapping) {\r\n          if (filter(mapping)) {\r\n            artifacts[mapping.artifact] = this.inputArtifacts[i];\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Iterate over the execution step artifacts and add them to the artifacts list\r\n   *\r\n   * @param artifacts the artifacts list, will be changed\r\n   * @param filter the filter function to select step artifacts based on their mapping\r\n   */\r\n  private iterateExecutionStepMappings(\r\n    artifacts: StepArtifact[],\r\n    filter: (mapping: ArtifactMapping) => boolean\r\n  ): void {\r\n    const method = this.decision.method;\r\n    for (let i = 0; i < method.executionSteps.length; i++) {\r\n      const executionStep = method.executionSteps[i];\r\n      for (let j = 0; j < executionStep.outputMappings.length; j++) {\r\n        const outputArtifact = executionStep.outputMappings[j];\r\n        for (const mapping of outputArtifact) {\r\n          if (filter(mapping)) {\r\n            artifacts[mapping.artifact] = this.steps[i].outputArtifacts[j];\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the output artifacts together with their data and mapping.\r\n   */\r\n  updateOutputArtifacts(outputArtifacts: OutputArtifactMapping[]): void {\r\n    this.outputArtifacts = outputArtifacts;\r\n  }\r\n\r\n  /**\r\n   * Checks whether the output artifacts are defined or whether there are no output artifacts.\r\n   *\r\n   * @return true if the output artifacts are defined or if there are no output artifacts\r\n   */\r\n  hasOutputArtifactsCorrectlyDefined(): boolean {\r\n    const outputArtifacts = this.decision.outputArtifacts.getList(\r\n      this.decision.method.outputArtifacts\r\n    ).elements;\r\n    if (outputArtifacts.length === 0) {\r\n      return true;\r\n    }\r\n    if (this.outputArtifacts != null) {\r\n      return (\r\n        this.outputArtifacts.length ===\r\n        outputArtifacts.reduce((acc, summay) => acc + summay.elements.length, 0)\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Add a comment to this running method\r\n   *\r\n   * @param comment the comment to add\r\n   */\r\n  addComment(comment: Comment): void {\r\n    this.comments.push(comment);\r\n  }\r\n\r\n  /**\r\n   * Get a comment of this running method\r\n   *\r\n   * @param commentId the id of the comment\r\n   */\r\n  getComment(commentId: string): Comment {\r\n    return this.comments.find((comment) => comment.id === commentId);\r\n  }\r\n\r\n  /**\r\n   * Remove a comment from this running method\r\n   *\r\n   * @param commentId the id of the comment to remove\r\n   */\r\n  removeComment(commentId: string): void {\r\n    this.comments = this.comments.filter((comment) => comment.id !== commentId);\r\n  }\r\n\r\n  /**\r\n   * Get the name of the method\r\n   *\r\n   * @return the name of the method\r\n   */\r\n  get methodName(): string {\r\n    return this.decision.method.name;\r\n  }\r\n\r\n  /**\r\n   * Get the current step of the method definition\r\n   *\r\n   * @return the execution step\r\n   */\r\n  get currentStep(): ExecutionStep {\r\n    return this.decision.method.executionSteps[this.currentStepNumber];\r\n  }\r\n\r\n  toDb(): RunningMethodEntry {\r\n    return {\r\n      nodeId: this.nodeId,\r\n      executionId: this.executionId,\r\n      comments: this.comments.map((comment) => comment.toDb()),\r\n      decision: this.decision.toDb(),\r\n      currentStepNumber: this.currentStepNumber,\r\n      inputArtifacts: this.inputArtifacts\r\n        ? this.inputArtifacts.map((artifact) => artifact.toDb())\r\n        : null,\r\n      outputArtifacts: this.outputArtifacts\r\n        ? this.outputArtifacts.map((outputArtifact) => outputArtifact.toDb())\r\n        : undefined,\r\n      steps: this.steps.map((step) => step.toDb()),\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { PouchdbService } from '../../database/pouchdb.service';\r\nimport {\r\n  RunningProcess,\r\n  RunningProcessEntry,\r\n  RunningProcessInit,\r\n} from './running-process';\r\nimport { DevelopmentProcessRegistryModule } from '../development-process-registry.module';\r\nimport { ArtifactDataType } from './artifact-data';\r\nimport { ProcessExecutionService } from './process-execution.service';\r\nimport { MethodExecutionService } from './method-execution.service';\r\nimport { Decision } from '../bm-process/decision';\r\nimport { MethodExecutionOutput } from '../module-api/method-execution-output';\r\nimport { StepInfo } from '../module-api/step-info';\r\nimport { Comment } from './comment';\r\nimport { ArtifactDataService } from './artifact-data.service';\r\nimport { RunningArtifact } from './running-artifact';\r\nimport { DefaultElementService } from '../../database/default-element.service';\r\nimport { OutputArtifactMapping } from './output-artifact-mapping';\r\n\r\n@Injectable({\r\n  providedIn: DevelopmentProcessRegistryModule,\r\n})\r\nexport class RunningProcessService extends DefaultElementService<\r\n  RunningProcess,\r\n  RunningProcessInit\r\n> {\r\n  protected readonly typeName = RunningProcess.typeName;\r\n\r\n  protected readonly elementConstructor = RunningProcess;\r\n\r\n  constructor(\r\n    private artifactDataService: ArtifactDataService,\r\n    private methodExecutionService: MethodExecutionService,\r\n    pouchdbService: PouchdbService,\r\n    private processExecutionService: ProcessExecutionService\r\n  ) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  /**\r\n   * Add new running process from a process.\r\n   *\r\n   * @param element the running process\r\n   */\r\n  async add(element: RunningProcessInit): Promise<void> {\r\n    const runningProcess = new RunningProcess(undefined, element);\r\n    await this.processExecutionService.initRunningProcess(runningProcess);\r\n    await this.processExecutionService.jumpToNextMethod(runningProcess);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Execute a single common node\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param nodeId the id of the node to execute\r\n   * @param flowId the flow id to take after the execution if it is an exclusive gateway\r\n   */\r\n  async executeStep(\r\n    runningProcess: RunningProcess,\r\n    nodeId: string = null,\r\n    flowId: string = null\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    await this.processExecutionService.moveToNextStep(\r\n      runningProcess,\r\n      nodeId,\r\n      flowId\r\n    );\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Jump to next methods or decisions\r\n   *\r\n   * @param runningProcess the running process\r\n   */\r\n  async jumpSteps(runningProcess: RunningProcess): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    await this.processExecutionService.jumpToNextMethod(runningProcess);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Start the execution of a method\r\n   *\r\n   * @param runningProcessId the id of the running process\r\n   * @param nodeId the id of the node to execute\r\n   */\r\n  async startMethodExecution(\r\n    runningProcessId: string,\r\n    nodeId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcessId);\r\n    if (\r\n      !(await this.processExecutionService.canExecuteNode(\r\n        databaseProcess,\r\n        nodeId\r\n      ))\r\n    ) {\r\n      throw new Error('Can not execute node');\r\n    }\r\n    this.methodExecutionService.startMethodExecution(databaseProcess, nodeId);\r\n    await this.save(databaseProcess);\r\n  }\r\n\r\n  /**\r\n   * Start the execution of a todomethod\r\n   *\r\n   * @param runningProcessId the id of the running process\r\n   * @param executionId the execution id of the todomethod\r\n   */\r\n  async startTodoMethodExecution(\r\n    runningProcessId: string,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcessId);\r\n    this.methodExecutionService.startTodoMethodExecution(\r\n      databaseProcess,\r\n      executionId\r\n    );\r\n    await this.save(databaseProcess);\r\n  }\r\n\r\n  /**\r\n   * Execute a step of the running method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async executeMethodStep(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    if (\r\n      !this.methodExecutionService.isExecutionStepPrepared(\r\n        runningProcess,\r\n        executionId\r\n      )\r\n    ) {\r\n      await this.methodExecutionService.prepareExecuteStep(\r\n        runningProcess,\r\n        executionId\r\n      );\r\n      await this.save(runningProcess);\r\n      runningProcess = await this.get(runningProcess._id);\r\n    }\r\n    await this.methodExecutionService.executeStep(runningProcess, executionId);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Finish the execution of a step. Called by a method of a module after the execution is finished.\r\n   *\r\n   * @param stepInfo the info about the running step\r\n   * @param output the output of the method of the module\r\n   */\r\n  async finishExecuteStep(\r\n    stepInfo: StepInfo,\r\n    output: MethodExecutionOutput\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(stepInfo.runningProcessId);\r\n    this.methodExecutionService.finishExecuteStep(\r\n      databaseProcess,\r\n      stepInfo.executionId,\r\n      stepInfo.step,\r\n      output\r\n    );\r\n    await this.save(databaseProcess);\r\n  }\r\n\r\n  /**\r\n   * Stop the execution of the current method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async stopMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    const nodeId = runningProcess.getRunningMethod(executionId).nodeId;\r\n    await this.methodExecutionService.stopMethodExecution(\r\n      runningProcess,\r\n      executionId\r\n    );\r\n    if (nodeId != null) {\r\n      await this.processExecutionService.moveToNextMethod(\r\n        runningProcess,\r\n        nodeId\r\n      );\r\n    }\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Abort the execution of the current method\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the executed method\r\n   */\r\n  async abortMethodExecution(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    await this.methodExecutionService.abortMethodExecution(\r\n      runningProcess,\r\n      executionId\r\n    );\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  async getExecutableElements(runningProcess: RunningProcess): Promise<any[]> {\r\n    return this.processExecutionService.getExecutableNodes(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Get all decision nodes that are executable and need a decision\r\n   *\r\n   * @param runningProcess the running process\r\n   * @return the decision nodes\r\n   */\r\n  async getExecutableDecisionNodes(\r\n    runningProcess: RunningProcess\r\n  ): Promise<any[]> {\r\n    return this.processExecutionService.getExecutableDecisionNodes(\r\n      runningProcess\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get all executable method elements that are not already executed\r\n   *\r\n   * @param runningProcess the running process\r\n   * @return a list of nodes which have methods that can be executed\r\n   */\r\n  async getExecutableMethods(runningProcess: RunningProcess): Promise<any[]> {\r\n    const executableNodes =\r\n      await this.processExecutionService.getExecutableNodes(runningProcess);\r\n    const methods = executableNodes.filter((node) =>\r\n      runningProcess.isExecutable(node.id)\r\n    );\r\n    return methods.filter(\r\n      (node) => runningProcess.getRunningMethodByNode(node.id) == null\r\n    );\r\n  }\r\n\r\n  async setInputArtifacts(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    inputArtifactMapping: { artifact: number; version: number }[]\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    this.methodExecutionService.selectInputArtifacts(\r\n      databaseProcess,\r\n      executionId,\r\n      inputArtifactMapping\r\n    );\r\n    await this.save(databaseProcess);\r\n  }\r\n\r\n  async updateOutputArtifacts(\r\n    runningProcess: RunningProcess,\r\n    executionId: string,\r\n    outputArtifactsMapping: OutputArtifactMapping[]\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    this.methodExecutionService.updateOutputArtifacts(\r\n      databaseProcess,\r\n      executionId,\r\n      outputArtifactsMapping\r\n    );\r\n    await this.save(databaseProcess);\r\n  }\r\n\r\n  /**\r\n   * Import an artifact into a process\r\n   *\r\n   * @param runningProcessId the id of the running process\r\n   * @param artifact the artifact to import into the running process\r\n   */\r\n  async importArtifact(\r\n    runningProcessId: string,\r\n    artifact: RunningArtifact\r\n  ): Promise<void> {\r\n    const runningProcess = await this.get(runningProcessId);\r\n    runningProcess.importArtifact(artifact);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Add a method to a running process that is executed out of the defined process\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param decision the method decisions\r\n   */\r\n  async addMethod(\r\n    runningProcess: RunningProcess,\r\n    decision: Decision\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    this.methodExecutionService.addMethod(runningProcess, decision);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Remove a method from a running process that is executed out of the defined process\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param executionId the id of the method to remove\r\n   */\r\n  async removeMethod(\r\n    runningProcess: RunningProcess,\r\n    executionId: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    this.methodExecutionService.removeMethod(runningProcess, executionId);\r\n    await this.save(runningProcess);\r\n  }\r\n\r\n  /**\r\n   * Remove the running process.\r\n   *\r\n   * @param id id of the running process\r\n   */\r\n  async delete(id: string): Promise<void> {\r\n    const result = await this.pouchdbService.get<RunningProcessEntry>(id);\r\n    const runningProcess = new RunningProcess(result, undefined);\r\n    // abort all running methods\r\n    runningProcess.runningMethods.forEach((method) =>\r\n      this.methodExecutionService.abortMethodExecution(\r\n        runningProcess,\r\n        method.executionId\r\n      )\r\n    );\r\n    // delete all referenced artifacts\r\n    for (const artifact of runningProcess.artifacts) {\r\n      for (const version of artifact.versions) {\r\n        if (version.data.type === ArtifactDataType.REFERENCE) {\r\n          await this.artifactDataService.remove(version.data);\r\n        }\r\n      }\r\n    }\r\n    await this.pouchdbService.remove(result);\r\n  }\r\n\r\n  /**\r\n   * Add a comment to a running method\r\n   *\r\n   * @param id the id of the running process\r\n   * @param executionId the id of the method currently executed\r\n   * @param comment the comment to add\r\n   */\r\n  async addComment(\r\n    id: string,\r\n    executionId: string,\r\n    comment: Comment\r\n  ): Promise<void> {\r\n    const process = await this.get(id);\r\n    const method = process.getRunningMethod(executionId);\r\n    method.addComment(comment);\r\n    await this.save(process);\r\n  }\r\n\r\n  /**\r\n   * Update a comment of a running method\r\n   *\r\n   * @param id the id of the running process\r\n   * @param executionId the id of the method currently executed\r\n   * @param comment the comment to add\r\n   */\r\n  async updateComment(\r\n    id: string,\r\n    executionId: string,\r\n    comment: Comment\r\n  ): Promise<void> {\r\n    const process = await this.get(id);\r\n    const method = process.getRunningMethod(executionId);\r\n    const dbComment = method.getComment(comment.id);\r\n    dbComment.update(comment);\r\n    await this.save(process);\r\n  }\r\n\r\n  /**\r\n   * Add a comment from a running method\r\n   *\r\n   * @param id the id of the running process\r\n   * @param executionId the id of the method currently executed\r\n   * @param commentId the id of the comment to remove\r\n   */\r\n  async removeComment(\r\n    id: string,\r\n    executionId: string,\r\n    commentId: string\r\n  ): Promise<void> {\r\n    const process = await this.get(id);\r\n    const method = process.getRunningMethod(executionId);\r\n    method.removeComment(commentId);\r\n    await this.save(process);\r\n  }\r\n\r\n  /**\r\n   * Change a running artifact's identifier\r\n   *\r\n   * @param runningProcess the running process\r\n   * @param runningArtifact the running artifact to change\r\n   * @param identifier the new identifier\r\n   */\r\n  async renameArtifact(\r\n    runningProcess: RunningProcess,\r\n    runningArtifact: RunningArtifact,\r\n    identifier: string\r\n  ): Promise<void> {\r\n    const databaseProcess = await this.get(runningProcess._id);\r\n    if (databaseProcess._rev !== runningProcess._rev) {\r\n      throw new Error(\r\n        'Reload needed, process in database does not fit current process'\r\n      );\r\n    }\r\n    runningProcess.renameArtifact(runningArtifact, identifier);\r\n    await this.save(runningProcess);\r\n  }\r\n}\r\n","import {\r\n  BmProcess,\r\n  BmProcessEntry,\r\n  BmProcessInit,\r\n} from '../bm-process/bm-process';\r\nimport { DatabaseModel } from '../../database/database-model';\r\nimport {\r\n  RunningArtifact,\r\n  RunningArtifactEntry,\r\n  RunningArtifactInit,\r\n} from './running-artifact';\r\nimport {\r\n  RunningMethod,\r\n  RunningMethodEntry,\r\n  RunningMethodInit,\r\n} from './running-method';\r\nimport { Step } from './step';\r\nimport {\r\n  RunningMethodInfo,\r\n  RunningMethodInfoEntry,\r\n  RunningMethodInfoInit,\r\n} from './running-method-info';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { Artifact } from '../method-elements/artifact/artifact';\r\nimport { ArtifactVersionInit } from './artifact-version';\r\nimport { OutputArtifactMapping } from './output-artifact-mapping';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n} from '../../database/database-entry';\r\nimport { Comment } from './comment';\r\n\r\nexport interface RunningProcessInit extends DatabaseRootInit {\r\n  name: string;\r\n  process: BmProcessInit;\r\n\r\n  todoMethods?: RunningMethodInit[];\r\n  runningMethods?: RunningMethodInit[];\r\n  executedMethods?: RunningMethodInfoInit[];\r\n\r\n  artifacts?: RunningArtifactInit[];\r\n}\r\n\r\nexport interface RunningProcessEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  process: BmProcessEntry;\r\n\r\n  todoMethods: RunningMethodEntry[];\r\n  runningMethods: RunningMethodEntry[];\r\n  executedMethods: RunningMethodInfoEntry[];\r\n\r\n  artifacts: RunningArtifactEntry[];\r\n}\r\n\r\nexport class RunningProcess\r\n  extends DatabaseModel\r\n  implements RunningProcessInit\r\n{\r\n  static readonly typeName = 'RunningProcess';\r\n\r\n  name: string;\r\n  process: BmProcess;\r\n\r\n  todoMethods: RunningMethod[] = [];\r\n  runningMethods: RunningMethod[] = [];\r\n  executedMethods: RunningMethodInfo[] = [];\r\n\r\n  artifacts: RunningArtifact[] = [];\r\n\r\n  constructor(entry: RunningProcessEntry, init: RunningProcessInit) {\r\n    super(entry, init, RunningProcess.typeName);\r\n    this.name = (entry ?? init).name;\r\n    if (entry != null) {\r\n      this.process = new BmProcess(entry.process, undefined);\r\n      this.todoMethods =\r\n        entry.todoMethods?.map(\r\n          (method) => new RunningMethod(method, undefined)\r\n        ) ?? this.todoMethods;\r\n      this.runningMethods =\r\n        entry.runningMethods?.map(\r\n          (method) => new RunningMethod(method, undefined)\r\n        ) ?? this.runningMethods;\r\n      this.executedMethods =\r\n        entry.executedMethods.map((info) => {\r\n          return {\r\n            nodeId: info.nodeId,\r\n            executionId: info.executionId,\r\n            methodName: info.methodName,\r\n            comments:\r\n              info.comments?.map(\r\n                (comment) => new Comment(comment, undefined)\r\n              ) ?? [],\r\n          };\r\n        }) ?? this.executedMethods;\r\n      this.artifacts =\r\n        entry.artifacts?.map(\r\n          (element) => new RunningArtifact(element, undefined)\r\n        ) ?? this.artifacts;\r\n    } else {\r\n      this.process = new BmProcess(undefined, init.process);\r\n      this.todoMethods =\r\n        init.todoMethods?.map(\r\n          (method) => new RunningMethod(undefined, method)\r\n        ) ?? this.todoMethods;\r\n      this.runningMethods =\r\n        init.runningMethods?.map(\r\n          (method) => new RunningMethod(undefined, method)\r\n        ) ?? this.runningMethods;\r\n      this.executedMethods =\r\n        init.executedMethods?.map((info) => {\r\n          return {\r\n            nodeId: info.nodeId,\r\n            executionId: info.executionId,\r\n            methodName: info.methodName,\r\n            comments:\r\n              info.comments?.map(\r\n                (comment) => new Comment(undefined, comment)\r\n              ) ?? [],\r\n          };\r\n        }) ?? this.executedMethods;\r\n      this.artifacts =\r\n        init.artifacts?.map(\r\n          (element) => new RunningArtifact(undefined, element)\r\n        ) ?? this.artifacts;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a method to the list of manually added methods that can be executed later\r\n   *\r\n   * @param runningMethod the running method\r\n   */\r\n  addTodoMethod(runningMethod: RunningMethod): void {\r\n    if (runningMethod.executionId == null) {\r\n      runningMethod.executionId = uuidv4();\r\n    }\r\n    this.todoMethods.push(runningMethod);\r\n  }\r\n\r\n  /**\r\n   * Get a specific todomethod by its id\r\n   *\r\n   * @param executionId the id of the todomethod\r\n   * @return the todomethod\r\n   */\r\n  getTodoMethod(executionId: string): RunningMethod | undefined {\r\n    return this.todoMethods.find(\r\n      (method) => method.executionId === executionId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Remove a method from the list of manually added methods that can be executed later\r\n   *\r\n   * @param executionId the id of the method\r\n   */\r\n  removeTodoMethod(executionId: string): void {\r\n    this.todoMethods = this.todoMethods.filter(\r\n      (method) => method.executionId !== executionId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add a running method to the currently executed methods list\r\n   *\r\n   * @param runningMethod the running method\r\n   */\r\n  addRunningMethod(runningMethod: RunningMethod): void {\r\n    this.runningMethods.push(runningMethod);\r\n  }\r\n\r\n  /**\r\n   * Add a running method of the bm process to the currently executed methods list\r\n   *\r\n   * @param nodeId the id of the node\r\n   * @return the added running method\r\n   */\r\n  addRunningMethodOfProcess(nodeId: string): RunningMethod {\r\n    const method = new RunningMethod(undefined, {\r\n      nodeId,\r\n      decision: this.process.decisions[nodeId],\r\n      steps: this.process.decisions[nodeId].method.executionSteps.map(\r\n        () => new Step(undefined, {})\r\n      ),\r\n    });\r\n    this.addRunningMethod(method);\r\n    return method;\r\n  }\r\n\r\n  /**\r\n   * Get a specific running method by its id\r\n   *\r\n   * @param executionId the id of the running method\r\n   * @return the running method\r\n   */\r\n  getRunningMethod(executionId: string): RunningMethod | undefined {\r\n    return this.runningMethods.find(\r\n      (method) => method.executionId === executionId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get a specific running method by the id of the corresponding node\r\n   *\r\n   * @param nodeId the id of the node\r\n   * @return the running method\r\n   */\r\n  getRunningMethodByNode(nodeId: string): RunningMethod | undefined {\r\n    return this.runningMethods.find((method) => method.nodeId === nodeId);\r\n  }\r\n\r\n  /**\r\n   * Remove a method from the currently executed methods list\r\n   *\r\n   * @param executionId the id of the method\r\n   */\r\n  removeRunningMethod(executionId: string): void {\r\n    this.runningMethods = this.runningMethods.filter(\r\n      (method) => method.executionId !== executionId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add a method to the executed methods list\r\n   *\r\n   * @param runningMethodInfo the info of the executed method\r\n   */\r\n  addExecutedMethod(runningMethodInfo: RunningMethodInfo): void {\r\n    this.executedMethods.push(runningMethodInfo);\r\n  }\r\n\r\n  /**\r\n   * Get an executed method\r\n   *\r\n   * @param executionId the id of the executed method\r\n   * @return the executed method\r\n   */\r\n  getExecutedMethod(executionId: string): RunningMethodInfo | undefined {\r\n    return this.executedMethods.find(\r\n      (method) => method.executionId === executionId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks whether a method to execute is defined for the node\r\n   *\r\n   * @param nodeId the id of the node\r\n   * @return true if a method is defined\r\n   */\r\n  isExecutable(nodeId: string): boolean {\r\n    return nodeId in this.process.decisions;\r\n  }\r\n\r\n  /**\r\n   * Get a method by its execution id\r\n   *\r\n   * @param executionId the id of the method\r\n   * @return the method\r\n   */\r\n  getMethod(executionId: string): RunningMethodInfo | undefined {\r\n    let result: RunningMethodInfo | undefined = this.todoMethods.find(\r\n      (method) => method.executionId === executionId\r\n    );\r\n    if (result == null) {\r\n      result = this.runningMethods.find(\r\n        (method) => method.executionId === executionId\r\n      );\r\n      if (result == null) {\r\n        result = this.executedMethods.find(\r\n          (method) => method.executionId === executionId\r\n        );\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Add the output artifacts of a method to the artifacts list of this process\r\n   *\r\n   * @param executionId the id of the executed method\r\n   * @param outputArtifacts the output artifacts\r\n   * @param outputArtifactsMapping the mapping of the output artifacts, whether to create a new artifact or merge with a current\r\n   */\r\n  addOutputArtifacts(\r\n    executionId: string,\r\n    outputArtifacts: Artifact[],\r\n    outputArtifactsMapping: OutputArtifactMapping[]\r\n  ): void {\r\n    const method = this.getRunningMethod(executionId);\r\n    outputArtifactsMapping.forEach((output, index) => {\r\n      const version: ArtifactVersionInit = {\r\n        createdBy: method.nodeId ? method.nodeId : 'manual',\r\n        executedBy: method.executionId,\r\n        data: output.data,\r\n      };\r\n      if (output.isDefinition) {\r\n        const artifact = new RunningArtifact(undefined, {\r\n          identifier: output.artifactName,\r\n          artifact: outputArtifacts[index],\r\n        });\r\n        artifact.addVersion(version);\r\n        this.artifacts.push(artifact);\r\n      } else {\r\n        this.artifacts[output.artifact].addVersion(version);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Import an artifact into this process\r\n   *\r\n   * @param artifact the artifact to import\r\n   */\r\n  importArtifact(artifact: RunningArtifact): void {\r\n    this.artifacts.push(artifact);\r\n  }\r\n\r\n  /**\r\n   * Change a running artifact's identifier\r\n   *\r\n   * @param artifact the running artifact to change\r\n   * @param identifier the new identifier\r\n   */\r\n  renameArtifact(artifact: RunningArtifact, identifier: string): void {\r\n    if (this.artifacts.indexOf(artifact) === -1) {\r\n      throw new Error('Artifact is not from this running process');\r\n    }\r\n    artifact.identifier = identifier;\r\n  }\r\n\r\n  toDb(): RunningProcessEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      process: this.process.toDb(),\r\n      todoMethods: this.todoMethods.map((method) => method.toDb()),\r\n      runningMethods: this.runningMethods.map((method) => method.toDb()),\r\n      executedMethods: this.executedMethods.map((executedMethod) => {\r\n        return {\r\n          nodeId: executedMethod.nodeId,\r\n          executionId: executedMethod.executionId,\r\n          methodName: executedMethod.methodName,\r\n          comments: executedMethod.comments.map((comment) => comment.toDb()),\r\n        };\r\n      }),\r\n      artifacts: this.artifacts.map((element) => element.toDb()),\r\n    };\r\n  }\r\n}\r\n","import {\r\n  ArtifactData,\r\n  ArtifactDataEntry,\r\n  ArtifactDataInit,\r\n} from './artifact-data';\r\nimport {\r\n  Artifact,\r\n  ArtifactEntry,\r\n  ArtifactInit,\r\n} from '../method-elements/artifact/artifact';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { MetaModelType } from '../meta-model-definition';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface StepArtifactInit extends DatabaseInit {\r\n  identifier: string;\r\n  artifact: ArtifactInit;\r\n  data: ArtifactDataInit;\r\n}\r\n\r\nexport interface StepArtifactEntry extends DatabaseEntry {\r\n  identifier: string;\r\n  artifact: ArtifactEntry;\r\n  data: ArtifactDataEntry;\r\n}\r\n\r\nexport class StepArtifact implements StepArtifactInit, DatabaseModelPart {\r\n  identifier: string;\r\n  artifact: Artifact;\r\n  data: ArtifactData;\r\n\r\n  constructor(\r\n    entry: StepArtifactEntry | undefined,\r\n    init: StepArtifactInit | undefined\r\n  ) {\r\n    this.identifier = (entry ?? init).identifier;\r\n    if (entry != null) {\r\n      this.artifact = new Artifact(entry.artifact, undefined);\r\n      this.data = new ArtifactData(entry.data, undefined);\r\n    } else if (init != null) {\r\n      this.artifact = new Artifact(undefined, init.artifact);\r\n      this.data = new ArtifactData(undefined, init.data);\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  get metaModelType(): MetaModelType {\r\n    return this.artifact.metaModel.type;\r\n  }\r\n\r\n  toDb(): StepArtifactEntry {\r\n    return {\r\n      identifier: this.identifier,\r\n      artifact: this.artifact.toDb(),\r\n      data: this.data.toDb(),\r\n    };\r\n  }\r\n}\r\n","import {\r\n  StepArtifact,\r\n  StepArtifactEntry,\r\n  StepArtifactInit,\r\n} from './step-artifact';\r\n\r\nexport interface StepInputArtifactInit extends StepArtifactInit {\r\n  versionInfo: {\r\n    number: number;\r\n    time: number;\r\n    createdBy: string;\r\n  };\r\n}\r\n\r\nexport interface StepInputArtifactEntry extends StepArtifactEntry {\r\n  versionInfo: {\r\n    number: number;\r\n    time: number;\r\n    createdBy: string;\r\n  };\r\n}\r\n\r\nexport class StepInputArtifact\r\n  extends StepArtifact\r\n  implements StepInputArtifactInit\r\n{\r\n  versionInfo: {\r\n    number: number;\r\n    time: number;\r\n    createdBy: string;\r\n  };\r\n\r\n  constructor(\r\n    entry: StepInputArtifactEntry | undefined,\r\n    init: StepInputArtifactInit | undefined\r\n  ) {\r\n    super(entry, init);\r\n    this.versionInfo = (entry ?? init).versionInfo;\r\n  }\r\n\r\n  toDb(): StepInputArtifactEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      versionInfo: this.versionInfo,\r\n    };\r\n  }\r\n}\r\n","import {\r\n  StepArtifact,\r\n  StepArtifactEntry,\r\n  StepArtifactInit,\r\n} from './step-artifact';\r\nimport { DatabaseModelPart } from '../../database/database-model-part';\r\nimport { DatabaseEntry, DatabaseInit } from '../../database/database-entry';\r\n\r\nexport interface StepInit extends DatabaseInit {\r\n  inputArtifacts?: StepArtifactInit[];\r\n  outputArtifacts?: StepArtifactInit[];\r\n}\r\n\r\nexport interface StepEntry extends DatabaseEntry {\r\n  inputArtifacts: StepArtifactEntry[];\r\n  outputArtifacts: StepArtifactEntry[];\r\n}\r\n\r\nexport class Step implements StepInit, DatabaseModelPart {\r\n  inputArtifacts: StepArtifact[] = null;\r\n  outputArtifacts: StepArtifact[] = null;\r\n\r\n  constructor(entry: StepEntry | undefined, init: StepInit | undefined) {\r\n    if (entry != null) {\r\n      this.inputArtifacts =\r\n        entry.inputArtifacts?.map(\r\n          (artifact) => new StepArtifact(artifact, undefined)\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        entry.outputArtifacts?.map(\r\n          (artifact) => new StepArtifact(artifact, undefined)\r\n        ) ?? this.outputArtifacts;\r\n    } else if (init != null) {\r\n      this.inputArtifacts =\r\n        init.inputArtifacts?.map(\r\n          (artifact) => new StepArtifact(undefined, artifact)\r\n        ) ?? this.inputArtifacts;\r\n      this.outputArtifacts =\r\n        init.outputArtifacts?.map(\r\n          (artifact) => new StepArtifact(undefined, artifact)\r\n        ) ?? this.outputArtifacts;\r\n    } else {\r\n      throw new Error('Either entry or init must be provided.');\r\n    }\r\n  }\r\n\r\n  finish(output: StepArtifact[]): void {\r\n    this.outputArtifacts = output;\r\n  }\r\n\r\n  toDb(): StepEntry {\r\n    return {\r\n      inputArtifacts: this.inputArtifacts\r\n        ? this.inputArtifacts.map((artifact) => artifact.toDb())\r\n        : null,\r\n      outputArtifacts: this.outputArtifacts\r\n        ? this.outputArtifacts.map((artifact) => artifact.toDb())\r\n        : null,\r\n    };\r\n  }\r\n}\r\n","import BaseRenderer from 'diagram-js/lib/draw/BaseRenderer';\r\nimport BpmnRenderer from 'bpmn-js/lib/draw/BpmnRenderer';\r\nimport TextRenderer from 'bpmn-js/lib/draw/TextRenderer';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { append, attr, remove, select } from 'tiny-svg';\r\n\r\nexport default class RunningProcessViewRenderer extends BaseRenderer {\r\n  static $inject = ['eventBus', 'bpmnRenderer', 'textRenderer'];\r\n\r\n  private static readonly HIGH_PRIORITY = 1500;\r\n\r\n  private bpmnRenderer: BpmnRenderer;\r\n  private textRenderer: TextRenderer;\r\n\r\n  constructor(eventBus, bpmnRenderer, textRenderer) {\r\n    super(eventBus, RunningProcessViewRenderer.HIGH_PRIORITY);\r\n\r\n    this.bpmnRenderer = bpmnRenderer;\r\n    this.textRenderer = textRenderer;\r\n  }\r\n\r\n  canRender(element) {\r\n    return is(element, 'bpmn:FlowNode') || is(element, 'bpmn:SequenceFlow');\r\n  }\r\n\r\n  drawShape(parentNode: SVGGElement, element) {\r\n    const shape: SVGRectElement = this.bpmnRenderer.drawShape(\r\n      parentNode,\r\n      element\r\n    );\r\n    const method = element.businessObject.get('method');\r\n    if (method) {\r\n      remove(select(parentNode, 'text'));\r\n      const methodName = this.textRenderer.createText(method.name, {\r\n        box: element,\r\n        align: 'center-middle',\r\n        padding: 5,\r\n      });\r\n      append(parentNode, methodName);\r\n      attr(shape, { rx: 0, ry: 0 });\r\n    }\r\n    if (element.businessObject.get('tokens') > 0) {\r\n      attr(shape, { stroke: 'red' });\r\n    } else if (element.businessObject.get('executed')) {\r\n      attr(shape, { stroke: 'green' });\r\n    }\r\n    return shape;\r\n  }\r\n\r\n  drawConnection(parentNode: SVGGElement, element) {\r\n    const connection: SVGPathElement = this.bpmnRenderer.drawConnection(\r\n      parentNode,\r\n      element\r\n    );\r\n    if (element.businessObject.get('used')) {\r\n      attr(connection, { stroke: 'green' });\r\n    }\r\n    return connection;\r\n  }\r\n\r\n  getShapePath(shape) {\r\n    return this.bpmnRenderer.getShapePath(shape);\r\n  }\r\n}\r\n","import CoreModule from 'bpmn-js/lib/core';\r\nimport RunningProcessViewRenderer from './RunningProcessViewRenderer';\r\n\r\nexport default {\r\n  __depends__: [CoreModule],\r\n  __init__: ['runningProcessViewRenderer'],\r\n  runningProcessViewRenderer: ['type', RunningProcessViewRenderer],\r\n};\r\n","import { NgModule } from '@angular/core';\r\nimport { RunningProcessViewerComponent } from './running-process-viewer/running-process-viewer.component';\r\nimport { KanbanBoardComponent } from './kanban-board/kanban-board.component';\r\nimport { RunningProcessKanbanBoardComponent } from './running-process-kanban-board/running-process-kanban-board.component';\r\nimport { RunningProcessMethodCommentsComponent } from './running-process-method-comments/running-process-method-comments.component';\r\nimport { RunningProcessMethodCommentFormComponent } from './running-process-method-comment-form/running-process-method-comment-form.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { QuillModule } from 'ngx-quill';\r\nimport { NgbPaginationModule } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    RunningProcessViewerComponent,\r\n    KanbanBoardComponent,\r\n    RunningProcessKanbanBoardComponent,\r\n    RunningProcessMethodCommentsComponent,\r\n    RunningProcessMethodCommentFormComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ReactiveFormsModule,\r\n    QuillModule,\r\n    NgbPaginationModule,\r\n  ],\r\n  exports: [\r\n    RunningProcessViewerComponent,\r\n    KanbanBoardComponent,\r\n    RunningProcessKanbanBoardComponent,\r\n    RunningProcessMethodCommentsComponent,\r\n  ],\r\n})\r\nexport class DevelopmentProcessViewModule {}\r\n","<div class=\"row min-height-200-px\">\r\n  <div class=\"col border-right\">\r\n    <div class=\"d-flex justify-content-center\">\r\n      <div class=\"flex-1\"></div>\r\n      <h6 class=\"text-center ml-auto mr-auto\">TODO</h6>\r\n      <div class=\"d-flex flex-1\">\r\n        <button class=\"btn btn-xs btn-primary ml-auto\" (click)=\"addTodo.emit()\">\r\n          Add\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex flex-column align-items-center\">\r\n      <div *ngFor=\"let info of todo\" class=\"card text-center w-75 my-2\">\r\n        <div class=\"card-body\">\r\n          <div class=\"card-title font-weight-bold\">{{ info.methodName }}</div>\r\n          <button\r\n            *ngIf=\"info.nodeId\"\r\n            class=\"btn btn-xs btn-dark mr-1 mb-1\"\r\n            (click)=\"viewNode.emit(info.nodeId)\"\r\n          >\r\n            Show development step in process\r\n          </button>\r\n          <button\r\n            class=\"btn btn-xs btn-info mr-1 mb-1\"\r\n            (click)=\"_showInfo(info)\"\r\n          >\r\n            Info\r\n          </button>\r\n          <button\r\n            class=\"btn btn-xs btn-warning mr-1 mb-1\"\r\n            (click)=\"_startExecution(info)\"\r\n          >\r\n            Start\r\n          </button>\r\n          <button\r\n            *ngIf=\"info.nodeId == null\"\r\n            class=\"btn btn-xs btn-secondary mb-1\"\r\n            (click)=\"removeTodo.emit(info.executionId)\"\r\n          >\r\n            Remove\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"col border-right\">\r\n    <h6 class=\"text-center\">Doing</h6>\r\n    <div class=\"d-flex flex-column align-items-center\">\r\n      <div *ngFor=\"let info of doing\" class=\"card text-center w-75 my-2\">\r\n        <div class=\"card-body\">\r\n          <div class=\"card-title font-weight-bold\">{{ info.methodName }}</div>\r\n          <button\r\n            *ngIf=\"info.nodeId\"\r\n            class=\"btn btn-xs btn-dark mr-1 mb-1\"\r\n            (click)=\"viewNode.emit(info.nodeId)\"\r\n          >\r\n            Show development step in process\r\n          </button>\r\n          <button\r\n            class=\"btn btn-xs btn-info mr-1 mb-1\"\r\n            (click)=\"_showInfo(info)\"\r\n          >\r\n            Info\r\n          </button>\r\n          <button\r\n            class=\"btn btn-xs btn-warning mb-1\"\r\n            (click)=\"viewExecution.emit(info.executionId)\"\r\n          >\r\n            View Execution\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"col\">\r\n    <h6 class=\"text-center\">Done</h6>\r\n    <div class=\"d-flex flex-column align-items-center\">\r\n      <div\r\n        *ngFor=\"\r\n          let info of done\r\n            | slice: (donePage - 1) * donePageSize:donePage * donePageSize\r\n        \"\r\n        class=\"card text-center w-75 my-2\"\r\n      >\r\n        <div class=\"card-body\">\r\n          <div class=\"card-title font-weight-bold\">{{ info.methodName }}</div>\r\n          <button\r\n            *ngIf=\"info.nodeId\"\r\n            class=\"btn btn-xs btn-dark mr-1 mb-1\"\r\n            (click)=\"viewNode.emit(info.nodeId)\"\r\n          >\r\n            Show development step in process\r\n          </button>\r\n          <button\r\n            class=\"btn btn-xs btn-dark mr-1 mb-1\"\r\n            (click)=\"viewComments.emit(info.executionId)\"\r\n          >\r\n            View Comments\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <ngb-pagination\r\n        *ngIf=\"done.length > donePageSize\"\r\n        [collectionSize]=\"done.length\"\r\n        [(page)]=\"donePage\"\r\n        [pageSize]=\"donePageSize\"\r\n        class=\"mt-3\"\r\n      ></ngb-pagination>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { KanbanBoardMethodInfo } from './kanban-board-method-info';\r\n\r\n@Component({\r\n  selector: 'app-kanban-board',\r\n  templateUrl: './kanban-board.component.html',\r\n  styleUrls: ['./kanban-board.component.css'],\r\n})\r\nexport class KanbanBoardComponent {\r\n  @Input() todo: KanbanBoardMethodInfo[];\r\n  @Input() doing: KanbanBoardMethodInfo[];\r\n  @Input() done: KanbanBoardMethodInfo[];\r\n\r\n  @Output() addTodo = new EventEmitter<void>();\r\n  @Output() removeTodo = new EventEmitter<string>(); // emits the execution id\r\n  @Output() viewNode = new EventEmitter<string>(); // emits the node id\r\n  @Output() showNodeInfo = new EventEmitter<string>(); // emits the node id\r\n  @Output() showExecutionInfo = new EventEmitter<string>(); // emits the execution id\r\n  @Output() startNodeExecution = new EventEmitter<string>(); // emits the node id\r\n  @Output() startExecution = new EventEmitter<string>(); // emits the execution id\r\n  @Output() viewExecution = new EventEmitter<string>(); // emits execution id\r\n  @Output() viewComments = new EventEmitter<string>(); // emits execution id\r\n\r\n  donePage: number = 1;\r\n  donePageSize: number = 4;\r\n\r\n  _showInfo(info: KanbanBoardMethodInfo): void {\r\n    if (info.executionId) {\r\n      this.showExecutionInfo.emit(info.executionId);\r\n    } else if (info.nodeId) {\r\n      this.showNodeInfo.emit(info.nodeId);\r\n    }\r\n  }\r\n\r\n  _startExecution(info: KanbanBoardMethodInfo): void {\r\n    if (info.executionId) {\r\n      this.startExecution.emit(info.executionId);\r\n    } else if (info.nodeId) {\r\n      this.startNodeExecution.emit(info.nodeId);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { KanbanBoardMethodInfo } from '../kanban-board/kanban-board-method-info';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\n\r\n@Component({\r\n  selector: 'app-running-process-kanban-board',\r\n  templateUrl: './running-process-kanban-board.component.html',\r\n  styleUrls: ['./running-process-kanban-board.component.css'],\r\n})\r\nexport class RunningProcessKanbanBoardComponent implements OnChanges {\r\n  @Input() runningProcess: RunningProcess;\r\n\r\n  @Output() addTodo = new EventEmitter<void>();\r\n  @Output() removeTodo = new EventEmitter<string>(); // emits the execution id\r\n  @Output() viewNode = new EventEmitter<string>(); // emits the node id\r\n  @Output() showInfo = new EventEmitter<Decision>();\r\n  @Output() startNodeExecution = new EventEmitter<string>(); // emits the node id\r\n  @Output() startExecution = new EventEmitter<string>(); // emits the execution id\r\n  @Output() viewExecution = new EventEmitter<string>(); // emits execution id\r\n  @Output() viewComments = new EventEmitter<string>(); // emits execution id\r\n\r\n  todo: KanbanBoardMethodInfo[] = [];\r\n  doing: KanbanBoardMethodInfo[] = [];\r\n  done: KanbanBoardMethodInfo[] = [];\r\n\r\n  constructor(private runningProcessService: RunningProcessService) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.runningProcess) {\r\n      void this.updateBoard(changes.runningProcess.currentValue);\r\n    }\r\n  }\r\n\r\n  _showNodeInfo(nodeId: string): void {\r\n    this.showInfo.emit(this.runningProcess.process.decisions[nodeId]);\r\n  }\r\n\r\n  _showExecutionInfo(executionId: string): void {\r\n    const todoMethod = this.runningProcess.getTodoMethod(executionId);\r\n    const runningMethod = this.runningProcess.getRunningMethod(executionId);\r\n    let decision;\r\n    if (todoMethod) {\r\n      decision = todoMethod.decision;\r\n    } else if (runningMethod) {\r\n      decision = runningMethod.decision;\r\n    }\r\n    this.showInfo.emit(decision);\r\n  }\r\n\r\n  private async updateBoard(runningProcess: RunningProcess): Promise<void> {\r\n    this.todo = await this.getTodoList(runningProcess);\r\n    this.doing = this.getDoingList(runningProcess);\r\n    this.done = this.getDoneList(runningProcess);\r\n  }\r\n\r\n  private async getTodoList(\r\n    runningProcess: RunningProcess\r\n  ): Promise<KanbanBoardMethodInfo[]> {\r\n    const todo: KanbanBoardMethodInfo[] = [];\r\n    todo.push(...runningProcess.todoMethods);\r\n    todo.push(\r\n      ...(\r\n        await this.runningProcessService.getExecutableMethods(runningProcess)\r\n      ).map((node) => {\r\n        return {\r\n          nodeId: node.id,\r\n          methodName: runningProcess.process.decisions[node.id].method.name,\r\n        };\r\n      })\r\n    );\r\n    return todo;\r\n  }\r\n\r\n  private getDoingList(\r\n    runningProcess: RunningProcess\r\n  ): KanbanBoardMethodInfo[] {\r\n    return runningProcess.runningMethods;\r\n  }\r\n\r\n  private getDoneList(runningProcess: RunningProcess): KanbanBoardMethodInfo[] {\r\n    return runningProcess.executedMethods.slice().reverse();\r\n  }\r\n}\r\n","<app-kanban-board\r\n  [todo]=\"todo\"\r\n  [doing]=\"doing\"\r\n  [done]=\"done\"\r\n  (addTodo)=\"addTodo.emit($event)\"\r\n  (removeTodo)=\"removeTodo.emit($event)\"\r\n  (viewNode)=\"viewNode.emit($event)\"\r\n  (showNodeInfo)=\"_showNodeInfo($event)\"\r\n  (showExecutionInfo)=\"_showExecutionInfo($event)\"\r\n  (startNodeExecution)=\"startNodeExecution.emit($event)\"\r\n  (startExecution)=\"startExecution.emit($event)\"\r\n  (viewExecution)=\"viewExecution.emit($event)\"\r\n  (viewComments)=\"viewComments.emit($event)\"\r\n></app-kanban-board>\r\n","<form [formGroup]=\"commentForm\" (ngSubmit)=\"submit()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"userName\" class=\"col-sm-4 col-form-label\">User</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"userName\"\r\n        class=\"form-control\"\r\n        id=\"userName\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"title\" class=\"col-sm-4 col-form-label\">Title</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"title\"\r\n        class=\"form-control\"\r\n        id=\"title\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"comment\" class=\"col-sm-4\">Comment</label>\r\n    <div class=\"col-sm-8\">\r\n      <quill-editor\r\n        [styles]=\"{ 'min-height': '250px' }\"\r\n        formControlName=\"comment\"\r\n        id=\"comment\"\r\n      ></quill-editor>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!commentForm.valid\"\r\n      >\r\n        <ng-container *ngIf=\"comment == null\">Add comment</ng-container>\r\n        <ng-container *ngIf=\"comment != null\">Edit comment</ng-container>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Comment } from '../../development-process-registry/running-process/comment';\r\nimport { AuthService } from '../../database/auth.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-running-process-method-comment-form',\r\n  templateUrl: './running-process-method-comment-form.component.html',\r\n  styleUrls: ['./running-process-method-comment-form.component.css'],\r\n})\r\nexport class RunningProcessMethodCommentFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() comment: Comment = null;\r\n\r\n  @Output() submitCommentForm = new EventEmitter<FormGroup>();\r\n\r\n  commentForm: FormGroup = this.fb.group({\r\n    userName: ['', Validators.required],\r\n    title: ['', Validators.required],\r\n    comment: ['', Validators.required],\r\n  });\r\n\r\n  private userNameChangeSubscription: Subscription;\r\n\r\n  constructor(private authService: AuthService, private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    if (this.comment == null && this.authService.username != null) {\r\n      this.userNameControl.disable();\r\n      this.userNameControl.setValue(this.authService.username);\r\n      this.userNameChangeSubscription = this.commentForm\r\n        .get('userName')\r\n        .valueChanges.pipe(\r\n          filter(\r\n            (value) =>\r\n              (value == null || value === '') &&\r\n              this.authService.username != null\r\n          ),\r\n          tap(() => this.userNameControl.setValue(this.authService.username))\r\n        )\r\n        .subscribe();\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.comment) {\r\n      this.commentForm.patchValue(changes.comment.currentValue);\r\n      this.userNameControl.disable();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.userNameChangeSubscription) {\r\n      this.userNameChangeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submit(): void {\r\n    this.submitCommentForm.emit(this.commentForm);\r\n  }\r\n\r\n  get userNameControl(): FormControl {\r\n    return this.commentForm.get('userName') as FormControl;\r\n  }\r\n}\r\n","<ng-template #editCommentModal let-d=\"dismiss\" let-c=\"close\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Edit comment {{ modalComment.title }}</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted\">\r\n      <app-running-process-method-comment-form\r\n        [comment]=\"modalComment\"\r\n        (submitCommentForm)=\"_updateComment($event)\"\r\n      ></app-running-process-method-comment-form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">Comments</h6>\r\n  <div *ngIf=\"comments.length === 0\">No comments</div>\r\n  <ul class=\"list-group\" *ngIf=\"comments.length > 0\">\r\n    <li *ngFor=\"let comment of comments\" class=\"list-group-item\">\r\n      <div class=\"d-flex w-100 justify-content-between\">\r\n        <small>Created by {{ comment.userName }}</small>\r\n        <div *ngIf=\"editable\">\r\n          <button\r\n            (click)=\"_editComment(comment)\"\r\n            type=\"button\"\r\n            class=\"btn btn-warning btn-xs mr-1\"\r\n          >\r\n            Edit\r\n          </button>\r\n          <button\r\n            (click)=\"removeComment.emit(comment.id)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <h5 class=\"border-bottom pb-2\">{{ comment.title }}</h5>\r\n      <p class=\"show-new-lines mb-1\">\r\n        <quill-view [content]=\"comment.comment\"></quill-view>\r\n      </p>\r\n      <small>{{ comment.time | date: 'short' }}</small>\r\n    </li>\r\n  </ul>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"editable\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">Add comment</h6>\r\n  <div class=\"text-muted pt-3\">\r\n    <app-running-process-method-comment-form\r\n      (submitCommentForm)=\"_addComment($event)\"\r\n    ></app-running-process-method-comment-form>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  Output,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { Comment } from '../../development-process-registry/running-process/comment';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-running-process-method-comments',\r\n  templateUrl: './running-process-method-comments.component.html',\r\n  styleUrls: ['./running-process-method-comments.component.css'],\r\n})\r\nexport class RunningProcessMethodCommentsComponent {\r\n  @Input() comments: Comment[];\r\n  @Input() editable = true;\r\n\r\n  @Output() addComment = new EventEmitter<Comment>();\r\n  @Output() updateComment = new EventEmitter<Comment>();\r\n  @Output() removeComment = new EventEmitter<string>();\r\n\r\n  modalComment: Comment;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('editCommentModal', { static: true }) editCommentModal: unknown;\r\n\r\n  constructor(private modalService: NgbModal) {}\r\n\r\n  _addComment(formGroup: FormGroup): void {\r\n    this.addComment.emit(new Comment(undefined, formGroup.getRawValue()));\r\n    formGroup.reset();\r\n  }\r\n\r\n  _editComment(comment: Comment): void {\r\n    this.modalComment = comment;\r\n    this.modalReference = this.modalService.open(this.editCommentModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  _updateComment(formGroup: FormGroup): void {\r\n    this.modalComment.update(formGroup.value);\r\n    this.updateComment.emit(this.modalComment);\r\n    this.modalReference.close();\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport BpmnViewer from 'bpmn-js/lib/NavigatedViewer';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { RunningProcessViewerService } from '../shared/running-process-viewer.service';\r\n\r\n@Component({\r\n  selector: 'app-running-process-viewer',\r\n  templateUrl: './running-process-viewer.component.html',\r\n  styleUrls: ['./running-process-viewer.component.css'],\r\n})\r\nexport class RunningProcessViewerComponent\r\n  implements OnInit, OnChanges, AfterContentInit, OnDestroy\r\n{\r\n  @Input() runningProcess: RunningProcess;\r\n\r\n  private viewer: BpmnViewer;\r\n\r\n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLDivElement>;\r\n\r\n  constructor(\r\n    private runningProcessViewerService: RunningProcessViewerService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.viewer = this.runningProcessViewerService.getBpmnViewer();\r\n    if (this.runningProcess) {\r\n      this.loadBmProcess(this.runningProcess, true);\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.runningProcess && this.viewer) {\r\n      this.loadBmProcess(\r\n        changes.runningProcess.currentValue,\r\n        changes.runningProcess.firstChange\r\n      );\r\n    }\r\n  }\r\n\r\n  ngAfterContentInit() {\r\n    this.viewer.attachTo(this.canvas.nativeElement);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.viewer.destroy();\r\n  }\r\n\r\n  focus(id: string) {\r\n    this.runningProcessViewerService.focusElement(this.viewer, id);\r\n    this.canvas.nativeElement.scrollIntoView({ behavior: 'smooth' });\r\n  }\r\n\r\n  getSelectedFlowNode() {\r\n    const selection = this.viewer.get('selection').get()[0];\r\n    if (is(selection, 'bpmn:FlowNode')) {\r\n      return selection;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getSelectedFlow() {\r\n    const selection = this.viewer.get('selection').get()[0];\r\n    if (is(selection, 'bpmn:SequenceFlow')) {\r\n      return selection;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private loadBmProcess(runningProcess: RunningProcess, firstLoad: boolean) {\r\n    this.viewer\r\n      .importXML(runningProcess.process.processDiagram)\r\n      .then(() => {\r\n        if (firstLoad) {\r\n          this.runningProcessViewerService.resizeView(this.viewer);\r\n        }\r\n      })\r\n      .catch((error) => console.log('LoadBmProcess: ' + error));\r\n  }\r\n}\r\n","<div #canvas class=\"border\" style=\"height: 500px\"></div>\r\n","import { Injectable } from '@angular/core';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { getBBox } from 'diagram-js/lib/util/Elements';\r\n\r\n@Injectable()\r\nexport abstract class BpmnViewerService {\r\n  /**\r\n   * Resize the view to view the diagram correctly\r\n   *\r\n   * @param modeler the modeler that currently displays the process\r\n   */\r\n  resizeView(modeler: any) {\r\n    const bbox = getBBox(\r\n      modeler\r\n        .get('elementRegistry')\r\n        .filter((element) => !is(element, 'bpmn:Process'))\r\n    );\r\n    const canvas = modeler.get('canvas');\r\n    const view = canvas.viewbox();\r\n    canvas.viewbox({\r\n      x: bbox.x - 160,\r\n      y: bbox.y - 50,\r\n      width: view.outer.width,\r\n      height: view.outer.height,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Focus a specific element\r\n   *\r\n   * @param modeler the modeler that currently displays the process\r\n   * @param id the id of the element\r\n   */\r\n  focusElement(modeler: any, id: string) {\r\n    const element = modeler.get('elementRegistry').get(id);\r\n    modeler.get('selection').select(element);\r\n    const canvas = modeler.get('canvas');\r\n    const viewbox = canvas.viewbox();\r\n    let adjustRatio = false;\r\n    const ratio = viewbox.width / viewbox.height;\r\n    if (viewbox.width < element.width) {\r\n      viewbox.width = element.width + 600;\r\n      adjustRatio = true;\r\n    }\r\n    if (viewbox.height < element.height) {\r\n      viewbox.height = element.height + 600;\r\n      adjustRatio = true;\r\n    }\r\n    if (adjustRatio) {\r\n      if (viewbox.width < viewbox.height * ratio) {\r\n        viewbox.width = viewbox.height * ratio;\r\n      } else if (viewbox.height < 1 / (ratio / viewbox.width)) {\r\n        viewbox.height = 1 / (ratio / viewbox.width);\r\n      }\r\n    }\r\n    viewbox.x = element.x - viewbox.width / 2 + element.width / 2;\r\n    viewbox.y = element.y - viewbox.height / 2 + element.height / 2;\r\n    canvas.viewbox(viewbox);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport BpmnViewer from 'bpmn-js/lib/NavigatedViewer';\r\nimport runningProcessView from '../bpmn-extensions/running-process-view';\r\nimport bmdl from '../../../assets/bpmn_bmdl.json';\r\nimport rbmp from '../../../assets/bpmn_running_process.json';\r\nimport { BpmnViewerService } from './bpmn-viewer.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class RunningProcessViewerService extends BpmnViewerService {\r\n  getBpmnViewer(): BpmnViewer {\r\n    return new BpmnViewer({\r\n      additionalModules: [runningProcessView],\r\n      moddleExtensions: {\r\n        bmdl,\r\n        rbmp,\r\n      },\r\n    });\r\n  }\r\n}\r\n","<form [formGroup]=\"definitionForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\">\r\n    <div\r\n      class=\"btn-group btn-group-toggle\"\r\n      ngbRadioGroup\r\n      name=\"internalArtifact\"\r\n      formControlName=\"internalArtifact\"\r\n    >\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"true\" /> Internal Artifact\r\n      </label>\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"false\" /> External Artifact\r\n      </label>\r\n    </div>\r\n  </div>\r\n  <div\r\n    *ngIf=\"definitionForm.get('internalArtifact').value\"\r\n    class=\"form-group row\"\r\n  >\r\n    <label for=\"metaModel\" class=\"col-sm-4 col-form-label\">Meta Model</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"metaModel\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"metaModelControl.invalid\"\r\n        id=\"metaModel\"\r\n        [ngbTypeahead]=\"searchMetaModel\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (click)=\"openMetaModelInput.next($any($event.target).value)\"\r\n        (focus)=\"openMetaModelInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!definitionForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { MetaModelService } from '../../development-process-registry/meta-model.service';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\nimport { debounceTime, filter, map, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-artifact-definition-form',\r\n  templateUrl: './artifact-definition-form.component.html',\r\n  styleUrls: ['./artifact-definition-form.component.css'],\r\n})\r\nexport class ArtifactDefinitionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() artifact: Artifact;\r\n\r\n  @Output() submitArtifactForm = new EventEmitter<FormGroup>();\r\n\r\n  definitionForm = this.fb.group(\r\n    {\r\n      internalArtifact: this.fb.control(false, Validators.required),\r\n      metaModel: this.fb.control(null),\r\n    },\r\n    {\r\n      validators: (group) => {\r\n        if (\r\n          group.get('internalArtifact').value &&\r\n          !group.get('metaModel').value\r\n        ) {\r\n          return { requiredMetaModel: true };\r\n        }\r\n        return null;\r\n      },\r\n    }\r\n  );\r\n  changed = false;\r\n\r\n  openMetaModelInput = new Subject<string>();\r\n\r\n  private changeSubscription: Subscription;\r\n  private internalArtifactSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private metaModelService: MetaModelService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.definitionForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = !this.equals(this.artifact, value)))\r\n      )\r\n      .subscribe();\r\n    this.internalArtifactSubscription =\r\n      this.internalArtifactControl.valueChanges\r\n        .pipe(\r\n          filter((value) => !value),\r\n          tap(() => this.metaModelControl.setValue(null))\r\n        )\r\n        .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.artifact) {\r\n      const oldArtifact: Artifact = changes.artifact.previousValue;\r\n      const newArtifact: Artifact = changes.artifact.currentValue;\r\n      if (!this.equals(newArtifact, oldArtifact)) {\r\n        this.definitionForm.patchValue(newArtifact);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.internalArtifactSubscription) {\r\n      this.internalArtifactSubscription.unsubscribe();\r\n    }\r\n    this.openMetaModelInput.complete();\r\n  }\r\n\r\n  searchMetaModel = (input: Observable<string>) => {\r\n    return merge(getTypeaheadInputPipe(input), this.openMetaModelInput).pipe(\r\n      map((term) =>\r\n        this.metaModels\r\n          .filter((metaModelItem) =>\r\n            metaModelItem.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  formatter(x: { name: string }) {\r\n    return x.name;\r\n  }\r\n\r\n  private equals(artifactA: Artifact, artifactB: Artifact) {\r\n    if (artifactA == null && artifactB == null) {\r\n      return true;\r\n    }\r\n    if (artifactA == null || artifactB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      artifactA.internalArtifact === artifactB.internalArtifact &&\r\n      this.equalsMetaModel(artifactA.metaModel, artifactB.metaModel)\r\n    );\r\n  }\r\n\r\n  private equalsMetaModel(\r\n    metaModelA: { name: string; type: any },\r\n    metaModelB: { name: string; type: any }\r\n  ) {\r\n    if (metaModelA == null && metaModelB == null) {\r\n      return true;\r\n    }\r\n    if (metaModelA == null || metaModelB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      metaModelA.name === metaModelB.name && metaModelA.type === metaModelB.type\r\n    );\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitArtifactForm.emit(this.definitionForm);\r\n  }\r\n\r\n  get metaModels() {\r\n    return this.metaModelService.metaModels;\r\n  }\r\n\r\n  get internalArtifactControl() {\r\n    return this.definitionForm.get('internalArtifact') as FormControl;\r\n  }\r\n\r\n  get metaModelControl() {\r\n    return this.definitionForm.get('metaModel') as FormControl;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"artifact\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ artifact.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"artifact\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update an Artifact and define its values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Artifact</h6>\r\n    <div class=\"text-muted\">\r\n      <app-method-element-form\r\n        [methodElement]=\"artifact\"\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"updateValue($event.value)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Definition</h6>\r\n    <div class=\"text-muted\">\r\n      <app-artifact-definition-form\r\n        [artifact]=\"artifact\"\r\n        (submitArtifactForm)=\"updateValue($event.value)\"\r\n      ></app-artifact-definition-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport {\r\n  Artifact,\r\n  ArtifactInit,\r\n} from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { ArtifactService } from '../../development-process-registry/method-elements/artifact/artifact.service';\r\nimport { MethodElementLoaderService } from '../shared/method-element-loader.service';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\n\r\n@Component({\r\n  selector: 'app-artifact',\r\n  templateUrl: './artifact.component.html',\r\n  styleUrls: ['./artifact.component.css'],\r\n  providers: [\r\n    MethodElementLoaderService,\r\n    { provide: MethodElementService, useExisting: ArtifactService },\r\n  ],\r\n})\r\nexport class ArtifactComponent {\r\n  constructor(\r\n    private artifactLoaderService: MethodElementLoaderService<\r\n      Artifact,\r\n      ArtifactInit\r\n    >,\r\n    private artifactService: ArtifactService\r\n  ) {}\r\n\r\n  async updateValue(value: any): Promise<void> {\r\n    await this.artifactService.update(this.artifact._id, value);\r\n  }\r\n\r\n  get artifact(): Artifact {\r\n    return this.artifactLoaderService.methodElement;\r\n  }\r\n\r\n  get listNames(): string[] {\r\n    return this.artifactLoaderService.listNames;\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport {\r\n  Artifact,\r\n  ArtifactEntry,\r\n} from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { ArtifactService } from '../../development-process-registry/method-elements/artifact/artifact.service';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { GroupSelection } from '../../development-process-registry/bm-process/decision';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\n\r\n@Component({\r\n  selector: 'app-artifacts-group-info',\r\n  templateUrl: './artifacts-group-info.component.html',\r\n  styleUrls: ['./artifacts-group-info.component.css'],\r\n})\r\nexport class ArtifactsGroupInfoComponent implements OnInit {\r\n  @Input() groups: MultipleSelection<Artifact>[][];\r\n  @Input() selection: GroupSelection<Artifact>;\r\n\r\n  @Output() submitGroupsForm = new EventEmitter<FormGroup>();\r\n\r\n  methodElements: ArtifactEntry[] = [];\r\n\r\n  constructor(private artifactService: ArtifactService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadMethodElements();\r\n  }\r\n\r\n  private async loadMethodElements(): Promise<void> {\r\n    this.methodElements = await this.artifactService.getList();\r\n  }\r\n}\r\n","<app-method-element-group-info\r\n  [groups]=\"groups\"\r\n  [selection]=\"selection\"\r\n  [methodElements]=\"methodElements\"\r\n  methodElementName=\"Artifact\"\r\n  (submitGroupsForm)=\"submitGroupsForm.emit($event)\"\r\n></app-method-element-group-info>\r\n","<ng-template\r\n  #artifactMethodElementSelectionForm\r\n  let-remove=\"remove\"\r\n  let-formGroup=\"formGroup\"\r\n  let-index=\"index\"\r\n>\r\n  <app-method-element-selection-form\r\n    [formGroup]=\"formGroup\"\r\n    [listNames]=\"listNames\"\r\n    [methodElements]=\"methodElements\"\r\n    methodElementName=\"Artifact\"\r\n    [multipleAllowed]=\"true\"\r\n    (remove)=\"remove(index)\"\r\n  ></app-method-element-selection-form>\r\n  <ng-container [formGroup]=\"formGroup\">\r\n    <app-development-method-artifact-mappings\r\n      *ngIf=\"\r\n        developmentMethod &&\r\n        formGroup.get('element').value &&\r\n        formGroup.get('element').value.metaModel\r\n      \"\r\n      [developmentMethod]=\"developmentMethod\"\r\n      formArrayName=\"mapping\"\r\n      [metaModel]=\"{\r\n        name: formGroup.get('element').value.metaModel.name,\r\n        type: formGroup.get('element').value.metaModel.type\r\n      }\"\r\n    ></app-development-method-artifact-mappings>\r\n  </ng-container>\r\n</ng-template>\r\n\r\n<form [formGroup]=\"artifactsForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-check\" *ngIf=\"formArray.controls.length > 0\">\r\n    <input\r\n      class=\"form-check-input\"\r\n      type=\"checkbox\"\r\n      formControlName=\"allowNone\"\r\n      id=\"checkboxAllowNone\"\r\n    />\r\n    <label class=\"form-check-label\" for=\"checkboxAllowNone\"> Allow None </label>\r\n  </div>\r\n  <div class=\"form-group\" formGroupName=\"artifacts\">\r\n    <ng-container\r\n      *ngFor=\"\r\n        let control of formArray.controls;\r\n        let index = index;\r\n        let first = first\r\n      \"\r\n    >\r\n      <div\r\n        *ngIf=\"index !== 0 || !artifactsForm.get('allowNone').value\"\r\n        [class.mt-3]=\"\r\n          index > 1 || (!artifactsForm.get('allowNone').value && !first)\r\n        \"\r\n        class=\"p-3 mb-3 bg-white rounded shadow-sm\"\r\n      >\r\n        <h6 class=\"border-bottom border-gray pb-2\">Group</h6>\r\n        <app-method-elements-selection-form\r\n          class=\"form-group\"\r\n          formArrayName=\"{{ index }}\"\r\n          [createFormGroupFactory]=\"createFormGroupFactory\"\r\n          [methodElementFormTemplate]=\"artifactMethodElementSelectionForm\"\r\n        ></app-method-elements-selection-form>\r\n        <div class=\"form-group d-flex\">\r\n          <button\r\n            (click)=\"remove(index)\"\r\n            type=\"button\"\r\n            class=\"btn btn-secondary ml-auto\"\r\n          >\r\n            Remove OR Group\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n  <div class=\"form-group d-flex\">\r\n    <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n      Add OR Group\r\n    </button>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!artifactsForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  Artifact,\r\n  ArtifactEntry,\r\n} from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { ArtifactService } from '../../development-process-registry/method-elements/artifact/artifact.service';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { MultipleMappingSelection } from '../../development-process-registry/development-method/multiple-mapping-selection';\r\nimport { ArtifactMappingFormService } from '../shared/artifact-mapping-form.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsListOfLists } from '../../shared/utils';\r\n\r\n@Component({\r\n  selector: 'app-artifacts-selection-form',\r\n  templateUrl: './artifacts-selection-form.component.html',\r\n  styleUrls: ['./artifacts-selection-form.component.css'],\r\n})\r\nexport class ArtifactsSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() artifacts: MultipleSelection<Artifact>[][];\r\n  @Input() developmentMethod: DevelopmentMethod = null;\r\n\r\n  @Output() submitArtifactsForm = new EventEmitter<FormArray>();\r\n\r\n  artifactsForm: FormGroup = this.fb.group({\r\n    allowNone: this.fb.control(false),\r\n    artifacts: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  methodElements: ArtifactEntry[] = [];\r\n  listNames: string[] = [];\r\n\r\n  private allowNoneSubscription: Subscription;\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private artifactMappingFormService: ArtifactMappingFormService,\r\n    private artifactService: ArtifactService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadMethodElements();\r\n\r\n    this.allowNoneSubscription = this.artifactsForm\r\n      .get('allowNone')\r\n      .valueChanges.subscribe((value) => {\r\n        if (value) {\r\n          if (this.formArray.controls.length > 0) {\r\n            if ((this.formArray.at(0) as FormArray).controls.length > 0) {\r\n              this.formArray.insert(0, this.fb.array([]));\r\n            }\r\n          }\r\n        } else {\r\n          if (this.formArray.controls.length > 0) {\r\n            if ((this.formArray.at(0) as FormArray).controls.length === 0) {\r\n              this.formArray.removeAt(0);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    this.changeSubscription = this.artifactsForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !equalsListOfLists(this.artifacts, value.artifacts))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.artifacts) {\r\n      const oldArtifactGroups: MultipleSelection<Artifact>[][] =\r\n        changes.artifacts.previousValue;\r\n      const newArtifactGroups: MultipleSelection<Artifact>[][] =\r\n        changes.artifacts.currentValue;\r\n      if (!equalsListOfLists(oldArtifactGroups, newArtifactGroups)) {\r\n        this.loadForm(newArtifactGroups);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.allowNoneSubscription) {\r\n      this.allowNoneSubscription.unsubscribe();\r\n    }\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  add(): void {\r\n    this.formArray.push(this.fb.array([]));\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitArtifactsForm.emit(\r\n      this.artifactsForm.get('artifacts') as FormArray\r\n    );\r\n  }\r\n\r\n  private loadForm(artifacts: MultipleSelection<Artifact>[][]): void {\r\n    const formArrays = artifacts.map((group) =>\r\n      this.fb.array(\r\n        group.map((element) => {\r\n          if (element instanceof MultipleMappingSelection) {\r\n            return this.fb.group({\r\n              list: [element.list, Validators.required],\r\n              element: { value: element.element, disabled: element.multiple },\r\n              multiple: element.multiple,\r\n              multipleElements: {\r\n                value: element.multipleElements,\r\n                disabled: element.multiple,\r\n              },\r\n              mapping: this.artifactMappingFormService.createMappingsForm(\r\n                element.mapping\r\n              ),\r\n            });\r\n          } else {\r\n            return this.fb.group({\r\n              list: [element.list, Validators.required],\r\n              element: { value: element.element, disabled: element.multiple },\r\n              multiple: element.multiple,\r\n              multipleElements: {\r\n                value: element.multipleElements,\r\n                disabled: element.multiple,\r\n              },\r\n              mapping: this.fb.array([]),\r\n            });\r\n          }\r\n        })\r\n      )\r\n    );\r\n    this.artifactsForm.setControl('artifacts', this.fb.array(formArrays));\r\n    if (artifacts.length > 0) {\r\n      this.artifactsForm.get('allowNone').setValue(artifacts[0].length === 0);\r\n    } else {\r\n      this.artifactsForm.get('allowNone').setValue(false);\r\n    }\r\n  }\r\n\r\n  private async loadMethodElements(): Promise<void> {\r\n    this.methodElements = await this.artifactService.getList();\r\n    this.listNames = [\r\n      ...new Set(this.methodElements.map((element) => element.list)),\r\n    ];\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.artifactsForm.get('artifacts') as FormArray;\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: null,\r\n      multiple: false,\r\n      multipleElements: false,\r\n      mapping: this.fb.array([]),\r\n    });\r\n}\r\n","<ng-template #deleteArtifactModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal (dismiss)=\"d()\" (delete)=\"delete(modalArtifact._id); c()\">\r\n    <div modalTitle>Delete Artifact {{ modalArtifact.name }}</div>\r\n    You are deleting the artifact {{ modalArtifact.name }}. This can not be\r\n    undone. This action will not delete the artifact from method building blocks\r\n    that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Artifacts</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Artifacts to use them for the definition of Method Fragments\r\n  </div>\r\n\r\n  <app-method-element-list\r\n    listTitle=\"Artifacts\"\r\n    [elementLists]=\"elementLists\"\r\n    (deleteElement)=\"openDeleteArtifactModal($event)\"\r\n  ></app-method-element-list>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Artifact</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-method-element-form\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"add($event)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { ArtifactService } from '../../development-process-registry/method-elements/artifact/artifact.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  Artifact,\r\n  ArtifactEntry,\r\n} from '../../development-process-registry/method-elements/artifact/artifact';\r\n\r\n@Component({\r\n  selector: 'app-artifacts',\r\n  templateUrl: './artifacts.component.html',\r\n  styleUrls: ['./artifacts.component.css'],\r\n})\r\nexport class ArtifactsComponent implements OnInit {\r\n  elementLists: { listName: string; elements: ArtifactEntry[] }[] = null;\r\n  listNames: string[] = [];\r\n\r\n  modalArtifact: Artifact;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteArtifactModal', { static: true })\r\n  deleteArtifactModal: unknown;\r\n\r\n  constructor(\r\n    private artifactService: ArtifactService,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.load();\r\n  }\r\n\r\n  private async load(): Promise<void> {\r\n    this.elementLists = await this.artifactService.getLists();\r\n    this.listNames = this.elementLists.map((list) => list.listName);\r\n  }\r\n\r\n  openDeleteArtifactModal(artifact: Artifact): void {\r\n    this.modalArtifact = artifact;\r\n    this.modalReference = this.modalService.open(this.deleteArtifactModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async delete(id: string): Promise<void> {\r\n    await this.artifactService.delete(id);\r\n    await this.load();\r\n  }\r\n\r\n  async add(form: FormGroup): Promise<void> {\r\n    await this.artifactService.add(form.value);\r\n    await this.load();\r\n  }\r\n}\r\n","<ng-template #addProcessPatternModal let-d=\"dismiss\" let-c=\"close\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Add Method Pattern</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-process-patterns-selection-form\r\n      [processPatterns]=\"modalProcessPatterns\"\r\n      [contextSituationalFactors]=\"bmProcess.situationalFactors\"\r\n      (selectProcessPattern)=\"addProcessPattern($event); c()\"\r\n    ></app-process-patterns-selection-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #selectProcessPatternModal let-d=\"dismiss\" let-c=\"close\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Select Method Pattern</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-process-patterns-selection-form\r\n      [processPatterns]=\"modalProcessPatterns\"\r\n      [contextSituationalFactors]=\"bmProcess.situationalFactors\"\r\n      (selectProcessPattern)=\"selectProcessPattern(modalElement, $event); c()\"\r\n    ></app-process-patterns-selection-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #showTypesModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Show types of {{ modalElement.businessObject.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"alert alert-info\">\r\n      Types that are defined for this activity.\r\n    </div>\r\n    <div class=\"alert alert-info\" *ngIf=\"modalElement.businessObject.inherit\">\r\n      Types are inherited from parent element.\r\n    </div>\r\n    <ng-container *ngIf=\"!modalElement.businessObject.inherit\">\r\n      <h5>Needed</h5>\r\n      <ul\r\n        class=\"list-group\"\r\n        *ngIf=\"modalElement.businessObject.get('neededType').length > 0\"\r\n      >\r\n        <li\r\n          class=\"list-group-item\"\r\n          *ngFor=\"let element of modalElement.businessObject.get('neededType')\"\r\n        >\r\n          <span *ngIf=\"element.element\"\r\n            >{{ element.element.name }} ({{ $any(element.list) | list }})</span\r\n          >\r\n          <span *ngIf=\"!element.element\">{{ $any(element.list) | list }}</span>\r\n        </li>\r\n      </ul>\r\n      <div\r\n        class=\"alert alert-info\"\r\n        *ngIf=\"modalElement.businessObject.get('neededType').length === 0\"\r\n      >\r\n        No needed types defined for this activity.\r\n      </div>\r\n      <h5 class=\"mt-3\">Forbidden</h5>\r\n      <ul\r\n        class=\"list-group\"\r\n        *ngIf=\"modalElement.businessObject.get('forbiddenType').length > 0\"\r\n      >\r\n        <li\r\n          class=\"list-group-item\"\r\n          *ngFor=\"\r\n            let element of modalElement.businessObject.get('forbiddenType')\r\n          \"\r\n        >\r\n          <span *ngIf=\"element.element\"\r\n            >{{ $any(element.list) | list }} {{ element.element.name }}</span\r\n          >\r\n          <span *ngIf=\"!element.element\">{{ $any(element.list) | list }}</span>\r\n        </li>\r\n      </ul>\r\n      <div\r\n        class=\"alert alert-info\"\r\n        *ngIf=\"modalElement.businessObject.get('forbiddenType').length === 0\"\r\n      >\r\n        No forbidden types defined for this activity.\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #deleteProcessPatternModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Delete Method Pattern {{ modalElement.businessObject.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"alert alert-warning\">\r\n      Deleting the Method Pattern {{ modalElement.businessObject.name }}.\r\n    </div>\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n    <button\r\n      class=\"btn btn-danger btn-block\"\r\n      (click)=\"deleteProcessPattern(modalElement); d()\"\r\n    >\r\n      Delete Method Pattern\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #selectDevelopmentMethodModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Select Method Building Block for {{ modalElement.businessObject.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-development-methods-selection-form\r\n      [contextSituationalFactors]=\"bmProcess.situationalFactors\"\r\n      [developmentMethods]=\"validDevelopmentMethods\"\r\n      (selectDevelopmentMethod)=\"selectDevelopmentMethod(modalElement, $event)\"\r\n    ></app-development-methods-selection-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #methodInfoModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Overview of Activity {{ modalElement.businessObject.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-method-info\r\n      [bmProcess]=\"bmProcess\"\r\n      [contextDomains]=\"bmProcess.domains\"\r\n      [contextSituationalFactors]=\"bmProcess.situationalFactors\"\r\n      [developmentMethod]=\"modalDevelopmentMethod\"\r\n      [decision]=\"bmProcess.decisions[modalElement.id]\"\r\n      (updateDecisions)=\"updateDecisions($event)\"\r\n    ></app-method-info>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #developmentMethodSummaryModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Summary of Activity {{ modalElement.businessObject.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-development-method-summary\r\n      [decision]=\"bmProcess.decisions[modalElement.id]\"\r\n    ></app-development-method-summary>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #patternInfoModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 *ngIf=\"modalElement.businessObject.taskName\" class=\"modal-title\">\r\n      Overview of Activity {{ modalElement.businessObject.taskName }}\r\n    </h4>\r\n    <h4 *ngIf=\"!modalElement.businessObject.taskName\" class=\"modal-title\">\r\n      Overview of Pattern {{ modalProcessPattern.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-pattern-info\r\n      [contextSituationalFactors]=\"bmProcess.situationalFactors\"\r\n      [processPattern]=\"modalProcessPattern\"\r\n    ></app-pattern-info>\r\n  </div>\r\n</ng-template>\r\n\r\n<div #canvas class=\"border\" style=\"height: 500px\"></div>\r\n<div class=\"container\">\r\n  <div class=\"p-3 bg-white rounded shadow-sm\">\r\n    <div class=\"row\">\r\n      <div class=\"col-4\"><strong>Legend:</strong></div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-list bpmn-legend-icon\"></i> Show types\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-clipboard-check bpmn-legend-icon\"></i> Show Method\r\n        Building Block summary\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-info-circle bpmn-legend-icon\"></i> Show Method Pattern\r\n        details\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-database bpmn-legend-icon\"></i> Select Method Building\r\n        Block\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-clipboard-list bpmn-legend-icon\"></i> Edit Method\r\n        Building Block details\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"far fa-trash-alt bpmn-legend-icon\"></i> Remove Method Building\r\n        Block from task / Delete Method Pattern\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"fas fa-sign-in-alt bpmn-legend-icon\"></i> Insert Method\r\n        Pattern\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"far fa-plus-square bpmn-legend-icon\"></i> Add Method Pattern\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Controls</h6>\r\n    <button class=\"btn btn-primary\" (click)=\"saveDiagram()\">\r\n      Save Diagram\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Warnings</h6>\r\n    <div *ngIf=\"isGeneratingWarnings\" class=\"alert alert-info mb-0\">\r\n      Loading warnings\r\n    </div>\r\n    <ngb-accordion *ngIf=\"!isGeneratingWarnings\">\r\n      <ngb-panel title=\"Low value Warnings\">\r\n        <ng-template ngbPanelContent>\r\n          <div *ngIf=\"lowWarnings.length === 0\" class=\"alert alert-success\">\r\n            There are no warnings about situational factors with a too low value\r\n          </div>\r\n          <ul *ngIf=\"lowWarnings.length > 0\">\r\n            <li *ngFor=\"let warning of lowWarnings\">\r\n              {{ warning.elementName }}\r\n              <a [routerLink]=\"[]\" (click)=\"selectElement(warning.elementId)\">{{\r\n                warning.name\r\n              }}</a>\r\n              has a too low value for the following factors\r\n              <ul>\r\n                <li *ngFor=\"let factor of warning.situationalFactors\">\r\n                  {{ factor }}\r\n                </li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n        </ng-template>\r\n      </ngb-panel>\r\n      <ngb-panel title=\"Incorrect value Warnings\">\r\n        <ng-template ngbPanelContent>\r\n          <div\r\n            *ngIf=\"incorrectWarnings.length === 0\"\r\n            class=\"alert alert-success mb-0\"\r\n          >\r\n            There are no warnings about situational factors with an incorrect\r\n            value\r\n          </div>\r\n          <ul *ngIf=\"incorrectWarnings.length > 0\">\r\n            <li *ngFor=\"let warning of incorrectWarnings\">\r\n              {{ warning.elementName }}\r\n              <a [routerLink]=\"[]\" (click)=\"selectElement(warning.elementId)\">{{\r\n                warning.name\r\n              }}</a>\r\n              has an incorrect value for the following factors\r\n              <ul>\r\n                <li *ngFor=\"let factor of warning.situationalFactors\">\r\n                  {{ factor }}\r\n                </li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n        </ng-template>\r\n      </ngb-panel>\r\n      <ngb-panel title=\"Missing Artifacts\">\r\n        <ng-template ngbPanelContent>\r\n          <div\r\n            *ngIf=\"missingArtifacts.length === 0\"\r\n            class=\"alert alert-success mb-0\"\r\n          >\r\n            There are no warnings about missing artifacts\r\n          </div>\r\n          <ul *ngIf=\"missingArtifacts.length > 0\">\r\n            <li *ngFor=\"let warning of missingArtifacts\">\r\n              {{ warning.elementName }}\r\n              <a [routerLink]=\"[]\" (click)=\"selectElement(warning.elementId)\">{{\r\n                warning.name\r\n              }}</a>\r\n              is missing the following Artifacts\r\n              <ul>\r\n                <li *ngFor=\"let artifact of warning.artifacts\">\r\n                  {{ artifact.name }}\r\n                </li>\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n        </ng-template>\r\n      </ngb-panel>\r\n      <ngb-panel title=\"Unreachable\">\r\n        <ng-template ngbPanelContent>\r\n          <div\r\n            *ngIf=\"unreachableActivities.length === 0\"\r\n            class=\"alert alert-success mb-0\"\r\n          >\r\n            There are no warnings about unreachable methods or activities\r\n          </div>\r\n          <ul *ngIf=\"unreachableActivities.length > 0\">\r\n            <li *ngFor=\"let warning of unreachableActivities\">\r\n              {{ warning.elementName }}\r\n              <a [routerLink]=\"[]\" (click)=\"selectElement(warning.elementId)\">{{\r\n                warning.name\r\n              }}</a>\r\n              can not be reached.\r\n            </li>\r\n          </ul>\r\n        </ng-template>\r\n      </ngb-panel>\r\n    </ngb-accordion>\r\n  </div>\r\n</div>\r\n","import {\r\n  AfterContentInit,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\nimport BpmnModeler from 'bpmn-js/lib/Modeler';\r\nimport { BpmnService } from '../shared/bpmn.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ProcessPatternService } from '../../development-process-registry/process-pattern/process-pattern.service';\r\nimport {\r\n  DevelopmentMethod,\r\n  DevelopmentMethodEntry,\r\n} from '../../development-process-registry/development-method/development-method';\r\nimport { DevelopmentMethodService } from '../../development-process-registry/development-method/development-method.service';\r\nimport {\r\n  ProcessPattern,\r\n  ProcessPatternEntry,\r\n} from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { DiagramComponentInterface } from '../shared/diagram-component-interface';\r\nimport {\r\n  SituationalFactor,\r\n  SituationalFactorEntry,\r\n} from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { DevelopmentMethodIncompleteModalComponent } from '../development-method-incomplete-modal/development-method-incomplete-modal.component';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\n\r\n@Component({\r\n  selector: 'app-bm-process-diagram',\r\n  templateUrl: './bm-process-diagram.component.html',\r\n  styleUrls: ['./bm-process-diagram.component.css'],\r\n})\r\nexport class BmProcessDiagramComponent\r\n  implements\r\n    DiagramComponentInterface,\r\n    OnInit,\r\n    OnChanges,\r\n    AfterContentInit,\r\n    OnDestroy\r\n{\r\n  @Input() bmProcess: BmProcess;\r\n\r\n  @Output() saveBmProcess = new EventEmitter<{\r\n    decisions?: { [elementId: string]: Decision };\r\n    processDiagram: string;\r\n  }>();\r\n\r\n  private modeler: BpmnModeler;\r\n\r\n  validDevelopmentMethods: DevelopmentMethodEntry[] = null;\r\n\r\n  lowWarnings: {\r\n    elementName: string;\r\n    name: string;\r\n    elementId: string;\r\n    situationalFactors: string[];\r\n  }[] = [];\r\n  incorrectWarnings: {\r\n    elementName: string;\r\n    name: string;\r\n    elementId: string;\r\n    situationalFactors: string[];\r\n  }[] = [];\r\n  isGeneratingWarnings = false;\r\n  private wantsToGenerateWarnings = false;\r\n\r\n  missingArtifacts: {\r\n    elementId: string;\r\n    elementName: string;\r\n    name: string;\r\n    artifacts: Artifact[];\r\n  }[] = [];\r\n  unreachableActivities: {\r\n    elementId: string;\r\n    elementName: string;\r\n    name: string;\r\n  }[] = [];\r\n\r\n  modalElement;\r\n  modalDevelopmentMethod: DevelopmentMethod;\r\n  modalProcessPattern: ProcessPattern;\r\n  modalProcessPatterns: ProcessPatternEntry[];\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLDivElement>;\r\n  @ViewChild('addProcessPatternModal', { static: true })\r\n  addProcessPatternModal: unknown;\r\n  @ViewChild('deleteProcessPatternModal', { static: true })\r\n  deleteProcessPatternModal: unknown;\r\n  @ViewChild('methodInfoModal', { static: true }) methodInfoModal: unknown;\r\n  @ViewChild('patternInfoModal', { static: true }) patternInfoModal: unknown;\r\n  @ViewChild('selectDevelopmentMethodModal', { static: true })\r\n  selectDevelopmentMethodModal: unknown;\r\n  @ViewChild('selectProcessPatternModal', { static: true })\r\n  selectProcessPatternModal: unknown;\r\n  @ViewChild('showTypesModal', { static: true }) showTypesModal: unknown;\r\n  @ViewChild('developmentMethodSummaryModal', { static: true })\r\n  developmentMethodSummaryModal: unknown;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    private bpmnService: BpmnService,\r\n    private developmentMethodService: DevelopmentMethodService,\r\n    private modalService: NgbModal,\r\n    private processPatternService: ProcessPatternService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.modeler = this.bpmnService.getBmProcessModeler();\r\n    const eventBus = this.modeler.get('eventBus');\r\n    eventBus.on('bmp.deletePattern', (event, subProcessElement) =>\r\n      this.openDeleteProcessPatternModal(subProcessElement)\r\n    );\r\n    eventBus.on('bmp.processPatterns', (event, businessObject) =>\r\n      this.openAddProcessPatternModal(businessObject)\r\n    );\r\n    eventBus.on('bmp.removeMethod', (event, methodElement) =>\r\n      this.removeMethodFromTask(methodElement)\r\n    );\r\n    eventBus.on('bmp.selectMethod', (event, taskElement) =>\r\n      this.openSelectDevelopmentMethodModal(taskElement)\r\n    );\r\n    eventBus.on('bmp.selectPattern', (event, callActivityElement) =>\r\n      this.openSelectProcessPatternModal(callActivityElement)\r\n    );\r\n    eventBus.on('bmp.showTypes', (event, taskElement) =>\r\n      this.openShowTypesModal(taskElement)\r\n    );\r\n    eventBus.on('bmp.showMethod', (event, methodElement) =>\r\n      this.openMethodInfoModal(methodElement)\r\n    );\r\n    eventBus.on('bmp.showPattern', (event, processPatternElement) =>\r\n      this.openProcessPatternInfoModal(processPatternElement)\r\n    );\r\n    eventBus.on('bmp.summary', (event, methodElement) =>\r\n      this.openDevelopmentMethodSummary(methodElement)\r\n    );\r\n    if (this.bmProcess) {\r\n      void this.loadBmProcess(this.bmProcess, true);\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.bmProcess && this.modeler) {\r\n      void this.loadBmProcess(\r\n        changes.bmProcess.currentValue,\r\n        changes.bmProcess.firstChange\r\n      );\r\n    }\r\n  }\r\n\r\n  ngAfterContentInit(): void {\r\n    this.modeler.attachTo(this.canvas.nativeElement);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.modeler.destroy();\r\n  }\r\n\r\n  private async loadBmProcess(\r\n    bmProcess: BmProcess,\r\n    firstLoad: boolean\r\n  ): Promise<void> {\r\n    if (bmProcess.processDiagram) {\r\n      this.modeler.get('taskRenderer').process = bmProcess;\r\n      this.modeler.get('taskRenderer').bmProcessService = this.bmProcessService;\r\n      await this.modeler.importXML(bmProcess.processDiagram);\r\n      if (firstLoad) {\r\n        this.bpmnService.resizeView(this.modeler);\r\n      }\r\n      this.checkWarnings();\r\n      this.checkArtifacts();\r\n    } else {\r\n      this.modeler.createDiagram();\r\n    }\r\n  }\r\n\r\n  async openAddProcessPatternModal(startingElement): Promise<void> {\r\n    this.modalProcessPatterns = null;\r\n    this.modalElement = startingElement;\r\n    const processPatterns: ProcessPatternEntry[] =\r\n      await this.processPatternService.getValidProcessPatterns(\r\n        [{ list: 'initialisation', element: null }],\r\n        []\r\n      );\r\n    this.modalProcessPatterns = this.sortByDistance(processPatterns);\r\n    this.modalReference = this.modalService.open(this.addProcessPatternModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async addProcessPattern(processPattern: ProcessPatternEntry): Promise<void> {\r\n    const pattern = await this.processPatternService.get(processPattern._id);\r\n    await this.bpmnService.appendBpmn(this.modeler, pattern, this.modalElement);\r\n    this.modeler.get('selection').deselect(this.modalElement);\r\n    await this.saveDiagram();\r\n  }\r\n\r\n  openShowTypesModal(taskElement): void {\r\n    this.modalElement = taskElement;\r\n    this.modalReference = this.modalService.open(this.showTypesModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openDeleteProcessPatternModal(subProcessElement): void {\r\n    this.modalElement = subProcessElement;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteProcessPatternModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  async deleteProcessPattern(subProcessElement): Promise<void> {\r\n    const removeDecision = (event, element): void => {\r\n      if (\r\n        element.element.businessObject &&\r\n        element.element.businessObject.method\r\n      ) {\r\n        this.bmProcess.removeDecision(element.element.id);\r\n      }\r\n    };\r\n    const eventBus = this.modeler.get('eventBus');\r\n    eventBus.on('shape.remove', removeDecision);\r\n    this.bpmnService.removeProcessPattern(this.modeler, subProcessElement);\r\n    eventBus.off('shape.remove', removeDecision);\r\n    await this.saveDiagram(this.bmProcess.decisions);\r\n  }\r\n\r\n  async openSelectDevelopmentMethodModal(taskElement): Promise<void> {\r\n    this.modalElement = taskElement;\r\n    const types = this.bpmnService.getTypesOfActivity(\r\n      this.modeler,\r\n      taskElement.id\r\n    );\r\n    const methods: DevelopmentMethodEntry[] =\r\n      await this.developmentMethodService.getValidDevelopmentMethods(\r\n        types.neededType,\r\n        types.forbiddenType\r\n      );\r\n    this.validDevelopmentMethods = this.sortByDistance(methods);\r\n    this.modalReference = this.modalService.open(\r\n      this.selectDevelopmentMethodModal,\r\n      {\r\n        size: 'lg',\r\n        beforeDismiss: () => {\r\n          this.validDevelopmentMethods = null;\r\n          return true;\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  resetSelectDevelopmentMethodModal(): void {\r\n    this.validDevelopmentMethods = null;\r\n    this.modalReference.close();\r\n  }\r\n\r\n  async selectDevelopmentMethod(\r\n    taskElement,\r\n    developmentMethod: DevelopmentMethod\r\n  ): Promise<void> {\r\n    const method = await this.developmentMethodService.get(\r\n      developmentMethod._id\r\n    );\r\n    if (!this.developmentMethodService.isCorrectlyDefined(method)) {\r\n      const modal = this.modalService.open(\r\n        DevelopmentMethodIncompleteModalComponent\r\n      );\r\n      const component: DevelopmentMethodIncompleteModalComponent =\r\n        modal.componentInstance;\r\n      component.developmentMethod = method;\r\n      return;\r\n    }\r\n    this.resetSelectDevelopmentMethodModal();\r\n    this.bmProcess.addDecision(taskElement.id, method);\r\n    this.bpmnService.selectDevelopmentMethodForProcessTask(\r\n      this.modeler,\r\n      taskElement,\r\n      method\r\n    );\r\n    await this.saveDiagram(this.bmProcess.decisions);\r\n  }\r\n\r\n  openMethodInfoModal(methodElement): void {\r\n    this.modalElement = methodElement;\r\n    this.modalDevelopmentMethod =\r\n      this.bmProcess.decisions[methodElement.id].method;\r\n    this.modalReference = this.modalService.open(this.methodInfoModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  private openDevelopmentMethodSummary(methodElement): void {\r\n    this.modalElement = methodElement;\r\n    this.modalReference = this.modalService.open(\r\n      this.developmentMethodSummaryModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  async openProcessPatternInfoModal(processPatternElement): Promise<void> {\r\n    this.modalElement = processPatternElement;\r\n    this.modalProcessPattern = await this.processPatternService.get(\r\n      processPatternElement.businessObject.get('processPatternId')\r\n    );\r\n    this.modalReference = this.modalService.open(this.patternInfoModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async openSelectProcessPatternModal(callActivityElement): Promise<void> {\r\n    this.modalProcessPatterns = null;\r\n    this.modalElement = callActivityElement;\r\n    const types = this.bpmnService.getTypesOfActivity(\r\n      this.modeler,\r\n      callActivityElement.id\r\n    );\r\n    const processPatterns: ProcessPatternEntry[] =\r\n      await this.processPatternService.getValidProcessPatterns(\r\n        [...types.neededType, { list: 'generic', element: null }],\r\n        types.forbiddenType\r\n      );\r\n    this.modalProcessPatterns = this.sortByDistance(processPatterns);\r\n    this.modalReference = this.modalService.open(\r\n      this.selectProcessPatternModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  async selectProcessPattern(\r\n    callActivityElement,\r\n    processPattern: ProcessPatternEntry\r\n  ): Promise<void> {\r\n    const pattern = await this.processPatternService.get(processPattern._id);\r\n    await this.bpmnService.insertProcessPatternIntoCallActivity(\r\n      this.modeler,\r\n      callActivityElement,\r\n      pattern\r\n    );\r\n    if (callActivityElement.businessObject.method) {\r\n      this.bmProcess.removeDecision(callActivityElement.id);\r\n      await this.saveDiagram(this.bmProcess.decisions);\r\n    } else {\r\n      await this.saveDiagram();\r\n    }\r\n  }\r\n\r\n  async removeMethodFromTask(methodElement): Promise<void> {\r\n    this.bpmnService.removeDevelopmentMethodFromProcessTask(\r\n      this.modeler,\r\n      methodElement\r\n    );\r\n    this.bmProcess.removeDecision(methodElement.id);\r\n    await this.saveDiagram(this.bmProcess.decisions);\r\n  }\r\n\r\n  checkWarnings(): void {\r\n    if (this.isGeneratingWarnings) {\r\n      this.wantsToGenerateWarnings = true;\r\n      return;\r\n    }\r\n    this.isGeneratingWarnings = true;\r\n\r\n    const lowWarnings: {\r\n      elementName: string;\r\n      name: string;\r\n      elementId: string;\r\n      situationalFactors: string[];\r\n    }[] = [];\r\n    const incorrectWarnings: {\r\n      elementName: string;\r\n      name: string;\r\n      elementId: string;\r\n      situationalFactors: string[];\r\n    }[] = [];\r\n\r\n    const generateWarnings = (\r\n      id: string,\r\n      elementName: 'Method' | 'Pattern',\r\n      name: string,\r\n      factors: SituationalFactor[]\r\n    ): void => {\r\n      const factorMap = SituationalFactor.createMap(factors);\r\n      const { low, incorrect } = this.bmProcess.checkMatch(factorMap);\r\n      if (low.length > 0) {\r\n        lowWarnings.push({\r\n          elementName,\r\n          name,\r\n          elementId: id,\r\n          situationalFactors: low,\r\n        });\r\n      }\r\n      if (incorrect.length > 0) {\r\n        incorrectWarnings.push({\r\n          elementName,\r\n          name,\r\n          elementId: id,\r\n          situationalFactors: incorrect,\r\n        });\r\n      }\r\n    };\r\n\r\n    const generateMethodWarnings = (element: any): void => {\r\n      const method = this.bmProcess.decisions[element.id].method;\r\n      generateWarnings(\r\n        element.id,\r\n        'Method',\r\n        method.name,\r\n        method.situationalFactors.map((factor) => factor.element)\r\n      );\r\n    };\r\n\r\n    const generatePatternWarnings = (\r\n      element: any,\r\n      pattern: ProcessPattern\r\n    ): void => {\r\n      generateWarnings(\r\n        element.id,\r\n        'Pattern',\r\n        pattern.name,\r\n        pattern.situationalFactors.map((factor) => factor.element)\r\n      );\r\n    };\r\n\r\n    const activities = this.bpmnService.getActivitiesWithMethod(this.modeler);\r\n    activities.forEach((activity) => generateMethodWarnings(activity));\r\n\r\n    const patternElements = this.bpmnService.getPatterns(this.modeler);\r\n    this.processPatternService\r\n      .getProcessPatterns(\r\n        patternElements.map((element) =>\r\n          element.businessObject.get('processPatternId')\r\n        )\r\n      )\r\n      .then((dbPatterns) => {\r\n        const dbPatternsMap: { [id: string]: ProcessPattern } = {};\r\n        dbPatterns.forEach(\r\n          (dbPattern) => (dbPatternsMap[dbPattern._id] = dbPattern)\r\n        );\r\n        patternElements.forEach((patternElement) =>\r\n          generatePatternWarnings(\r\n            patternElement,\r\n            dbPatternsMap[patternElement.businessObject.get('processPatternId')]\r\n          )\r\n        );\r\n        if (!this.wantsToGenerateWarnings) {\r\n          this.lowWarnings = lowWarnings;\r\n          this.incorrectWarnings = incorrectWarnings;\r\n        }\r\n      })\r\n      .finally(() => {\r\n        this.isGeneratingWarnings = false;\r\n        if (this.wantsToGenerateWarnings) {\r\n          this.wantsToGenerateWarnings = false;\r\n          this.checkWarnings();\r\n        }\r\n      });\r\n  }\r\n\r\n  selectElement(id: string): void {\r\n    this.bpmnService.focusElement(this.modeler, id);\r\n    this.canvas.nativeElement.scrollIntoView({ behavior: 'smooth' });\r\n  }\r\n\r\n  async updateDecisions(value: any): Promise<void> {\r\n    this.bmProcess.decisions[this.modalElement.id].update(value);\r\n    await this.saveDiagram(this.bmProcess.decisions);\r\n  }\r\n\r\n  saveDiagram(\r\n    decisions: { [elementId: string]: Decision } = undefined\r\n  ): Promise<void> {\r\n    return this.modeler.saveXML().then((result) => {\r\n      if (decisions != null) {\r\n        this.saveBmProcess.emit({\r\n          decisions,\r\n          processDiagram: result.xml,\r\n        });\r\n      } else {\r\n        this.saveBmProcess.emit({\r\n          processDiagram: result.xml,\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  diagramChanged(): Promise<boolean> {\r\n    return this.modeler\r\n      .saveXML()\r\n      .then((result) => result.xml !== this.bmProcess.processDiagram);\r\n  }\r\n\r\n  sortByDistance<\r\n    T extends {\r\n      _id: string;\r\n      situationalFactors: { list: string; element?: SituationalFactorEntry }[];\r\n    }[]\r\n  >(elements: T): T {\r\n    const distanceMap: { [id: string]: number } = {};\r\n    elements.forEach(\r\n      (element) =>\r\n        (distanceMap[element._id] = this.bmProcessService.distanceToContext(\r\n          this.bmProcess,\r\n          element.situationalFactors.map((factor) => factor.element)\r\n        ))\r\n    );\r\n    return elements.sort(\r\n      (elementA, elementB) =>\r\n        distanceMap[elementA._id] - distanceMap[elementB._id]\r\n    );\r\n  }\r\n\r\n  checkArtifacts(): void {\r\n    const missingMap = this.bpmnService.checkArtifacts(\r\n      this.modeler,\r\n      this.bmProcess.decisions\r\n    );\r\n    const decisions = this.bmProcess.decisions;\r\n    const elementRegistry = this.modeler.get('elementRegistry');\r\n    const missing = Object.entries(missingMap).map(([key, value]) => {\r\n      const element = elementRegistry.get(key);\r\n      let elementName;\r\n      let name;\r\n      if (key in decisions) {\r\n        elementName = 'Method';\r\n        name = decisions[key].method.name;\r\n      } else if (element.businessObject.name) {\r\n        elementName = 'Activity';\r\n        name = element.businessObject.name;\r\n      } else {\r\n        elementName = 'Node';\r\n        name = element.type;\r\n      }\r\n      return {\r\n        artifacts: value,\r\n        elementId: key,\r\n        elementName,\r\n        name,\r\n      };\r\n    });\r\n    this.missingArtifacts = missing.filter((element) => element.artifacts);\r\n    this.unreachableActivities = missing.filter(\r\n      (element) => !element.artifacts\r\n    );\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"bmProcess\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ bmProcess.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"bmProcess\" role=\"main\">\r\n  <div\r\n    class=\"alert alert-info container mt-3\"\r\n    role=\"alert\"\r\n    *ngIf=\"!bmProcess.initial\"\r\n  >\r\n    <p>\r\n      On this page it is possible to create a Business Model Development Method.\r\n      You already defined the development context on the bottom of the page,\r\n      which will later be used to check situational factors. Now start with the\r\n      definition of the Method by clicking on the start event and then, on the\r\n      add button to select a Method Pattern as a starting point.\r\n    </p>\r\n\r\n    <p>\r\n      After that, you can append more patterns when selecting the added Method\r\n      Pattern or insert Method Patterns into activities by selecting the\r\n      activity and then selecting the insert icon. This is only possible if the\r\n      corresponding activity has a plus symbol and is thus a call activity.\r\n      Otherwise it is only possible to insert Method Building Blocks into the\r\n      activity by selecting the database icon when an activity is selected.\r\n    </p>\r\n\r\n    <p class=\"mb-0\">\r\n      Additionally, it is possible to get an overview of an inserted Method\r\n      Building Block by selecting the corresponding activity and selecting the\r\n      info icon. There it is also possible to select which groups of artifacts\r\n      and stakeholders to use and which concrete Method Elements to use.\r\n    </p>\r\n  </div>\r\n\r\n  <app-bm-process-diagram\r\n    *ngIf=\"!bmProcess.initial\"\r\n    [bmProcess]=\"bmProcess\"\r\n    (saveBmProcess)=\"saveBmProcess($event.processDiagram, $event.decisions)\"\r\n  ></app-bm-process-diagram>\r\n\r\n  <div class=\"container\">\r\n    <div class=\"my-3 alert alert-info\" *ngIf=\"bmProcess.initial\">\r\n      Start by defining the context of your business model.\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">Context</h6>\r\n      <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n        <h6 class=\"border-bottom border-gray pb-2\">Domain</h6>\r\n        <div class=\"alert alert-info\">\r\n          Select the domains that are related to your business model. They are\r\n          later used to select fitting canvas building blocks.\r\n        </div>\r\n        <div class=\"text-muted\">\r\n          <app-domains-selection-form\r\n            [domains]=\"bmProcess.domains\"\r\n            (submitDomainsForm)=\"updateDomains($event.value)\"\r\n          ></app-domains-selection-form>\r\n        </div>\r\n      </div>\r\n      <div class=\"mt-3 p-3 bg-white rounded shadow-sm\">\r\n        <h6 class=\"border-bottom border-gray pb-2\">Situational Factors</h6>\r\n        <div class=\"alert alert-info\">\r\n          Select situational factors to describe the current situation of your\r\n          company, problem, market, etc. They are later used to help you to\r\n          select fitting method patterns and building blocks.\r\n        </div>\r\n        <div class=\"text-muted\">\r\n          <app-situational-factors-selection-form\r\n            [situationalFactors]=\"bmProcess.situationalFactors\"\r\n            (submitSituationalFactorsForm)=\"\r\n              updateSituationalFactors($event.value)\r\n            \"\r\n          ></app-situational-factors-selection-form>\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        *ngIf=\"bmProcess.initial\"\r\n        (click)=\"finishInitialization()\"\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block btn-primary mt-3\"\r\n      >\r\n        Finish definition of the context\r\n      </button>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { DiagramComponentInterface } from '../shared/diagram-component-interface';\r\nimport { BmProcessDiagramComponent } from '../bm-process-diagram/bm-process-diagram.component';\r\nimport { BmProcessLoaderService } from '../shared/bm-process-loader.service';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\nimport { Domain } from '../../development-process-registry/knowledge/domain';\r\nimport { SelectionInit } from '../../development-process-registry/development-method/selection';\r\nimport { SituationalFactorInit } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\n\r\n@Component({\r\n  selector: 'app-bm-process',\r\n  templateUrl: './bm-process.component.html',\r\n  styleUrls: ['./bm-process.component.css'],\r\n  providers: [BmProcessLoaderService],\r\n})\r\nexport class BmProcessComponent implements OnInit, DiagramComponentInterface {\r\n  @ViewChild(BmProcessDiagramComponent)\r\n  diagramComponent: BmProcessDiagramComponent;\r\n\r\n  private previousInitial = null;\r\n\r\n  constructor(\r\n    private bmProcessLoaderService: BmProcessLoaderService,\r\n    private bmProcessService: BmProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.bmProcessLoaderService.loaded.subscribe(() => {\r\n      if (this.previousInitial === true && this.bmProcess.initial === false) {\r\n        document.body.scrollIntoView({ behavior: 'smooth' });\r\n      }\r\n      this.previousInitial = this.bmProcess.initial;\r\n    });\r\n  }\r\n\r\n  async finishInitialization(): Promise<void> {\r\n    await this.bmProcessService.finishInitialization(this.bmProcess._id);\r\n  }\r\n\r\n  async updateDomains(domains: Domain[]): Promise<void> {\r\n    await this.bmProcessService.updateDomains(this.bmProcess._id, domains);\r\n  }\r\n\r\n  async updateSituationalFactors(\r\n    situationalFactors: SelectionInit<SituationalFactorInit>[]\r\n  ): Promise<void> {\r\n    await this.bmProcessService.updateSituationalFactors(\r\n      this.bmProcess._id,\r\n      situationalFactors\r\n    );\r\n  }\r\n\r\n  async saveBmProcess(\r\n    processDiagram: string,\r\n    decisions?: { [elementId: string]: Decision }\r\n  ): Promise<void> {\r\n    await this.bmProcessService.saveBmProcessDiagram(\r\n      this.bmProcess._id,\r\n      processDiagram,\r\n      decisions\r\n    );\r\n  }\r\n\r\n  async diagramChanged(): Promise<boolean> {\r\n    if (this.diagramComponent == null) {\r\n      return false;\r\n    }\r\n    return this.diagramComponent.diagramChanged();\r\n  }\r\n\r\n  saveDiagram(): Promise<void> {\r\n    return this.diagramComponent.saveDiagram();\r\n  }\r\n\r\n  get bmProcess(): BmProcess {\r\n    return this.bmProcessLoaderService.bmProcess;\r\n  }\r\n}\r\n","<ng-template #deleteBmProcessModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteBmProcess(modalBmProcess._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Business Model Development Method {{ modalBmProcess.name }}\r\n    </div>\r\n    You are deleting the business model development method\r\n    {{ modalBmProcess.name }}. This can not be undone. This action has no effect\r\n    on running methods.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\"\r\n      >Business Model Development Methods</a\r\n    >\r\n    <a\r\n      *ngFor=\"let bmProcess of bmProcessesList\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['bmprocessview', bmProcess._id]\"\r\n      >{{ bmProcess.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Business Model Development Methods from Method Patterns and Method\r\n    Building Blocks.\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Business Model Development Methods\"\r\n    [loading]=\"loading\"\r\n    [reloading]=\"reloading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No Business Model Development Methods defined.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let bmProcess of bmProcessesList\"\r\n      >\r\n        <div>\r\n          <span>{{ bmProcess.name }}</span>\r\n        </div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"['bmprocessview', bmProcess._id]\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n            >View</a\r\n          >\r\n          <button\r\n            (click)=\"openDeleteBmProcessModal(bmProcess)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Add Business Model Development Method\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"bmProcessForm\"\r\n        (ngSubmit)=\"addBmProcess(bmProcessForm)\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\"\r\n            >Business Model Development Method Name</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!bmProcessForm.valid\"\r\n            >\r\n              Add Business Model Development Method\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  BmProcess,\r\n  BmProcessEntry,\r\n  BmProcessInit,\r\n} from '../../development-process-registry/bm-process/bm-process';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-bm-processes',\r\n  templateUrl: './bm-processes.component.html',\r\n  styleUrls: ['./bm-processes.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: BmProcessService },\r\n  ],\r\n})\r\nexport class BmProcessesComponent {\r\n  bmProcessForm = this.fb.group({\r\n    name: this.fb.control('', Validators.required),\r\n  });\r\n\r\n  modalBmProcess: BmProcessEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteBmProcessModal', { static: true })\r\n  deleteBmProcessModal: unknown;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private listService: ListService<BmProcess, BmProcessInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  openDeleteBmProcessModal(bmProcess: BmProcessEntry): void {\r\n    this.modalBmProcess = bmProcess;\r\n    this.modalReference = this.modalService.open(this.deleteBmProcessModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async deleteBmProcess(id: string): Promise<void> {\r\n    await this.listService.delete(id);\r\n  }\r\n\r\n  async addBmProcess(bmProcessForm: FormGroup): Promise<void> {\r\n    await this.listService.add({ name: bmProcessForm.value.name });\r\n    this.bmProcessForm.reset();\r\n  }\r\n\r\n  get bmProcessesList(): BmProcessEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { is } from 'bpmn-js/lib/util/ModelUtil';\r\n\r\nexport default class BmProcessPatternsContextPad {\r\n  static $inject = ['contextPad', 'eventBus'];\r\n\r\n  constructor(contextPad, private eventBus) {\r\n    contextPad.registerProvider(this);\r\n  }\r\n\r\n  getContextPadEntries(element) {\r\n    if (is(element, 'bpmn:Activity')) {\r\n      return {\r\n        'bmdl.types': {\r\n          group: 'edit',\r\n          className:\r\n            'bpmn-icon-service ' +\r\n            (element.businessObject.get('neededType').length > 0 ||\r\n            element.businessObject.inherit\r\n              ? 'text-success'\r\n              : 'text-danger'),\r\n          title: 'Manage types',\r\n          action: {\r\n            click: () =>\r\n              this.eventBus.fire('bmdl.types', element.businessObject),\r\n          },\r\n        },\r\n      };\r\n    } else {\r\n      return {};\r\n    }\r\n  }\r\n}\r\n","import ContextPadProvider from 'bpmn-js/lib/features/context-pad/ContextPadProvider';\r\n\r\nexport default class BmProcessPatternsOverrideContextPadProvider extends ContextPadProvider {\r\n  getContextPadEntries(element) {\r\n    const actions = super.getContextPadEntries(element);\r\n    delete actions['append.intermediate-event'];\r\n    return actions;\r\n  }\r\n}\r\n","import PaletteProvider from 'bpmn-js/lib/features/palette/PaletteProvider';\r\n\r\nexport default class BmProcessPatternsPaletteProvider extends PaletteProvider {\r\n  getPaletteEntries(element) {\r\n    const actionNames = [\r\n      'hand-tool',\r\n      'lasso-tool',\r\n      'space-tool',\r\n      'global-connect-tool',\r\n      'create.start-event',\r\n      'create.end-event',\r\n      'create.exclusive-gateway',\r\n      'create.task',\r\n      'tool-separator',\r\n    ];\r\n    const actions = super.getPaletteEntries(element);\r\n    const newActions = {};\r\n    for (const name of actionNames) {\r\n      newActions[name] = actions[name];\r\n    }\r\n    return newActions;\r\n  }\r\n}\r\n","import ReplaceMenuProvider from 'bpmn-js/lib/features/popup-menu/ReplaceMenuProvider';\r\n\r\nexport default class BmProcessPatternsReplaceMenuProvider extends ReplaceMenuProvider {\r\n  _createEntries(element, replaceOptions) {\r\n    const allowedTargetTypes = new Set<string>([\r\n      'bpmn:StartEvent',\r\n      'bpmn:EndEvent',\r\n      'bpmn:ExclusiveGateway',\r\n      'bpmn:ParallelGateway',\r\n      'bpmn:Task',\r\n      'bpmn:CallActivity',\r\n    ]);\r\n    replaceOptions = replaceOptions.filter((option) => {\r\n      if (option.target.eventDefinitionType) {\r\n        return allowedTargetTypes.has(option.target.eventDefinitionType);\r\n      }\r\n      return allowedTargetTypes.has(option.target.type);\r\n    });\r\n    return super._createEntries(element, replaceOptions);\r\n  }\r\n\r\n  _createSequenceFlowEntries() {\r\n    return [];\r\n  }\r\n\r\n  _getLoopEntries() {\r\n    return [];\r\n  }\r\n}\r\n","import BmProcessPatternsContextPad from './BmProcessPatternsContextPad';\r\nimport BmProcessPatternsOverrideContextPadProvider from './BmProcessPatternsOverrideContextPadProvider';\r\nimport BmProcessPatternsPaletteProvider from './BmProcessPatternsPaletteProvider';\r\nimport BmProcessPatternsReplaceMenuProvider from './BmProcessPatternsReplaceMenuProvider';\r\nimport ContextPadModule from 'diagram-js/lib/features/context-pad';\r\nimport CoreModule from 'bpmn-js/lib/core';\r\nimport ModelingModule from 'bpmn-js/lib/features/modeling';\r\nimport PaletteModule from 'bpmn-js/lib/features/palette';\r\n\r\nexport default {\r\n  __depends__: [ContextPadModule, CoreModule, ModelingModule, PaletteModule],\r\n  __init__: [\r\n    'bmProcessPatternsContextPad',\r\n    'paletteProvider',\r\n    'replaceMenuProvider',\r\n  ],\r\n  bmProcessPatternsContextPad: ['type', BmProcessPatternsContextPad],\r\n  contextPadProvider: ['type', BmProcessPatternsOverrideContextPadProvider],\r\n  paletteProvider: ['type', BmProcessPatternsPaletteProvider],\r\n  replaceMenuProvider: ['type', BmProcessPatternsReplaceMenuProvider],\r\n};\r\n","import { is } from 'bpmn-js/lib/util/ModelUtil';\r\n\r\nexport default class BmProcessContextPadProvider {\r\n  static $inject = ['contextPad', 'eventBus'];\r\n\r\n  constructor(contextPad, private eventBus) {\r\n    contextPad.registerProvider(this);\r\n  }\r\n\r\n  getContextPadEntries(element) {\r\n    const controls = {};\r\n    if (\r\n      (is(element, 'bpmn:SubProcess') &&\r\n        is(element.parent, 'bpmn:SubProcess')) ||\r\n      is(element, 'bpmn:Task') ||\r\n      is(element, 'bpmn:CallActivity')\r\n    ) {\r\n      controls['bmp.showTypes'] = {\r\n        group: 'info',\r\n        className: 'fas fa-list font-bpmn-adaption',\r\n        title: 'Show types',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.showTypes', element),\r\n        },\r\n      };\r\n    }\r\n    if (is(element, 'bpmn:SubProcess')) {\r\n      controls['bmp.showPattern'] = {\r\n        group: 'info',\r\n        className: 'fas fa-info-circle font-bpmn-adaption',\r\n        title: 'Show Method Pattern details',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.showPattern', element),\r\n        },\r\n      };\r\n      controls['bmp.deletePattern'] = {\r\n        group: 'edit',\r\n        className: 'far fa-trash-alt font-bpmn-adaption',\r\n        title: 'Delete Method Pattern',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.deletePattern', element),\r\n        },\r\n      };\r\n    }\r\n    if (\r\n      (is(element, 'bpmn:StartEvent') || is(element, 'bpmn:SubProcess')) &&\r\n      element.businessObject.get('outgoing').length === 0\r\n    ) {\r\n      controls['bmp.processPatterns'] = {\r\n        group: 'edit',\r\n        className: 'far fa-plus-square font-bpmn-adaption',\r\n        title: 'Add Method Pattern',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.processPatterns', element),\r\n        },\r\n      };\r\n    }\r\n    if (is(element, 'bpmn:Task') || is(element, 'bpmn:CallActivity')) {\r\n      controls['bmp.selectMethod'] = {\r\n        group: 'edit',\r\n        className: 'fas fa-database font-bpmn-adaption',\r\n        title: 'Select Method Building Block',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.selectMethod', element),\r\n        },\r\n      };\r\n      if (element.businessObject.method) {\r\n        controls['bmp.showMethod'] = {\r\n          group: 'edit',\r\n          className: 'fas fa-clipboard-list font-bpmn-adaption',\r\n          title: 'Edit Method Building Block details',\r\n          action: {\r\n            click: () => this.eventBus.fire('bmp.showMethod', element),\r\n          },\r\n        };\r\n        controls['bmp.summary'] = {\r\n          group: 'info',\r\n          className: 'fas fa-clipboard-check font-bpmn-adaption',\r\n          title: 'Show Method Building Block summary',\r\n          action: {\r\n            click: () => this.eventBus.fire('bmp.summary', element),\r\n          },\r\n        };\r\n        controls['bmp.removeMethod'] = {\r\n          group: 'edit',\r\n          className: 'far fa-trash-alt font-bpmn-adaption',\r\n          title: 'Remove Method Building Block from task',\r\n          action: {\r\n            click: () => this.eventBus.fire('bmp.removeMethod', element),\r\n          },\r\n        };\r\n      }\r\n    }\r\n    if (is(element, 'bpmn:CallActivity')) {\r\n      controls['bmp.selectPattern'] = {\r\n        group: 'edit',\r\n        className: 'fas fa-sign-in-alt font-bpmn-adaption',\r\n        title: 'Insert Method Pattern',\r\n        action: {\r\n          click: () => this.eventBus.fire('bmp.selectPattern', element),\r\n        },\r\n      };\r\n    }\r\n    return controls;\r\n  }\r\n}\r\n","export default class BmProcessLabelEditing {\r\n  private static readonly PRIORITY = 1500;\r\n\r\n  static $inject = ['eventBus'];\r\n\r\n  constructor(private eventBus) {\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.eventBus.on(\r\n      'element.dblclick',\r\n      BmProcessLabelEditing.PRIORITY,\r\n      () => false\r\n    );\r\n  }\r\n}\r\n","import PaletteProvider from 'bpmn-js/lib/features/palette/PaletteProvider';\r\n\r\nexport default class BmProcessPaletteProvider extends PaletteProvider {\r\n  getPaletteEntries(element) {\r\n    const actions = super.getPaletteEntries(element);\r\n    return {\r\n      'hand-tool': actions['hand-tool'],\r\n      'space-tool': actions['space-tool'],\r\n      'lasso-tool': actions['lasso-tool'],\r\n    };\r\n  }\r\n}\r\n","import RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\r\n\r\nexport default class BmProcessRuleProvider extends RuleProvider {\r\n  private static readonly PRIORITY = 1500;\r\n\r\n  init() {\r\n    this.addRule('connection.reconnect', (context): false | undefined => {\r\n      const currentSource = context.connection.businessObject.sourceRef;\r\n      const currentTarget = context.connection.businessObject.targetRef;\r\n      const newSource = context.source.businessObject;\r\n      const newTarget = context.target.businessObject;\r\n      if (currentSource !== newSource || currentTarget !== newTarget) {\r\n        return false;\r\n      }\r\n      return undefined;\r\n    });\r\n    this.addRule('elements.move', (context): false | undefined => {\r\n      if (context.shapes.length > 0) {\r\n        const shape = context.shapes[0];\r\n        if (context.target && context.target !== shape.parent) {\r\n          return false;\r\n        }\r\n      }\r\n      return undefined;\r\n    });\r\n  }\r\n\r\n  addRule(actions, fn) {\r\n    super.addRule(actions, BmProcessRuleProvider.PRIORITY, fn);\r\n  }\r\n}\r\n","import BaseRenderer from 'diagram-js/lib/draw/BaseRenderer';\r\nimport BpmnRenderer from 'bpmn-js/lib/draw/BpmnRenderer';\r\nimport TextRenderer from 'bpmn-js/lib/draw/TextRenderer';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { append, attr, remove, select } from 'tiny-svg';\r\nimport { BmProcess } from '../../../development-process-registry/bm-process/bm-process';\r\nimport { BmProcessService } from '../../../development-process-registry/bm-process/bm-process.service';\r\n\r\nexport default class BmProcessTaskRenderer extends BaseRenderer {\r\n  static $inject = ['eventBus', 'bpmnRenderer', 'textRenderer'];\r\n\r\n  private static readonly HIGH_PRIORITY = 1500;\r\n\r\n  private bpmnRenderer: BpmnRenderer;\r\n  private textRenderer: TextRenderer;\r\n\r\n  private process: BmProcess = null;\r\n  private bmProcessService: BmProcessService;\r\n\r\n  constructor(eventBus, bpmnRenderer, textRenderer) {\r\n    super(eventBus, BmProcessTaskRenderer.HIGH_PRIORITY);\r\n\r\n    this.bpmnRenderer = bpmnRenderer;\r\n    this.textRenderer = textRenderer;\r\n  }\r\n\r\n  canRender(element) {\r\n    return is(element, 'bpmn:Task') || is(element, 'bpmn:CallActivity');\r\n  }\r\n\r\n  drawShape(parentNode: SVGGElement, element) {\r\n    const shape: SVGRectElement = this.bpmnRenderer.drawShape(\r\n      parentNode,\r\n      element\r\n    );\r\n    const method = element.businessObject.get('method');\r\n    if (method) {\r\n      remove(select(parentNode, 'text'));\r\n      const methodName = this.textRenderer.createText(method.name, {\r\n        box: element,\r\n        align: 'center-middle',\r\n        padding: 5,\r\n      });\r\n      append(parentNode, methodName);\r\n      if (this.process && element.id in this.process.decisions) {\r\n        const decision = this.process.decisions[element.id];\r\n        if (!this.bmProcessService.checkDecisionStepArtifacts(decision)) {\r\n          attr(shape, { stroke: 'orange', rx: 2, ry: 2 });\r\n        } else if (!decision.isComplete()) {\r\n          attr(shape, { stroke: 'gray', rx: 2, ry: 2 });\r\n        } else {\r\n          attr(shape, { stroke: 'green', rx: 0, ry: 0 });\r\n        }\r\n      } else {\r\n        attr(shape, { stroke: 'green', rx: 0, ry: 0 });\r\n      }\r\n    } else {\r\n      attr(shape, { stroke: 'red' });\r\n    }\r\n    return shape;\r\n  }\r\n\r\n  getShapePath(shape) {\r\n    return this.bpmnRenderer.getShapePath(shape);\r\n  }\r\n}\r\n","import BmProcessContextPadProvider from './BmProcessContextPadProvider';\r\nimport BmProcessLabelEditing from './BmProcessLabelEditing';\r\nimport BmProcessPaletteProvider from './BmProcessPaletteProvider';\r\nimport BmProcessRuleProvider from './BmProcessRuleProvider';\r\nimport BmProcessTaskRenderer from './BmProcessTaskRenderer';\r\nimport ContextPadModule from 'diagram-js/lib/features/context-pad';\r\nimport CoreModule from 'bpmn-js/lib/core';\r\nimport ModelingModule from 'bpmn-js/lib/features/modeling';\r\nimport PaletteModule from 'bpmn-js/lib/features/palette';\r\n\r\nexport default {\r\n  __depends__: [ContextPadModule, CoreModule, ModelingModule, PaletteModule],\r\n  __init__: [\r\n    'bmProcessLabelEditing',\r\n    'bmProcessRuleProvider',\r\n    'contextPadProvider',\r\n    'dropOnFlowBehavior',\r\n    'paletteProvider',\r\n    'taskRenderer',\r\n  ],\r\n  bmProcessLabelEditing: ['type', BmProcessLabelEditing],\r\n  bmProcessRuleProvider: ['type', BmProcessRuleProvider],\r\n  contextPadProvider: ['type', BmProcessContextPadProvider],\r\n  dropOnFlowBehavior: ['value', null],\r\n  paletteProvider: ['type', BmProcessPaletteProvider],\r\n  taskRenderer: ['type', BmProcessTaskRenderer],\r\n};\r\n","<form [formGroup]=\"artifactForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"identifier\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        class=\"form-control\"\r\n        id=\"identifier\"\r\n        formControlName=\"identifier\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"artifactName\" class=\"col-sm-4 col-form-label\"\r\n      >Artifact Type</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        readonly\r\n        class=\"form-control-plaintext\"\r\n        id=\"artifactName\"\r\n        value=\"{{ artifact.artifact.name }}\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group form-row\" *ngIf=\"artifact.artifact.internalArtifact\">\r\n    <label for=\"artifactMetaModel\" class=\"col-sm-4 col-form-label\"\r\n      >Artifact Meta Model</label\r\n    >\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        readonly\r\n        class=\"form-control-plaintext\"\r\n        id=\"artifactMetaModel\"\r\n        value=\"{{ artifact.artifact.metaModel.name }}\"\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!artifactForm.valid\"\r\n      >\r\n        Update Artifact<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-concrete-artifact-form',\r\n  templateUrl: './concrete-artifact-form.component.html',\r\n  styleUrls: ['./concrete-artifact-form.component.css'],\r\n})\r\nexport class ConcreteArtifactFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() artifact: RunningArtifact;\r\n\r\n  @Output() submitArtifactForm = new EventEmitter<FormGroup>();\r\n\r\n  artifactForm: FormGroup = this.fb.group({\r\n    identifier: ['', Validators.required],\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.artifactForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = this.artifact.identifier !== value.identifier)\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.artifact) {\r\n      const newArtifact = changes.artifact.currentValue;\r\n      const oldArtifact = changes.artifact.previousValue;\r\n      if (!this.equalArtifacts(oldArtifact, newArtifact)) {\r\n        this.loadForm(newArtifact);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitArtifactForm.emit(this.artifactForm);\r\n  }\r\n\r\n  private loadForm(artifact: RunningArtifact): void {\r\n    if (artifact) {\r\n      this.artifactForm.setValue({ identifier: artifact.identifier });\r\n    } else {\r\n      this.artifactForm.setValue({ identifier: '' });\r\n    }\r\n  }\r\n\r\n  private equalArtifacts(\r\n    artifactA: RunningArtifact,\r\n    artifactB: RunningArtifact\r\n  ): boolean {\r\n    if (artifactA == null && artifactB == null) {\r\n      return true;\r\n    }\r\n    if (artifactA == null || artifactB == null) {\r\n      return false;\r\n    }\r\n    return artifactA.identifier === artifactB.identifier;\r\n  }\r\n}\r\n","<ng-template #showArtifactVersionModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Version #{{ artifact.versions.indexOf(modalVersion) + 1 }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <ng-container\r\n      *ngIf=\"getArtifactDataTypeString() === modalVersion.data.type\"\r\n    >\r\n      <h5>Note</h5>\r\n      <quill-view [content]=\"modalVersion.data.data\"></quill-view>\r\n    </ng-container>\r\n    <ng-container\r\n      *ngIf=\"getArtifactDataTypeReference() === modalVersion.data.type\"\r\n    >\r\n      <h5>Reference</h5>\r\n      This version points on another object in the database.\r\n      <button\r\n        class=\"btn btn-xs btn-primary\"\r\n        (click)=\"viewArtifactReference(modalVersion.data.data)\"\r\n      >\r\n        View\r\n      </button>\r\n    </ng-container>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"artifact\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'concreteArtifacts']\">\r\n      Concrete Artifacts\r\n    </a>\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ artifact.identifier }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"artifact\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update an artifact and view it.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Artifact</h6>\r\n    <app-concrete-artifact-form\r\n      [artifact]=\"artifact\"\r\n      (submitArtifactForm)=\"updateIdentifier($event.value.identifier)\"\r\n    ></app-concrete-artifact-form>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Versions</h6>\r\n    <ul class=\"list-group\" *ngIf=\"artifact.versions.length > 0\">\r\n      <li\r\n        class=\"list-group-item\"\r\n        *ngFor=\"let version of artifact.versions; let index = index\"\r\n      >\r\n        <a [routerLink]=\"[]\" (click)=\"openShowArtifactVersionModal(version)\">\r\n          Version #{{ index + 1 }}\r\n        </a>\r\n        &ndash; Imported from {{ version.importName }}\r\n        &ndash;\r\n        {{ version.time | date: 'short' }}\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { ConcreteArtifactLoaderService } from '../shared/concrete-artifact-loader.service';\r\nimport { ConcreteArtifactService } from '../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { ArtifactVersion } from '../../development-process-registry/running-process/artifact-version';\r\nimport {\r\n  ArtifactDataReference,\r\n  ArtifactDataType,\r\n} from '../../development-process-registry/running-process/artifact-data';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { MetaModelService } from '../../development-process-registry/meta-model.service';\r\nimport { Router } from '@angular/router';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\n\r\n@Component({\r\n  selector: 'app-concrete-artifact',\r\n  templateUrl: './concrete-artifact.component.html',\r\n  styleUrls: ['./concrete-artifact.component.css'],\r\n  providers: [ConcreteArtifactLoaderService],\r\n})\r\nexport class ConcreteArtifactComponent {\r\n  modalVersion: ArtifactVersion;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('showArtifactVersionModal', { static: true })\r\n  showArtifactVersionModal: unknown;\r\n\r\n  constructor(\r\n    private concreteArtifactLoaderService: ConcreteArtifactLoaderService,\r\n    private concreteArtifactService: ConcreteArtifactService,\r\n    private metaModelService: MetaModelService,\r\n    private modalService: NgbModal,\r\n    private router: Router\r\n  ) {}\r\n\r\n  async updateIdentifier(identifier: string): Promise<void> {\r\n    await this.concreteArtifactService.updateIdentifier(\r\n      this.artifact._id,\r\n      identifier\r\n    );\r\n  }\r\n\r\n  openShowArtifactVersionModal(version: ArtifactVersion): void {\r\n    this.modalVersion = version;\r\n    this.modalReference = this.modalService.open(\r\n      this.showArtifactVersionModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  viewArtifactReference(reference: ArtifactDataReference): void {\r\n    this.modalReference.close();\r\n    this.metaModelService\r\n      .getMetaModelApi(reference.type)\r\n      .view(reference, this.router, {\r\n        referenceType: 'Artifact',\r\n        artifactId: this.artifact._id,\r\n        versionId: this.artifact.versions.indexOf(this.modalVersion),\r\n      });\r\n  }\r\n\r\n  get artifact(): RunningArtifact {\r\n    return this.concreteArtifactLoaderService.artifact;\r\n  }\r\n\r\n  getArtifactDataTypeString(): ArtifactDataType {\r\n    return ArtifactDataType.STRING;\r\n  }\r\n\r\n  getArtifactDataTypeReference(): ArtifactDataType {\r\n    return ArtifactDataType.REFERENCE;\r\n  }\r\n}\r\n","<ng-template #deleteArtifactModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteArtifact(modalArtifact); c()\"\r\n  >\r\n    <div modalTitle>Delete Artifact {{ modalArtifact.identifier }}</div>\r\n    You are deleting the concrete artifact {{ modalArtifact.identifier }}. This\r\n    can not be undone.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Concrete Artifacts</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Artifacts that can be imported into running methods.\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Concrete Artifacts\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No artifacts available.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let artifact of artifacts\"\r\n      >\r\n        <div>\r\n          <span>\r\n            {{ artifact.identifier }} &ndash;\r\n            {{ artifact.artifact.name }}\r\n          </span>\r\n        </div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"getRouterLink(artifact)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n          >\r\n            View\r\n          </a>\r\n          <button\r\n            (click)=\"openDeleteArtifactModal(artifact)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  RunningArtifact,\r\n  RunningArtifactEntry,\r\n  RunningArtifactInit,\r\n} from '../../development-process-registry/running-process/running-artifact';\r\nimport { ConcreteArtifactService } from '../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-concrete-artifacts',\r\n  templateUrl: './concrete-artifacts.component.html',\r\n  styleUrls: ['./concrete-artifacts.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: ConcreteArtifactService },\r\n  ],\r\n})\r\nexport class ConcreteArtifactsComponent {\r\n  modalArtifact: RunningArtifactEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteArtifactModal', { static: true })\r\n  deleteArtifactModal: unknown;\r\n\r\n  constructor(\r\n    private listService: ListService<RunningArtifact, RunningArtifactInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  openDeleteArtifactModal(artifact: RunningArtifactEntry): void {\r\n    this.modalArtifact = artifact;\r\n    this.modalReference = this.modalService.open(this.deleteArtifactModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async deleteArtifact(artifact: RunningArtifactEntry): Promise<void> {\r\n    await this.listService.delete(artifact._id);\r\n  }\r\n\r\n  getRouterLink(artifact: RunningArtifactEntry): string[] {\r\n    return ['detail', artifact._id];\r\n  }\r\n\r\n  get artifacts(): RunningArtifactEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { Directive, ViewContainerRef } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[appConfigurationFormPlaceholder]',\r\n})\r\nexport class ConfigurationFormPlaceholderDirective {\r\n  constructor(public viewContainerRef: ViewContainerRef) {}\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-confirm-leave-modal',\r\n  templateUrl: './confirm-leave-modal.component.html',\r\n  styleUrls: ['./confirm-leave-modal.component.css'],\r\n})\r\nexport class ConfirmLeaveModalComponent {\r\n  constructor(private activeModal: NgbActiveModal) {}\r\n\r\n  close() {\r\n    this.activeModal.dismiss();\r\n  }\r\n\r\n  leave() {\r\n    this.activeModal.close(false);\r\n  }\r\n\r\n  saveChanges() {\r\n    this.activeModal.close(true);\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">You have unsaved changes in the diagram</h4>\r\n</div>\r\n<div class=\"modal-body\">\r\n  You can stay on this page, discard them or save them.\r\n</div>\r\n<div class=\"modal-footer\">\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"close()\">\r\n    Close\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"leave()\">\r\n    Leave without saving\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary\" (click)=\"saveChanges()\">\r\n    Save changes\r\n  </button>\r\n</div>\r\n","<div [formGroup]=\"formGroup\" class=\"form-row\">\r\n  <div class=\"form-group col-md\">\r\n    <label for=\"selectOutput\">To other step or output</label>\r\n    <select id=\"selectOutput\" class=\"form-control\" formControlName=\"output\">\r\n      <option [ngValue]=\"false\">Step</option>\r\n      <option [ngValue]=\"true\">Output</option>\r\n    </select>\r\n  </div>\r\n  <ng-container *ngIf=\"!outputControl.value\">\r\n    <div class=\"form-group col-md\">\r\n      <label for=\"inputStep\">Step</label>\r\n      <select id=\"inputStep\" class=\"form-control\" formControlName=\"step\">\r\n        <ng-container\r\n          *ngFor=\"\r\n            let step of executionStepsFormValue ??\r\n              developmentMethod.executionSteps;\r\n            let index = index\r\n          \"\r\n        >\r\n          <option\r\n            *ngIf=\"stepNumber == null || index > stepNumber\"\r\n            [ngValue]=\"index\"\r\n          >\r\n            #{{ index + 1 }}\r\n          </option>\r\n        </ng-container>\r\n      </select>\r\n    </div>\r\n  </ng-container>\r\n  <ng-container *ngIf=\"outputControl.value\">\r\n    <div class=\"form-group col-md\">\r\n      <label for=\"inputGroup\">Group</label>\r\n      <select id=\"inputGroup\" class=\"form-control\" formControlName=\"group\">\r\n        <option\r\n          *ngFor=\"\r\n            let group of developmentMethod.outputArtifacts;\r\n            let index = index\r\n          \"\r\n          [ngValue]=\"index\"\r\n        >\r\n          #{{ index + 1 }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n  </ng-container>\r\n  <div class=\"form-group col\">\r\n    <label for=\"inputArtifact\">Artifact</label>\r\n    <div class=\"input-group\">\r\n      <select\r\n        id=\"inputArtifact\"\r\n        class=\"form-control\"\r\n        formControlName=\"artifact\"\r\n      >\r\n        <ng-container *ngFor=\"let artifact of artifacts; let index = index\">\r\n          <option\r\n            *ngIf=\"artifactConformsToMetaModel(artifact)\"\r\n            [ngValue]=\"index\"\r\n          >\r\n            #{{ index + 1 }} {{ artifact.name }}\r\n          </option>\r\n        </ng-container>\r\n      </select>\r\n      <div class=\"input-group-append\">\r\n        <button\r\n          class=\"btn btn-outline-secondary\"\r\n          type=\"button\"\r\n          (click)=\"remove.emit()\"\r\n        >\r\n          Remove\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormControl, FormGroup, FormGroupDirective } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\nimport { ArtifactMappingFormService } from '../shared/artifact-mapping-form.service';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { ExecutionStepsFormValue } from '../shared/execution-steps-form.service';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\nimport { MetaModelIdentifier } from '../../development-process-registry/meta-model-definition';\r\n\r\n@Component({\r\n  selector: 'app-development-method-artifact-mapping',\r\n  templateUrl: './development-method-artifact-mapping.component.html',\r\n  styleUrls: ['./development-method-artifact-mapping.component.css'],\r\n})\r\nexport class DevelopmentMethodArtifactMappingComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() executionStepsFormValue?: ExecutionStepsFormValue;\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n  @Input() metaModel: MetaModelIdentifier;\r\n  @Input() stepNumber: number = null;\r\n\r\n  @Output() remove = new EventEmitter<void>();\r\n\r\n  artifacts: MetaModelIdentifier[] = [];\r\n\r\n  private outputChangeSubscription: Subscription;\r\n  private stepChangeSubscription: Subscription;\r\n  private groupChangeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private artifactMappingService: ArtifactMappingFormService,\r\n    private formGroupDirective: FormGroupDirective,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.updateSubscriptions();\r\n    this.outputChangeSubscription = this.outputControl.valueChanges\r\n      .pipe(\r\n        tap(() => {\r\n          this.artifactMappingService.convertMappingForm(this.formGroup);\r\n          this.artifacts = [];\r\n          this.updateSubscriptions();\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.developmentMethod) {\r\n      this.updateSubscriptions();\r\n    } else if (\r\n      changes.executionStepsFormValue &&\r\n      !this.outputControl.value &&\r\n      this.stepControl.value != null\r\n    ) {\r\n      this.updateStepArtifacts(this.stepControl.value);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.outputChangeSubscription) {\r\n      this.outputChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.stepChangeSubscription) {\r\n      this.stepChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.groupChangeSubscription) {\r\n      this.groupChangeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  updateSubscriptions(): void {\r\n    if (this.stepChangeSubscription) {\r\n      this.stepChangeSubscription.unsubscribe();\r\n      this.stepChangeSubscription = null;\r\n    }\r\n    if (this.groupChangeSubscription) {\r\n      this.groupChangeSubscription.unsubscribe();\r\n      this.groupChangeSubscription = null;\r\n    }\r\n    if (this.outputControl.value) {\r\n      if (this.groupControl.value != null) {\r\n        this.updateGroupArtifacts(this.groupControl.value);\r\n      }\r\n      this.groupChangeSubscription = this.groupControl.valueChanges\r\n        .pipe(tap((groupNumber) => this.updateGroupArtifacts(groupNumber)))\r\n        .subscribe();\r\n    } else {\r\n      if (this.stepControl.value != null) {\r\n        this.updateStepArtifacts(this.stepControl.value);\r\n      }\r\n      this.stepChangeSubscription = this.stepControl.valueChanges\r\n        .pipe(\r\n          tap((stepNumber) => {\r\n            if (stepNumber == null) {\r\n              this.artifacts = [];\r\n            } else {\r\n              this.artifactControl.reset();\r\n              this.updateStepArtifacts(stepNumber);\r\n            }\r\n          })\r\n        )\r\n        .subscribe();\r\n    }\r\n  }\r\n\r\n  updateGroupArtifacts(groupNumber: number): void {\r\n    const group = this.developmentMethod.outputArtifacts[groupNumber];\r\n    this.artifacts = group.map((artifact) => {\r\n      if (!artifact.element || !artifact.element.metaModel) {\r\n        return {\r\n          name: 'Placeholer',\r\n          type: null,\r\n        };\r\n      }\r\n      return {\r\n        name: artifact.element.name,\r\n        type: artifact.element.metaModel.type,\r\n      };\r\n    });\r\n  }\r\n\r\n  updateStepArtifacts(stepNumber: number): void {\r\n    if (this.executionStepsFormValue != null) {\r\n      const method = this.executionStepsFormValue[stepNumber].method;\r\n      if (method != null) {\r\n        this.artifacts = method.input;\r\n      } else {\r\n        this.artifacts = [];\r\n      }\r\n    } else {\r\n      const step = this.developmentMethod.executionSteps[stepNumber];\r\n      this.artifacts = this.moduleService.getModuleMethod(\r\n        step.module,\r\n        step.method\r\n      ).input;\r\n    }\r\n  }\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.formGroupDirective.control;\r\n  }\r\n\r\n  get outputControl(): FormControl {\r\n    return this.formGroup.get('output') as FormControl;\r\n  }\r\n\r\n  get stepControl(): FormControl {\r\n    return this.formGroup.get('step') as FormControl;\r\n  }\r\n\r\n  get groupControl(): FormControl {\r\n    return this.formGroup.get('group') as FormControl;\r\n  }\r\n\r\n  get artifactControl(): FormControl {\r\n    return this.formGroup.get('artifact') as FormControl;\r\n  }\r\n\r\n  artifactConformsToMetaModel(artifact: MetaModelIdentifier): boolean {\r\n    return artifact.type === this.metaModel.type;\r\n  }\r\n}\r\n","<div\r\n  *ngFor=\"let control of formArray.controls; let index = index\"\r\n  [formGroup]=\"$any(control)\"\r\n>\r\n  <app-development-method-artifact-mapping\r\n    [executionStepsFormValue]=\"executionStepsFormValue\"\r\n    [developmentMethod]=\"developmentMethod\"\r\n    [metaModel]=\"metaModel\"\r\n    [stepNumber]=\"stepNumber\"\r\n    (remove)=\"removeMapping(index)\"\r\n  ></app-development-method-artifact-mapping>\r\n</div>\r\n<div class=\"d-flex\">\r\n  <button type=\"button\" class=\"ml-auto btn btn-primary\" (click)=\"addMapping()\">\r\n    Add Mapping\r\n  </button>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { FormArray, FormArrayName } from '@angular/forms';\r\nimport { ArtifactMappingFormService } from '../shared/artifact-mapping-form.service';\r\nimport { ExecutionStepsFormValue } from '../shared/execution-steps-form.service';\r\nimport { MetaModelIdentifier } from '../../development-process-registry/meta-model-definition';\r\n\r\n@Component({\r\n  selector: 'app-development-method-artifact-mappings',\r\n  templateUrl: './development-method-artifact-mappings.component.html',\r\n  styleUrls: ['./development-method-artifact-mappings.component.css'],\r\n})\r\nexport class DevelopmentMethodArtifactMappingsComponent {\r\n  @Input() executionStepsFormValue?: ExecutionStepsFormValue;\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n  @Input() metaModel: MetaModelIdentifier;\r\n  @Input() stepNumber: number = null;\r\n\r\n  constructor(\r\n    private artifactMappingService: ArtifactMappingFormService,\r\n    private formArrayName: FormArrayName\r\n  ) {}\r\n\r\n  addMapping(): void {\r\n    this.formArray.push(this.artifactMappingService.createMappingForm());\r\n  }\r\n\r\n  removeMapping(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.formArrayName.control;\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-development-method-form',\r\n  templateUrl: './development-method-form.component.html',\r\n  styleUrls: ['./development-method-form.component.css'],\r\n})\r\nexport class DevelopmentMethodFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() developmentMethod!: DevelopmentMethod;\r\n\r\n  @Output() submitDevelopmentMethodForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.nameControl.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = value !== this.developmentMethod.name))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.developmentMethod) {\r\n      const oldDevelopmentMethod: DevelopmentMethod =\r\n        changes.developmentMethod.previousValue;\r\n      const newDevelopmentMethod: DevelopmentMethod =\r\n        changes.developmentMethod.currentValue;\r\n      if (\r\n        changes.developmentMethod.firstChange ||\r\n        oldDevelopmentMethod.name !== newDevelopmentMethod.name\r\n      ) {\r\n        this.nameControl.setValue(newDevelopmentMethod.name);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription != null) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitDevelopmentMethodForm.emit(this.form);\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.form.get('name') as FormControl;\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">Building Block incomplete</h4>\r\n  <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"dismiss()\">\r\n    <span aria-hidden=\"true\">&times;</span>\r\n    <span class=\"sr-only\">Close Window</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <div class=\"alert alert-warning\">\r\n    The provided building block is incomplete. Please check it in the building\r\n    block overview.\r\n  </div>\r\n</div>\r\n<div class=\"modal-footer d-flex\">\r\n  <button type=\"button\" class=\"btn btn-dark\" (click)=\"dismiss()\">Close</button>\r\n  <button\r\n    *ngIf=\"developmentMethod != null\"\r\n    type=\"button\"\r\n    class=\"btn btn-primary ml-auto\"\r\n    (click)=\"check()\"\r\n  >\r\n    Check\r\n  </button>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { NgbActiveModal, NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-development-method-incomplete-modal',\r\n  templateUrl: './development-method-incomplete-modal.component.html',\r\n  styleUrls: ['./development-method-incomplete-modal.component.css'],\r\n})\r\nexport class DevelopmentMethodIncompleteModalComponent {\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n\r\n  constructor(\r\n    private activeModal: NgbActiveModal,\r\n    private modalService: NgbModal,\r\n    private router: Router\r\n  ) {}\r\n\r\n  dismiss(): void {\r\n    this.activeModal.dismiss();\r\n  }\r\n\r\n  async check(): Promise<void> {\r\n    this.modalService.dismissAll();\r\n    await this.router.navigate([\r\n      'methods',\r\n      'methodview',\r\n      this.developmentMethod._id,\r\n    ]);\r\n  }\r\n}\r\n","<div class=\"text-muted\" [formGroup]=\"formGroup\">\r\n  <div class=\"form-row\">\r\n    <div class=\"form-group col\">\r\n      <label for=\"moduleInput\">Module</label>\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"module\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"moduleControl.invalid\"\r\n        id=\"moduleInput\"\r\n        [ngbTypeahead]=\"searchModule\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (click)=\"openModuleInput.next($any($event.target).value)\"\r\n        (focus)=\"openModuleInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n    <div class=\"form-group col\">\r\n      <label for=\"methodInput\">Method</label>\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"method\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"methodControl.invalid\"\r\n        id=\"methodInput\"\r\n        [ngbTypeahead]=\"searchMethod\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (click)=\"openMethodInput.next($any($event.target).value)\"\r\n        (focus)=\"openMethodInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <h5\r\n    *ngIf=\"\r\n      selectedMethod != null &&\r\n      selectedMethod.configurationFormComponent != null\r\n    \"\r\n  >\r\n    Predefined Values\r\n  </h5>\r\n  <ng-template appConfigurationFormPlaceholder></ng-template>\r\n  <ng-container *ngIf=\"selectedMethod && selectedMethod.input.length > 0\">\r\n    <h5>Input Artifacts</h5>\r\n    <ul class=\"list-group mb-3\">\r\n      <li\r\n        class=\"list-group-item\"\r\n        *ngFor=\"let input of selectedMethod.input; let index = index\"\r\n      >\r\n        <b [class.text-danger]=\"artifactInputs[index].length === 0\">{{\r\n          input.name\r\n        }}</b>\r\n        <div *ngIf=\"artifactInputs[index].length === 0\">\r\n          No input for this artifact defined\r\n        </div>\r\n        <div *ngIf=\"artifactInputs[index].length > 0\">\r\n          Input from:\r\n          <ul>\r\n            <li *ngFor=\"let from of artifactInputs[index]\">\r\n              {{ from.isStep ? 'Step' : 'Input Group' }} #{{\r\n                from.index + 1\r\n              }}\r\n              Artifact #{{ from.artifact + 1 }}\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </ng-container>\r\n  <ng-container *ngIf=\"selectedMethod && selectedMethod.output.length > 0\">\r\n    <h5>Output Artifacts</h5>\r\n    <ul formArrayName=\"outputMappings\" class=\"list-group mb-3\">\r\n      <li\r\n        *ngFor=\"let output of selectedMethod.output; let index = index\"\r\n        class=\"list-group-item\"\r\n      >\r\n        <b>{{ output.name }}</b>\r\n        <app-development-method-artifact-mappings\r\n          [executionStepsFormValue]=\"executionStepsFormValue\"\r\n          [developmentMethod]=\"developmentMethod\"\r\n          formArrayName=\"{{ index }}\"\r\n          [metaModel]=\"output\"\r\n          [stepNumber]=\"stepNumber\"\r\n        ></app-development-method-artifact-mappings>\r\n      </li>\r\n    </ul>\r\n  </ng-container>\r\n  <div class=\"d-flex\">\r\n    <button class=\"btn btn-dark ml-auto\" (click)=\"remove.emit()\">Remove</button>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  ComponentFactoryResolver,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\nimport { filter, map, tap } from 'rxjs/operators';\r\nimport {\r\n  FormArray,\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  FormGroupDirective,\r\n} from '@angular/forms';\r\nimport { Module } from '../../development-process-registry/module-api/module';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { ConfigurationFormPlaceholderDirective } from '../configuration-form-placeholder.directive';\r\nimport { ModuleMethod } from '../../development-process-registry/module-api/module-method';\r\nimport { ConfigurationFormComponent } from '../../development-process-registry/module-api/configuration-form-component';\r\nimport {\r\n  ExecutionStepsFormService,\r\n  ExecutionStepsFormValue,\r\n} from '../shared/execution-steps-form.service';\r\n\r\n@Component({\r\n  selector: 'app-development-method-select-execution-step',\r\n  templateUrl: './development-method-select-execution-step.component.html',\r\n  styleUrls: ['./development-method-select-execution-step.component.css'],\r\n})\r\nexport class DevelopmentMethodSelectExecutionStepComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() executionStepsFormValue?: ExecutionStepsFormValue;\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n  @Input() stepNumber: number;\r\n\r\n  modules: Module[];\r\n  methods: ModuleMethod[] = [];\r\n\r\n  artifactInputs: { isStep: boolean; index: number; artifact: number }[][];\r\n\r\n  @Output() remove = new EventEmitter<void>();\r\n\r\n  openModuleInput = new Subject<string>();\r\n  openMethodInput = new Subject<string>();\r\n\r\n  @ViewChild(ConfigurationFormPlaceholderDirective, { static: true })\r\n  configurationFormHost: ConfigurationFormPlaceholderDirective;\r\n\r\n  private moduleChangeSubscription: Subscription;\r\n  private methodChangeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private componentFactoryResolver: ComponentFactoryResolver,\r\n    private executionStepsFormService: ExecutionStepsFormService,\r\n    private fb: FormBuilder,\r\n    private formGroupDirective: FormGroupDirective,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    if (this.moduleControl.value != null) {\r\n      this.initMethods(this.moduleControl.value);\r\n    }\r\n    if (this.selectedMethod != null) {\r\n      this.initConfiguration(this.selectedMethod);\r\n    }\r\n    this.moduleChangeSubscription = this.moduleControl.valueChanges\r\n      .pipe(\r\n        tap(() => this.methodControl.setValue(null)),\r\n        tap(() => (this.methods = [])),\r\n        filter((module) => module),\r\n        tap((module) => this.initMethods(module))\r\n      )\r\n      .subscribe();\r\n    this.methodChangeSubscription = this.methodControl.valueChanges\r\n      .pipe(\r\n        tap(() => this.outputArtifactsControl.clear()),\r\n        tap(() => this.clearConfiguration()),\r\n        tap(() =>\r\n          this.executionStepsFormService.executionStepMethodChange(\r\n            this.formGroup.parent as FormArray,\r\n            this.stepNumber\r\n          )\r\n        ),\r\n        filter((method) => method),\r\n        tap(() =>\r\n          this.selectedMethod.output.forEach(() =>\r\n            this.outputArtifactsControl.push(this.fb.array([]))\r\n          )\r\n        ),\r\n        tap((method: ModuleMethod) => this.initConfiguration(method)),\r\n        tap(() => this.calculateInput())\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.developmentMethod) {\r\n      const developmentMethod: DevelopmentMethod =\r\n        changes.developmentMethod.currentValue;\r\n      const toolNames = developmentMethod.getAllToolNames();\r\n      this.modules = this.moduleService.modules.filter((module) =>\r\n        toolNames.has(module.name)\r\n      );\r\n    }\r\n    if (changes.developmentMethod || changes.stepNumber) {\r\n      this.calculateInput();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.moduleChangeSubscription) {\r\n      this.moduleChangeSubscription.unsubscribe();\r\n    }\r\n    this.openModuleInput.complete();\r\n    this.openMethodInput.complete();\r\n  }\r\n\r\n  initMethods(module: Module): void {\r\n    this.methods = Object.values(module.methods);\r\n  }\r\n\r\n  initConfiguration(method: ModuleMethod): void {\r\n    if (\r\n      method.configurationFormComponent != null &&\r\n      method.createConfigurationForm != null\r\n    ) {\r\n      if (!this.formGroup.contains('predefinedInput')) {\r\n        this.formGroup.addControl(\r\n          'predefinedInput',\r\n          this.executionStepsFormService.createPredefinedInputForm(method, null)\r\n        );\r\n      }\r\n      const configurationFormComponentFactory =\r\n        this.componentFactoryResolver.resolveComponentFactory(\r\n          method.configurationFormComponent\r\n        );\r\n      const viewContainerRef = this.configurationFormHost.viewContainerRef;\r\n      viewContainerRef.clear();\r\n      const componentRef =\r\n        viewContainerRef.createComponent<ConfigurationFormComponent>(\r\n          configurationFormComponentFactory\r\n        );\r\n      componentRef.instance.formGroup = this.predefinedInputControl;\r\n    }\r\n  }\r\n\r\n  clearConfiguration(): void {\r\n    this.configurationFormHost.viewContainerRef.clear();\r\n    this.formGroup.removeControl('predefinedInput');\r\n  }\r\n\r\n  calculateInput(): void {\r\n    if (this.selectedMethod != null) {\r\n      this.artifactInputs = this.developmentMethod.checkStepInputArtifacts(\r\n        this.stepNumber,\r\n        this.selectedMethod.input.length\r\n      );\r\n    } else {\r\n      this.artifactInputs = [];\r\n    }\r\n  }\r\n\r\n  searchModule = (input: Observable<string>): Observable<Module[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openModuleInput).pipe(\r\n      map((term) =>\r\n        this.modules\r\n          .filter((moduleItem) =>\r\n            moduleItem.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  searchMethod = (input: Observable<string>): Observable<ModuleMethod[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openMethodInput).pipe(\r\n      map((term) =>\r\n        this.methods\r\n          .filter((methodItem) =>\r\n            methodItem.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 8)\r\n      )\r\n    );\r\n  };\r\n\r\n  formatter(x: { name: string }): string {\r\n    return x.name;\r\n  }\r\n\r\n  get moduleControl(): FormControl {\r\n    return this.formGroup.get('module') as FormControl;\r\n  }\r\n\r\n  get methodControl(): FormControl {\r\n    return this.formGroup.get('method') as FormControl;\r\n  }\r\n\r\n  get outputArtifactsControl(): FormArray {\r\n    return this.formGroup.get('outputMappings') as FormArray;\r\n  }\r\n\r\n  get predefinedInputControl(): FormGroup {\r\n    return this.formGroup.get('predefinedInput') as FormGroup;\r\n  }\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.formGroupDirective.control;\r\n  }\r\n\r\n  get selectedMethod(): ModuleMethod {\r\n    return this.methodControl.value as ModuleMethod;\r\n  }\r\n}\r\n","<form [formGroup]=\"executionStepsSelectionForm\" (ngSubmit)=\"submitForm()\">\r\n  <ul *ngIf=\"formArray.controls.length > 0\" class=\"list-group mb-3\">\r\n    <li\r\n      *ngFor=\"let control of formArray.controls; let index = index\"\r\n      class=\"list-group-item\"\r\n    >\r\n      <h5>Step #{{ index + 1 }}</h5>\r\n      <app-development-method-select-execution-step\r\n        [executionStepsFormValue]=\"formArray.value\"\r\n        [formGroup]=\"$any(control)\"\r\n        [developmentMethod]=\"developmentMethod\"\r\n        [stepNumber]=\"index\"\r\n        (remove)=\"removeStep(index)\"\r\n      ></app-development-method-select-execution-step>\r\n    </li>\r\n  </ul>\r\n  <div class=\"d-flex mb-3\">\r\n    <button type=\"button\" class=\"btn btn-primary ml-auto\" (click)=\"addStep()\">\r\n      Add execution step\r\n    </button>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!executionStepsSelectionForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup } from '@angular/forms';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { ExecutionStep } from '../../development-process-registry/development-method/execution-step';\r\nimport { ExecutionStepsFormService } from '../shared/execution-steps-form.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsList } from '../../shared/utils';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\n\r\n@Component({\r\n  selector: 'app-development-method-select-execution-steps',\r\n  templateUrl: './development-method-select-execution-steps.component.html',\r\n  styleUrls: ['./development-method-select-execution-steps.component.css'],\r\n})\r\nexport class DevelopmentMethodSelectExecutionStepsComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n\r\n  @Output() submitExecutionStepsSelectionForm = new EventEmitter<FormArray>();\r\n\r\n  executionStepsSelectionForm: FormGroup = this.fb.group({\r\n    steps: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private executionStepsFormService: ExecutionStepsFormService,\r\n    private fb: FormBuilder,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.executionStepsSelectionForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equalExecutionSteps(\r\n              this.developmentMethod.executionSteps,\r\n              this.executionStepsFormService.getExecutionSteps(value.steps)\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.developmentMethod) {\r\n      const oldDevelopmentMethod: DevelopmentMethod =\r\n        changes.developmentMethod.previousValue;\r\n      const newDevelopmentMethod: DevelopmentMethod =\r\n        changes.developmentMethod.currentValue;\r\n      if (\r\n        oldDevelopmentMethod == null ||\r\n        !this.equalExecutionSteps(\r\n          oldDevelopmentMethod.executionSteps,\r\n          newDevelopmentMethod.executionSteps\r\n        )\r\n      ) {\r\n        this.loadForm(newDevelopmentMethod.executionSteps);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  addStep(): void {\r\n    this.executionStepsFormService.addExecutionStep(this.formArray);\r\n  }\r\n\r\n  removeStep(index: number): void {\r\n    this.executionStepsFormService.removeExecutionStep(this.formArray, index);\r\n  }\r\n\r\n  loadForm(executionSteps: ExecutionStep[]): void {\r\n    this.executionStepsSelectionForm.setControl(\r\n      'steps',\r\n      this.executionStepsFormService.createForm(executionSteps)\r\n    );\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitExecutionStepsSelectionForm.emit(this.formArray);\r\n  }\r\n\r\n  private equalExecutionSteps(\r\n    executionStepsA: ExecutionStep[],\r\n    executionStepsB: ExecutionStep[]\r\n  ): boolean {\r\n    if (!equalsList(executionStepsA, executionStepsB)) {\r\n      return false;\r\n    }\r\n    return executionStepsA.every((stepA, index) => {\r\n      if (stepA.module != null && stepA.method != null) {\r\n        const method = this.moduleService.getModuleMethod(\r\n          stepA.module,\r\n          stepA.method\r\n        );\r\n        if (method.equalPredefinedInput) {\r\n          return method.equalPredefinedInput(\r\n            stepA.predefinedInput,\r\n            executionStepsB[index].predefinedInput\r\n          );\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    });\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.executionStepsSelectionForm.get('steps') as FormArray;\r\n  }\r\n}\r\n","<div class=\"d-flex align-items-baseline\">\r\n  <h5>{{ developmentMethod.name }}</h5>\r\n  <button\r\n    (click)=\"selectDevelopmentMethod.emit(developmentMethod)\"\r\n    type=\"button\"\r\n    class=\"btn btn-primary ml-auto btn-xs\"\r\n  >\r\n    Select\r\n  </button>\r\n</div>\r\n<p>{{ developmentMethod.description }}</p>\r\n<app-situational-factors-overview\r\n  *ngIf=\"needed && needed.length > 0\"\r\n  [provided]=\"provided\"\r\n  [needed]=\"needed\"\r\n></app-situational-factors-overview>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { DevelopmentMethodEntry } from '../../development-process-registry/development-method/development-method';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\n\r\n@Component({\r\n  selector: 'app-development-method-selection-form',\r\n  templateUrl: './development-method-selection-form.component.html',\r\n  styleUrls: ['./development-method-selection-form.component.css'],\r\n})\r\nexport class DevelopmentMethodSelectionFormComponent implements OnChanges {\r\n  @Input() developmentMethod: DevelopmentMethodEntry;\r\n  @Input() contextSituationalFactors: {\r\n    list: string;\r\n    element?: SituationalFactor;\r\n  }[] = [];\r\n\r\n  @Output() selectDevelopmentMethod =\r\n    new EventEmitter<DevelopmentMethodEntry>();\r\n\r\n  needed: SituationalFactor[] = [];\r\n  provided: SituationalFactor[] = [];\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.contextSituationalFactors) {\r\n      this.needed = changes.contextSituationalFactors.currentValue.map(\r\n        (factor) => factor.element\r\n      );\r\n    }\r\n    if (changes.developmentMethod) {\r\n      this.provided =\r\n        changes.developmentMethod.currentValue.situationalFactors.map(\r\n          (factor) => factor.element\r\n        );\r\n    }\r\n  }\r\n}\r\n","<ng-template #defaultCell let-list=\"list\">\r\n  <ul>\r\n    <li *ngFor=\"let element of asGroupSummary(list).elements\">\r\n      <ng-container *ngIf=\"element.multiple\">\r\n        {{ element.list | list | multiple: true }}\r\n        <ul>\r\n          <li *ngFor=\"let concreteElement of element.elements\">\r\n            {{ concreteElement.name }}\r\n          </li>\r\n        </ul>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"!element.multiple\">\r\n        <ng-container *ngIf=\"element.elements.length === 1\">\r\n          {{ element.elements[0].name | multiple: element.multipleElements }}\r\n          ({{ element.elements[0].list | list }})\r\n        </ng-container>\r\n        <ng-container *ngIf=\"element.elements.length === 0\">\r\n          ({{ element.list | list }})\r\n        </ng-container>\r\n      </ng-container>\r\n    </li>\r\n  </ul>\r\n</ng-template>\r\n\r\n<ng-template #inputArtifactsCell>\r\n  <ul>\r\n    <li *ngFor=\"let element of inputArtifacts; let index = index\">\r\n      {{ element.identifier }} &ndash; {{ element.artifact.name }} &ndash;\r\n      Version #{{ element.versionInfo.number + 1 }} &ndash;\r\n      {{ element.versionInfo.time | date: 'short' }}\r\n      <ul\r\n        *ngIf=\"\r\n          element.data && (element.data.type === 1 || element.data.type === 2)\r\n        \"\r\n      >\r\n        <li *ngIf=\"element.data.type === 1\">\r\n          <quill-view [content]=\"element.data.data\"></quill-view>\r\n        </li>\r\n        <li *ngIf=\"element.data.type === 2\">\r\n          {{ metaModelDefinitions[index].name }}\r\n          <button\r\n            class=\"btn btn-xs btn-secondary\"\r\n            (click)=\"_viewArtifactReference(index, element.data.data)\"\r\n          >\r\n            View\r\n          </button>\r\n        </li>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n</ng-template>\r\n\r\n<table class=\"table mb-0\">\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"row\">Building Block Name</th>\r\n      <td>{{ decision.method.name }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Building Block Description</th>\r\n      <td class=\"show-new-lines\">{{ decision.method.description }}</td>\r\n    </tr>\r\n    <tr *ngIf=\"decision.method.examples.length > 0\">\r\n      <th scope=\"row\">Examples</th>\r\n      <td class=\"show-new-lines\">\r\n        <ul class=\"list-group\">\r\n          <li\r\n            *ngFor=\"let example of decision.method.examples\"\r\n            class=\"list-group-item\"\r\n          >\r\n            {{ example }}\r\n          </li>\r\n        </ul>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Input Artifacts</th>\r\n      <td>\r\n        <ng-container *ngIf=\"!inputArtifacts\">\r\n          <ng-container\r\n            *ngTemplateOutlet=\"\r\n              defaultCell;\r\n              context: { list: this.summary.inputArtifacts }\r\n            \"\r\n          ></ng-container>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"inputArtifacts\">\r\n          <ng-container *ngTemplateOutlet=\"inputArtifactsCell\"></ng-container>\r\n        </ng-container>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Output Artifacts</th>\r\n      <td>\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            defaultCell;\r\n            context: { list: this.summary.outputArtifacts }\r\n          \"\r\n        ></ng-container>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Involved Stakeholders</th>\r\n      <td>\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            defaultCell;\r\n            context: { list: this.summary.stakeholders }\r\n          \"\r\n        ></ng-container>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Tools</th>\r\n      <td>\r\n        <ng-container\r\n          *ngTemplateOutlet=\"defaultCell; context: { list: this.summary.tools }\"\r\n        ></ng-container>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  Decision,\r\n  GroupSummary,\r\n} from '../../development-process-registry/bm-process/decision';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { Stakeholder } from '../../development-process-registry/method-elements/stakeholder/stakeholder';\r\nimport { Tool } from '../../development-process-registry/method-elements/tool/tool';\r\nimport { MethodElement } from '../../development-process-registry/method-elements/method-element';\r\nimport { StepInputArtifact } from '../../development-process-registry/running-process/step-input-artifact';\r\nimport { MetaModelService } from '../../development-process-registry/meta-model.service';\r\nimport {\r\n  MetaModelApi,\r\n  MetaModelDefinition,\r\n} from '../../development-process-registry/meta-model-definition';\r\nimport {\r\n  ArtifactDataReference,\r\n  ArtifactDataType,\r\n} from '../../development-process-registry/running-process/artifact-data';\r\n\r\n@Component({\r\n  selector: 'app-development-method-summary',\r\n  templateUrl: './development-method-summary.component.html',\r\n  styleUrls: ['./development-method-summary.component.css'],\r\n})\r\nexport class DevelopmentMethodSummaryComponent implements OnChanges {\r\n  @Input() decision: Decision;\r\n  @Input() inputArtifacts: StepInputArtifact[] = null;\r\n\r\n  @Output() viewArtifactReference = new EventEmitter<{\r\n    reference: ArtifactDataReference;\r\n    api: MetaModelApi;\r\n  }>();\r\n\r\n  metaModelDefinitions: MetaModelDefinition[];\r\n\r\n  summary: {\r\n    inputArtifacts: GroupSummary<Artifact>;\r\n    outputArtifacts: GroupSummary<Artifact>;\r\n    stakeholders: GroupSummary<Stakeholder>;\r\n    tools: GroupSummary<Tool>;\r\n  };\r\n\r\n  constructor(private metaModelService: MetaModelService) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.decision) {\r\n      this.summary = changes.decision.currentValue.getSummary();\r\n    }\r\n    if (changes.inputArtifacts && changes.inputArtifacts.currentValue != null) {\r\n      const inputArtifacts: StepInputArtifact[] =\r\n        changes.inputArtifacts.currentValue;\r\n      this.metaModelDefinitions = [];\r\n      this.metaModelDefinitions.length = inputArtifacts.length;\r\n      for (let index = 0; index < inputArtifacts.length; index++) {\r\n        const stepArtifact = inputArtifacts[index];\r\n        if (stepArtifact.data.type === ArtifactDataType.REFERENCE) {\r\n          const reference: ArtifactDataReference = stepArtifact.data.data;\r\n          this.metaModelDefinitions[index] =\r\n            this.metaModelService.getMetaModelDefinition(reference.type);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _viewArtifactReference(index: number, reference: ArtifactDataReference) {\r\n    this.viewArtifactReference.emit({\r\n      reference,\r\n      api: this.metaModelDefinitions[index].api,\r\n    });\r\n  }\r\n\r\n  asGroupSummary<T extends MethodElement>(element: any): GroupSummary<T> {\r\n    return element as GroupSummary<T>;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'methods']\">\r\n      Method Building Blocks\r\n    </a>\r\n    <a *ngIf=\"developmentMethod\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ developmentMethod.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"developmentMethod\" role=\"main\" class=\"container\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    <p>\r\n      Create a Method Building Block to insert it later into activities of\r\n      Method Patterns. A Method Building Block needs at least a Type to be\r\n      inserted into an activity of a Method Pattern.\r\n    </p>\r\n\r\n    <p>\r\n      It is possible to only select a value for the list input field and let the\r\n      second input field empty. Then the Business Developer can decide later,\r\n      when creating the Business Model Development Method, which concrete\r\n      element to use. Additionally, it is possible to select multiple to define\r\n      that a Business Developer will be able to select multiple concrete\r\n      elements.\r\n    </p>\r\n\r\n    <p class=\"mb-0\">\r\n      Artifacts and Stakeholders allow the creation of different groups. Later,\r\n      when creating the Business Model Development Method, one group can be\r\n      chosen to be used.\r\n    </p>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Method Building Block</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-development-method-form\r\n        [developmentMethod]=\"developmentMethod\"\r\n        (submitDevelopmentMethodForm)=\"\r\n          updateDevelopmentMethodValue($event.value)\r\n        \"\r\n      ></app-development-method-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Types</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-types-selection-form\r\n        [types]=\"developmentMethod.types\"\r\n        (submitTypesForm)=\"\r\n          updateDevelopmentMethodValue({ types: $event.value })\r\n        \"\r\n      ></app-types-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Situational Factors</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-situational-factors-selection-form\r\n        [situationalFactors]=\"developmentMethod.situationalFactors\"\r\n        (submitSituationalFactorsForm)=\"\r\n          updateDevelopmentMethodValue({ situationalFactors: $event.value })\r\n        \"\r\n      ></app-situational-factors-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Description</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-description-form\r\n        [description]=\"developmentMethod.description\"\r\n        (submitDescriptionForm)=\"updateDevelopmentMethod($event)\"\r\n      ></app-description-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Examples</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-examples-form\r\n        [examples]=\"developmentMethod.examples\"\r\n        (submitExamplesForm)=\"\r\n          updateDevelopmentMethodValue({ examples: $event.value })\r\n        \"\r\n      ></app-examples-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Input Artifacts</h6>\r\n    <div class=\"pt-3\">\r\n      <app-artifacts-selection-form\r\n        [artifacts]=\"developmentMethod.inputArtifacts\"\r\n        [developmentMethod]=\"developmentMethod\"\r\n        (submitArtifactsForm)=\"\r\n          updateDevelopmentMethodValue({ inputArtifacts: $event.value })\r\n        \"\r\n      ></app-artifacts-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Output Artifacts</h6>\r\n    <div class=\"pt-3\">\r\n      <app-artifacts-selection-form\r\n        [artifacts]=\"developmentMethod.outputArtifacts\"\r\n        (submitArtifactsForm)=\"\r\n          updateDevelopmentMethodValue({ outputArtifacts: $event.value })\r\n        \"\r\n      ></app-artifacts-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Stakeholders</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-stakeholders-selection-form\r\n        [stakeholders]=\"developmentMethod.stakeholders\"\r\n        (submitStakeholdersForm)=\"\r\n          updateDevelopmentMethodValue({ stakeholders: $event.value })\r\n        \"\r\n      ></app-stakeholders-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Tools</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-tools-selection-form\r\n        [tools]=\"developmentMethod.tools\"\r\n        (submitToolsForm)=\"\r\n          updateDevelopmentMethodValue({ tools: $event.value })\r\n        \"\r\n      ></app-tools-selection-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Execution steps</h6>\r\n    <div class=\"pt-3\">\r\n      <div class=\"alert alert-info\">\r\n        The modules must first be added in the tools before they can be selected\r\n        here.\r\n      </div>\r\n      <app-development-method-select-execution-steps\r\n        [developmentMethod]=\"developmentMethod\"\r\n        (submitExecutionStepsSelectionForm)=\"updateExecutionSteps($event)\"\r\n      ></app-development-method-select-execution-steps>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Edit Author Information</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-author-form\r\n        [author]=\"developmentMethod.author\"\r\n        (submitAuthorForm)=\"\r\n          updateDevelopmentMethodValue({ author: $event.value })\r\n        \"\r\n      ></app-author-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { DevelopmentMethodService } from '../../development-process-registry/development-method/development-method.service';\r\nimport { FormArray, FormGroup } from '@angular/forms';\r\nimport { ExecutionStepsFormService } from '../shared/execution-steps-form.service';\r\nimport { DevelopmentMethodLoaderService } from '../shared/development-method-loader.service';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\n\r\n@Component({\r\n  selector: 'app-development-method',\r\n  templateUrl: './development-method.component.html',\r\n  styleUrls: ['./development-method.component.css'],\r\n  providers: [DevelopmentMethodLoaderService],\r\n})\r\nexport class DevelopmentMethodComponent {\r\n  constructor(\r\n    private developmentMethodLoaderService: DevelopmentMethodLoaderService,\r\n    private developmentMethodService: DevelopmentMethodService,\r\n    private executionStepsFormService: ExecutionStepsFormService\r\n  ) {}\r\n\r\n  async updateExecutionSteps(form: FormArray): Promise<void> {\r\n    const executionSteps = this.executionStepsFormService.getExecutionSteps(\r\n      form.value\r\n    );\r\n    await this.updateDevelopmentMethodValue({ executionSteps });\r\n  }\r\n\r\n  async updateDevelopmentMethod(form: FormGroup): Promise<void> {\r\n    await this.updateDevelopmentMethodValue(form.value);\r\n  }\r\n\r\n  async updateDevelopmentMethodValue(\r\n    value: Partial<DevelopmentMethod>\r\n  ): Promise<void> {\r\n    await this.developmentMethodService.update(\r\n      this.developmentMethod._id,\r\n      value\r\n    );\r\n  }\r\n\r\n  get developmentMethod(): DevelopmentMethod {\r\n    return this.developmentMethodLoaderService.developmentMethod;\r\n  }\r\n}\r\n","<ng-template #ref let-item>\r\n  <app-development-method-selection-form\r\n    [contextSituationalFactors]=\"contextSituationalFactors\"\r\n    [developmentMethod]=\"item\"\r\n    (selectDevelopmentMethod)=\"selectDevelopmentMethod.emit($event)\"\r\n  ></app-development-method-selection-form>\r\n</ng-template>\r\n\r\n<app-search\r\n  heading=\"Building Blocks\"\r\n  itemName=\"Method Building Blocks\"\r\n  [content]=\"ref\"\r\n  [items]=\"developmentMethods\"\r\n></app-search>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { DevelopmentMethodEntry } from '../../development-process-registry/development-method/development-method';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { SEARCH_FUNCTION, searchFunction } from '../../shared/search.service';\r\n\r\n@Component({\r\n  selector: 'app-development-methods-selection-form',\r\n  templateUrl: './development-methods-selection-form.component.html',\r\n  styleUrls: ['./development-methods-selection-form.component.css'],\r\n  providers: [{ provide: SEARCH_FUNCTION, useValue: searchFunction }],\r\n})\r\nexport class DevelopmentMethodsSelectionFormComponent {\r\n  @Input() developmentMethods: DevelopmentMethodEntry[];\r\n  @Input() contextSituationalFactors: {\r\n    list: string;\r\n    element?: SituationalFactor;\r\n  }[] = [];\r\n\r\n  @Output() selectDevelopmentMethod =\r\n    new EventEmitter<DevelopmentMethodEntry>();\r\n}\r\n","<ng-template #deleteDevelopmentMethodModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteDevelopmentMethod(modalDevelopmentMethod._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Method Building Block {{ modalDevelopmentMethod.name }}\r\n    </div>\r\n    You are deleting the method building block\r\n    {{ modalDevelopmentMethod.name }}. This can not be undone. This action will\r\n    not delete the method building block from business model development methods\r\n    that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Method Building Blocks</a>\r\n    <a\r\n      *ngFor=\"let developmentMethod of developmentMethodsList\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['methodview', developmentMethod._id]\"\r\n      >{{ developmentMethod.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Method Building Blocks to use them for the Business Model Development\r\n    Methods\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Method Building Blocks\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No Method Building Blocks defined.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"list-group-item\"\r\n        *ngFor=\"let developmentMethod of developmentMethodsList\"\r\n      >\r\n        <app-results-list-item\r\n          [viewLink]=\"['methodview', developmentMethod._id]\"\r\n          (delete)=\"openDeleteDevelopmentMethodModal(developmentMethod)\"\r\n        >\r\n          <ng-container itemTitle>\r\n            {{ developmentMethod.name }}\r\n          </ng-container>\r\n          <ng-container itemDescription>\r\n            {{ developmentMethod.description }}\r\n          </ng-container>\r\n          <app-author-info\r\n            [author]=\"developmentMethod.author\"\r\n          ></app-author-info>\r\n        </app-results-list-item>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Add Method Building Block\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"developmentMethodForm\"\r\n        (ngSubmit)=\"addDevelopmentMethod(developmentMethodForm)\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\"\r\n            >Method Building Block Name</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!developmentMethodForm.valid\"\r\n            >\r\n              Add Method Building Block\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  DevelopmentMethod,\r\n  DevelopmentMethodEntry,\r\n  DevelopmentMethodInit,\r\n} from '../../development-process-registry/development-method/development-method';\r\nimport { DevelopmentMethodService } from '../../development-process-registry/development-method/development-method.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-development-methods',\r\n  templateUrl: './development-methods.component.html',\r\n  styleUrls: ['./development-methods.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: DevelopmentMethodService },\r\n  ],\r\n})\r\nexport class DevelopmentMethodsComponent {\r\n  developmentMethodForm = this.fb.group({\r\n    name: this.fb.control('', Validators.required),\r\n  });\r\n\r\n  modalDevelopmentMethod: DevelopmentMethodEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteDevelopmentMethodModal', { static: true })\r\n  deleteDevelopmentMethodModal: unknown;\r\n\r\n  constructor(\r\n    private listService: ListService<DevelopmentMethod, DevelopmentMethodInit>,\r\n    private fb: FormBuilder,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  openDeleteDevelopmentMethodModal(\r\n    developmentMethod: DevelopmentMethodEntry\r\n  ): void {\r\n    this.modalDevelopmentMethod = developmentMethod;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteDevelopmentMethodModal,\r\n      {\r\n        size: 'lg',\r\n      }\r\n    );\r\n  }\r\n\r\n  async deleteDevelopmentMethod(id: string): Promise<void> {\r\n    await this.listService.delete(id);\r\n  }\r\n\r\n  async addDevelopmentMethod(developmentMethodForm: FormGroup): Promise<void> {\r\n    await this.listService.add({\r\n      name: developmentMethodForm.value.name,\r\n      author: {},\r\n    });\r\n    this.developmentMethodForm.reset();\r\n  }\r\n\r\n  get developmentMethodsList(): DevelopmentMethodEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { BmProcessesComponent } from './bm-processes/bm-processes.component';\r\nimport { BmProcessComponent } from './bm-process/bm-process.component';\r\nimport { DevelopmentMethodsComponent } from './development-methods/development-methods.component';\r\nimport { DevelopmentMethodComponent } from './development-method/development-method.component';\r\nimport { ProcessPatternsComponent } from './process-patterns/process-patterns.component';\r\nimport { ProcessPatternComponent } from './process-pattern/process-pattern.component';\r\nimport { DiagramChangeGuard } from './shared/diagram-change.guard';\r\nimport { SituationalFactorsComponent } from './situational-factors/situational-factors.component';\r\nimport { SituationalFactorComponent } from './situational-factor/situational-factor.component';\r\nimport { ArtifactsComponent } from './artifacts/artifacts.component';\r\nimport { ArtifactComponent } from './artifact/artifact.component';\r\nimport { StakeholdersComponent } from './stakeholders/stakeholders.component';\r\nimport { StakeholderComponent } from './stakeholder/stakeholder.component';\r\nimport { ToolsComponent } from './tools/tools.component';\r\nimport { ToolComponent } from './tool/tool.component';\r\nimport { TypesComponent } from './types/types.component';\r\nimport { TypeComponent } from './type/type.component';\r\nimport { RunningProcessesComponent } from './running-processes/running-processes.component';\r\nimport { RunningProcessComponent } from './running-process/running-process.component';\r\nimport { RunningProcessMethodComponent } from './running-process-method/running-process-method.component';\r\nimport { DomainsComponent } from './domains/domains.component';\r\nimport { DomainComponent } from './domain/domain.component';\r\nimport { AuthGuard } from '../database/auth.guard';\r\nimport { MethodElementsComponent } from './method-elements/method-elements.component';\r\nimport { ConcreteArtifactsComponent } from './concrete-artifacts/concrete-artifacts.component';\r\nimport { ConcreteArtifactComponent } from './concrete-artifact/concrete-artifact.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'bmprocess',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: BmProcessesComponent },\r\n      {\r\n        path: 'bmprocessview/:id',\r\n        component: BmProcessComponent,\r\n        canDeactivate: [DiagramChangeGuard],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'concreteArtifacts',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: ConcreteArtifactsComponent },\r\n      {\r\n        path: 'detail/:id',\r\n        component: ConcreteArtifactComponent,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'methods',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: DevelopmentMethodsComponent },\r\n      { path: 'methodview/:id', component: DevelopmentMethodComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'process',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: ProcessPatternsComponent },\r\n      {\r\n        path: 'processview/:id',\r\n        component: ProcessPatternComponent,\r\n        canDeactivate: [DiagramChangeGuard],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    path: 'domains',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: DomainsComponent },\r\n      { path: 'detail/:id', component: DomainComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'methodElements',\r\n    component: MethodElementsComponent,\r\n    canActivate: [AuthGuard],\r\n  },\r\n  {\r\n    path: 'artifacts',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: ArtifactsComponent },\r\n      { path: 'detail/:id', component: ArtifactComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'situationalFactors',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: SituationalFactorsComponent },\r\n      { path: 'detail/:id', component: SituationalFactorComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'stakeholders',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: StakeholdersComponent },\r\n      { path: 'detail/:id', component: StakeholderComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'tools',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: ToolsComponent },\r\n      { path: 'detail/:id', component: ToolComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'types',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: TypesComponent },\r\n      { path: 'detail/:id', component: TypeComponent },\r\n    ],\r\n  },\r\n  {\r\n    path: 'runningprocess',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      { path: '', component: RunningProcessesComponent },\r\n      {\r\n        path: 'runningprocessview/:id',\r\n        children: [\r\n          { path: '', component: RunningProcessComponent },\r\n          {\r\n            path: 'method/:executionId',\r\n            component: RunningProcessMethodComponent,\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DevelopmentProcessesRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { BmProcessComponent } from './bm-process/bm-process.component';\r\nimport { BmProcessDiagramComponent } from './bm-process-diagram/bm-process-diagram.component';\r\nimport { BmProcessesComponent } from './bm-processes/bm-processes.component';\r\nimport { DevelopmentMethodComponent } from './development-method/development-method.component';\r\nimport { DevelopmentMethodsComponent } from './development-methods/development-methods.component';\r\nimport { DevelopmentProcessesRoutingModule } from './development-processes-routing.module';\r\nimport { ProcessPatternComponent } from './process-pattern/process-pattern.component';\r\nimport { ProcessPatternDiagramComponent } from './process-pattern-diagram/process-pattern-diagram.component';\r\nimport { ProcessPatternTypesFormComponent } from './process-pattern-types-form/process-pattern-types-form.component';\r\nimport { ProcessPatternsComponent } from './process-patterns/process-patterns.component';\r\nimport { ConfirmLeaveModalComponent } from './confirm-leave-modal/confirm-leave-modal.component';\r\nimport { SituationalFactorsComponent } from './situational-factors/situational-factors.component';\r\nimport { SituationalFactorComponent } from './situational-factor/situational-factor.component';\r\nimport { MethodElementListComponent } from './method-element-list/method-element-list.component';\r\nimport { MethodElementFormComponent } from './method-element-form/method-element-form.component';\r\nimport { ArtifactsComponent } from './artifacts/artifacts.component';\r\nimport { ArtifactComponent } from './artifact/artifact.component';\r\nimport { StakeholdersComponent } from './stakeholders/stakeholders.component';\r\nimport { StakeholderComponent } from './stakeholder/stakeholder.component';\r\nimport { ToolComponent } from './tool/tool.component';\r\nimport { ToolsComponent } from './tools/tools.component';\r\nimport { TypesComponent } from './types/types.component';\r\nimport { TypeComponent } from './type/type.component';\r\nimport { MethodElementSelectionFormComponent } from './method-element-selection-form/method-element-selection-form.component';\r\nimport { MethodElementsSelectionFormComponent } from './method-elements-selection-form/method-elements-selection-form.component';\r\nimport { TypesSelectionFormComponent } from './types-selection-form/types-selection-form.component';\r\nimport { SituationalFactorsSelectionFormComponent } from './situational-factors-selection-form/situational-factors-selection-form.component';\r\nimport { SituationalFactorSelectionFormComponent } from './situational-factor-selection-form/situational-factor-selection-form.component';\r\nimport { ArtifactsSelectionFormComponent } from './artifacts-selection-form/artifacts-selection-form.component';\r\nimport { StakeholdersSelectionFormComponent } from './stakeholders-selection-form/stakeholders-selection-form.component';\r\nimport { ToolsSelectionFormComponent } from './tools-selection-form/tools-selection-form.component';\r\nimport { ExamplesFormComponent } from './examples-form/examples-form.component';\r\nimport { MethodInfoComponent } from './method-info/method-info.component';\r\nimport { MethodElementGroupInfoComponent } from './method-element-group-info/method-element-group-info.component';\r\nimport { MethodElementInfoComponent } from './method-element-info/method-element-info.component';\r\nimport { ArtifactsGroupInfoComponent } from './artifacts-group-info/artifacts-group-info.component';\r\nimport { StakeholdersGroupInfoComponent } from './stakeholders-group-info/stakeholders-group-info.component';\r\nimport { SituationalFactorsOverviewComponent } from './situational-factors-overview/situational-factors-overview.component';\r\nimport { PatternInfoComponent } from './pattern-info/pattern-info.component';\r\nimport { DevelopmentMethodSelectionFormComponent } from './development-method-selection-form/development-method-selection-form.component';\r\nimport { DevelopmentMethodsSelectionFormComponent } from './development-methods-selection-form/development-methods-selection-form.component';\r\nimport { ProcessPatternSelectionFormComponent } from './process-pattern-selection-form/process-pattern-selection-form.component';\r\nimport { ProcessPatternsSelectionFormComponent } from './process-patterns-selection-form/process-patterns-selection-form.component';\r\nimport { DevelopmentMethodSummaryComponent } from './development-method-summary/development-method-summary.component';\r\nimport { ToolsGroupInfoComponent } from './tools-group-info/tools-group-info.component';\r\nimport { RunningProcessComponent } from './running-process/running-process.component';\r\nimport { RunningProcessesComponent } from './running-processes/running-processes.component';\r\nimport { RunningProcessSelectOutputArtifactsComponent } from './running-process-select-output-artifacts/running-process-select-output-artifacts.component';\r\nimport { RunningProcessSelectInputArtifactsComponent } from './running-process-select-input-artifacts/running-process-select-input-artifacts.component';\r\nimport { DevelopmentMethodSelectExecutionStepsComponent } from './development-method-select-execution-steps/development-method-select-execution-steps.component';\r\nimport { DevelopmentMethodSelectExecutionStepComponent } from './development-method-select-execution-step/development-method-select-execution-step.component';\r\nimport { DevelopmentMethodArtifactMappingComponent } from './development-method-artifact-mapping/development-method-artifact-mapping.component';\r\nimport { DevelopmentMethodArtifactMappingsComponent } from './development-method-artifact-mappings/development-method-artifact-mappings.component';\r\nimport { RunningProcessMethodComponent } from './running-process-method/running-process-method.component';\r\nimport { ConfigurationFormPlaceholderDirective } from './configuration-form-placeholder.directive';\r\nimport { MethodInfoStepComponent } from './method-info-step/method-info-step.component';\r\nimport { MethodInfoStepsComponent } from './method-info-steps/method-info-steps.component';\r\nimport { DomainComponent } from './domain/domain.component';\r\nimport { DomainsComponent } from './domains/domains.component';\r\nimport { SituationalFactorFormComponent } from './situational-factor-form/situational-factor-form.component';\r\nimport { ArtifactDefinitionFormComponent } from './artifact-definition-form/artifact-definition-form.component';\r\nimport { MethodElementsComponent } from './method-elements/method-elements.component';\r\nimport { ConcreteArtifactsComponent } from './concrete-artifacts/concrete-artifacts.component';\r\nimport { ConcreteArtifactComponent } from './concrete-artifact/concrete-artifact.component';\r\nimport { RunningProcessArtifactExportFormComponent } from './running-process-artifact-export-form/running-process-artifact-export-form.component';\r\nimport { ConcreteArtifactFormComponent } from './concrete-artifact-form/concrete-artifact-form.component';\r\nimport { RunningProcessArtifactImportFormComponent } from './running-process-artifact-import-form/running-process-artifact-import-form.component';\r\nimport { RunningProcessArtifactRenameFormComponent } from './running-process-artifact-rename-form/running-process-artifact-rename-form.component';\r\nimport { MultiplePipe } from './pipes/multiple.pipe';\r\nimport { ListPipe } from './pipes/list.pipe';\r\nimport { QuillModule } from 'ngx-quill';\r\nimport { RunningProcessSelectOutputArtifactComponent } from './running-process-select-output-artifact/running-process-select-output-artifact.component';\r\nimport { DevelopmentMethodIncompleteModalComponent } from './development-method-incomplete-modal/development-method-incomplete-modal.component';\r\nimport { DevelopmentMethodFormComponent } from './development-method-form/development-method-form.component';\r\nimport { ProcessPatternFormComponent } from './process-pattern-form/process-pattern-form.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    BmProcessComponent,\r\n    BmProcessDiagramComponent,\r\n    BmProcessesComponent,\r\n    DevelopmentMethodComponent,\r\n    DevelopmentMethodsComponent,\r\n    ProcessPatternComponent,\r\n    ProcessPatternDiagramComponent,\r\n    ProcessPatternTypesFormComponent,\r\n    ProcessPatternsComponent,\r\n    ConfirmLeaveModalComponent,\r\n    SituationalFactorsComponent,\r\n    SituationalFactorComponent,\r\n    MethodElementListComponent,\r\n    MethodElementFormComponent,\r\n    ArtifactsComponent,\r\n    ArtifactComponent,\r\n    StakeholdersComponent,\r\n    StakeholderComponent,\r\n    ToolComponent,\r\n    ToolsComponent,\r\n    TypesComponent,\r\n    TypeComponent,\r\n    MethodElementSelectionFormComponent,\r\n    MethodElementsSelectionFormComponent,\r\n    TypesSelectionFormComponent,\r\n    SituationalFactorsSelectionFormComponent,\r\n    SituationalFactorSelectionFormComponent,\r\n    ArtifactsSelectionFormComponent,\r\n    StakeholdersSelectionFormComponent,\r\n    ToolsSelectionFormComponent,\r\n    ExamplesFormComponent,\r\n    MethodInfoComponent,\r\n    MethodElementGroupInfoComponent,\r\n    MethodElementInfoComponent,\r\n    ArtifactsGroupInfoComponent,\r\n    StakeholdersGroupInfoComponent,\r\n    SituationalFactorsOverviewComponent,\r\n    PatternInfoComponent,\r\n    DevelopmentMethodSelectionFormComponent,\r\n    DevelopmentMethodsSelectionFormComponent,\r\n    ProcessPatternSelectionFormComponent,\r\n    ProcessPatternsSelectionFormComponent,\r\n    DevelopmentMethodSummaryComponent,\r\n    ToolsGroupInfoComponent,\r\n    RunningProcessComponent,\r\n    RunningProcessesComponent,\r\n    RunningProcessSelectOutputArtifactsComponent,\r\n    RunningProcessSelectInputArtifactsComponent,\r\n    DevelopmentMethodSelectExecutionStepsComponent,\r\n    DevelopmentMethodSelectExecutionStepComponent,\r\n    DevelopmentMethodArtifactMappingComponent,\r\n    DevelopmentMethodArtifactMappingsComponent,\r\n    RunningProcessMethodComponent,\r\n    ConfigurationFormPlaceholderDirective,\r\n    MethodInfoStepComponent,\r\n    MethodInfoStepsComponent,\r\n    DomainComponent,\r\n    DomainsComponent,\r\n    SituationalFactorFormComponent,\r\n    ArtifactDefinitionFormComponent,\r\n    MethodElementsComponent,\r\n    ConcreteArtifactsComponent,\r\n    ConcreteArtifactComponent,\r\n    RunningProcessArtifactExportFormComponent,\r\n    ConcreteArtifactFormComponent,\r\n    RunningProcessArtifactImportFormComponent,\r\n    RunningProcessArtifactRenameFormComponent,\r\n    MultiplePipe,\r\n    ListPipe,\r\n    RunningProcessSelectOutputArtifactComponent,\r\n    DevelopmentMethodIncompleteModalComponent,\r\n    DevelopmentMethodFormComponent,\r\n    ProcessPatternFormComponent,\r\n  ],\r\n  imports: [DevelopmentProcessesRoutingModule, SharedModule, QuillModule],\r\n})\r\nexport class DevelopmentProcessesModule {}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"domain\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'domains']\">Domains</a>\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ domain.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"domain\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update a Domain and define its values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Domain</h6>\r\n    <div class=\"text-muted\">\r\n      <app-description-form\r\n        [description]=\"domain.description\"\r\n        (submitDescriptionForm)=\"updateDescription($event.value)\"\r\n      ></app-description-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { DomainService } from '../../development-process-registry/knowledge/domain.service';\r\nimport { DomainLoaderService } from '../shared/domain-loader.service';\r\n\r\n@Component({\r\n  selector: 'app-domain',\r\n  templateUrl: './domain.component.html',\r\n  styleUrls: ['./domain.component.css'],\r\n  providers: [DomainLoaderService],\r\n})\r\nexport class DomainComponent {\r\n  constructor(\r\n    private domainLoaderService: DomainLoaderService,\r\n    private domainService: DomainService\r\n  ) {}\r\n\r\n  async updateDescription(description: any) {\r\n    await this.domainService.update(this.domain._id, description);\r\n  }\r\n\r\n  get domain() {\r\n    return this.domainLoaderService.domain;\r\n  }\r\n}\r\n","<ng-template #deleteDomainModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal (dismiss)=\"d()\" (delete)=\"deleteDomain(modalDomain); c()\">\r\n    <div modalTitle>Delete Domain {{ modalDomain.name }}</div>\r\n    You are deleting the domain {{ modalDomain.name }}. This can not be undone.\r\n    This action will not delete the domain from models that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Domains</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Domains to use them for canvas building blocks.\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Domains\"\r\n    [loading]=\"loading\"\r\n    [reloading]=\"reloading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No domains defined.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let domain of domains\"\r\n      >\r\n        <div>{{ domain.name }}</div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"getRouterLink(domain)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n          >\r\n            View\r\n          </a>\r\n          <button\r\n            (click)=\"openDeleteDomainModal(domain)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Domain</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"domainForm\" (ngSubmit)=\"addDomain()\">\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!domainForm.valid\"\r\n            >\r\n              Add\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { DomainService } from '../../development-process-registry/knowledge/domain.service';\r\nimport {\r\n  Domain,\r\n  DomainEntry,\r\n  DomainInit,\r\n} from '../../development-process-registry/knowledge/domain';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-domains',\r\n  templateUrl: './domains.component.html',\r\n  styleUrls: ['./domains.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: DomainService },\r\n  ],\r\n})\r\nexport class DomainsComponent {\r\n  domainForm: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n\r\n  modalDomain: DomainEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteDomainModal', { static: true })\r\n  deleteDomainModal: unknown;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private listService: ListService<Domain, DomainInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  async addDomain(): Promise<void> {\r\n    await this.listService.add(this.domainForm.value);\r\n    this.domainForm.reset();\r\n  }\r\n\r\n  openDeleteDomainModal(domain: DomainEntry): void {\r\n    this.modalDomain = domain;\r\n    this.modalReference = this.modalService.open(this.deleteDomainModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async deleteDomain(domain: DomainEntry): Promise<void> {\r\n    await this.listService.delete(domain._id);\r\n  }\r\n\r\n  getRouterLink(domain: DomainEntry): string[] {\r\n    return ['/', 'domains', 'detail', domain._id];\r\n  }\r\n\r\n  get domains(): DomainEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","<form [formGroup]=\"examplesForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\" formArrayName=\"examples\">\r\n    <app-form-array-list\r\n      elementName=\"Example\"\r\n      [formArray]=\"formArray\"\r\n    ></app-form-array-list>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!examplesForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-examples-form',\r\n  templateUrl: './examples-form.component.html',\r\n  styleUrls: ['./examples-form.component.css'],\r\n})\r\nexport class ExamplesFormComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() examples: string[];\r\n\r\n  @Output() submitExamplesForm = new EventEmitter<FormArray>();\r\n\r\n  examplesForm: FormGroup = this.fb.group({\r\n    examples: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.examplesForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equalExamples(this.examples, value.examples))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.examples) {\r\n      const oldExamples = changes.examples.previousValue;\r\n      const newExamples = changes.examples.currentValue;\r\n      if (!this.equalExamples(oldExamples, newExamples)) {\r\n        this.loadForm(changes.examples.currentValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitExamplesForm.emit(this.formArray);\r\n  }\r\n\r\n  private loadForm(examples: string[]) {\r\n    const formGroups = examples.map((example) =>\r\n      this.fb.control(example, Validators.required)\r\n    );\r\n    this.examplesForm.setControl('examples', this.fb.array(formGroups));\r\n  }\r\n\r\n  private equalExamples(examplesA: string[], examplesB: string[]) {\r\n    if (examplesA == null && examplesB == null) {\r\n      return true;\r\n    }\r\n    if (examplesA == null || examplesB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      examplesA.length === examplesB.length &&\r\n      examplesA.every((exampleA, index) => examplesB[index] === exampleA)\r\n    );\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.examplesForm.get('examples') as FormArray;\r\n  }\r\n}\r\n","<form [formGroup]=\"methodElementForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\" *ngIf=\"!methodElement\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"list\" class=\"col-sm-4 col-form-label\">List</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"list\"\r\n        class=\"form-control\"\r\n        id=\"list\"\r\n        [ngbTypeahead]=\"searchLists\"\r\n        (click)=\"openListInput.next($any($event.target).value)\"\r\n        (focus)=\"openListInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group\" *ngIf=\"methodElement\">\r\n    <label for=\"description\">Description</label>\r\n    <textarea\r\n      formControlName=\"description\"\r\n      class=\"form-control\"\r\n      id=\"description\"\r\n      rows=\"3\"\r\n    ></textarea>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        *ngIf=\"!methodElement\"\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!methodElementForm.valid\"\r\n      >\r\n        Add\r\n      </button>\r\n      <button\r\n        *ngIf=\"methodElement\"\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!methodElementForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { MethodElement } from '../../development-process-registry/method-elements/method-element';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\nimport { debounceTime, map, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-method-element-form',\r\n  templateUrl: './method-element-form.component.html',\r\n  styleUrls: ['./method-element-form.component.css'],\r\n})\r\nexport class MethodElementFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() methodElement: MethodElement = null;\r\n  @Input() listNames: string[] = [];\r\n\r\n  @Output() submitMethodElementForm = new EventEmitter<FormGroup>();\r\n\r\n  methodElementForm: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n    list: ['', Validators.required],\r\n    description: [''],\r\n  });\r\n  changed = false;\r\n\r\n  openListInput = new Subject<string>();\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.methodElementForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed =\r\n              this.methodElement !== null &&\r\n              !this.equals(this.methodElement, value))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.methodElement) {\r\n      const oldMethodElement: MethodElement =\r\n        changes.methodElement.previousValue;\r\n      const newMethodElement: MethodElement =\r\n        changes.methodElement.currentValue;\r\n      if (!this.equals(newMethodElement, oldMethodElement)) {\r\n        this.loadForm(newMethodElement);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n    this.openListInput.complete();\r\n  }\r\n\r\n  private loadForm(methodElement: MethodElement) {\r\n    this.methodElementForm.patchValue(methodElement);\r\n  }\r\n\r\n  private equals(\r\n    methodElementA: MethodElement,\r\n    methodElementB: MethodElement\r\n  ): boolean {\r\n    if (methodElementA == null && methodElementB == null) {\r\n      return true;\r\n    }\r\n    if (methodElementA == null || methodElementB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      methodElementA.list === methodElementB.list &&\r\n      methodElementA.description === methodElementB.description\r\n    );\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitMethodElementForm.emit(this.methodElementForm);\r\n    if (this.methodElement === null) {\r\n      this.methodElementForm.reset();\r\n    }\r\n  }\r\n\r\n  searchLists = (input: Observable<string>) => {\r\n    return merge(getTypeaheadInputPipe(input), this.openListInput).pipe(\r\n      map((term) =>\r\n        this.listNames\r\n          .filter((listItem) =>\r\n            listItem.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 10)\r\n      )\r\n    );\r\n  };\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <ul\r\n    class=\"form-group list-group\"\r\n    ngbRadioGroup\r\n    formControlName=\"selectedGroup\"\r\n  >\r\n    <li *ngFor=\"let group of groups; let index = index\" class=\"list-group-item\">\r\n      <ul class=\"list-group shadow-sm\">\r\n        <li\r\n          [class.list-group-item-secondary]=\"selectedGroup !== index\"\r\n          [class.list-group-item-primary]=\"selectedGroup === index\"\r\n          class=\"list-group-item d-flex align-items-baseline\"\r\n        >\r\n          <h5 class=\"mb-0\" *ngIf=\"group.length > 0\">Group</h5>\r\n          <h5 class=\"mb-0\" *ngIf=\"group.length === 0\">None</h5>\r\n          <div class=\"ml-auto btn-group btn-group-toggle\">\r\n            <label ngbButtonLabel class=\"btn-primary\">\r\n              <input ngbButton type=\"radio\" [value]=\"index\" /> Select\r\n            </label>\r\n          </div>\r\n        </li>\r\n        <ng-container *ngIf=\"selectedGroup !== index\">\r\n          <li *ngFor=\"let element of group\" class=\"list-group-item\">\r\n            <app-method-element-info\r\n              [element]=\"element\"\r\n              [methodElementName]=\"methodElementName\"\r\n            ></app-method-element-info>\r\n          </li>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"selectedGroup === index\">\r\n          <li\r\n            *ngFor=\"let element of group; let elementIndex = index\"\r\n            class=\"list-group-item\"\r\n            formArrayName=\"elements\"\r\n          >\r\n            <app-method-element-info\r\n              [formArrayName]=\"elementIndex.toString()\"\r\n              [element]=\"element\"\r\n              [methodElements]=\"methodElements\"\r\n              [methodElementName]=\"methodElementName\"\r\n            ></app-method-element-info>\r\n          </li>\r\n        </ng-container>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n  <div *ngIf=\"groups.length > 0\" class=\"form-group row mt-3\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n} from '../../development-process-registry/method-elements/method-element';\r\nimport {\r\n  FormArray,\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { GroupSelection } from '../../development-process-registry/bm-process/decision';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-method-element-group-info',\r\n  templateUrl: './method-element-group-info.component.html',\r\n  styleUrls: ['./method-element-group-info.component.css'],\r\n})\r\nexport class MethodElementGroupInfoComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() methodElementName: string;\r\n\r\n  @Input() groups: MultipleSelection<MethodElement>[][];\r\n  @Input() selection: GroupSelection<MethodElement>;\r\n\r\n  @Input() methodElements: MethodElementEntry[] = [];\r\n\r\n  @Output() submitGroupsForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    selectedGroup: [null, Validators.required],\r\n    elements: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  private selectedIndexSubscription: Subscription;\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.selectedIndexSubscription =\r\n      this.selectedGroupControl.valueChanges.subscribe((value) =>\r\n        this.generateControls(value)\r\n      );\r\n    this.changeSubscription = this.form.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = !this.selection.equals(value)))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.groups) {\r\n      this.loadForm();\r\n    } else if (changes.selection) {\r\n      const oldSelection: GroupSelection<MethodElement> =\r\n        changes.selection.previousValue;\r\n      const newSelection: GroupSelection<MethodElement> =\r\n        changes.selection.currentValue;\r\n      if (!newSelection.equals(oldSelection)) {\r\n        this.loadForm();\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.selectedIndexSubscription) {\r\n      this.selectedIndexSubscription.unsubscribe();\r\n    }\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitGroupsForm.emit(this.form);\r\n  }\r\n\r\n  private loadForm(): void {\r\n    this.selectedGroupControl.setValue(this.selection.selectedGroup, {\r\n      emitEvent: false,\r\n    });\r\n    this.generateControls(this.selection.selectedGroup);\r\n    if (this.selection.elements) {\r\n      this.elementsFormArray.patchValue(this.selection.elements);\r\n    }\r\n  }\r\n\r\n  private generateControls(selectedGroup: number): void {\r\n    if (selectedGroup !== null) {\r\n      const elements = this.groups[selectedGroup].map((element, index) => {\r\n        if (\r\n          element.multiple &&\r\n          this.selection.elements &&\r\n          this.selection.elements[index]\r\n        ) {\r\n          return this.fb.array(\r\n            this.selection.elements[index].map(() =>\r\n              this.fb.control(null, Validators.required)\r\n            )\r\n          );\r\n        }\r\n        return this.fb.array(element.multiple ? [] : [this.fb.control(null)]);\r\n      });\r\n      this.form.setControl('elements', this.fb.array(elements));\r\n    } else {\r\n      this.form.setControl('elements', this.fb.control(null));\r\n    }\r\n  }\r\n\r\n  get selectedGroupControl(): FormControl {\r\n    return this.form.get('selectedGroup') as FormControl;\r\n  }\r\n\r\n  get selectedGroup(): number {\r\n    return this.selectedGroupControl.value;\r\n  }\r\n\r\n  get elementsFormArray(): FormArray {\r\n    return this.form.get('elements') as FormArray;\r\n  }\r\n}\r\n","<div class=\"form-row\">\r\n  <div class=\"form-group col\">\r\n    <label for=\"listInput\">List</label>\r\n    <input\r\n      readonly\r\n      type=\"text\"\r\n      [value]=\"element.list | multiple: element.multiple\"\r\n      class=\"form-control-plaintext\"\r\n      id=\"listInput\"\r\n    />\r\n  </div>\r\n  <div class=\"form-group col\" *ngIf=\"element.element == null\">\r\n    <label for=\"elementInput\">{{ methodElementName }}</label>\r\n    <div class=\"input-group\" *ngIf=\"formArray && formArray.length > 0\">\r\n      <input\r\n        *ngIf=\"formArray.length > 0\"\r\n        #input\r\n        type=\"text\"\r\n        [formControl]=\"$any(formArray.controls[0])\"\r\n        class=\"form-control\"\r\n        id=\"elementInput\"\r\n        [ngbTypeahead]=\"searchElements(input)\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (click)=\"openElementInput.next([input, $any($event.target).value])\"\r\n        (focus)=\"openElementInput.next([input, $any($event.target).value])\"\r\n      />\r\n      <div class=\"input-group-append\" *ngIf=\"element.multiple\">\r\n        <button\r\n          (click)=\"add(1)\"\r\n          class=\"btn btn-outline-secondary align-self-baseline\"\r\n          type=\"button\"\r\n        >\r\n          +\r\n        </button>\r\n        <button\r\n          *ngIf=\"formArray.length > 0\"\r\n          (click)=\"remove(0)\"\r\n          class=\"btn btn-outline-secondary align-self-baseline\"\r\n          type=\"button\"\r\n        >\r\n          -\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div *ngIf=\"formArray && formArray.length === 0\">\r\n      <button\r\n        (click)=\"add()\"\r\n        class=\"btn btn-outline-secondary align-self-baseline\"\r\n        type=\"button\"\r\n      >\r\n        +\r\n      </button>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group col\" *ngIf=\"element.element != null\">\r\n    <label for=\"elementInputStatic\">{{ methodElementName }}</label>\r\n    <input\r\n      readonly\r\n      type=\"text\"\r\n      [value]=\"element.element.name | multiple: element.multipleElements\"\r\n      class=\"form-control-plaintext\"\r\n      id=\"elementInputStatic\"\r\n    />\r\n  </div>\r\n</div>\r\n<ng-container *ngIf=\"formArray && element.multiple\">\r\n  <div\r\n    *ngFor=\"let control of formArray.controls.slice(1); let index = index\"\r\n    class=\"form-row\"\r\n  >\r\n    <div class=\"form-group col\"></div>\r\n    <div class=\"form-group col\">\r\n      <label for=\"elementMultipleInput\" class=\"sr-only\">{{\r\n        methodElementName\r\n      }}</label>\r\n      <div class=\"input-group\">\r\n        <input\r\n          #input\r\n          type=\"text\"\r\n          [formControl]=\"$any(control)\"\r\n          class=\"form-control\"\r\n          id=\"elementMultipleInput\"\r\n          [ngbTypeahead]=\"searchElements(input)\"\r\n          [editable]=\"false\"\r\n          [resultFormatter]=\"formatter\"\r\n          [inputFormatter]=\"formatter\"\r\n          (click)=\"openElementInput.next([input, $any($event.target).value])\"\r\n          (focus)=\"openElementInput.next([input, $any($event.target).value])\"\r\n        />\r\n        <div class=\"input-group-append\" *ngIf=\"element.multiple\">\r\n          <button\r\n            (click)=\"add(index + 2)\"\r\n            class=\"btn btn-outline-secondary align-self-baseline\"\r\n            type=\"button\"\r\n          >\r\n            +\r\n          </button>\r\n          <button\r\n            (click)=\"remove(index + 1)\"\r\n            class=\"btn btn-outline-secondary align-self-baseline\"\r\n            type=\"button\"\r\n          >\r\n            -\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { Component, Input, Optional } from '@angular/core';\r\nimport {\r\n  MethodElement,\r\n  MethodElementEntry,\r\n} from '../../development-process-registry/method-elements/method-element';\r\nimport { merge, Observable, Subject } from 'rxjs';\r\nimport {\r\n  FormArray,\r\n  FormArrayName,\r\n  FormBuilder,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\nimport { filter, map } from 'rxjs/operators';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\n\r\n@Component({\r\n  selector: 'app-method-element-info',\r\n  templateUrl: './method-element-info.component.html',\r\n  styleUrls: ['./method-element-info.component.css'],\r\n})\r\nexport class MethodElementInfoComponent {\r\n  @Input() methodElementName: string;\r\n\r\n  @Input() element: MultipleSelection<MethodElement>;\r\n\r\n  @Input() methodElements: MethodElementEntry[] = [];\r\n\r\n  openElementInput = new Subject<[HTMLInputElement, string]>();\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    @Optional() private formArrayName: FormArrayName\r\n  ) {}\r\n\r\n  searchElements =\r\n    (field: HTMLInputElement) =>\r\n    (input: Observable<string>): Observable<MethodElementEntry[]> => {\r\n      return merge(\r\n        getTypeaheadInputPipe(input),\r\n        this.openElementInput.pipe(\r\n          filter(([f]) => f === field),\r\n          map(([, i]) => i)\r\n        )\r\n      ).pipe(\r\n        map((term) =>\r\n          this.methodElements\r\n            .filter(\r\n              (methodElement) =>\r\n                methodElement.list.toLowerCase() ===\r\n                  this.element.list.toLowerCase() &&\r\n                methodElement.name.toLowerCase().includes(term.toLowerCase())\r\n            )\r\n            .slice(0, 7)\r\n        )\r\n      );\r\n    };\r\n\r\n  add(index: number = null): void {\r\n    if (index === null) {\r\n      index = this.formArray.length;\r\n    }\r\n    this.formArray.insert(index, this.fb.control(null, Validators.required));\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  formatter(x: { name: string }): string {\r\n    return x.name;\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.formArrayName ? this.formArrayName.control : null;\r\n  }\r\n}\r\n","<app-list-wrapper\r\n  [listTitle]=\"listTitle\"\r\n  [loading]=\"elementLists == null\"\r\n  [noResults]=\"elementLists && elementLists.length === 0\"\r\n>\r\n  <div noResults>No elements defined.</div>\r\n  <div\r\n    results\r\n    *ngFor=\"let list of elementLists\"\r\n    class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n  >\r\n    <h6 class=\"border-bottom border-gray pb-2\">{{ list.listName }}</h6>\r\n    <ul class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let element of list.elements\"\r\n      >\r\n        <div>\r\n          <span>{{ element.name }}</span>\r\n        </div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"getRouterLink(element)\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n          >\r\n            View\r\n          </a>\r\n          <button\r\n            (click)=\"deleteElement.emit(element)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</app-list-wrapper>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { MethodElement } from '../../development-process-registry/method-elements/method-element';\r\n\r\n@Component({\r\n  selector: 'app-method-element-list',\r\n  templateUrl: './method-element-list.component.html',\r\n  styleUrls: ['./method-element-list.component.css'],\r\n})\r\nexport class MethodElementListComponent<T extends MethodElement> {\r\n  @Input() listTitle: string;\r\n  @Input() elementLists: { listName: string; elements: T[] }[] = null;\r\n  @Input() getRouterLink: (element: T) => string[] = (element) => [\r\n    'detail',\r\n    element._id,\r\n  ];\r\n  @Output() deleteElement = new EventEmitter<T>();\r\n}\r\n","<div [formGroup]=\"formGroup\" class=\"form-row\">\r\n  <div class=\"form-group col\">\r\n    <label for=\"listInput\">List</label>\r\n    <div class=\"input-group\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"list\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"listControl.invalid\"\r\n        id=\"listInput\"\r\n        aria-describedby=\"listInputFeedback\"\r\n        [ngbTypeahead]=\"searchLists\"\r\n        (click)=\"openListInput.next($any($event.target).value)\"\r\n        (focus)=\"openListInput.next($any($event.target).value)\"\r\n      />\r\n      <div\r\n        class=\"input-group-append btn-group btn-group-toggle\"\r\n        *ngIf=\"multipleAllowed\"\r\n      >\r\n        <label class=\"btn-outline-secondary\" ngbButtonLabel>\r\n          <input type=\"checkbox\" formControlName=\"multiple\" ngbButton />\r\n          Multiple\r\n        </label>\r\n      </div>\r\n    </div>\r\n    <div id=\"listInputFeedback\" class=\"invalid-feedback\">\r\n      <span *ngIf=\"listControl.hasError('required')\"\r\n        >This field is required.</span\r\n      >\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group col\">\r\n    <label for=\"elementInput\">{{ methodElementName }}</label>\r\n    <div class=\"input-group\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"element\"\r\n        class=\"form-control\"\r\n        id=\"elementInput\"\r\n        [ngbTypeahead]=\"searchElements\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (click)=\"openElementInput.next($any($event.target).value)\"\r\n        (focus)=\"openElementInput.next($any($event.target).value)\"\r\n      />\r\n      <div\r\n        class=\"input-group-append btn-group btn-group-toggle\"\r\n        *ngIf=\"multipleAllowed\"\r\n      >\r\n        <label class=\"btn-outline-secondary\" ngbButtonLabel>\r\n          <input type=\"checkbox\" formControlName=\"multipleElements\" ngbButton />\r\n          Multiple\r\n        </label>\r\n      </div>\r\n      <div class=\"input-group-append\">\r\n        <button\r\n          (click)=\"remove.emit()\"\r\n          class=\"btn btn-secondary align-self-baseline\"\r\n          type=\"button\"\r\n        >\r\n          Remove\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n} from '@angular/core';\r\nimport { MethodElementEntry } from '../../development-process-registry/method-elements/method-element';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  FormGroupDirective,\r\n} from '@angular/forms';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport { filter, map, tap } from 'rxjs/operators';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\n\r\n@Component({\r\n  selector: 'app-method-element-selection-form',\r\n  templateUrl: './method-element-selection-form.component.html',\r\n  styleUrls: ['./method-element-selection-form.component.css'],\r\n})\r\nexport class MethodElementSelectionFormComponent implements OnInit, OnDestroy {\r\n  @Input() methodElementName: string;\r\n  @Input() multipleAllowed = false;\r\n\r\n  @Input() methodElements: MethodElementEntry[] = [];\r\n  @Input() listNames: string[] = [];\r\n\r\n  @Output() remove = new EventEmitter<void>();\r\n\r\n  private listChangeSubscription: Subscription;\r\n  private multipleChangeSubscription: Subscription;\r\n  private elementChangeSubscription: Subscription;\r\n\r\n  openListInput = new Subject<string>();\r\n  openElementInput = new Subject<string>();\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private formGroupDirective: FormGroupDirective\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.listChangeSubscription = this.listControl.valueChanges\r\n      .pipe(\r\n        filter(\r\n          (value) =>\r\n            this.elementControl.value &&\r\n            this.elementControl.value.list !== value\r\n        ),\r\n        tap(() => this.elementControl.setValue(null))\r\n      )\r\n      .subscribe();\r\n    this.elementChangeSubscription = this.elementControl.valueChanges\r\n      .pipe(\r\n        filter((value) => value && this.listControl.value !== value.list),\r\n        tap((value) => this.listControl.setValue(value.list))\r\n      )\r\n      .subscribe();\r\n    if (this.multipleAllowed) {\r\n      this.multipleChangeSubscription = this.multipleControl.valueChanges\r\n        .pipe(\r\n          tap((value) => {\r\n            if (value) {\r\n              this.elementControl.disable();\r\n              this.multipleElementsControl.disable();\r\n            } else {\r\n              this.elementControl.enable();\r\n              this.multipleElementsControl.enable();\r\n            }\r\n          }),\r\n          filter((value) => value),\r\n          tap(() => {\r\n            this.elementControl.setValue(null);\r\n            this.multipleElementsControl.setValue(false);\r\n          })\r\n        )\r\n        .subscribe();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.listChangeSubscription) {\r\n      this.listChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.elementChangeSubscription) {\r\n      this.elementChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.multipleChangeSubscription) {\r\n      this.multipleChangeSubscription.unsubscribe();\r\n    }\r\n    this.openListInput.complete();\r\n    this.openElementInput.complete();\r\n  }\r\n\r\n  searchLists = (input: Observable<string>): Observable<string[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openListInput).pipe(\r\n      map((term) =>\r\n        this.listNames\r\n          .filter((listItem) =>\r\n            listItem.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 10)\r\n      )\r\n    );\r\n  };\r\n\r\n  searchElements = (\r\n    input: Observable<string>\r\n  ): Observable<MethodElementEntry[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openElementInput).pipe(\r\n      map((term) =>\r\n        this.methodElements\r\n          .filter(\r\n            (methodElement) =>\r\n              (!this.listControl.value ||\r\n                methodElement.list.toLowerCase() ===\r\n                  this.listControl.value.toLowerCase()) &&\r\n              methodElement.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  formatter(x: { name: string }): string {\r\n    return x.name;\r\n  }\r\n\r\n  get listControl(): FormControl {\r\n    return this.formGroup.get('list') as FormControl;\r\n  }\r\n\r\n  get multipleControl(): FormControl {\r\n    return this.formGroup.get('multiple') as FormControl;\r\n  }\r\n\r\n  get elementControl(): FormControl {\r\n    return this.formGroup.get('element') as FormControl;\r\n  }\r\n\r\n  get multipleElementsControl(): FormControl {\r\n    return this.formGroup.get('multipleElements') as FormControl;\r\n  }\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.formGroupDirective.control;\r\n  }\r\n}\r\n","<ng-template\r\n  #defaultMethodElementSelectionForm\r\n  let-formGroup=\"formGroup\"\r\n  let-index=\"index\"\r\n>\r\n  <app-method-element-selection-form\r\n    [formGroup]=\"formGroup\"\r\n    [listNames]=\"listNames\"\r\n    [methodElements]=\"methodElements\"\r\n    [methodElementName]=\"methodElementName\"\r\n    [multipleAllowed]=\"multipleAllowed\"\r\n    (remove)=\"remove(index)\"\r\n  ></app-method-element-selection-form>\r\n</ng-template>\r\n\r\n<div class=\"form-group\">\r\n  <div *ngFor=\"let control of formArray.controls; let index = index\">\r\n    <ng-container\r\n      *ngTemplateOutlet=\"\r\n        methodElementFormTemplate\r\n          ? methodElementFormTemplate\r\n          : defaultMethodElementSelectionForm;\r\n        context: getTemplateContext($any(control), index)\r\n      \"\r\n    ></ng-container>\r\n  </div>\r\n</div>\r\n<div class=\"form-group d-flex\">\r\n  <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n    Add {{ methodElementName }}\r\n  </button>\r\n</div>\r\n","import { Component, Input, TemplateRef } from '@angular/core';\r\nimport { MethodElementEntry } from '../../development-process-registry/method-elements/method-element';\r\nimport { FormArray, FormArrayName, FormGroup } from '@angular/forms';\r\n\r\nexport interface TemplateContext {\r\n  formGroup: FormGroup;\r\n  index: number;\r\n  listNames: string[];\r\n  methodElements: MethodElementEntry[];\r\n  methodElementName: string;\r\n  remove: (index: number) => void;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-method-elements-selection-form',\r\n  templateUrl: './method-elements-selection-form.component.html',\r\n  styleUrls: ['./method-elements-selection-form.component.css'],\r\n})\r\nexport class MethodElementsSelectionFormComponent {\r\n  @Input() methodElementName = 'Element';\r\n  @Input() multipleAllowed = false;\r\n\r\n  @Input() methodElements: MethodElementEntry[] = [];\r\n  @Input() listNames: string[] = [];\r\n\r\n  @Input() methodElementFormTemplate: TemplateRef<unknown>;\r\n  @Input() createFormGroupFactory: () => FormGroup;\r\n\r\n  constructor(private formArrayName: FormArrayName) {}\r\n\r\n  add(): void {\r\n    this.formArray.push(this.createFormGroupFactory());\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.formArrayName.control;\r\n  }\r\n\r\n  getTemplateContext(formGroup: FormGroup, index: number): TemplateContext {\r\n    return {\r\n      formGroup,\r\n      index,\r\n      listNames: this.listNames,\r\n      methodElements: this.methodElements,\r\n      methodElementName: this.methodElementName,\r\n      remove: this.remove.bind(this),\r\n    };\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Method Elements</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\">\r\n    All method elements, except for tasks, are defined in the presented\r\n    sections. Tasks are directly defined while creating method building blocks.\r\n  </div>\r\n\r\n  <app-list-wrapper listTitle=\"Method Elements\">\r\n    <div results class=\"list-group\">\r\n      <a\r\n        *ngFor=\"let item of methodElementLinks\"\r\n        class=\"list-group-item list-group-item-action d-flex\"\r\n        [routerLink]=\"item.route\"\r\n      >\r\n        <div>{{ item.name }}</div>\r\n        <div class=\"ml-auto\">\r\n          <div class=\"btn btn-dark btn-xs\">View</div>\r\n        </div>\r\n      </a>\r\n    </div>\r\n  </app-list-wrapper>\r\n</main>\r\n","import { Component } from '@angular/core';\r\n\r\ninterface MethodElementLink {\r\n  name: string;\r\n  route: string[];\r\n}\r\n\r\n@Component({\r\n  selector: 'app-method-elements',\r\n  templateUrl: './method-elements.component.html',\r\n  styleUrls: ['./method-elements.component.css'],\r\n})\r\nexport class MethodElementsComponent {\r\n  methodElementLinks: MethodElementLink[] = [\r\n    { name: 'Artifacts', route: ['/', 'artifacts'] },\r\n    { name: 'Situational Factors', route: ['/', 'situationalFactors'] },\r\n    { name: 'Stakeholders', route: ['/', 'stakeholders'] },\r\n    { name: 'Tools', route: ['/', 'tools'] },\r\n    { name: 'Types', route: ['/', 'types'] },\r\n  ];\r\n}\r\n","import {\r\n  Component,\r\n  ComponentFactoryResolver,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { ExecutionStep } from '../../development-process-registry/development-method/execution-step';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\nimport { ConfigurationFormPlaceholderDirective } from '../configuration-form-placeholder.directive';\r\nimport { ControlContainer, FormGroup } from '@angular/forms';\r\nimport { Domain } from '../../development-process-registry/knowledge/domain';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\n\r\n@Component({\r\n  selector: 'app-method-info-step',\r\n  templateUrl: './method-info-step.component.html',\r\n  styleUrls: ['./method-info-step.component.css'],\r\n})\r\nexport class MethodInfoStepComponent implements OnChanges {\r\n  @Input() bmProcess: BmProcess;\r\n  @Input() contextDomains: Domain[];\r\n  @Input() step: ExecutionStep;\r\n  @Input() stepDecision: any;\r\n\r\n  @Output() forceUpdate = new EventEmitter<any>();\r\n\r\n  @ViewChild(ConfigurationFormPlaceholderDirective, { static: true })\r\n  configurationFormHost: ConfigurationFormPlaceholderDirective;\r\n\r\n  constructor(\r\n    private componentFactoryResolver: ComponentFactoryResolver,\r\n    private controlContainer: ControlContainer,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.bmProcess || changes.step) {\r\n      this.initConfiguration(changes.step.currentValue);\r\n    }\r\n  }\r\n\r\n  initConfiguration(step: ExecutionStep) {\r\n    const method = this.moduleService.getModuleMethod(step.module, step.method);\r\n    if (\r\n      method.decisionConfigurationFormComponent != null &&\r\n      method.createDecisionConfigurationForm != null\r\n    ) {\r\n      const configurationFormComponentFactory =\r\n        this.componentFactoryResolver.resolveComponentFactory(\r\n          method.decisionConfigurationFormComponent\r\n        );\r\n      const viewContainerRef = this.configurationFormHost.viewContainerRef;\r\n      viewContainerRef.clear();\r\n      const componentRef = viewContainerRef.createComponent(\r\n        configurationFormComponentFactory\r\n      );\r\n      componentRef.instance.formGroup = this.formGroup;\r\n      componentRef.instance.bmProcess = this.bmProcess;\r\n      componentRef.instance.predefinedInput = this.step.predefinedInput;\r\n      componentRef.instance.contextDomains = this.contextDomains;\r\n      componentRef.instance.forceUpdate = this.forceUpdate;\r\n      componentRef.instance.stepDecision = this.stepDecision;\r\n    }\r\n  }\r\n\r\n  get formGroup() {\r\n    return this.controlContainer.control as FormGroup;\r\n  }\r\n}\r\n","<h6>{{ step.module }} &ndash; {{ step.method }}</h6>\r\n<ng-template appConfigurationFormPlaceholder></ng-template>\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <ul formArrayName=\"steps\" class=\"list-group\">\r\n    <li *ngFor=\"let step of steps; let index = index\" class=\"list-group-item\">\r\n      <app-method-info-step\r\n        [formGroupName]=\"index.toString()\"\r\n        [bmProcess]=\"bmProcess\"\r\n        [contextDomains]=\"contextDomains\"\r\n        [step]=\"step\"\r\n        [stepDecision]=\"stepDecisions[index]\"\r\n        (forceUpdate)=\"forceUpdate.emit({ step: index, stepDecision: $event })\"\r\n      ></app-method-info-step>\r\n    </li>\r\n  </ul>\r\n  <div *ngIf=\"steps.length > 0\" class=\"form-group row mt-3\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-dark btn-block\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        <ng-container>Update</ng-container>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup } from '@angular/forms';\r\nimport { ExecutionStep } from '../../development-process-registry/development-method/execution-step';\r\nimport { MethodInfoStepsFormService } from '../shared/method-info-steps-form.service';\r\nimport { Domain } from '../../development-process-registry/knowledge/domain';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\n\r\n@Component({\r\n  selector: 'app-method-info-steps',\r\n  templateUrl: './method-info-steps.component.html',\r\n  styleUrls: ['./method-info-steps.component.css'],\r\n})\r\nexport class MethodInfoStepsComponent implements OnChanges {\r\n  @Input() bmProcess: BmProcess;\r\n  @Input() contextDomains: Domain[];\r\n  @Input() steps: ExecutionStep[];\r\n  @Input() stepDecisions: any[];\r\n\r\n  @Output() submitStepsForm = new EventEmitter<any[]>();\r\n  @Output() forceUpdate = new EventEmitter<{\r\n    step: number;\r\n    stepDecision: any;\r\n  }>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    steps: this.fb.array([]),\r\n  });\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private methodInfoStepsFormService: MethodInfoStepsFormService\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.steps || changes.stepDecisions) {\r\n      this.form.setControl(\r\n        'steps',\r\n        this.methodInfoStepsFormService.createForm(\r\n          this.steps,\r\n          this.stepDecisions\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitStepsForm.emit(\r\n      this.methodInfoStepsFormService.getStepDecisions(this.formArray.value)\r\n    );\r\n  }\r\n\r\n  get formArray() {\r\n    return this.form.get('steps') as FormArray;\r\n  }\r\n}\r\n","<table class=\"table mb-0\">\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"row\">Building Block Name</th>\r\n      <td>{{ developmentMethod.name }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Building Block Description</th>\r\n      <td class=\"show-new-lines\">{{ developmentMethod.description }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Examples</th>\r\n      <td class=\"show-new-lines\">\r\n        <ul class=\"list-group\">\r\n          <li\r\n            *ngFor=\"let example of developmentMethod.examples\"\r\n            class=\"list-group-item\"\r\n          >\r\n            {{ example }}\r\n          </li>\r\n        </ul>\r\n      </td>\r\n    </tr>\r\n    <tr\r\n      *ngIf=\"contextSituationalFactors && contextSituationalFactors.length > 0\"\r\n    >\r\n      <th scope=\"row\">Situational Factors</th>\r\n      <td class=\"show-new-lines\">\r\n        <app-situational-factors-overview\r\n          [needed]=\"needed\"\r\n          [provided]=\"provided\"\r\n        ></app-situational-factors-overview>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Input Artifacts</th>\r\n      <td>\r\n        <app-artifacts-group-info\r\n          [selection]=\"decision.inputArtifacts\"\r\n          [groups]=\"developmentMethod.inputArtifacts\"\r\n          (submitGroupsForm)=\"\r\n            updateDecisions.emit({ inputArtifacts: $event.value })\r\n          \"\r\n        ></app-artifacts-group-info>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Output Artifacts</th>\r\n      <td>\r\n        <app-artifacts-group-info\r\n          [selection]=\"decision.outputArtifacts\"\r\n          [groups]=\"developmentMethod.outputArtifacts\"\r\n          (submitGroupsForm)=\"\r\n            updateDecisions.emit({ outputArtifacts: $event.value })\r\n          \"\r\n        ></app-artifacts-group-info>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Involved Stakeholders</th>\r\n      <td>\r\n        <app-stakeholders-group-info\r\n          [selection]=\"decision.stakeholders\"\r\n          [groups]=\"developmentMethod.stakeholders\"\r\n          (submitGroupsForm)=\"\r\n            updateDecisions.emit({ stakeholders: $event.value })\r\n          \"\r\n        ></app-stakeholders-group-info>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Tools</th>\r\n      <td>\r\n        <app-tools-group-info\r\n          [selection]=\"decision.tools\"\r\n          [groups]=\"developmentMethod.tools\"\r\n          (submitGroupsForm)=\"updateDecisions.emit({ tools: $event.value })\"\r\n        ></app-tools-group-info>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Steps</th>\r\n      <td>\r\n        <app-method-info-steps\r\n          [bmProcess]=\"bmProcess\"\r\n          [contextDomains]=\"contextDomains\"\r\n          [steps]=\"decision.method.executionSteps\"\r\n          [stepDecisions]=\"decision.stepDecisions\"\r\n          (submitStepsForm)=\"updateDecisions.emit({ stepDecisions: $event })\"\r\n          (forceUpdate)=\"forceUpdate($event)\"\r\n        ></app-method-info-steps>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { Domain } from '../../development-process-registry/knowledge/domain';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\nimport { Selection } from '../../development-process-registry/development-method/selection';\r\n\r\n@Component({\r\n  selector: 'app-method-info',\r\n  templateUrl: './method-info.component.html',\r\n  styleUrls: ['./method-info.component.css'],\r\n})\r\nexport class MethodInfoComponent implements OnChanges {\r\n  @Input() bmProcess: BmProcess;\r\n  @Input() developmentMethod: DevelopmentMethod;\r\n  @Input() decision: Decision;\r\n  @Input() contextDomains: Domain[];\r\n  @Input() contextSituationalFactors: Selection<SituationalFactor>[] = [];\r\n\r\n  @Output() updateDecisions = new EventEmitter<any>();\r\n\r\n  needed: SituationalFactor[] = [];\r\n  provided: SituationalFactor[] = [];\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.contextSituationalFactors) {\r\n      this.needed = changes.contextSituationalFactors.currentValue.map(\r\n        (factor) => factor.element\r\n      );\r\n    }\r\n    if (changes.developmentMethod) {\r\n      this.provided =\r\n        changes.developmentMethod.currentValue.situationalFactors.map(\r\n          (factor) => factor.element\r\n        );\r\n    }\r\n  }\r\n\r\n  forceUpdate(data: { step: number; stepDecision: any }) {\r\n    const stepDecisions = this.decision.stepDecisions.slice();\r\n    stepDecisions[data.step] = data.stepDecision;\r\n    this.updateDecisions.emit({ stepDecisions });\r\n  }\r\n}\r\n","<table class=\"table mb-0\">\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"row\">Pattern Name</th>\r\n      <td>{{ processPattern.name }}</td>\r\n    </tr>\r\n    <tr>\r\n      <th scope=\"row\">Pattern Description</th>\r\n      <td class=\"show-new-lines\">{{ processPattern.description }}</td>\r\n    </tr>\r\n    <tr\r\n      *ngIf=\"contextSituationalFactors && contextSituationalFactors.length > 0\"\r\n    >\r\n      <th scope=\"row\">Situational Factors</th>\r\n      <td>\r\n        <app-situational-factors-overview\r\n          [needed]=\"needed\"\r\n          [provided]=\"provided\"\r\n        ></app-situational-factors-overview>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { ProcessPattern } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\n\r\n@Component({\r\n  selector: 'app-pattern-info',\r\n  templateUrl: './pattern-info.component.html',\r\n  styleUrls: ['./pattern-info.component.css'],\r\n})\r\nexport class PatternInfoComponent implements OnChanges {\r\n  @Input() processPattern: ProcessPattern;\r\n  @Input() contextSituationalFactors: {\r\n    list: string;\r\n    element: SituationalFactor;\r\n  }[] = [];\r\n\r\n  needed: SituationalFactor[] = [];\r\n  provided: SituationalFactor[] = [];\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.contextSituationalFactors) {\r\n      this.needed = changes.contextSituationalFactors.currentValue.map(\r\n        (factor) => factor.element\r\n      );\r\n    }\r\n    if (changes.processPattern) {\r\n      this.provided =\r\n        changes.processPattern.currentValue.situationalFactors.map(\r\n          (factor) => factor.element\r\n        );\r\n    }\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n  name: 'list',\r\n})\r\nexport class ListPipe implements PipeTransform {\r\n  transform(value: string): string {\r\n    return 'List ' + value;\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n  name: 'multiple',\r\n})\r\nexport class MultiplePipe implements PipeTransform {\r\n  transform(value: string, multiple: boolean): string {\r\n    if (multiple) {\r\n      return value + ' (multiple)';\r\n    } else {\r\n      return value;\r\n    }\r\n  }\r\n}\r\n","<ng-template #manageTypesModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Manage types of activity {{ modalTask.name }}</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"text-muted pt-3\">\r\n      <app-process-pattern-types-form\r\n        [types]=\"modalTask\"\r\n        (submitTypesForm)=\"updateTypes($event)\"\r\n      ></app-process-pattern-types-form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<div #canvas class=\"border\" style=\"height: 500px\"></div>\r\n<div class=\"container\">\r\n  <div class=\"p-3 bg-white rounded shadow-sm\">\r\n    <div class=\"row\">\r\n      <div class=\"col-4\"><strong>Legend:</strong></div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-end-event-none bpmn-legend-icon\"></i> Create/Append\r\n        EndEvent\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-gateway-none bpmn-legend-icon\"></i> Create/Append\r\n        Gateway\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-task bpmn-legend-icon\"></i> Create/Append Task\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-screw-wrench bpmn-legend-icon\"></i> Change type of\r\n        BPMN element\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-trash bpmn-legend-icon\"></i> Remove\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-service bpmn-legend-icon\"></i> Manage Types of task\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-connection-multi bpmn-legend-icon\"></i> Add\r\n        Connection\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-text-annotation bpmn-legend-icon\"></i> Add\r\n        Annotation\r\n      </div>\r\n      <div class=\"col-4\"></div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-hand-tool bpmn-legend-icon\"></i> Hand Tool to move\r\n        the diagram\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-lasso-tool bpmn-legend-icon\"></i> Lasso Tool to\r\n        select multiple elements\r\n      </div>\r\n      <div class=\"col-4\">\r\n        <i class=\"bpmn-icon-space-tool bpmn-legend-icon\"></i> Space Tool to\r\n        create/remove space between elements\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Controls</h6>\r\n    <button class=\"btn btn-primary\" (click)=\"saveDiagram()\">\r\n      Save Diagram\r\n    </button>\r\n  </div>\r\n</div>\r\n","import {\r\n  AfterContentInit,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\n\r\nimport Modeler from 'bpmn-js/lib/Modeler';\r\nimport { ProcessPattern } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { BpmnService } from '../shared/bpmn.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { DiagramComponentInterface } from '../shared/diagram-component-interface';\r\nimport { Type } from '../../development-process-registry/method-elements/type/type';\r\n\r\n@Component({\r\n  selector: 'app-process-pattern-diagram',\r\n  templateUrl: './process-pattern-diagram.component.html',\r\n  styleUrls: ['./process-pattern-diagram.component.css'],\r\n})\r\nexport class ProcessPatternDiagramComponent\r\n  implements\r\n    DiagramComponentInterface,\r\n    OnInit,\r\n    AfterContentInit,\r\n    OnChanges,\r\n    OnDestroy\r\n{\r\n  @Input() processPattern: ProcessPattern;\r\n\r\n  @Output() saveProcessPattern = new EventEmitter<string>();\r\n\r\n  private modeler: Modeler;\r\n\r\n  modalTask: {\r\n    id: string;\r\n    name: string;\r\n    inherit: boolean;\r\n    neededType: { list: string; element: Type }[];\r\n    forbiddenType: { list: string; element: Type }[];\r\n  };\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('canvas', { static: true }) canvas: ElementRef<HTMLDivElement>;\r\n  @ViewChild('manageTypesModal', { static: true }) manageTypesModal: any;\r\n\r\n  constructor(\r\n    private bpmnService: BpmnService,\r\n    private fb: FormBuilder,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.modeler = this.bpmnService.getBpmnProcessPatternModeler();\r\n    this.modeler\r\n      .get('eventBus')\r\n      .on('bmdl.types', (event, businessTask) =>\r\n        this.openManageTypesModal(businessTask)\r\n      );\r\n    if (this.processPattern) {\r\n      this.loadProcessPattern(this.processPattern, true);\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.processPattern && this.modeler) {\r\n      this.loadProcessPattern(\r\n        changes.processPattern.currentValue,\r\n        changes.processPattern.firstChange\r\n      );\r\n    }\r\n  }\r\n\r\n  ngAfterContentInit(): void {\r\n    this.modeler.attachTo(this.canvas.nativeElement);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.modeler.destroy();\r\n  }\r\n\r\n  saveDiagram(): Promise<void> {\r\n    return this.modeler\r\n      .saveXML()\r\n      .then((result) => this.saveProcessPattern.emit(result.xml));\r\n  }\r\n\r\n  openManageTypesModal(businessTask) {\r\n    this.modalTask = {\r\n      id: businessTask.id,\r\n      name: businessTask.name,\r\n      inherit: businessTask.get('inherit'),\r\n      neededType: businessTask.get('neededType'),\r\n      forbiddenType: businessTask.get('forbiddenType'),\r\n    };\r\n    this.modalReference = this.modalService.open(this.manageTypesModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async updateTypes(typesForm: FormGroup) {\r\n    this.bpmnService.setTypesOfActivity(\r\n      this.modeler,\r\n      this.modalTask.id,\r\n      typesForm.value.inherit,\r\n      typesForm.value.neededType,\r\n      typesForm.value.forbiddenType\r\n    );\r\n    this.modalReference.close();\r\n    await this.saveDiagram();\r\n  }\r\n\r\n  private loadProcessPattern(\r\n    processPattern: ProcessPattern,\r\n    firstLoad: boolean\r\n  ) {\r\n    if (processPattern.pattern) {\r\n      this.modeler\r\n        .importXML(processPattern.pattern)\r\n        .then(() => {\r\n          if (firstLoad) {\r\n            this.bpmnService.resizeView(this.modeler);\r\n          }\r\n        })\r\n        .catch((error) => console.log('LoadProcessPattern: ' + error));\r\n    } else {\r\n      this.modeler.createDiagram();\r\n    }\r\n  }\r\n\r\n  diagramChanged(): Promise<boolean> {\r\n    return this.modeler\r\n      .saveXML()\r\n      .then((result) => result.xml !== this.processPattern.pattern);\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { ProcessPattern } from '../../development-process-registry/process-pattern/process-pattern';\r\n\r\n@Component({\r\n  selector: 'app-process-pattern-form',\r\n  templateUrl: './process-pattern-form.component.html',\r\n  styleUrls: ['./process-pattern-form.component.css'],\r\n})\r\nexport class ProcessPatternFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() processPattern!: ProcessPattern;\r\n\r\n  @Output() submitProcessPatternForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    this.changeSubscription = this.nameControl.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = value !== this.processPattern.name))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.processPattern) {\r\n      const oldProcessPattern: ProcessPattern =\r\n        changes.processPattern.previousValue;\r\n      const newProcessPattern: ProcessPattern =\r\n        changes.processPattern.currentValue;\r\n      if (\r\n        changes.processPattern.firstChange ||\r\n        oldProcessPattern.name !== newProcessPattern.name\r\n      ) {\r\n        this.nameControl.setValue(newProcessPattern.name);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription != null) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitProcessPatternForm.emit(this.form);\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.form.get('name') as FormControl;\r\n  }\r\n}\r\n","<div class=\"d-flex align-items-baseline\">\r\n  <h5>{{ processPattern.name }}</h5>\r\n  <button\r\n    (click)=\"selectProcessPattern.emit(processPattern)\"\r\n    type=\"button\"\r\n    class=\"btn btn-primary ml-auto btn-xs\"\r\n  >\r\n    Select\r\n  </button>\r\n</div>\r\n<p>{{ processPattern.description }}</p>\r\n<app-situational-factors-overview\r\n  *ngIf=\"needed && needed.length > 0\"\r\n  [provided]=\"provided\"\r\n  [needed]=\"needed\"\r\n></app-situational-factors-overview>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { ProcessPatternEntry } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\n\r\n@Component({\r\n  selector: 'app-process-pattern-selection-form',\r\n  templateUrl: './process-pattern-selection-form.component.html',\r\n  styleUrls: ['./process-pattern-selection-form.component.css'],\r\n})\r\nexport class ProcessPatternSelectionFormComponent implements OnChanges {\r\n  @Input() processPattern: ProcessPatternEntry;\r\n  @Input() contextSituationalFactors: {\r\n    list: string;\r\n    element: SituationalFactor;\r\n  }[] = [];\r\n\r\n  @Output() selectProcessPattern = new EventEmitter<ProcessPatternEntry>();\r\n\r\n  needed: SituationalFactor[] = [];\r\n  provided: SituationalFactor[] = [];\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.contextSituationalFactors) {\r\n      this.needed = changes.contextSituationalFactors.currentValue.map(\r\n        (factor) => factor.element\r\n      );\r\n    }\r\n    if (changes.processPattern) {\r\n      this.provided =\r\n        changes.processPattern.currentValue.situationalFactors.map(\r\n          (factor) => factor.element\r\n        );\r\n    }\r\n  }\r\n}\r\n","<form [formGroup]=\"typesForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"alert alert-info\">\r\n    Inherit types from parent to create generic patterns.\r\n  </div>\r\n\r\n  <div class=\"form-group\">\r\n    <div\r\n      class=\"btn-group btn-group-toggle\"\r\n      ngbRadioGroup\r\n      name=\"inherit\"\r\n      formControlName=\"inherit\"\r\n    >\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"true\" /> Inherit types\r\n      </label>\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"false\" /> Do not inherit types\r\n      </label>\r\n    </div>\r\n  </div>\r\n\r\n  <app-method-elements-selection-form\r\n    *ngIf=\"!typesForm.value.inherit\"\r\n    class=\"form-group\"\r\n    formArrayName=\"neededType\"\r\n    [createFormGroupFactory]=\"createFormGroupFactory\"\r\n    [listNames]=\"listNames\"\r\n    [methodElements]=\"methodElements\"\r\n    methodElementName=\"Needed Type\"\r\n  ></app-method-elements-selection-form>\r\n\r\n  <app-method-elements-selection-form\r\n    *ngIf=\"!typesForm.value.inherit\"\r\n    class=\"form-group\"\r\n    formArrayName=\"forbiddenType\"\r\n    [createFormGroupFactory]=\"createFormGroupFactory\"\r\n    [listNames]=\"listNames\"\r\n    [methodElements]=\"methodElements\"\r\n    methodElementName=\"Forbidden Type\"\r\n  ></app-method-elements-selection-form>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-dark btn-block\"\r\n        [disabled]=\"!typesForm.valid\"\r\n      >\r\n        Update Types\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  Type,\r\n  TypeEntry,\r\n} from '../../development-process-registry/method-elements/type/type';\r\nimport { TypeService } from '../../development-process-registry/method-elements/type/type.service';\r\n\r\n@Component({\r\n  selector: 'app-process-pattern-types-form',\r\n  templateUrl: './process-pattern-types-form.component.html',\r\n  styleUrls: ['./process-pattern-types-form.component.css'],\r\n})\r\nexport class ProcessPatternTypesFormComponent implements OnInit, OnChanges {\r\n  @Input() types: {\r\n    inherit: boolean;\r\n    neededType: { list: string; element: Type }[];\r\n    forbiddenType: { list: string; element: Type }[];\r\n  };\r\n\r\n  @Output() submitTypesForm = new EventEmitter<FormGroup>();\r\n\r\n  typesForm: FormGroup = this.fb.group({\r\n    inherit: this.fb.control(false, Validators.required),\r\n    neededType: this.fb.array([]),\r\n    forbiddenType: this.fb.array([]),\r\n  });\r\n\r\n  methodElements: TypeEntry[];\r\n  listNames: string[];\r\n\r\n  constructor(private fb: FormBuilder, private typeService: TypeService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadTypes();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.types) {\r\n      this.loadForm(changes.types.currentValue);\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitTypesForm.emit(this.typesForm);\r\n  }\r\n\r\n  private loadForm(types: {\r\n    inherit: boolean;\r\n    neededType: { list: string; element: Type }[];\r\n    forbiddenType: { list: string; element: Type }[];\r\n  }): void {\r\n    const mapTypeToFormGroup = (type: {\r\n      list: string;\r\n      element: Type;\r\n    }): FormGroup =>\r\n      this.fb.group({\r\n        list: [type.list, Validators.required],\r\n        element: type.element,\r\n      });\r\n    const neededTypesFormGroups = types.neededType.map(mapTypeToFormGroup);\r\n    const forbiddenTypesFormGroups =\r\n      types.forbiddenType.map(mapTypeToFormGroup);\r\n\r\n    if (types.inherit) {\r\n      this.typesForm.get('inherit').setValue(types.inherit);\r\n    }\r\n    this.typesForm.setControl(\r\n      'neededType',\r\n      this.fb.array(neededTypesFormGroups)\r\n    );\r\n    this.typesForm.setControl(\r\n      'forbiddenType',\r\n      this.fb.array(forbiddenTypesFormGroups)\r\n    );\r\n  }\r\n\r\n  private async loadTypes(): Promise<void> {\r\n    this.methodElements = await this.typeService.getList();\r\n    this.listNames = [\r\n      ...new Set(this.methodElements.map((element) => element.list)),\r\n    ];\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: null,\r\n    });\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'process']\"> Method Patterns </a>\r\n    <a *ngIf=\"processPattern\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ processPattern.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"processPattern\">\r\n  <div class=\"alert alert-info container mt-3\" role=\"alert\">\r\n    <p>\r\n      Create a Method Pattern by using activities as placeholders for Method\r\n      Building Blocks. Call activities are placeholders for both Method Building\r\n      Blocks and other Method Patterns. Name processes and activities as you\r\n      like and define needed and forbidden types on them.\r\n    </p>\r\n\r\n    <p>\r\n      A later selected Method Building Block or Method Pattern must have at\r\n      least one type that is in the needed types and must not have any type that\r\n      is in the forbidden types to be inserted into the placeholder.\r\n    </p>\r\n\r\n    <p class=\"mb-0\">\r\n      <strong>Important:</strong> Select a type for an activity through the gear\r\n      icon that is shown if an activity is selected. If the gear icon is red, no\r\n      type is selected. If it is green, a type is selected.\r\n    </p>\r\n  </div>\r\n\r\n  <app-process-pattern-diagram\r\n    [processPattern]=\"processPattern\"\r\n    (saveProcessPattern)=\"save($event)\"\r\n  ></app-process-pattern-diagram>\r\n\r\n  <div class=\"container\">\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">Method Pattern</h6>\r\n      <div class=\"text-muted pt-3\">\r\n        <app-process-pattern-form\r\n          [processPattern]=\"processPattern\"\r\n          (submitProcessPatternForm)=\"updateProcessPatternValue($event.value)\"\r\n        ></app-process-pattern-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">Types</h6>\r\n      <div class=\"text-muted pt-3\">\r\n        <app-types-selection-form\r\n          [internalTypes]=\"true\"\r\n          [types]=\"processPattern.types\"\r\n          (submitTypesForm)=\"updateProcessPatternValue({ types: $event.value })\"\r\n        ></app-types-selection-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">Situational Factors</h6>\r\n      <div class=\"text-muted pt-3\">\r\n        <app-situational-factors-selection-form\r\n          [situationalFactors]=\"processPattern.situationalFactors\"\r\n          (submitSituationalFactorsForm)=\"\r\n            updateProcessPatternValue({ situationalFactors: $event.value })\r\n          \"\r\n        ></app-situational-factors-selection-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">Description</h6>\r\n      <div class=\"text-muted pt-3\">\r\n        <app-description-form\r\n          [description]=\"processPattern.description\"\r\n          (submitDescriptionForm)=\"\r\n            updateProcessPatternValue({ description: $event.value.description })\r\n          \"\r\n        ></app-description-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n        Edit Author Information\r\n      </h6>\r\n      <div class=\"text-muted pt-3\">\r\n        <app-author-form\r\n          [author]=\"processPattern.author\"\r\n          (submitAuthorForm)=\"\r\n            updateProcessPatternValue({ author: $event.value })\r\n          \"\r\n        ></app-author-form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { ProcessPatternService } from '../../development-process-registry/process-pattern/process-pattern.service';\r\nimport { DiagramComponentInterface } from '../shared/diagram-component-interface';\r\nimport { ProcessPatternDiagramComponent } from '../process-pattern-diagram/process-pattern-diagram.component';\r\nimport { ProcessPatternLoaderService } from '../shared/process-pattern-loader.service';\r\n\r\n@Component({\r\n  selector: 'app-process-pattern',\r\n  templateUrl: './process-pattern.component.html',\r\n  styleUrls: ['./process-pattern.component.css'],\r\n  providers: [ProcessPatternLoaderService],\r\n})\r\nexport class ProcessPatternComponent implements DiagramComponentInterface {\r\n  @ViewChild(ProcessPatternDiagramComponent)\r\n  diagramComponent: ProcessPatternDiagramComponent;\r\n\r\n  constructor(\r\n    private processPatternLoaderService: ProcessPatternLoaderService,\r\n    private processPatternService: ProcessPatternService\r\n  ) {}\r\n\r\n  async save(pattern: string) {\r\n    await this.processPatternService.update(this.processPattern._id, {\r\n      pattern,\r\n    });\r\n  }\r\n\r\n  async updateProcessPatternValue(value: any) {\r\n    await this.processPatternService.update(this.processPattern._id, value);\r\n  }\r\n\r\n  diagramChanged(): Promise<boolean> {\r\n    return this.diagramComponent.diagramChanged();\r\n  }\r\n\r\n  saveDiagram(): Promise<void> {\r\n    return this.diagramComponent.saveDiagram();\r\n  }\r\n\r\n  get processPattern() {\r\n    return this.processPatternLoaderService.processPattern;\r\n  }\r\n}\r\n","<ng-template #ref let-item>\r\n  <app-process-pattern-selection-form\r\n    [contextSituationalFactors]=\"contextSituationalFactors\"\r\n    [processPattern]=\"item\"\r\n    (selectProcessPattern)=\"selectProcessPattern.emit($event)\"\r\n  ></app-process-pattern-selection-form>\r\n</ng-template>\r\n\r\n<app-search\r\n  heading=\"Method Patterns\"\r\n  itemName=\"Method Pattern\"\r\n  [content]=\"ref\"\r\n  [items]=\"processPatterns\"\r\n></app-search>\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { ProcessPatternEntry } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { SEARCH_FUNCTION, searchFunction } from '../../shared/search.service';\r\n\r\n@Component({\r\n  selector: 'app-process-patterns-selection-form',\r\n  templateUrl: './process-patterns-selection-form.component.html',\r\n  styleUrls: ['./process-patterns-selection-form.component.css'],\r\n  providers: [{ provide: SEARCH_FUNCTION, useValue: searchFunction }],\r\n})\r\nexport class ProcessPatternsSelectionFormComponent {\r\n  @Input() processPatterns: ProcessPatternEntry[];\r\n  @Input() contextSituationalFactors: {\r\n    list: string;\r\n    element?: SituationalFactor;\r\n  }[] = [];\r\n\r\n  @Output() selectProcessPattern = new EventEmitter<ProcessPatternEntry>();\r\n}\r\n","<ng-template #deleteProcessPatternModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteProcessPattern(modalProcessPattern._id); c()\"\r\n  >\r\n    <div modalTitle>Delete Method Pattern {{ modalProcessPattern.name }}</div>\r\n    You are deleting the method pattern {{ modalProcessPattern.name }}. This can\r\n    not be undone. This action will not delete the method pattern from business\r\n    model development methods that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Method Patterns</a>\r\n    <a\r\n      *ngFor=\"let processPattern of processPatternList\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['processview', processPattern._id]\"\r\n      >{{ processPattern.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Method Patterns to use them for the Business Model Development\r\n    Methods\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Method Patterns\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No Method Patterns defined.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"list-group-item\"\r\n        *ngFor=\"let processPattern of processPatternList\"\r\n      >\r\n        <app-results-list-item\r\n          [viewLink]=\"['processview', processPattern._id]\"\r\n          (delete)=\"openDeleteProcessPatternModal(processPattern)\"\r\n        >\r\n          <ng-container itemTitle>\r\n            {{ processPattern.name }}\r\n          </ng-container>\r\n          <ng-container itemDescription>\r\n            {{ processPattern.description }}\r\n          </ng-container>\r\n          <app-author-info [author]=\"processPattern.author\"></app-author-info>\r\n        </app-results-list-item>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Method Pattern</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"processPatternForm\"\r\n        (ngSubmit)=\"addProcessPattern(processPatternForm)\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\"\r\n            >Method Pattern Name</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!processPatternForm.valid\"\r\n            >\r\n              Add Method Pattern\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  ProcessPattern,\r\n  ProcessPatternEntry,\r\n  ProcessPatternInit,\r\n} from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { ProcessPatternService } from '../../development-process-registry/process-pattern/process-pattern.service';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-process-patterns',\r\n  templateUrl: './process-patterns.component.html',\r\n  styleUrls: ['./process-patterns.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: ProcessPatternService },\r\n  ],\r\n})\r\nexport class ProcessPatternsComponent {\r\n  processPatternForm = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n\r\n  modalProcessPattern: ProcessPatternEntry;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteProcessPatternModal', { static: true })\r\n  deleteProcessPatternModal: unknown;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private listService: ListService<ProcessPattern, ProcessPatternInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  openDeleteProcessPatternModal(processPattern: ProcessPatternEntry): void {\r\n    this.modalProcessPattern = processPattern;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteProcessPatternModal,\r\n      {\r\n        size: 'lg',\r\n      }\r\n    );\r\n  }\r\n\r\n  async deleteProcessPattern(id: string): Promise<void> {\r\n    await this.listService.delete(id);\r\n  }\r\n\r\n  async addProcessPattern(processPatternForm: any): Promise<void> {\r\n    await this.listService.add({ name: processPatternForm.value.name });\r\n    this.processPatternForm.reset();\r\n  }\r\n\r\n  get processPatternList(): ProcessPatternEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\n\r\n@Component({\r\n  selector: 'app-running-process-artifact-export-form',\r\n  templateUrl: './running-process-artifact-export-form.component.html',\r\n  styleUrls: ['./running-process-artifact-export-form.component.css'],\r\n})\r\nexport class RunningProcessArtifactExportFormComponent implements OnChanges {\r\n  @Input() artifact: RunningArtifact;\r\n\r\n  @Output() submitArtifactExportForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.artifact) {\r\n      const newArtifact: RunningArtifact = changes.artifact.currentValue;\r\n      const oldArtifact: RunningArtifact = changes.artifact.previousValue;\r\n      if (\r\n        changes.artifact.firstChange ||\r\n        newArtifact.identifier !== oldArtifact.identifier\r\n      ) {\r\n        this.form = this.fb.group({\r\n          identifier: newArtifact.identifier,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitArtifactExportForm.emit(this.form);\r\n  }\r\n}\r\n","<div class=\"alert alert-info\">\r\n  Export the artifact to add it to the artifacts list and import it in other\r\n  methods.\r\n</div>\r\n<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"identifier\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        class=\"form-control\"\r\n        id=\"identifier\"\r\n        formControlName=\"identifier\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group\">\r\n    <button\r\n      type=\"submit\"\r\n      class=\"btn btn-sm btn-dark btn-block\"\r\n      [disabled]=\"!form.valid\"\r\n    >\r\n      Export Artifact\r\n    </button>\r\n  </div>\r\n</form>\r\n","<ng-template #ref let-item>\r\n  <div class=\"d-flex align-items-baseline\">\r\n    <h5>{{ item.identifier }}</h5>\r\n    <button\r\n      (click)=\"selectArtifact.emit(item)\"\r\n      type=\"button\"\r\n      class=\"btn btn-primary ml-auto btn-xs\"\r\n    >\r\n      Select\r\n    </button>\r\n  </div>\r\n  <div class=\"row\">\r\n    <div class=\"col-sm-4\">Artifact Type</div>\r\n    <div class=\"col-sm-8\">\r\n      {{ item.artifact.name }}\r\n    </div>\r\n  </div>\r\n  <div class=\"row\" *ngIf=\"item.artifact.internalArtifact\">\r\n    <div class=\"col-sm-4\">Artifact Meta Model</div>\r\n    <div class=\"col-sm-8\">\r\n      {{ item.artifact.metaModel.name }}\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<app-search\r\n  heading=\"Artifacts\"\r\n  itemName=\"Artifact\"\r\n  [content]=\"ref\"\r\n  [items]=\"artifacts\"\r\n></app-search>\r\n","import { Component, EventEmitter, OnInit, Output } from '@angular/core';\r\nimport {\r\n  RunningArtifact,\r\n  RunningArtifactEntry,\r\n} from '../../development-process-registry/running-process/running-artifact';\r\nimport { ConcreteArtifactService } from '../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { SEARCH_FUNCTION } from '../../shared/search.service';\r\n\r\n@Component({\r\n  selector: 'app-running-process-artifact-import-form',\r\n  templateUrl: './running-process-artifact-import-form.component.html',\r\n  styleUrls: ['./running-process-artifact-import-form.component.css'],\r\n  providers: [\r\n    {\r\n      provide: SEARCH_FUNCTION,\r\n      useValue: (searchValue: string, item: RunningArtifact): boolean =>\r\n        item.identifier.toLowerCase().includes(searchValue),\r\n    },\r\n  ],\r\n})\r\nexport class RunningProcessArtifactImportFormComponent implements OnInit {\r\n  artifacts: RunningArtifactEntry[];\r\n\r\n  @Output() selectArtifact = new EventEmitter<RunningArtifact>();\r\n\r\n  constructor(private concreteArtifactService: ConcreteArtifactService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadArtifacts();\r\n  }\r\n\r\n  async loadArtifacts(): Promise<void> {\r\n    this.artifacts = await this.concreteArtifactService.getList();\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-running-process-artifact-rename-form',\r\n  templateUrl: './running-process-artifact-rename-form.component.html',\r\n  styleUrls: ['./running-process-artifact-rename-form.component.css'],\r\n})\r\nexport class RunningProcessArtifactRenameFormComponent implements OnChanges {\r\n  @Input() artifact: RunningArtifact;\r\n\r\n  @Output() submitArtifactExportForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.artifact) {\r\n      const newArtifact: RunningArtifact = changes.artifact.currentValue;\r\n      const oldArtifact: RunningArtifact = changes.artifact.previousValue;\r\n      if (\r\n        changes.artifact.firstChange ||\r\n        newArtifact.identifier !== oldArtifact.identifier\r\n      ) {\r\n        this.form = this.fb.group({\r\n          identifier: newArtifact.identifier,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitArtifactExportForm.emit(this.form);\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"identifier\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        class=\"form-control\"\r\n        id=\"identifier\"\r\n        formControlName=\"identifier\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group\">\r\n    <button\r\n      type=\"submit\"\r\n      class=\"btn btn-sm btn-dark btn-block\"\r\n      [disabled]=\"!form.valid\"\r\n    >\r\n      Rename artifact\r\n    </button>\r\n  </div>\r\n</form>\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"runningProcess\">\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        runningProcess._id\r\n      ]\"\r\n    >\r\n      {{ runningProcess.process.name }} &ndash; {{ runningProcess.name }}\r\n    </a>\r\n    <a *ngIf=\"runningMethod\" class=\"nav-link active\" [routerLink]=\"[]\">\r\n      {{ runningMethod.methodName }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"error && errorStatus === 404\" role=\"main\">\r\n  <div class=\"alert alert-info container my-3\">\r\n    <p>This running method does not exist. Reason: {{ errorReason }}.</p>\r\n    <p class=\"mb-0\">\r\n      <a [routerLink]=\"['/', 'runningprocess']\">\r\n        Go back to overview of running methods\r\n      </a>\r\n    </p>\r\n  </div>\r\n</main>\r\n\r\n<main *ngIf=\"runningMethod === null\" role=\"main\">\r\n  <div class=\"alert alert-info container my-3\">\r\n    <p>This development step does not exist or is not executed.</p>\r\n    <p class=\"mb-0\">\r\n      <a\r\n        [routerLink]=\"[\r\n          '/',\r\n          'runningprocess',\r\n          'runningprocessview',\r\n          runningProcess._id\r\n        ]\"\r\n      >\r\n        Go back to kanban board of running method\r\n      </a>\r\n    </p>\r\n  </div>\r\n</main>\r\n\r\n<main *ngIf=\"runningProcess != null && runningMethod != null\" role=\"main\">\r\n  <div class=\"container\">\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <div\r\n        class=\"\r\n          d-flex\r\n          align-items-baseline\r\n          justify-content-between\r\n          border-bottom border-gray\r\n          mb-2\r\n        \"\r\n      >\r\n        <h6 class=\"pb-2 mb-0\">Steps</h6>\r\n        <button class=\"btn btn-sm btn-warning\" (click)=\"abortMethodExecution()\">\r\n          Abort development step execution\r\n        </button>\r\n      </div>\r\n      <div class=\"d-flex\">\r\n        <ul class=\"list-group list-group-horizontal ml-auto mr-auto\">\r\n          <li\r\n            class=\"list-group-item\"\r\n            [class.active]=\"getStateInputSelection() === getState()\"\r\n            [class.disabled]=\"getState() > getStateInputSelection()\"\r\n            [attr.aria-disabled]=\"getState() > getStateInputSelection()\"\r\n          >\r\n            Select input artifacts<span\r\n              *ngIf=\"getStateInputSelection() === getState()\"\r\n              class=\"sr-only\"\r\n            >\r\n              (active)</span\r\n            >\r\n          </li>\r\n          <li\r\n            *ngIf=\"runningMethod.hasSteps()\"\r\n            class=\"list-group-item\"\r\n            [class.active]=\"getStateExecution() === getState()\"\r\n            [class.disabled]=\"getState() > getStateExecution()\"\r\n            [attr.aria-disabled]=\"getState() > getStateExecution()\"\r\n          >\r\n            Execute Development Step<span\r\n              *ngIf=\"getStateExecution() === getState()\"\r\n              class=\"sr-only\"\r\n            >\r\n              (active)</span\r\n            >\r\n          </li>\r\n          <li\r\n            class=\"list-group-item\"\r\n            [class.active]=\"getStateOutputSelection() === getState()\"\r\n            [class.disabled]=\"getState() > getStateOutputSelection()\"\r\n            [attr.aria-disabled]=\"getState() > getStateOutputSelection()\"\r\n          >\r\n            Create/Merge output artifacts<span\r\n              *ngIf=\"getStateOutputSelection() === getState()\"\r\n              class=\"sr-only\"\r\n            >\r\n              (active)</span\r\n            >\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div\r\n      *ngIf=\"getStateInputSelection() === getState()\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Input Mapping</h6>\r\n      <app-running-process-select-input-artifacts\r\n        [decision]=\"runningMethod.decision\"\r\n        [runningProcess]=\"runningProcess\"\r\n        (selectInputArtifacts)=\"selectInputArtifacts($event)\"\r\n      ></app-running-process-select-input-artifacts>\r\n    </div>\r\n    <div\r\n      *ngIf=\"getState() > getStateInputSelection()\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Development Step Overview</h6>\r\n      <app-development-method-summary\r\n        [decision]=\"runningMethod.decision\"\r\n        [inputArtifacts]=\"runningMethod.inputArtifacts\"\r\n        (viewArtifactReference)=\"\r\n          viewArtifactReference($event.reference, $event.api)\r\n        \"\r\n      ></app-development-method-summary>\r\n    </div>\r\n    <div\r\n      *ngIf=\"getStateExecution() <= getState() && runningMethod.hasSteps()\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Execution Steps</h6>\r\n      <ol>\r\n        <li\r\n          *ngFor=\"\r\n            let step of runningMethod.decision.method.executionSteps;\r\n            let index = index\r\n          \"\r\n          [class.text-success]=\"index < runningMethod.currentStepNumber\"\r\n          [class.text-warning]=\"index === runningMethod.currentStepNumber\"\r\n        >\r\n          {{ step.module }} &ndash; {{ step.method }}\r\n          <span *ngIf=\"index < runningMethod.currentStepNumber\" class=\"sr-only\">\r\n            (step already executed)</span\r\n          >\r\n          <span\r\n            *ngIf=\"index === runningMethod.currentStepNumber\"\r\n            class=\"sr-only\"\r\n          >\r\n            (step to execute)</span\r\n          >\r\n        </li>\r\n      </ol>\r\n      <button\r\n        *ngIf=\"runningMethod.hasStepsLeft()\"\r\n        class=\"btn btn-block btn-primary\"\r\n        (click)=\"executeMethodStep()\"\r\n      >\r\n        Execute next step\r\n      </button>\r\n    </div>\r\n    <div\r\n      *ngIf=\"getStateOutputSelection() === getState()\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Output Mapping</h6>\r\n      <app-running-process-select-output-artifacts\r\n        [runningProcess]=\"runningProcess\"\r\n        [runningMethod]=\"runningMethod\"\r\n        [decision]=\"runningMethod.decision\"\r\n        (updateOutputArtifacts)=\"updateOutputArtifacts($event)\"\r\n      ></app-running-process-select-output-artifacts>\r\n    </div>\r\n\r\n    <div\r\n      *ngIf=\"getStateOutputSelection() === getState()\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Finish execution</h6>\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-primary btn-block\"\r\n        [disabled]=\"!runningMethod.hasOutputArtifactsCorrectlyDefined()\"\r\n        (click)=\"finishExecution()\"\r\n      >\r\n        Finish execution\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <app-running-process-method-comments\r\n        [comments]=\"runningMethod.comments\"\r\n        (addComment)=\"addComment($event)\"\r\n        (updateComment)=\"updateComment($event)\"\r\n        (removeComment)=\"removeComment($event)\"\r\n      ></app-running-process-method-comments>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../development-process-registry/running-process/running-method';\r\nimport { FormArray } from '@angular/forms';\r\nimport { OutputArtifactMappingFormService } from '../shared/output-artifact-mapping-form.service';\r\nimport { Comment } from '../../development-process-registry/running-process/comment';\r\nimport { ArtifactDataReference } from '../../development-process-registry/running-process/artifact-data';\r\nimport { MetaModelApi } from '../../development-process-registry/meta-model-definition';\r\nimport { RunningMethodLoaderService } from '../shared/running-method-loader.service';\r\n\r\nenum State {\r\n  INPUT_SELECTION,\r\n  EXECUTION,\r\n  OUTPUT_SELECTION,\r\n}\r\n\r\n@Component({\r\n  selector: 'app-running-process-method',\r\n  templateUrl: './running-process-method.component.html',\r\n  styleUrls: ['./running-process-method.component.css'],\r\n  providers: [RunningMethodLoaderService],\r\n})\r\nexport class RunningProcessMethodComponent {\r\n  constructor(\r\n    private outputArtifactMappingFormService: OutputArtifactMappingFormService,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private runningMethodLoaderService: RunningMethodLoaderService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  async selectInputArtifacts(inputArtifactMapping: FormArray): Promise<void> {\r\n    const inputArtifactMappingValue = inputArtifactMapping.value;\r\n    const inputArtifactMap = (mapping: {\r\n      artifact: number;\r\n    }): { artifact: number; version: number } => {\r\n      return {\r\n        artifact: mapping.artifact,\r\n        version:\r\n          this.runningProcess.artifacts[mapping.artifact].versions.length - 1,\r\n      };\r\n    };\r\n    await this.runningProcessService.setInputArtifacts(\r\n      this.runningProcess,\r\n      this.runningMethod.executionId,\r\n      inputArtifactMappingValue.map(inputArtifactMap)\r\n    );\r\n  }\r\n\r\n  async executeMethodStep(): Promise<void> {\r\n    await this.runningProcessService.executeMethodStep(\r\n      this.runningProcess,\r\n      this.runningMethod.executionId\r\n    );\r\n  }\r\n\r\n  async updateOutputArtifacts(\r\n    outputArtifactsMapping: FormArray\r\n  ): Promise<void> {\r\n    const mapping = this.outputArtifactMappingFormService.get(\r\n      outputArtifactsMapping.value\r\n    );\r\n    await this.runningProcessService.updateOutputArtifacts(\r\n      this.runningProcess,\r\n      this.runningMethod.executionId,\r\n      mapping\r\n    );\r\n  }\r\n\r\n  async finishExecution(): Promise<void> {\r\n    let runningProcess = this.runningProcess;\r\n    await this.runningProcessService.stopMethodExecution(\r\n      runningProcess,\r\n      this.runningMethod.executionId\r\n    );\r\n    runningProcess = await this.runningProcessService.get(runningProcess._id);\r\n    await this.runningProcessService.jumpSteps(runningProcess);\r\n    await this.router.navigate([\r\n      'runningprocess',\r\n      'runningprocessview',\r\n      runningProcess._id,\r\n    ]);\r\n  }\r\n\r\n  async abortMethodExecution(): Promise<void> {\r\n    await this.runningProcessService.abortMethodExecution(\r\n      this.runningProcess,\r\n      this.runningMethod.executionId\r\n    );\r\n    await this.router.navigate([\r\n      'runningprocess',\r\n      'runningprocessview',\r\n      this.runningProcess._id,\r\n    ]);\r\n  }\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  viewArtifactReference(\r\n    reference: ArtifactDataReference,\r\n    api: MetaModelApi\r\n  ): void {\r\n    api.view(reference, this.router, {\r\n      referenceType: 'Method',\r\n      runningProcessId: this.runningProcess._id,\r\n      executionId: this.runningMethod.executionId,\r\n    });\r\n  }\r\n\r\n  getState(): State {\r\n    if (this.runningMethod.inputArtifacts == null) {\r\n      return State.INPUT_SELECTION;\r\n    } else if (this.runningMethod.hasStepsLeft()) {\r\n      return State.EXECUTION;\r\n    } else {\r\n      return State.OUTPUT_SELECTION;\r\n    }\r\n  }\r\n\r\n  getStateInputSelection(): State {\r\n    return State.INPUT_SELECTION;\r\n  }\r\n\r\n  getStateExecution(): State {\r\n    return State.EXECUTION;\r\n  }\r\n\r\n  getStateOutputSelection(): State {\r\n    return State.OUTPUT_SELECTION;\r\n  }\r\n\r\n  get error(): boolean {\r\n    return this.runningMethodLoaderService.error;\r\n  }\r\n\r\n  get errorStatus(): number {\r\n    return this.runningMethodLoaderService.errorStatus;\r\n  }\r\n\r\n  get errorReason(): string {\r\n    return this.runningMethodLoaderService.errorReason;\r\n  }\r\n\r\n  get runningProcess(): RunningProcess {\r\n    return this.runningMethodLoaderService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.runningMethodLoaderService.runningMethod;\r\n  }\r\n}\r\n","<ng-container *ngIf=\"inputArtifacts.length === 0\">\r\n  <div class=\"alert alert-info\">\r\n    This building block has no input artifacts.\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <button\r\n      type=\"button\"\r\n      class=\"btn btn-block btn-primary\"\r\n      (click)=\"nextStep()\"\r\n    >\r\n      Confirm\r\n    </button>\r\n  </div>\r\n</ng-container>\r\n<form\r\n  [formGroup]=\"form\"\r\n  *ngIf=\"inputArtifacts.length > 0\"\r\n  (ngSubmit)=\"submitForm()\"\r\n>\r\n  <div formArrayName=\"inputArtifacts\">\r\n    <div\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n      *ngFor=\"let artifact of inputArtifacts; let index = index\"\r\n      formGroupName=\"{{ index }}\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">\r\n        Artifact Type: {{ artifact.name }} ({{ artifact.list | list }})\r\n      </h6>\r\n      <div class=\"form-group\">\r\n        <label for=\"artifact\">Artifact</label>\r\n        <select class=\"form-control\" id=\"artifact\" formControlName=\"artifact\">\r\n          <ng-container\r\n            *ngFor=\"let a of runningProcess.artifacts; let index = index\"\r\n          >\r\n            <option *ngIf=\"a.artifact._id === artifact._id\" [ngValue]=\"index\">\r\n              {{ a.identifier }}\r\n            </option>\r\n          </ng-container>\r\n        </select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <button\r\n      type=\"submit\"\r\n      class=\"btn btn-block btn-primary\"\r\n      [disabled]=\"!form.valid\"\r\n    >\r\n      Confirm\r\n    </button>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { FormArray, FormBuilder, Validators } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-running-process-select-input-artifacts',\r\n  templateUrl: './running-process-select-input-artifacts.component.html',\r\n  styleUrls: ['./running-process-select-input-artifacts.component.css'],\r\n})\r\nexport class RunningProcessSelectInputArtifactsComponent implements OnChanges {\r\n  @Input() runningProcess: RunningProcess;\r\n  @Input() decision: Decision;\r\n\r\n  @Output() selectInputArtifacts = new EventEmitter<FormArray>();\r\n\r\n  inputArtifacts: Artifact[];\r\n\r\n  form = this.fb.group({\r\n    inputArtifacts: this.fb.array([]),\r\n  });\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.decision) {\r\n      const decision: Decision = changes.decision.currentValue;\r\n      const artifacts = [];\r\n      decision.inputArtifacts\r\n        .getList(decision.method.inputArtifacts)\r\n        .elements.forEach((element) => artifacts.push(...element.elements));\r\n      this.inputArtifacts = artifacts;\r\n      this.loadForm(artifacts);\r\n    }\r\n  }\r\n\r\n  loadForm(artifacts: Artifact[]): void {\r\n    const formGroups = artifacts.map(() =>\r\n      this.fb.group({\r\n        artifact: this.fb.control(null, Validators.required),\r\n      })\r\n    );\r\n    this.form.setControl('inputArtifacts', this.fb.array(formGroups));\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.selectInputArtifacts.emit(this.formArray);\r\n  }\r\n\r\n  nextStep(): void {\r\n    this.selectInputArtifacts.emit(this.fb.array([]));\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.form.get('inputArtifacts') as FormArray;\r\n  }\r\n}\r\n","<div [formGroup]=\"formGroup\" class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">\r\n    {{ artifact.name }} ({{ artifact.list | list }})\r\n  </h6>\r\n  <div class=\"form-group\">\r\n    <div\r\n      class=\"btn-group btn-group-toggle\"\r\n      ngbRadioGroup\r\n      name=\"selectIsDefinition\"\r\n      formControlName=\"isDefinition\"\r\n    >\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"false\" /> Merge\r\n      </label>\r\n      <label ngbButtonLabel class=\"btn-primary\">\r\n        <input ngbButton type=\"radio\" [value]=\"true\" /> New Artifact\r\n      </label>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"!definitionControl.value\" class=\"form-group\">\r\n    <label for=\"artifact\">Artifact</label>\r\n    <div class=\"input-group\">\r\n      <select class=\"form-control\" id=\"artifact\" formControlName=\"artifact\">\r\n        <ng-container *ngFor=\"let a of processArtifacts; let index = index\">\r\n          <option *ngIf=\"a.artifact._id === artifact._id\" [ngValue]=\"index\">\r\n            {{ a.identifier }}\r\n          </option>\r\n        </ng-container>\r\n      </select>\r\n      <div *ngIf=\"!artifact.internalArtifact\" class=\"input-group-append\">\r\n        <button\r\n          [disabled]=\"artifactControl.value == null\"\r\n          class=\"btn btn-outline-primary\"\r\n          type=\"button\"\r\n          (click)=\"loadData(artifactControl.value)\"\r\n        >\r\n          Load\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group\" *ngIf=\"definitionControl.value\">\r\n    <label for=\"name\">Name</label>\r\n    <div class=\"input-group\">\r\n      <input class=\"form-control\" id=\"name\" formControlName=\"artifactName\" />\r\n      <div *ngIf=\"artifact.internalArtifact\" class=\"input-group-append\">\r\n        <button\r\n          class=\"btn btn-outline-primary\"\r\n          type=\"button\"\r\n          (click)=\"setDefaultName()\"\r\n        >\r\n          Set default name\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group\" *ngIf=\"showNotes\">\r\n    <label for=\"externalOutputArtifactData\">Note</label>\r\n    <quill-editor\r\n      [styles]=\"{ 'min-height': '250px' }\"\r\n      id=\"externalOutputArtifactData\"\r\n      formControlName=\"data\"\r\n    ></quill-editor>\r\n  </div>\r\n</div>\r\n","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { AbstractControl, ControlContainer, FormGroup } from '@angular/forms';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { OutputArtifactMappingFormValue } from '../shared/output-artifact-mapping-form.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { StepArtifact } from '../../development-process-registry/running-process/step-artifact';\r\nimport { MetaModelService } from '../../development-process-registry/meta-model.service';\r\nimport { ArtifactDataType } from '../../development-process-registry/running-process/artifact-data';\r\n\r\n@Component({\r\n  selector: 'app-running-process-select-output-artifact',\r\n  templateUrl: './running-process-select-output-artifact.component.html',\r\n  styleUrls: ['./running-process-select-output-artifact.component.css'],\r\n})\r\nexport class RunningProcessSelectOutputArtifactComponent\r\n  implements OnInit, OnDestroy\r\n{\r\n  @Input() artifact!: Artifact;\r\n  @Input() internalArtifact?: StepArtifact;\r\n  @Input() processArtifacts!: RunningArtifact[];\r\n\r\n  private artifactIsDefinitionChangeSubscription?: Subscription;\r\n  private artifactSelectionChangeSubscription?: Subscription;\r\n\r\n  constructor(\r\n    private controlContainer: ControlContainer,\r\n    private metaModelService: MetaModelService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.artifactIsDefinitionChangeSubscription =\r\n      this.definitionControl.valueChanges.subscribe(async (value) => {\r\n        if (value && !this.artifactNameControl.value) {\r\n          await this.setDefaultName();\r\n        }\r\n      });\r\n    this.artifactSelectionChangeSubscription =\r\n      this.artifactControl.valueChanges.subscribe((value: number) =>\r\n        this.loadData(value)\r\n      );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.artifactIsDefinitionChangeSubscription != null) {\r\n      this.artifactIsDefinitionChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.artifactSelectionChangeSubscription != null) {\r\n      this.artifactSelectionChangeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load the data of an artifact into the data control.\r\n   *\r\n   * @param artifact the number of the artifact to load\r\n   */\r\n  loadData(artifact: number): void {\r\n    const runningArtifact = this.processArtifacts[artifact];\r\n    this.dataControl.setValue(\r\n      runningArtifact.versions[runningArtifact.versions.length - 1].data.data\r\n    );\r\n  }\r\n\r\n  async setDefaultName(): Promise<void> {\r\n    if (\r\n      this.internalArtifact != null &&\r\n      this.internalArtifact.data.type === ArtifactDataType.REFERENCE\r\n    ) {\r\n      const api = this.metaModelService.getMetaModelApi(\r\n        this.internalArtifact.metaModelType\r\n      );\r\n      if (api != null) {\r\n        const name = await api.getName(this.internalArtifact.data.data);\r\n        if (name != null) {\r\n          this.artifactNameControl.setValue(name);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.controlContainer.control as FormGroup;\r\n  }\r\n\r\n  get definitionControl(): AbstractControl {\r\n    return this.formGroup.get('isDefinition');\r\n  }\r\n\r\n  get artifactNameControl(): AbstractControl {\r\n    return this.formGroup.get('artifactName');\r\n  }\r\n\r\n  get artifactControl(): AbstractControl {\r\n    return this.formGroup.get('artifact');\r\n  }\r\n\r\n  get dataControl(): AbstractControl {\r\n    return this.formGroup.get('data');\r\n  }\r\n\r\n  get showNotes(): boolean {\r\n    if (this.artifact.internalArtifact) {\r\n      return false;\r\n    }\r\n    const formValue: OutputArtifactMappingFormValue = this.formGroup.value;\r\n    if (formValue.isDefinition) {\r\n      return true;\r\n    }\r\n    return formValue.artifact != null;\r\n  }\r\n}\r\n","<ng-container *ngIf=\"outputArtifacts.length === 0\">\r\n  <div class=\"alert alert-info\">\r\n    This building block has no output artifacts.\r\n  </div>\r\n</ng-container>\r\n<form\r\n  [formGroup]=\"form\"\r\n  *ngIf=\"outputArtifacts.length > 0\"\r\n  (ngSubmit)=\"submitForm()\"\r\n>\r\n  <div formArrayName=\"outputArtifacts\">\r\n    <app-running-process-select-output-artifact\r\n      *ngFor=\"let artifact of outputArtifacts; let index = index\"\r\n      formGroupName=\"{{ index }}\"\r\n      [artifact]=\"artifact\"\r\n      [internalArtifact]=\"internalOutputArtifacts[index]\"\r\n      [processArtifacts]=\"runningProcess.artifacts\"\r\n    ></app-running-process-select-output-artifact>\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <button\r\n      type=\"submit\"\r\n      class=\"btn btn-sm btn-block\"\r\n      [class.btn-dark]=\"!changed\"\r\n      [class.btn-primary]=\"changed\"\r\n      [disabled]=\"!form.valid\"\r\n    >\r\n      Update Artifacts<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n    </button>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { FormArray, FormBuilder, FormGroup } from '@angular/forms';\r\nimport {\r\n  OutputArtifactMappingFormService,\r\n  OutputArtifactMappingFormValue,\r\n} from '../shared/output-artifact-mapping-form.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { RunningMethod } from '../../development-process-registry/running-process/running-method';\r\nimport { OutputArtifactMapping } from '../../development-process-registry/running-process/output-artifact-mapping';\r\nimport { equalsListGeneric } from '../../shared/utils';\r\nimport { ArtifactDataType } from '../../development-process-registry/running-process/artifact-data';\r\nimport { StepArtifact } from '../../development-process-registry/running-process/step-artifact';\r\n\r\n@Component({\r\n  selector: 'app-running-process-select-output-artifacts',\r\n  templateUrl: './running-process-select-output-artifacts.component.html',\r\n  styleUrls: ['./running-process-select-output-artifacts.component.css'],\r\n})\r\nexport class RunningProcessSelectOutputArtifactsComponent\r\n  implements OnChanges, OnDestroy\r\n{\r\n  @Input() runningProcess: RunningProcess;\r\n  @Input() runningMethod: RunningMethod;\r\n  @Input() decision: Decision;\r\n\r\n  @Output() updateOutputArtifacts = new EventEmitter<FormArray>();\r\n\r\n  outputArtifacts: Artifact[];\r\n  internalOutputArtifacts: StepArtifact[];\r\n\r\n  form: FormGroup;\r\n  changed = false;\r\n\r\n  private changeSubscription?: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private outputArtifactMappingFormService: OutputArtifactMappingFormService\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    let reload = false;\r\n    if (changes.runningMethod) {\r\n      const oldRunningMethod: RunningMethod =\r\n        changes.runningMethod.previousValue;\r\n      const newRunningMethod: RunningMethod =\r\n        changes.runningMethod.currentValue;\r\n      if (\r\n        oldRunningMethod == null ||\r\n        !this.equals(\r\n          oldRunningMethod.outputArtifacts,\r\n          newRunningMethod.outputArtifacts\r\n        )\r\n      ) {\r\n        reload = true;\r\n      }\r\n    }\r\n    if (changes.decision || reload) {\r\n      const decision: Decision = changes.decision.currentValue;\r\n      const artifacts = [];\r\n      decision.outputArtifacts\r\n        .getList(decision.method.outputArtifacts)\r\n        .elements.forEach((element) => artifacts.push(...element.elements));\r\n      this.outputArtifacts = artifacts;\r\n      this.internalOutputArtifacts = this.runningMethod.getOutputArtifacts();\r\n      this.loadForm(artifacts, this.runningMethod.outputArtifacts);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription != null) {\r\n      this.changeSubscription.unsubscribe();\r\n      this.changeSubscription = undefined;\r\n    }\r\n  }\r\n\r\n  loadForm(\r\n    artifacts: Artifact[],\r\n    outputArtifacts: OutputArtifactMapping[]\r\n  ): void {\r\n    if (this.changeSubscription != null) {\r\n      this.changeSubscription.unsubscribe();\r\n      this.changeSubscription = undefined;\r\n    }\r\n    this.form = this.outputArtifactMappingFormService.createForm(\r\n      artifacts,\r\n      outputArtifacts\r\n    );\r\n    this.changed = false;\r\n    this.changeSubscription = this.formArray.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value: OutputArtifactMappingFormValue[]) =>\r\n            (this.changed = !this.equals(\r\n              this.outputArtifactMappingFormService.get(value),\r\n              this.runningMethod.outputArtifacts\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.updateOutputArtifacts.emit(this.formArray);\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.form.get('outputArtifacts') as FormArray;\r\n  }\r\n\r\n  showNotes(artifact: Artifact, index: number): boolean {\r\n    if (artifact.internalArtifact) {\r\n      return false;\r\n    }\r\n    const formValue: OutputArtifactMappingFormValue =\r\n      this.formArray.at(index).value;\r\n    if (formValue.isDefinition) {\r\n      return true;\r\n    }\r\n    return formValue.artifact != null;\r\n  }\r\n\r\n  private equals(\r\n    outputArtifactsA: OutputArtifactMapping[],\r\n    outputArtifactsB: OutputArtifactMapping[]\r\n  ): boolean {\r\n    return equalsListGeneric(\r\n      outputArtifactsA,\r\n      outputArtifactsB,\r\n      (mappingA, mappingB): boolean => {\r\n        if (\r\n          mappingA.isDefinition !== mappingB.isDefinition ||\r\n          mappingA.data.type !== mappingB.data.type\r\n        ) {\r\n          return false;\r\n        }\r\n        if (mappingA.isDefinition) {\r\n          if (mappingA.artifactName !== mappingB.artifactName) {\r\n            return false;\r\n          }\r\n        } else {\r\n          if (mappingA.artifact !== mappingB.artifact) {\r\n            return false;\r\n          }\r\n        }\r\n        if (mappingA.data.type === ArtifactDataType.STRING) {\r\n          return mappingA.data.data === mappingB.data.data;\r\n        }\r\n        return true;\r\n      }\r\n    );\r\n  }\r\n}\r\n","<ng-template #infoModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Building Block Info</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-development-method-summary\r\n      [decision]=\"modalDecision\"\r\n    ></app-development-method-summary>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #multipleOptionsInfoModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Execution Error</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    You need to select one of the outgoing flows of the exclusive gateway to\r\n    specify which path should be taken for the execution.\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #showArtifactVersionModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Version #{{ modalArtifact.versions.indexOf(modalArtifactVersion) + 1 }} of\r\n      {{ modalArtifact.identifier }} &ndash; {{ modalArtifact.artifact.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <ng-container\r\n      *ngIf=\"getArtifactDataTypeString() === modalArtifactVersion.data.type\"\r\n    >\r\n      <h5>Note</h5>\r\n      <quill-view [content]=\"modalArtifactVersion.data.data\"></quill-view>\r\n    </ng-container>\r\n    <ng-container\r\n      *ngIf=\"getArtifactDataTypeReference() === modalArtifactVersion.data.type\"\r\n    >\r\n      <h5>Reference</h5>\r\n      This version points on another object in the database.\r\n      <button\r\n        class=\"btn btn-xs btn-primary\"\r\n        (click)=\"viewArtifactReference(modalArtifactVersion.data.data)\"\r\n      >\r\n        View\r\n      </button>\r\n    </ng-container>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #selectMethodModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Select Method Building Block to add to TODO</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-development-methods-selection-form\r\n      [contextSituationalFactors]=\"runningProcess.process.situationalFactors\"\r\n      [developmentMethods]=\"modalDevelopmentMethods\"\r\n      (selectDevelopmentMethod)=\"configureMethod($event)\"\r\n    ></app-development-methods-selection-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #methodConfigurationModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Configure Building Block {{ modalDevelopmentMethod.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-method-info\r\n      [contextSituationalFactors]=\"runningProcess.process.situationalFactors\"\r\n      [developmentMethod]=\"modalDevelopmentMethod\"\r\n      [decision]=\"modalDecision\"\r\n      (updateDecisions)=\"updateDecision($event)\"\r\n    ></app-method-info>\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n    <button class=\"btn btn-primary\" (click)=\"addMethod()\">Add method</button>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #commentsModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Comments of {{ modalRunningMethodInfo.methodName }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-running-process-method-comments\r\n      [comments]=\"modalRunningMethodInfo.comments\"\r\n      [editable]=\"false\"\r\n    ></app-running-process-method-comments>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #artifactExportModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Export Artifact</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-running-process-artifact-export-form\r\n      [artifact]=\"modalArtifact\"\r\n      (submitArtifactExportForm)=\"\r\n        exportArtifact($event.value.identifier, modalArtifact); d()\r\n      \"\r\n    ></app-running-process-artifact-export-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #artifactImportModal let-d=\"dismiss\" let-c=\"close\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Import Artifact</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-running-process-artifact-import-form\r\n      (selectArtifact)=\"importArtifact($event._id); c()\"\r\n    ></app-running-process-artifact-import-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<ng-template #artifactRenameModal let-c=\"close\" let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">\r\n      Rename Artifact {{ modalArtifact.identifier }} &ndash;\r\n      {{ modalArtifact.artifact.name }}\r\n    </h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <app-running-process-artifact-rename-form\r\n      [artifact]=\"modalArtifact\"\r\n      (submitArtifactExportForm)=\"\r\n        renameArtifact($event.value.identifier, modalArtifact); c()\r\n      \"\r\n    ></app-running-process-artifact-rename-form>\r\n  </div>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"runningProcess\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\"\r\n      >{{ runningProcess.process.name }} &ndash; {{ runningProcess.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main\r\n  *ngIf=\"\r\n    runningProcessLoaderService.error &&\r\n    runningProcessLoaderService.errorStatus === 404\r\n  \"\r\n  role=\"main\"\r\n>\r\n  <div class=\"alert alert-info container my-3\">\r\n    <p>\r\n      This running method does not exist. Reason:\r\n      {{ runningProcessLoaderService.errorReason }}.\r\n    </p>\r\n    <p class=\"mb-0\">\r\n      <a [routerLink]=\"['/', 'runningprocess']\"\r\n        >Go back to overview of running methods</a\r\n      >\r\n    </p>\r\n  </div>\r\n</main>\r\n\r\n<main *ngIf=\"runningProcess\" role=\"main\">\r\n  <app-running-process-viewer\r\n    [runningProcess]=\"runningProcess\"\r\n  ></app-running-process-viewer>\r\n\r\n  <div class=\"container\">\r\n    <div\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n      *ngIf=\"decisions.length > 0\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Decision</h6>\r\n      <ul class=\"list-group\">\r\n        <li *ngFor=\"let decision of decisions\" class=\"list-group-item\">\r\n          <div class=\"d-flex justify-content-between align-items-baseline\">\r\n            <h5>\r\n              Exclusive Gateway<span\r\n                *ngIf=\"decision.businessObject && decision.businessObject.name\"\r\n              >\r\n                {{ decision.businessObject.name }}</span\r\n              >\r\n            </h5>\r\n            <div class=\"d-flex align-items-baseline\">\r\n              <button\r\n                (click)=\"focus(decision.id)\"\r\n                type=\"button\"\r\n                class=\"btn btn-dark btn-xs mr-1\"\r\n              >\r\n                View\r\n              </button>\r\n              <button\r\n                (click)=\"executeStep(decision.id)\"\r\n                type=\"button\"\r\n                class=\"btn btn-primary btn-xs\"\r\n              >\r\n                Next Step\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2\">Kanban Board</h6>\r\n      <app-running-process-kanban-board\r\n        [runningProcess]=\"runningProcess\"\r\n        (addTodo)=\"openSelectMethodModal()\"\r\n        (removeTodo)=\"removeMethod($event)\"\r\n        (viewNode)=\"focus($event)\"\r\n        (showInfo)=\"openInfoModal($event)\"\r\n        (startNodeExecution)=\"startNodeExecution($event)\"\r\n        (startExecution)=\"startExecution($event)\"\r\n        (viewExecution)=\"viewExecution($event)\"\r\n        (viewComments)=\"openCommentsModal($event)\"\r\n      ></app-running-process-kanban-board>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <div\r\n        class=\"\r\n          d-flex\r\n          align-items-baseline\r\n          justify-content-between\r\n          border-bottom border-gray\r\n          mb-2\r\n        \"\r\n      >\r\n        <h6 class=\"pb-2 mb-0\">Artifacts</h6>\r\n        <button class=\"btn btn-xs btn-dark\" (click)=\"openArtifactImportModal()\">\r\n          Import Artifact\r\n        </button>\r\n      </div>\r\n      <div\r\n        *ngIf=\"runningProcess.artifacts.length === 0\"\r\n        class=\"alert alert-info mb-0\"\r\n      >\r\n        There are no artifacts\r\n      </div>\r\n      <ul *ngIf=\"runningProcess.artifacts.length > 0\" class=\"list-group\">\r\n        <li\r\n          *ngFor=\"let artifact of runningProcess.artifacts\"\r\n          class=\"list-group-item\"\r\n        >\r\n          <div class=\"d-flex\">\r\n            <div>\r\n              {{ artifact.identifier }} &ndash; {{ artifact.artifact.name }}\r\n            </div>\r\n            <div class=\"ml-auto\">\r\n              <div\r\n                class=\"btn btn-dark btn-xs mr-1\"\r\n                (click)=\"openRenameArtifactModal(artifact)\"\r\n              >\r\n                Rename\r\n              </div>\r\n              <div\r\n                class=\"btn btn-dark btn-xs\"\r\n                (click)=\"openArtifactExportModal(artifact)\"\r\n              >\r\n                Export\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <ul *ngIf=\"artifact.versions.length > 0\">\r\n            <li *ngFor=\"let version of artifact.versions; let index = index\">\r\n              <a\r\n                [routerLink]=\"[]\"\r\n                (click)=\"openShowArtifactVersionModal(artifact, version)\"\r\n                >Version #{{ index + 1 }}</a\r\n              >\r\n              &ndash;\r\n              <a\r\n                *ngIf=\"\r\n                  version.createdBy !== 'manual' &&\r\n                  version.createdBy !== 'imported'\r\n                \"\r\n                [routerLink]=\"[]\"\r\n                (click)=\"focus(version.createdBy)\"\r\n              >\r\n                {{\r\n                  runningProcess.process.decisions[version.createdBy].method\r\n                    .name\r\n                }}\r\n              </a>\r\n              <span *ngIf=\"version.createdBy === 'manual'\">\r\n                {{\r\n                  runningProcess.getExecutedMethod(version.executedBy)\r\n                    .methodName\r\n                }}\r\n              </span>\r\n              <span *ngIf=\"version.createdBy === 'imported'\">\r\n                Imported from {{ version.importName }}\r\n              </span>\r\n              &ndash; {{ version.time | date: 'short' }}\r\n            </li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\nimport { RunningProcessViewerComponent } from '../../development-process-view/running-process-viewer/running-process-viewer.component';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { ArtifactVersion } from '../../development-process-registry/running-process/artifact-version';\r\nimport { OutputArtifactMappingFormService } from '../shared/output-artifact-mapping-form.service';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\nimport {\r\n  DevelopmentMethod,\r\n  DevelopmentMethodEntry,\r\n} from '../../development-process-registry/development-method/development-method';\r\nimport { DevelopmentMethodService } from '../../development-process-registry/development-method/development-method.service';\r\nimport { SituationalFactorEntry } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { ExecutionErrors } from '../../development-process-registry/running-process/process-execution.service';\r\nimport {\r\n  ArtifactDataReference,\r\n  ArtifactDataType,\r\n} from '../../development-process-registry/running-process/artifact-data';\r\nimport { RunningMethodInfo } from '../../development-process-registry/running-process/running-method-info';\r\nimport { MetaModelService } from '../../development-process-registry/meta-model.service';\r\nimport { RunningProcessLoaderService } from '../shared/running-process-loader.service';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { ConcreteArtifactService } from '../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { DevelopmentMethodIncompleteModalComponent } from '../development-method-incomplete-modal/development-method-incomplete-modal.component';\r\n\r\n@Component({\r\n  selector: 'app-running-process',\r\n  templateUrl: './running-process.component.html',\r\n  styleUrls: ['./running-process.component.css'],\r\n  providers: [RunningProcessLoaderService],\r\n})\r\nexport class RunningProcessComponent implements OnInit {\r\n  decisions: any[];\r\n\r\n  private modalReference: NgbModalRef;\r\n  modalDecision: Decision;\r\n  modalArtifact: RunningArtifact;\r\n  modalArtifactVersion: ArtifactVersion;\r\n  modalDevelopmentMethods: DevelopmentMethodEntry[] = null;\r\n  modalDevelopmentMethod: DevelopmentMethod;\r\n  modalRunningMethodInfo: RunningMethodInfo;\r\n\r\n  @ViewChild(RunningProcessViewerComponent)\r\n  runningProcessViewer: RunningProcessViewerComponent;\r\n  @ViewChild('infoModal', { static: true }) infoModal: unknown;\r\n  @ViewChild('multipleOptionsInfoModal', { static: true })\r\n  multipleOptionsInfoModal: unknown;\r\n  @ViewChild('showArtifactVersionModal', { static: true })\r\n  showArtifactVersionModal: unknown;\r\n  @ViewChild('selectMethodModal', { static: true }) selectMethodModal: unknown;\r\n  @ViewChild('methodConfigurationModal', { static: true })\r\n  methodConfigurationModal: unknown;\r\n  @ViewChild('commentsModal', { static: true }) commentsModal: unknown;\r\n  @ViewChild('artifactExportModal', { static: true })\r\n  artifactExportModal: unknown;\r\n  @ViewChild('artifactImportModal', { static: true })\r\n  artifactImportModal: unknown;\r\n  @ViewChild('artifactRenameModal', { static: true })\r\n  artifactRenameModal: unknown;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    private concreteArtifactService: ConcreteArtifactService,\r\n    private developmentMethodService: DevelopmentMethodService,\r\n    private metaModelService: MetaModelService,\r\n    private modalService: NgbModal,\r\n    private outputArtifactMappingFormService: OutputArtifactMappingFormService,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    public runningProcessLoaderService: RunningProcessLoaderService,\r\n    private runningProcessService: RunningProcessService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.runningProcessLoaderService.loaded.subscribe(() =>\r\n      this.afterReload(this.runningProcess)\r\n    );\r\n  }\r\n\r\n  openShowArtifactVersionModal(\r\n    artifact: RunningArtifact,\r\n    version: ArtifactVersion\r\n  ): void {\r\n    this.modalArtifact = artifact;\r\n    this.modalArtifactVersion = version;\r\n    this.modalReference = this.modalService.open(\r\n      this.showArtifactVersionModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  viewArtifactReference(reference: ArtifactDataReference): void {\r\n    this.modalReference.close();\r\n    this.metaModelService\r\n      .getMetaModelApi(reference.type)\r\n      .view(reference, this.router, {\r\n        referenceType: 'Process',\r\n        runningProcessId: this.runningProcess._id,\r\n      });\r\n  }\r\n\r\n  openInfoModal(decision: Decision): void {\r\n    this.modalDecision = decision;\r\n    this.modalReference = this.modalService.open(this.infoModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async openSelectMethodModal(): Promise<void> {\r\n    this.modalReference = this.modalService.open(this.selectMethodModal, {\r\n      size: 'lg',\r\n      beforeDismiss: () => {\r\n        this.modalDevelopmentMethods = null;\r\n        return true;\r\n      },\r\n    });\r\n    this.modalDevelopmentMethods = this.sortByDistance(\r\n      await this.developmentMethodService.getList()\r\n    );\r\n  }\r\n\r\n  async configureMethod(method: DevelopmentMethodEntry): Promise<void> {\r\n    const developmentMethod = new DevelopmentMethod(method, undefined);\r\n    if (!this.developmentMethodService.isCorrectlyDefined(developmentMethod)) {\r\n      const modal = this.modalService.open(\r\n        DevelopmentMethodIncompleteModalComponent\r\n      );\r\n      const component: DevelopmentMethodIncompleteModalComponent =\r\n        modal.componentInstance;\r\n      component.developmentMethod = developmentMethod;\r\n      return;\r\n    }\r\n    this.modalDevelopmentMethods = null;\r\n    this.modalReference.close();\r\n    await this.modalReference.result;\r\n    this.modalDevelopmentMethod = developmentMethod;\r\n    this.modalDecision = new Decision(undefined, {\r\n      method: this.modalDevelopmentMethod,\r\n      stakeholders: {},\r\n      inputArtifacts: {},\r\n      outputArtifacts: {},\r\n      tools: {},\r\n      stepDecisions: this.modalDevelopmentMethod.executionSteps.map(() => null),\r\n    });\r\n    this.modalReference = this.modalService.open(\r\n      this.methodConfigurationModal,\r\n      { size: 'lg' }\r\n    );\r\n  }\r\n\r\n  updateDecision(updates: any): void {\r\n    this.modalDecision.update(updates);\r\n  }\r\n\r\n  async executeStep(nodeId: string): Promise<void> {\r\n    const selectedFlow = this.runningProcessViewer.getSelectedFlow();\r\n    try {\r\n      await this.runningProcessService.executeStep(\r\n        this.runningProcess,\r\n        nodeId,\r\n        selectedFlow ? selectedFlow.id : null\r\n      );\r\n      const process = await this.runningProcessService.get(\r\n        this.runningProcess._id\r\n      );\r\n      await this.runningProcessService.jumpSteps(process);\r\n    } catch (error) {\r\n      if (error.message === ExecutionErrors.MULTIPLE_OPTIONS) {\r\n        this.focus(nodeId);\r\n        this.modalReference = this.modalService.open(\r\n          this.multipleOptionsInfoModal,\r\n          { size: 'lg' }\r\n        );\r\n      } else {\r\n        console.log(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  async addMethod(): Promise<void> {\r\n    this.modalReference.close();\r\n    await this.runningProcessService.addMethod(\r\n      this.runningProcess,\r\n      this.modalDecision\r\n    );\r\n  }\r\n\r\n  async removeMethod(executionId: string): Promise<void> {\r\n    await this.runningProcessService.removeMethod(\r\n      this.runningProcess,\r\n      executionId\r\n    );\r\n  }\r\n\r\n  sortByDistance<\r\n    T extends {\r\n      _id: string;\r\n      situationalFactors: { list: string; element?: SituationalFactorEntry }[];\r\n    }[]\r\n  >(elements: T): T {\r\n    const distanceMap: { [id: string]: number } = {};\r\n    elements.forEach(\r\n      (element) =>\r\n        (distanceMap[element._id] = this.bmProcessService.distanceToContext(\r\n          this.runningProcess.process,\r\n          element.situationalFactors.map((factor) => factor.element)\r\n        ))\r\n    );\r\n    return elements.sort(\r\n      (elementA, elementB) =>\r\n        distanceMap[elementA._id] - distanceMap[elementB._id]\r\n    );\r\n  }\r\n\r\n  async viewExecution(executionId): Promise<void> {\r\n    await this.router.navigate([\r\n      'runningprocess',\r\n      'runningprocessview',\r\n      this.runningProcess._id,\r\n      'method',\r\n      executionId,\r\n    ]);\r\n  }\r\n\r\n  focus(id: string): void {\r\n    this.runningProcessViewer.focus(id);\r\n  }\r\n\r\n  async startNodeExecution(nodeId: string): Promise<void> {\r\n    await this.runningProcessService.startMethodExecution(\r\n      this.runningProcess._id,\r\n      nodeId\r\n    );\r\n  }\r\n\r\n  async startExecution(executionId: string): Promise<void> {\r\n    await this.runningProcessService.startTodoMethodExecution(\r\n      this.runningProcess._id,\r\n      executionId\r\n    );\r\n  }\r\n\r\n  openCommentsModal(executionId: string): void {\r\n    this.modalRunningMethodInfo = this.runningProcess.getMethod(executionId);\r\n    this.modalReference = this.modalService.open(this.commentsModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  openArtifactExportModal(artifact: RunningArtifact): void {\r\n    this.modalArtifact = artifact;\r\n    this.modalReference = this.modalService.open(this.artifactExportModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async exportArtifact(\r\n    identifier: string,\r\n    artifact: RunningArtifact\r\n  ): Promise<void> {\r\n    artifact = await this.concreteArtifactService.export(\r\n      identifier,\r\n      artifact,\r\n      this.runningProcess.name\r\n    );\r\n    await this.router.navigate([\r\n      '/',\r\n      'concreteArtifacts',\r\n      'detail',\r\n      artifact._id,\r\n    ]);\r\n  }\r\n\r\n  openArtifactImportModal(): void {\r\n    this.modalReference = this.modalService.open(this.artifactImportModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async importArtifact(artifactId: string): Promise<void> {\r\n    const artifact = await this.concreteArtifactService.get(artifactId);\r\n    const copiedArtifact = await this.concreteArtifactService.copy(artifact);\r\n    await this.runningProcessService.importArtifact(\r\n      this.runningProcess._id,\r\n      copiedArtifact\r\n    );\r\n  }\r\n\r\n  openRenameArtifactModal(artifact: RunningArtifact): void {\r\n    this.modalArtifact = artifact;\r\n    this.modalReference = this.modalService.open(this.artifactRenameModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async renameArtifact(\r\n    identifier: string,\r\n    artifact: RunningArtifact\r\n  ): Promise<void> {\r\n    await this.runningProcessService.renameArtifact(\r\n      this.runningProcess,\r\n      artifact,\r\n      identifier\r\n    );\r\n  }\r\n\r\n  getArtifactDataTypeString(): ArtifactDataType {\r\n    return ArtifactDataType.STRING;\r\n  }\r\n\r\n  getArtifactDataTypeReference(): ArtifactDataType {\r\n    return ArtifactDataType.REFERENCE;\r\n  }\r\n\r\n  private async afterReload(runningProcess: RunningProcess): Promise<void> {\r\n    this.decisions =\r\n      await this.runningProcessService.getExecutableDecisionNodes(\r\n        runningProcess\r\n      );\r\n  }\r\n\r\n  get runningProcess(): RunningProcess {\r\n    return this.runningProcessLoaderService.runningProcess;\r\n  }\r\n}\r\n","<ng-template #deleteProcessModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteRunningProcess(modalRunningProcess._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Running Method {{ modalRunningProcess.process.name }} &ndash;\r\n      {{ modalRunningProcess.name }}\r\n    </div>\r\n    You are deleting the running method {{ modalRunningProcess.name }}, which\r\n    executes the method {{ modalRunningProcess.process.name }}. By deleting this\r\n    running method all corresponding models are deleted too. This can not be\r\n    undone.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Running Methods</a>\r\n    <a\r\n      *ngFor=\"let runningProcess of runningProcessesList\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['runningprocessview', runningProcess._id]\"\r\n    >\r\n      {{ runningProcess.process.name }} &ndash; {{ runningProcess.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    A list of all methods that are currently executed. To create such a method\r\n    create a\r\n    <a routerLink=\"/bmprocess\">Business Model Development Method</a> and add the\r\n    method to the running methods in the form below.\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Running Methods\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No running methods available.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"\r\n          d-flex\r\n          list-group-item\r\n          justify-content-between\r\n          align-items-baseline\r\n        \"\r\n        *ngFor=\"let runningProcess of runningProcessesList\"\r\n      >\r\n        <div>\r\n          <span\r\n            >{{ runningProcess.process.name }} &ndash;\r\n            {{ runningProcess.name }}</span\r\n          >\r\n        </div>\r\n        <div>\r\n          <a\r\n            [routerLink]=\"['runningprocessview', runningProcess._id]\"\r\n            type=\"button\"\r\n            class=\"btn btn-dark btn-xs mr-1\"\r\n            >View</a\r\n          >\r\n          <button\r\n            (click)=\"openDeleteProcessModal(runningProcess)\"\r\n            type=\"button\"\r\n            class=\"btn btn-danger btn-xs\"\r\n          >\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Add Running Method</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"addRunningProcessForm\"\r\n        (ngSubmit)=\"addRunningProcess()\"\r\n      >\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"processSelector\" class=\"col-sm-4 col-form-label\"\r\n            >Method</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <select\r\n              id=\"processSelector\"\r\n              formControlName=\"process\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"\r\n                processControl.invalid && processControl.touched\r\n              \"\r\n            >\r\n              <option *ngFor=\"let process of processes\" [ngValue]=\"process\">\r\n                {{ process.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"nameControl.invalid && nameControl.touched\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!addRunningProcessForm.valid\"\r\n            >\r\n              Add\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport {\r\n  RunningProcess,\r\n  RunningProcessEntry,\r\n  RunningProcessInit,\r\n} from '../../development-process-registry/running-process/running-process';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\nimport { BmProcessEntry } from '../../development-process-registry/bm-process/bm-process';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\n\r\n@Component({\r\n  selector: 'app-running-processes',\r\n  templateUrl: './running-processes.component.html',\r\n  styleUrls: ['./running-processes.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: RunningProcessService },\r\n  ],\r\n})\r\nexport class RunningProcessesComponent implements OnInit {\r\n  addRunningProcessForm: FormGroup;\r\n  processes: BmProcessEntry[] = [];\r\n\r\n  modalRunningProcess: RunningProcess;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteProcessModal', { static: true })\r\n  deleteProcessModal: unknown;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    private fb: FormBuilder,\r\n    private listService: ListService<RunningProcess, RunningProcessInit>,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadProcesses();\r\n    this.initForm();\r\n  }\r\n\r\n  initForm(): void {\r\n    this.addRunningProcessForm = this.fb.group({\r\n      name: ['', Validators.required],\r\n      process: [null, Validators.required],\r\n    });\r\n  }\r\n\r\n  async addRunningProcess(): Promise<void> {\r\n    await this.listService.add({\r\n      process: this.processControl.value,\r\n      name: this.nameControl.value,\r\n    });\r\n    this.initForm();\r\n  }\r\n\r\n  async loadProcesses(): Promise<void> {\r\n    this.processes = await this.bmProcessService.getList();\r\n  }\r\n\r\n  async openDeleteProcessModal(runningProcess: RunningProcess): Promise<void> {\r\n    this.modalRunningProcess = runningProcess;\r\n    this.modalReference = this.modalService.open(this.deleteProcessModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async deleteRunningProcess(id: string): Promise<void> {\r\n    await this.listService.delete(id);\r\n  }\r\n\r\n  get processControl(): FormControl {\r\n    return this.addRunningProcessForm.get('process') as FormControl;\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.addRunningProcessForm.get('name') as FormControl;\r\n  }\r\n\r\n  get runningProcessesList(): RunningProcessEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  ArtifactMapping,\r\n  ArtifactMappingInit,\r\n} from '../../development-process-registry/development-method/artifact-mapping';\r\n\r\nexport type MappingsFormValue = MappingFormValue[];\r\n\r\nexport interface MappingFormValue {\r\n  output: boolean;\r\n  step?: number;\r\n  group?: number;\r\n  artifact: number;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ArtifactMappingFormService {\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  createMappingsForm(mappings: ArtifactMapping[]): FormArray {\r\n    return this.fb.array(\r\n      mappings.map((mapping) => this.createMappingForm(mapping))\r\n    );\r\n  }\r\n\r\n  createMappingForm(mapping: ArtifactMapping = null): FormGroup {\r\n    if (!mapping) {\r\n      return this.fb.group({\r\n        output: this.fb.control(false, Validators.required),\r\n        step: this.fb.control(null, Validators.required),\r\n        artifact: this.fb.control(null, Validators.required),\r\n      });\r\n    } else if (mapping.output) {\r\n      return this.fb.group({\r\n        output: this.fb.control(true, Validators.required),\r\n        group: this.fb.control(mapping.group, Validators.required),\r\n        artifact: this.fb.control(mapping.artifact, Validators.required),\r\n      });\r\n    } else {\r\n      return this.fb.group({\r\n        output: this.fb.control(false, Validators.required),\r\n        step: this.fb.control(mapping.step, Validators.required),\r\n        artifact: this.fb.control(mapping.artifact, Validators.required),\r\n      });\r\n    }\r\n  }\r\n\r\n  convertMappingForm(mappingForm: FormGroup): void {\r\n    if (mappingForm.get('output').value) {\r\n      mappingForm.removeControl('step');\r\n      mappingForm.addControl(\r\n        'group',\r\n        this.fb.control(null, Validators.required)\r\n      );\r\n    } else {\r\n      mappingForm.removeControl('group');\r\n      mappingForm.addControl(\r\n        'step',\r\n        this.fb.control(null, Validators.required)\r\n      );\r\n    }\r\n    mappingForm.get('artifact').reset();\r\n  }\r\n\r\n  /**\r\n   * Resets the step and artifact.\r\n   *\r\n   * @param mappingsForm the mappings in which to search\r\n   * @param step the step to which a mapping should point to reset it\r\n   */\r\n  removeMappingTo(mappingsForm: FormArray, step: number): void {\r\n    mappingsForm.controls.forEach((mappingForm: FormGroup) => {\r\n      if (\r\n        mappingForm.get('output').value === false &&\r\n        mappingForm.get('step').value === step\r\n      ) {\r\n        mappingForm.get('step').reset();\r\n        mappingForm.get('artifact').reset();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Resets only the artifact.\r\n   *\r\n   * @param mappingsForm the mappings in which to search\r\n   * @param step the step to which a mapping should point to reset it\r\n   */\r\n  resetMappingTo(mappingsForm: FormArray, step: number): void {\r\n    mappingsForm.controls.forEach((mappingForm: FormGroup) => {\r\n      if (\r\n        mappingForm.get('output').value === false &&\r\n        mappingForm.get('step').value === step\r\n      ) {\r\n        mappingForm.get('artifact').reset();\r\n      }\r\n    });\r\n  }\r\n\r\n  getMappings(mappings: MappingsFormValue): ArtifactMappingInit[] {\r\n    return mappings.map((mapping) => this.getMapping(mapping));\r\n  }\r\n\r\n  getMapping(mapping: MappingFormValue): ArtifactMappingInit {\r\n    if (mapping.output) {\r\n      return {\r\n        output: mapping.output,\r\n        group: mapping.group,\r\n        artifact: mapping.artifact,\r\n      };\r\n    } else {\r\n      return {\r\n        output: mapping.output,\r\n        step: mapping.step,\r\n        artifact: mapping.artifact,\r\n      };\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { BmProcess } from '../../development-process-registry/bm-process/bm-process';\r\nimport { BmProcessService } from '../../development-process-registry/bm-process/bm-process.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class BmProcessLoaderService extends ElementLoaderService {\r\n  bmProcess: BmProcess = null;\r\n\r\n  constructor(\r\n    private bmProcessService: BmProcessService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const bmProcessId = paramMap.get('id');\r\n    this.changesFeed = this.bmProcessService\r\n      .getChangesFeed(bmProcessId)\r\n      .subscribe(() => this.loadBmProcess(bmProcessId));\r\n    void this.loadBmProcess(bmProcessId);\r\n  }\r\n\r\n  private async loadBmProcess(bmProcessId: string): Promise<void> {\r\n    this.bmProcess = await this.bmProcessService.get(bmProcessId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport BpmnModeler from 'bpmn-js/lib/Modeler';\r\nimport bmProcess from '../bpmn-extensions/bm-process';\r\nimport bmProcessPatterns from '../bpmn-extensions/bm-process-patterns';\r\nimport bmdl from '../../../assets/bpmn_bmdl.json';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\nimport { center } from 'diagram-js/lib/util/PositionUtil';\r\nimport { getBBox, selfAndChildren } from 'diagram-js/lib/util/Elements';\r\nimport { pointInRect } from 'diagram-js/lib/util/Geometry';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { ProcessPattern } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { Type } from '../../development-process-registry/method-elements/type/type';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { Decision } from '../../development-process-registry/bm-process/decision';\r\nimport { BpmnViewerService } from '../../development-process-view/shared/bpmn-viewer.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class BpmnService extends BpmnViewerService {\r\n  /**\r\n   * Get a BpmnModeler with customizations to support the creation of process patterns\r\n   *\r\n   * @returns the bpmnModeler\r\n   */\r\n  getBpmnProcessPatternModeler(): BpmnModeler {\r\n    return new BpmnModeler({\r\n      additionalModules: [bmProcessPatterns],\r\n      moddleExtensions: {\r\n        bmdl,\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get a BpmnModeler with customizations to support the development of business model development processes\r\n   *\r\n   * @returns a bpmnModeler\r\n   */\r\n  getBmProcessModeler(): BpmnModeler {\r\n    return new BpmnModeler({\r\n      additionalModules: [bmProcess],\r\n      moddleExtensions: {\r\n        bmdl,\r\n      },\r\n    });\r\n  }\r\n\r\n  appendBpmn(\r\n    modeler: BpmnModeler,\r\n    processPattern: ProcessPattern,\r\n    lastElement\r\n  ): Promise<void> {\r\n    const processPatternModeler = this.getBmProcessModeler();\r\n    return processPatternModeler\r\n      .importXML(processPattern.pattern)\r\n      .then(() => {\r\n        const operation = new BpmnAttachOperation(\r\n          modeler,\r\n          processPatternModeler,\r\n          lastElement\r\n        );\r\n        operation.init();\r\n        operation.attach(processPattern.name, processPattern._id);\r\n      })\r\n      .finally(() => processPatternModeler.destroy());\r\n  }\r\n\r\n  /**\r\n   * Removes a process pattern from the modeler\r\n   *\r\n   * @param modeler the modeler\r\n   * @param subProcessElement the sub process representing the process pattern\r\n   */\r\n  removeProcessPattern(modeler: BpmnModeler, subProcessElement) {\r\n    const modeling = modeler.get('modeling');\r\n    if (is(subProcessElement.parent, 'bpmn:SubProcess')) {\r\n      const operation = new BpmnRemoveOperation(modeler, subProcessElement);\r\n      operation.init();\r\n      operation.remove();\r\n    } else {\r\n      modeling.removeElements([subProcessElement]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set types of an activity to specify which methods can be used\r\n   *\r\n   * @param modeler the modeler\r\n   * @param activityId the id of the activity\r\n   * @param inherit whether the types should be inherited\r\n   * @param neededTypes the needed types of the method\r\n   * @param forbiddenTypes the forbidden types of the method\r\n   */\r\n  setTypesOfActivity(\r\n    modeler: BpmnModeler,\r\n    activityId: string,\r\n    inherit: boolean,\r\n    neededTypes: { list: string; element: Type }[],\r\n    forbiddenTypes: { list: string; element: Type }[]\r\n  ) {\r\n    const moddle = modeler.get('moddle');\r\n    const modeling = modeler.get('modeling');\r\n    const elementRegistry = modeler.get('elementRegistry');\r\n    modeling.updateProperties(elementRegistry.get(activityId), {\r\n      inherit,\r\n      neededType: neededTypes.map((element) => mapTypes(moddle, element)),\r\n      forbiddenType: forbiddenTypes.map((element) => mapTypes(moddle, element)),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get types of an activity that specify which methods can be used. Also queries parents if types are inherited.\r\n   *\r\n   * @param modeler the modeler\r\n   * @param activityId the id of the activity\r\n   */\r\n  getTypesOfActivity(\r\n    modeler: BpmnModeler,\r\n    activityId: string\r\n  ): {\r\n    neededType: { list: string; element: { _id: string; name: string } }[];\r\n    forbiddenType: { list: string; element: { _id: string; name: string } }[];\r\n  } {\r\n    const elementRegistry = modeler.get('elementRegistry');\r\n    const activity = elementRegistry.get(activityId);\r\n    let businessObject = activity.businessObject;\r\n    while (\r\n      businessObject &&\r\n      (businessObject.inherit || !businessObject.neededType)\r\n    ) {\r\n      businessObject = businessObject.$parent;\r\n    }\r\n    return {\r\n      neededType: businessObject ? businessObject.get('neededType') : [],\r\n      forbiddenType: businessObject ? businessObject.get('forbiddenType') : [],\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Selects a development method for a process pattern task and adds the development method to the task\r\n   *\r\n   * @param modeler the modeler\r\n   * @param taskElement the task element\r\n   * @param developmentMethod the development method\r\n   */\r\n  selectDevelopmentMethodForProcessTask(\r\n    modeler: BpmnModeler,\r\n    taskElement,\r\n    developmentMethod: DevelopmentMethod\r\n  ) {\r\n    const moddle = modeler.get('moddle');\r\n    const modeling = modeler.get('modeling');\r\n    modeling.updateProperties(taskElement, {\r\n      method: moddle.create('bmdl:Method', {\r\n        name: developmentMethod.name,\r\n        id: developmentMethod._id,\r\n      }),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Removes a development method from a task in the process\r\n   *\r\n   * @param modeler the modeler that currently displays the process\r\n   * @param taskElement the task element from which the method should be removed\r\n   */\r\n  removeDevelopmentMethodFromProcessTask(modeler: BpmnModeler, taskElement) {\r\n    const modeling = modeler.get('modeling');\r\n    modeling.updateProperties(taskElement, { method: null });\r\n  }\r\n\r\n  insertProcessPatternIntoCallActivity(\r\n    modeler: BpmnModeler,\r\n    callActivityElement,\r\n    processPattern: ProcessPattern\r\n  ) {\r\n    const processPatternModeler = this.getBmProcessModeler();\r\n    return processPatternModeler\r\n      .importXML(processPattern.pattern)\r\n      .then(() => {\r\n        const operation = new BpmnInsertOperation(\r\n          modeler,\r\n          processPatternModeler,\r\n          callActivityElement\r\n        );\r\n        operation.init();\r\n        operation.insert(processPattern.name, processPattern._id);\r\n      })\r\n      .finally(() => processPatternModeler.destroy());\r\n  }\r\n\r\n  /**\r\n   * Get all activities that have a method defined\r\n   *\r\n   * @param modeler the modeler of the current model\r\n   * @returns elements that have a method defined\r\n   */\r\n  getActivitiesWithMethod(modeler: BpmnModeler): any[] {\r\n    return modeler\r\n      .get('elementRegistry')\r\n      .filter((element) => element.businessObject.get('method'));\r\n  }\r\n\r\n  /**\r\n   * Get all method ids used in the model\r\n   *\r\n   * @param modeler the modeler of the current model\r\n   * @returns used method ids\r\n   */\r\n  getUsedMethodIds(modeler: BpmnModeler): string[] {\r\n    return this.getActivitiesWithMethod(modeler).map((element) =>\r\n      element.businessObject.get('method').get('id')\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get all pattern elements of the current model\r\n   *\r\n   * @param modeler the modeler of the current model\r\n   * @returns elements that are used as a pattern\r\n   */\r\n  getPatterns(modeler: BpmnModeler) {\r\n    return modeler\r\n      .get('elementRegistry')\r\n      .filter((element) => element.businessObject.get('processPatternId'));\r\n  }\r\n\r\n  /**\r\n   * Get all pattern ids used in the model\r\n   *\r\n   * @param modeler the modeler of the current model\r\n   * @returns used method ids\r\n   */\r\n  getUsedPatternIds(modeler: BpmnModeler): string[] {\r\n    return this.getPatterns(modeler).map((element) =>\r\n      element.businessObject.get('processPatternId')\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Check whether there are artifacts that are not created earlier\r\n   *\r\n   * @param modeler the modeler of the current model\r\n   * @param decisions the decisions of the bm process\r\n   */\r\n  checkArtifacts(\r\n    modeler: BpmnModeler,\r\n    decisions: { [elementId: string]: Decision }\r\n  ): { [elementId: string]: Artifact[] } {\r\n    const operation = new BpmnCheckArtifacts(modeler, decisions);\r\n    return operation.checkArtifacts();\r\n  }\r\n}\r\n\r\nclass BpmnOperation {\r\n  readonly currentElementRegistry;\r\n  readonly currentElementFactory;\r\n  readonly currentBpmnFactory;\r\n  readonly currentModdle;\r\n  readonly currentModeling;\r\n\r\n  constructor(current: BpmnModeler) {\r\n    this.currentElementRegistry = current.get('elementRegistry');\r\n    this.currentElementFactory = current.get('elementFactory');\r\n    this.currentBpmnFactory = current.get('bpmnFactory');\r\n    this.currentModdle = current.get('moddle');\r\n    this.currentModeling = current.get('modeling');\r\n  }\r\n\r\n  init() {}\r\n\r\n  /**\r\n   * Reconnect an already existing connection\r\n   *\r\n   * @param source the new source\r\n   * @param target the new target\r\n   * @param oldConnection the old connection\r\n   */\r\n  reconnect(source, target, oldConnection) {\r\n    const flowBusinessObject = this.currentBpmnFactory.create(\r\n      oldConnection.businessObject.$type,\r\n      {\r\n        name: oldConnection.businessObject.name,\r\n      }\r\n    );\r\n    let waypoints: any[] = oldConnection.waypoints.slice();\r\n    if (oldConnection.source !== source) {\r\n      // Find index of last point that is in the new source\r\n      let index: number = null;\r\n      for (let i = waypoints.length - 1; i >= 0; --i) {\r\n        if (pointInRect(waypoints[i], source, 20)) {\r\n          index = i;\r\n          break;\r\n        }\r\n      }\r\n      if (index !== null) {\r\n        waypoints = waypoints.slice(index);\r\n      } else if (waypoints.length > 0) {\r\n        waypoints.unshift({\r\n          x: source.x + source.width / 2,\r\n          y: source.y + source.height / 2,\r\n        });\r\n      }\r\n    }\r\n    if (oldConnection.target !== target) {\r\n      // Find index of first point that is in the new target\r\n      let index: number = null;\r\n      for (let i = 0; i < waypoints.length; ++i) {\r\n        if (pointInRect(waypoints[i], target, 20)) {\r\n          index = i;\r\n          break;\r\n        }\r\n      }\r\n      if (index !== null) {\r\n        waypoints = waypoints.slice(0, index + 1);\r\n      } else if (waypoints.length > 0) {\r\n        waypoints.push({\r\n          x: target.x + source.width / 2,\r\n          y: target.y + target.height / 2,\r\n        });\r\n      }\r\n    }\r\n    const flowElement = this.currentElementFactory.createConnection({\r\n      type: oldConnection.type,\r\n      businessObject: flowBusinessObject,\r\n      waypoints: waypoints.length > 1 ? waypoints : undefined,\r\n    });\r\n    this.currentModeling.createConnection(\r\n      source,\r\n      target,\r\n      flowElement,\r\n      oldConnection.parent\r\n    );\r\n    if (flowElement.label) {\r\n      this.currentModeling.updateLabel(\r\n        flowElement,\r\n        oldConnection.businessObject.name,\r\n        {\r\n          x: oldConnection.label.x,\r\n          y: oldConnection.label.y,\r\n          height: oldConnection.label.height,\r\n          width: oldConnection.label.width,\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Copy BPMN relevant data, like types\r\n   *\r\n   * @param oldElement the old element\r\n   * @param newElement the new element\r\n   */\r\n  copyBpmnData(oldElement, newElement) {\r\n    this.currentModeling.updateProperties(newElement, {\r\n      inherit: oldElement.businessObject.get('inherit'),\r\n      neededType: oldElement.businessObject\r\n        .get('neededType')\r\n        .map((element) => mapTypes(this.currentModdle, element)),\r\n      forbiddenType: oldElement.businessObject\r\n        .get('forbiddenType')\r\n        .map((element) => mapTypes(this.currentModdle, element)),\r\n    });\r\n  }\r\n}\r\n\r\nclass BpmnAppendOperation extends BpmnOperation {\r\n  readonly appendElementRegistry;\r\n\r\n  readonly suffix = '_' + String(Date.now());\r\n\r\n  oldBoundaries: { x: number; y: number; width: number; height: number } = null;\r\n  processPoint: { x: number; y: number } = null;\r\n  processSize: { width: number; height: number };\r\n\r\n  constructor(current: BpmnModeler, append: BpmnModeler) {\r\n    super(current);\r\n    this.appendElementRegistry = append.get('elementRegistry');\r\n  }\r\n\r\n  init() {\r\n    super.init();\r\n    this.calculateOldBoundaries();\r\n    this.calculateProcessSize();\r\n  }\r\n\r\n  private calculateOldBoundaries() {\r\n    const bbox = getBBox(\r\n      this.appendElementRegistry.filter(\r\n        (element) => !is(element, 'bpmn:Process')\r\n      )\r\n    );\r\n    this.oldBoundaries = {\r\n      x: bbox.x,\r\n      y: bbox.y,\r\n      width: bbox.width,\r\n      height: bbox.height,\r\n    };\r\n  }\r\n\r\n  private calculateProcessSize() {\r\n    this.processSize = {\r\n      height: this.oldBoundaries.height + 50,\r\n      width: this.oldBoundaries.width + 40,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Translate a point into the new process\r\n   *\r\n   * @param point the point\r\n   * @returns the translated point\r\n   */\r\n  translatePoint(point: { x: number; y: number }): { x: number; y: number } {\r\n    return {\r\n      x: point.x - this.oldBoundaries.x + this.processPoint.x + 20,\r\n      y: point.y - this.oldBoundaries.y + this.processPoint.y + 30,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create a subprocess\r\n   *\r\n   * @param name the name of the subprocess\r\n   * @param processPatternId the id of the process pattern\r\n   * @param parent the parent of the subprocess\r\n   * @returns the created subprocess\r\n   */\r\n  createSubProcess(name: string, processPatternId: string, parent): any {\r\n    const bmBusinessObject = this.currentBpmnFactory.create('bpmn:SubProcess', {\r\n      name,\r\n    });\r\n    const bmElement = this.currentElementFactory.createShape({\r\n      type: 'bpmn:SubProcess',\r\n      isExpanded: true,\r\n      businessObject: bmBusinessObject,\r\n    });\r\n    const subprocess = this.currentModeling.createShape(\r\n      bmElement,\r\n      { ...this.processPoint, ...this.processSize },\r\n      parent\r\n    );\r\n    this.currentModeling.updateProperties(subprocess, {\r\n      processPatternId,\r\n    });\r\n    return subprocess;\r\n  }\r\n\r\n  /**\r\n   * Append all FlowNodes and TextAnnotations to the subprocess\r\n   *\r\n   * @param subProcess the subprocess\r\n   */\r\n  appendNodes(subProcess) {\r\n    this.appendElementRegistry\r\n      .filter(\r\n        (element) =>\r\n          (is(element, 'bpmn:FlowNode') ||\r\n            is(element, 'bpmn:TextAnnotation')) &&\r\n          is(element, element.type)\r\n      )\r\n      .forEach((element) => {\r\n        const bmBusinessObject = this.currentBpmnFactory.create(\r\n          element.businessObject.$type,\r\n          {\r\n            ...element.businessObject,\r\n            id: element.businessObject.id + this.suffix,\r\n            attachedToRef: element.businessObject.attachedToRef\r\n              ? this.currentElementRegistry.get(\r\n                  element.businessObject.attachedToRef.id + this.suffix\r\n                )\r\n              : undefined,\r\n          }\r\n        );\r\n        const bmElement = this.currentElementFactory.createShape({\r\n          type: element.type,\r\n          businessObject: bmBusinessObject,\r\n        });\r\n        this.currentModeling.createShape(\r\n          bmElement,\r\n          {\r\n            ...this.translatePoint(element),\r\n            height: element.height,\r\n            width: element.width,\r\n          },\r\n          subProcess\r\n        );\r\n        if (bmElement.label) {\r\n          this.currentModeling.updateLabel(bmElement, bmBusinessObject.name, {\r\n            ...this.translatePoint(element.label),\r\n            height: element.label.height,\r\n            width: element.label.width,\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Create all connections\r\n   *\r\n   * @param subProcess the subprocess in which the connections should be created\r\n   */\r\n  connectNodes(subProcess) {\r\n    this.appendElementRegistry\r\n      .filter(\r\n        (element) =>\r\n          (is(element, 'bpmn:SequenceFlow') ||\r\n            is(element, 'bpmn:Association')) &&\r\n          is(element, element.type)\r\n      )\r\n      .forEach((element) => {\r\n        const connection = element.businessObject;\r\n        const source = this.currentElementRegistry.get(\r\n          connection.sourceRef.id + this.suffix\r\n        );\r\n        const target = this.currentElementRegistry.get(\r\n          connection.targetRef.id + this.suffix\r\n        );\r\n        const waypoints = element.waypoints.map((waypoint) =>\r\n          this.translatePoint(waypoint)\r\n        );\r\n        const flowBusinessObject = this.currentBpmnFactory.create(\r\n          connection.$type,\r\n          {\r\n            id: connection.id + this.suffix,\r\n            name: connection.name,\r\n          }\r\n        );\r\n        const flowElement = this.currentElementFactory.createConnection({\r\n          type: element.type,\r\n          businessObject: flowBusinessObject,\r\n          waypoints,\r\n        });\r\n        this.currentModeling.createConnection(\r\n          source,\r\n          target,\r\n          flowElement,\r\n          subProcess\r\n        );\r\n        if (flowElement.label) {\r\n          this.currentModeling.updateLabel(flowElement, connection.name, {\r\n            ...this.translatePoint(element.label),\r\n            height: element.label.height,\r\n            width: element.label.width,\r\n          });\r\n        }\r\n      });\r\n  }\r\n}\r\n\r\nclass BpmnInsertOperation extends BpmnAppendOperation {\r\n  private readonly insertElement;\r\n\r\n  constructor(current: BpmnModeler, append: BpmnModeler, insertElement) {\r\n    super(current, append);\r\n    this.insertElement = insertElement;\r\n  }\r\n\r\n  init() {\r\n    super.init();\r\n    this.calculateProcessPoint();\r\n  }\r\n\r\n  private calculateProcessPoint() {\r\n    const mid = center(this.insertElement);\r\n    this.processPoint = {\r\n      x: mid.x - this.processSize.width / 2,\r\n      y: mid.y - this.processSize.height / 2,\r\n    };\r\n  }\r\n\r\n  insert(processName: string, processPatternId: string) {\r\n    const subprocess = this.insertSubProcess(processName, processPatternId);\r\n    this.appendNodes(subprocess);\r\n    this.connectNodes(subprocess);\r\n  }\r\n\r\n  private insertSubProcess(processName: string, processPatternId: string) {\r\n    this.createSpace();\r\n    const subprocess = this.createSubProcess(\r\n      processName,\r\n      processPatternId,\r\n      this.insertElement.parent\r\n    );\r\n    this.insertElement.incoming.forEach((flow) =>\r\n      this.reconnect(flow.source, subprocess, flow)\r\n    );\r\n    this.insertElement.outgoing.forEach((flow) =>\r\n      this.reconnect(subprocess, flow.target, flow)\r\n    );\r\n    this.currentModeling.removeElements([\r\n      ...this.insertElement.incoming,\r\n      ...this.insertElement.outgoing,\r\n      this.insertElement,\r\n    ]);\r\n    return subprocess;\r\n  }\r\n\r\n  createSubProcess(name: string, processPatternId: string, parent): any {\r\n    const subprocess = super.createSubProcess(name, processPatternId, parent);\r\n    this.copyBpmnData(this.insertElement, subprocess);\r\n    this.currentModeling.updateProperties(subprocess, {\r\n      taskName: this.insertElement.businessObject.name,\r\n    });\r\n    return subprocess;\r\n  }\r\n\r\n  private createSpace() {\r\n    const delta = {\r\n      x: (this.processSize.width - this.insertElement.width) / 2,\r\n      y: (this.processSize.height - this.insertElement.height) / 2,\r\n    };\r\n    const innerSubProcesses = this.getParents();\r\n    const leftRightCheck =\r\n      this.checkLeftSpace(innerSubProcesses) ||\r\n      this.checkRightSpace(innerSubProcesses);\r\n    const topBottomCheck =\r\n      this.checkTopSpace(innerSubProcesses) ||\r\n      this.checkBottomSpace(innerSubProcesses);\r\n    const completeSpaceCheck = this.checkCompleteSpace(innerSubProcesses);\r\n    if (leftRightCheck || (completeSpaceCheck && !topBottomCheck)) {\r\n      this.createLeftSpace(innerSubProcesses, delta.x);\r\n      this.createRightSpace(innerSubProcesses, delta.x);\r\n    }\r\n    if (topBottomCheck) {\r\n      this.createTopSpace(innerSubProcesses, delta.y);\r\n      this.createBottomSpace(innerSubProcesses, delta.y);\r\n    }\r\n  }\r\n\r\n  private checkLeftSpace(innerSubProcesses) {\r\n    const condition = (element) =>\r\n      element.x + element.width < this.processPoint.x ||\r\n      element.x > this.insertElement.x ||\r\n      element.y + element.height < this.insertElement.y ||\r\n      element.y > this.insertElement.y + this.insertElement.height;\r\n    return (\r\n      this.checkSpace(condition, innerSubProcesses) ||\r\n      this.insertElement.parent.x > this.processPoint.x\r\n    );\r\n  }\r\n\r\n  private checkRightSpace(innerSubProcesses) {\r\n    const condition = (element) =>\r\n      element.x + element.width <\r\n        this.insertElement.x + this.insertElement.width ||\r\n      element.x > this.processPoint.x + this.processSize.width ||\r\n      element.y + element.height < this.insertElement.y ||\r\n      element.y > this.insertElement.y + this.insertElement.height;\r\n    return (\r\n      this.checkSpace(condition, innerSubProcesses) ||\r\n      this.insertElement.parent.x + this.insertElement.parent.width <\r\n        this.processPoint.x + this.processSize.width\r\n    );\r\n  }\r\n\r\n  private checkTopSpace(innerSubProcesses) {\r\n    const condition = (element) =>\r\n      element.x + element.width < this.insertElement.x ||\r\n      element.x > this.insertElement.x + this.insertElement.width ||\r\n      element.y + element.height < this.processPoint.y ||\r\n      element.y > this.insertElement.y;\r\n    return (\r\n      this.checkSpace(condition, innerSubProcesses) ||\r\n      this.insertElement.parent.y > this.processPoint.y\r\n    );\r\n  }\r\n\r\n  private checkBottomSpace(innerSubProcesses) {\r\n    const condition = (element) =>\r\n      element.x + element.width < this.insertElement.x ||\r\n      element.x > this.insertElement.x + this.insertElement.width ||\r\n      element.y + element.height <\r\n        this.insertElement.y + this.insertElement.height ||\r\n      element.y > this.processPoint.y + this.processSize.height;\r\n    return (\r\n      this.checkSpace(condition, innerSubProcesses) ||\r\n      this.insertElement.parent.y + this.insertElement.parent.height <\r\n        this.processPoint.y + this.processSize.height\r\n    );\r\n  }\r\n\r\n  private checkCompleteSpace(innerSubProcesses) {\r\n    const condition = (element) =>\r\n      element.x + element.width < this.processPoint.x ||\r\n      element.x > this.processPoint.x + this.processSize.width ||\r\n      element.y + element.height < this.processPoint.y ||\r\n      element.y > this.processPoint.y + this.processSize.height;\r\n    return this.checkSpace(condition, innerSubProcesses);\r\n  }\r\n\r\n  private checkSpace(condition: (element) => boolean, innerSubProcesses) {\r\n    const elements = this.currentElementRegistry.filter(\r\n      (element) =>\r\n        element.id !== this.insertElement.id &&\r\n        !is(element, 'bpmn:Process') &&\r\n        !innerSubProcesses.includes(element)\r\n    );\r\n    const waypointsToLines = (waypoints) => {\r\n      const lines = [];\r\n      for (let i = 0; i < waypoints.length - 1; ++i) {\r\n        lines.push({\r\n          x: Math.min(waypoints[i].x, waypoints[i + 1].x),\r\n          y: Math.min(waypoints[i].y, waypoints[i + 1].y),\r\n          width: Math.abs(waypoints[i + 1].x - waypoints[i].x),\r\n          height: Math.abs(waypoints[i + 1].y - waypoints[i].y),\r\n        });\r\n      }\r\n      return lines;\r\n    };\r\n    return (\r\n      elements.some((element) => !element.waypoints && !condition(element)) ||\r\n      elements.some(\r\n        (element) =>\r\n          element.waypoints &&\r\n          element.source !== this.insertElement &&\r\n          element.target !== this.insertElement &&\r\n          waypointsToLines(element.waypoints).some((line) => !condition(line))\r\n      )\r\n    );\r\n  }\r\n\r\n  private createLeftSpace(innerSubProcesses, xDelta: number) {\r\n    this.createSpaceDirection(\r\n      innerSubProcesses,\r\n      this.insertElement.x,\r\n      'e',\r\n      xDelta\r\n    );\r\n    this.processPoint = {\r\n      x: this.processPoint.x + xDelta,\r\n      y: this.processPoint.y,\r\n    };\r\n  }\r\n\r\n  private createRightSpace(innerSubProcesses, xDelta: number) {\r\n    this.createSpaceDirection(\r\n      innerSubProcesses,\r\n      this.insertElement.x + this.insertElement.width,\r\n      'e',\r\n      xDelta\r\n    );\r\n  }\r\n\r\n  private createTopSpace(innerSubProcesses, yDelta: number) {\r\n    this.createSpaceDirection(\r\n      innerSubProcesses,\r\n      this.insertElement.y,\r\n      's',\r\n      yDelta\r\n    );\r\n    this.processPoint = {\r\n      x: this.processPoint.x,\r\n      y: this.processPoint.y + yDelta,\r\n    };\r\n  }\r\n\r\n  private createBottomSpace(innerSubProcesses, yDelta: number) {\r\n    this.createSpaceDirection(\r\n      innerSubProcesses,\r\n      this.insertElement.y + this.insertElement.height,\r\n      's',\r\n      yDelta\r\n    );\r\n  }\r\n\r\n  private createSpaceDirection(\r\n    innerSubProcesses,\r\n    from: number,\r\n    direction: 'e' | 's',\r\n    delta: number\r\n  ) {\r\n    const elements = this.currentElementRegistry.filter(\r\n      (element) =>\r\n        (direction === 'e' ? element.x : element.y) >= from &&\r\n        (innerSubProcesses.includes(element.parent) ||\r\n          is(element.parent, 'bpmn:Process')) &&\r\n        !innerSubProcesses.includes(element)\r\n    );\r\n    const toMove = selfAndChildren(elements, true, -1);\r\n    this.currentModeling.createSpace(\r\n      toMove,\r\n      innerSubProcesses,\r\n      { x: direction === 'e' ? delta : 0, y: direction === 's' ? delta : 0 },\r\n      direction,\r\n      from\r\n    );\r\n  }\r\n\r\n  private getParents(): any[] {\r\n    const parents = [];\r\n    for (\r\n      let parent = this.insertElement.parent;\r\n      !is(parent, 'bpmn:Process');\r\n      parent = parent.parent\r\n    ) {\r\n      parents.push(parent);\r\n    }\r\n    return parents;\r\n  }\r\n}\r\n\r\nclass BpmnRemoveOperation extends BpmnOperation {\r\n  private readonly subprocess;\r\n\r\n  constructor(current: BpmnModeler, subprocess) {\r\n    super(current);\r\n    this.subprocess = subprocess;\r\n  }\r\n\r\n  remove() {\r\n    const activity = this.createActivity();\r\n    this.reconnectActivity(activity);\r\n    this.removeSubprocess();\r\n  }\r\n\r\n  private createActivity() {\r\n    const bmBusinessObject = this.currentBpmnFactory.create(\r\n      'bpmn:CallActivity',\r\n      { name: this.subprocess.businessObject.get('taskName') }\r\n    );\r\n    const bmElement = this.currentElementFactory.createShape({\r\n      type: 'bpmn:CallActivity',\r\n      businessObject: bmBusinessObject,\r\n    });\r\n    const activity = this.currentModeling.createShape(\r\n      bmElement,\r\n      center(this.subprocess),\r\n      this.subprocess.parent\r\n    );\r\n    this.copyBpmnData(this.subprocess, activity);\r\n    return activity;\r\n  }\r\n\r\n  private reconnectActivity(activity) {\r\n    this.subprocess.incoming.forEach((flow) =>\r\n      this.reconnect(flow.source, activity, flow)\r\n    );\r\n    this.subprocess.outgoing.forEach((flow) =>\r\n      this.reconnect(activity, flow.target, flow)\r\n    );\r\n  }\r\n\r\n  private removeSubprocess() {\r\n    this.currentModeling.removeElements([\r\n      ...this.subprocess.incoming,\r\n      ...this.subprocess.outgoing,\r\n      this.subprocess,\r\n    ]);\r\n  }\r\n}\r\n\r\nclass BpmnAttachOperation extends BpmnAppendOperation {\r\n  private readonly attachmentElement;\r\n\r\n  constructor(current: BpmnModeler, append: BpmnModeler, attachmentElement) {\r\n    super(current, append);\r\n    this.attachmentElement = attachmentElement;\r\n  }\r\n\r\n  init() {\r\n    super.init();\r\n    this.calculateProcessPoint();\r\n  }\r\n\r\n  private calculateProcessPoint() {\r\n    const point = center(this.attachmentElement);\r\n    this.processPoint = {\r\n      x: this.attachmentElement.x + this.attachmentElement.width + 50,\r\n      y: point.y - this.processSize.height / 2,\r\n    };\r\n  }\r\n\r\n  attach(processName: string, processPatternId: string) {\r\n    const subprocess = this.appendSubProcess(processName, processPatternId);\r\n    this.appendNodes(subprocess);\r\n    this.connectNodes(subprocess);\r\n  }\r\n\r\n  private appendSubProcess(processName: string, processPatternId: string) {\r\n    const subprocess = this.createSubProcess(\r\n      processName,\r\n      processPatternId,\r\n      this.attachmentElement.parent\r\n    );\r\n    this.currentModeling.createConnection(\r\n      this.attachmentElement,\r\n      subprocess,\r\n      { type: 'bpmn:SequenceFlow' },\r\n      this.attachmentElement.parent\r\n    );\r\n    return subprocess;\r\n  }\r\n}\r\n\r\nclass BpmnCheckArtifacts {\r\n  private readonly elementRegistry;\r\n  private readonly decisions: { [elementId: string]: Decision };\r\n\r\n  private visitedNodes = new Set();\r\n  private artifacts: { [elementId: string]: Artifact[] } = {};\r\n  private currentNodes = [];\r\n\r\n  constructor(\r\n    modeler: BpmnModeler,\r\n    decisions: { [elementId: string]: Decision }\r\n  ) {\r\n    this.elementRegistry = modeler.get('elementRegistry');\r\n    this.decisions = decisions;\r\n  }\r\n\r\n  checkArtifacts(): { [elementId: string]: Artifact[] | null } {\r\n    const missingMap = {};\r\n    const startingElement = this.elementRegistry.find(\r\n      (element) =>\r\n        is(element, 'bpmn:StartEvent') && is(element.parent, 'bpmn:Process')\r\n    );\r\n    this.currentNodes.push(startingElement);\r\n    while (this.currentNodes.length > 0) {\r\n      const currentNode = this.currentNodes[0];\r\n      this.currentNodes.splice(0, 1);\r\n      let incomingArtifacts;\r\n      if (is(currentNode, 'bpmn:ParallelGateway')) {\r\n        incomingArtifacts = this.getIncomingArtifactsUnion(currentNode);\r\n        if (incomingArtifacts === null) {\r\n          continue;\r\n        }\r\n      } else if (is(currentNode, 'bpmn:ExclusiveGateway')) {\r\n        incomingArtifacts = this.getIncomingArtifactsIntersect(currentNode);\r\n      } else {\r\n        incomingArtifacts = this.getIncomingArtifacts(currentNode);\r\n      }\r\n      this.visitedNodes.add(currentNode);\r\n      const incomingArtifactIds = incomingArtifacts.map(\r\n        (artifact) => artifact._id\r\n      );\r\n      const neededArtifacts = this.getNeededArtifacts(currentNode);\r\n      const missing = neededArtifacts.filter(\r\n        (artifact) => !incomingArtifactIds.includes(artifact._id)\r\n      );\r\n      if (missing.length > 0 || currentNode.id in missingMap) {\r\n        missingMap[currentNode.id] = missing;\r\n      }\r\n      const previousArtifactIds =\r\n        currentNode.id in this.artifacts\r\n          ? this.artifacts[currentNode.id].map((artifact) => artifact._id)\r\n          : null;\r\n      this.artifacts[currentNode.id] = [\r\n        ...incomingArtifacts,\r\n        ...this.getCreatedArtifacts(currentNode),\r\n      ];\r\n      const currentArtifactIds = this.artifacts[currentNode.id].map(\r\n        (artifact) => artifact._id\r\n      );\r\n      if (previousArtifactIds) {\r\n        const unchanged =\r\n          currentArtifactIds.every((id) => previousArtifactIds.includes(id)) &&\r\n          previousArtifactIds.every((id) => currentArtifactIds.includes(id));\r\n        if (unchanged) {\r\n          continue;\r\n        }\r\n      }\r\n      this.currentNodes.push(...this.getTargets(currentNode));\r\n    }\r\n    this.elementRegistry\r\n      .getAll()\r\n      .filter(\r\n        (element) =>\r\n          is(element, 'bpmn:FlowNode') &&\r\n          !this.visitedNodes.has(element) &&\r\n          !is(element, 'bpmn:SubProcess')\r\n      )\r\n      .forEach((element) => (missingMap[element.id] = null));\r\n    return missingMap;\r\n  }\r\n\r\n  getNeededArtifacts(element): Artifact[] {\r\n    return this.getDecisionArtifacts(element, true);\r\n  }\r\n\r\n  getCreatedArtifacts(element): Artifact[] {\r\n    return this.getDecisionArtifacts(element, false);\r\n  }\r\n\r\n  getDecisionArtifacts(element, input = false): Artifact[] {\r\n    if (element.id in this.decisions) {\r\n      const artifacts: Artifact[] = [];\r\n      const decision = this.decisions[element.id];\r\n      const decisionArtifacts = input\r\n        ? decision.inputArtifacts\r\n        : decision.outputArtifacts;\r\n      if (\r\n        decisionArtifacts.selectedGroup === null ||\r\n        decisionArtifacts.selectedGroup === undefined\r\n      ) {\r\n        return [];\r\n      }\r\n      const method = decision.method;\r\n      const group = input\r\n        ? method.inputArtifacts[decisionArtifacts.selectedGroup]\r\n        : method.outputArtifacts[decisionArtifacts.selectedGroup];\r\n      group.forEach((selection, index) => {\r\n        if (selection.element) {\r\n          artifacts.push(selection.element);\r\n        } else {\r\n          artifacts.push(...decisionArtifacts.elements[index].filter((e) => e));\r\n        }\r\n      });\r\n      return artifacts;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getIncomingArtifactsUnion(element): Artifact[] {\r\n    const artifacts: Artifact[] = [];\r\n    const sources = this.getSources(element);\r\n    if (sources.some((source) => !(source.id in this.artifacts))) {\r\n      return null;\r\n    }\r\n    sources.forEach((source) => artifacts.push(...this.getArtifacts(source)));\r\n    return artifacts;\r\n  }\r\n\r\n  getIncomingArtifactsIntersect(element): Artifact[] {\r\n    const artifacts: Artifact[][] = [];\r\n    const sources = this.getSources(element);\r\n    if (sources.length === 0) {\r\n      return [];\r\n    }\r\n    sources\r\n      .filter((source) => source.id in this.artifacts)\r\n      .forEach((source) => artifacts.push(this.getArtifacts(source)));\r\n    const others: string[][] = artifacts.map((group) =>\r\n      group.map((artifact) => artifact._id)\r\n    );\r\n    others.slice(0, 1);\r\n    let resultingArtifacts: Artifact[] = artifacts[0];\r\n    others.forEach(\r\n      (group) =>\r\n        (resultingArtifacts = resultingArtifacts.filter((artifact) =>\r\n          group.includes(artifact._id)\r\n        ))\r\n    );\r\n    return resultingArtifacts;\r\n  }\r\n\r\n  getIncomingArtifacts(element): Artifact[] {\r\n    const artifacts: Artifact[] = [];\r\n    const sources = this.getSources(element);\r\n    sources.forEach((source) => artifacts.push(...this.getArtifacts(source)));\r\n    return artifacts;\r\n  }\r\n\r\n  getArtifacts(element): Artifact[] {\r\n    if (element.id in this.artifacts) {\r\n      return this.artifacts[element.id];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getSources(element): any[] {\r\n    let node;\r\n    let incomingFlows;\r\n    for (\r\n      node = element, incomingFlows = node.incoming;\r\n      incomingFlows.length === 0;\r\n      node = node.parent, incomingFlows = node.incoming\r\n    ) {\r\n      if (is(node.parent, 'bpmn:Process')) {\r\n        return [];\r\n      }\r\n    }\r\n    return incomingFlows\r\n      .map((flow) => flow.source)\r\n      .map((source) => {\r\n        if (is(source, 'bpmn:SubProcess')) {\r\n          return source.children.find((e) => is(e, 'bpmn:EndEvent'));\r\n        } else {\r\n          return source;\r\n        }\r\n      });\r\n  }\r\n\r\n  getTargets(element): any[] {\r\n    let node;\r\n    let outgoingFlows;\r\n    for (\r\n      node = element, outgoingFlows = node.outgoing;\r\n      outgoingFlows.length === 0;\r\n      node = node.parent, outgoingFlows = node.outgoing\r\n    ) {\r\n      if (is(node.parent, 'bpmn:Process')) {\r\n        return [];\r\n      }\r\n    }\r\n    return outgoingFlows\r\n      .map((flow) => flow.target)\r\n      .map((target) => {\r\n        if (is(target, 'bpmn:SubProcess')) {\r\n          return target.children.find((e) => is(e, 'bpmn:StartEvent'));\r\n        } else {\r\n          return target;\r\n        }\r\n      });\r\n  }\r\n}\r\n\r\nfunction mapTypes(moddle, element: { list: string; element: Type }) {\r\n  return moddle.create('bmdl:Type', {\r\n    list: element.list,\r\n    element: element.element\r\n      ? moddle.create('bmdl:MethodElement', {\r\n          _id: element.element._id,\r\n          name: element.element.name,\r\n        })\r\n      : null,\r\n  });\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { RunningArtifact } from '../../development-process-registry/running-process/running-artifact';\r\nimport { ConcreteArtifactService } from '../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class ConcreteArtifactLoaderService extends ElementLoaderService {\r\n  artifact: RunningArtifact = null;\r\n\r\n  constructor(\r\n    private concreteArtifactService: ConcreteArtifactService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const artifactId = paramMap.get('id');\r\n    this.changesFeed = this.concreteArtifactService\r\n      .getChangesFeed(artifactId)\r\n      .subscribe(() => this.loadArtifact(artifactId));\r\n    void this.loadArtifact(artifactId);\r\n  }\r\n\r\n  private async loadArtifact(artifactId: string): Promise<void> {\r\n    this.artifact = await this.concreteArtifactService.get(artifactId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { DevelopmentMethod } from '../../development-process-registry/development-method/development-method';\r\nimport { DevelopmentMethodService } from '../../development-process-registry/development-method/development-method.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class DevelopmentMethodLoaderService extends ElementLoaderService {\r\n  developmentMethod: DevelopmentMethod = null;\r\n\r\n  constructor(\r\n    private developmentMethodService: DevelopmentMethodService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const developmentMethodId = paramMap.get('id');\r\n    this.changesFeed = this.developmentMethodService\r\n      .getChangesFeed(developmentMethodId)\r\n      .subscribe(() => this.loadDevelopmentMethod(developmentMethodId));\r\n    void this.loadDevelopmentMethod(developmentMethodId);\r\n  }\r\n\r\n  private async loadDevelopmentMethod(\r\n    developmentMethodId: string\r\n  ): Promise<void> {\r\n    this.developmentMethod = await this.developmentMethodService.get(\r\n      developmentMethodId\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  CanDeactivate,\r\n  RouterStateSnapshot,\r\n} from '@angular/router';\r\nimport { DiagramComponentInterface } from './diagram-component-interface';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ConfirmLeaveModalComponent } from '../confirm-leave-modal/confirm-leave-modal.component';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class DiagramChangeGuard\r\n  implements CanDeactivate<DiagramComponentInterface>\r\n{\r\n  constructor(private modalService: NgbModal) {}\r\n\r\n  async canDeactivate(\r\n    component: DiagramComponentInterface,\r\n    currentRoute: ActivatedRouteSnapshot,\r\n    currentState: RouterStateSnapshot,\r\n    nextState?: RouterStateSnapshot\r\n  ): Promise<boolean> {\r\n    const changed = await component.diagramChanged();\r\n    if (changed) {\r\n      const modal = this.modalService.open(ConfirmLeaveModalComponent, {\r\n        size: 'lg',\r\n      });\r\n      try {\r\n        const result = await modal.result;\r\n        if (result) {\r\n          await component.saveDiagram();\r\n        }\r\n        return true;\r\n      } catch {\r\n        return false;\r\n      }\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { Domain } from '../../development-process-registry/knowledge/domain';\r\nimport { DomainService } from '../../development-process-registry/knowledge/domain.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class DomainLoaderService extends ElementLoaderService {\r\n  domain: Domain = null;\r\n\r\n  constructor(private domainService: DomainService, route: ActivatedRoute) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const domainId = paramMap.get('id');\r\n    this.changesFeed = this.domainService\r\n      .getChangesFeed(domainId)\r\n      .subscribe(() => this.loadDomain(domainId));\r\n    void this.loadDomain(domainId);\r\n  }\r\n\r\n  private async loadDomain(domainId: string): Promise<void> {\r\n    this.domain = await this.domainService.get(domainId);\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Module } from '../../development-process-registry/module-api/module';\r\nimport { ExecutionStep } from '../../development-process-registry/development-method/execution-step';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\nimport { ArtifactMapping } from '../../development-process-registry/development-method/artifact-mapping';\r\nimport {\r\n  ArtifactMappingFormService,\r\n  MappingsFormValue,\r\n} from './artifact-mapping-form.service';\r\nimport { ModuleMethod } from '../../development-process-registry/module-api/module-method';\r\n\r\nexport type ExecutionStepsFormValue = ExecutionStepFormValue[];\r\n\r\nexport interface ExecutionStepFormValue {\r\n  module: Module;\r\n  method: ModuleMethod;\r\n  outputMappings: MappingsFormValue[];\r\n  predefinedInput: any;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ExecutionStepsFormService {\r\n  constructor(\r\n    private artifactMappingService: ArtifactMappingFormService,\r\n    private fb: FormBuilder,\r\n    private moduleService: ModuleService\r\n  ) {}\r\n\r\n  createForm(executionSteps: ExecutionStep[]): FormArray {\r\n    return this.fb.array(\r\n      executionSteps.map((step) => this.createExecutionStepForm(step))\r\n    );\r\n  }\r\n\r\n  createExecutionStepForm(executionStep: ExecutionStep = null): FormGroup {\r\n    let module: Module = null;\r\n    let method = null;\r\n    if (executionStep) {\r\n      module = this.moduleService.getModule(executionStep.module);\r\n      method = module.methods[executionStep.method];\r\n    }\r\n    return this.fb.group({\r\n      module: this.fb.control(module, Validators.required),\r\n      method: this.fb.control(method, Validators.required),\r\n      outputMappings: this.createMappingsForm(\r\n        method,\r\n        executionStep ? executionStep.outputMappings : null\r\n      ),\r\n      predefinedInput: this.createPredefinedInputForm(\r\n        method,\r\n        executionStep ? executionStep.predefinedInput : null\r\n      ),\r\n    });\r\n  }\r\n\r\n  createMappingsForm(\r\n    method: ModuleMethod,\r\n    outputMappings: ArtifactMapping[][]\r\n  ): FormArray {\r\n    let outputs = [];\r\n    if (method) {\r\n      outputs = method.output.map((output, index) => {\r\n        let mappings = [];\r\n        if (outputMappings && index < outputMappings.length) {\r\n          mappings = outputMappings[index];\r\n        }\r\n        return this.artifactMappingService.createMappingsForm(mappings);\r\n      });\r\n    }\r\n    return this.fb.array(outputs);\r\n  }\r\n\r\n  createPredefinedInputForm(\r\n    method: ModuleMethod,\r\n    predefinedInput: any\r\n  ): FormGroup {\r\n    if (method != null && method.createConfigurationForm != null) {\r\n      return method.createConfigurationForm(predefinedInput);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Add an execution step to the form.\r\n   *\r\n   * @param executionStepForm the execution step form\r\n   */\r\n  addExecutionStep(executionStepForm: FormArray): void {\r\n    executionStepForm.push(this.createExecutionStepForm());\r\n  }\r\n\r\n  /**\r\n   * Called if the method of an execution step has changed.\r\n   *\r\n   * @param executionStepForm the execution step form\r\n   * @param step the index of the step to remove\r\n   */\r\n  executionStepMethodChange(executionStepForm: FormArray, step: number): void {\r\n    executionStepForm.controls.forEach((control) => {\r\n      const outputMappings = control.get('outputMappings') as FormArray;\r\n      outputMappings.controls.forEach((control: FormArray) => {\r\n        this.artifactMappingService.resetMappingTo(control, step);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Remove an execution step from the form and remove all mappings to it.\r\n   *\r\n   * @param executionStepForm the execution step form\r\n   * @param step the index of the step to remove\r\n   */\r\n  removeExecutionStep(executionStepForm: FormArray, step: number): void {\r\n    executionStepForm.controls.forEach((control) => {\r\n      const outputMappings = control.get('outputMappings') as FormArray;\r\n      outputMappings.controls.forEach((control: FormArray) => {\r\n        this.artifactMappingService.removeMappingTo(control, step);\r\n      });\r\n    });\r\n    executionStepForm.removeAt(step);\r\n  }\r\n\r\n  getExecutionSteps(form: ExecutionStepsFormValue): ExecutionStep[] {\r\n    return form.map(\r\n      (step) =>\r\n        new ExecutionStep(undefined, {\r\n          module: step.module ? step.module.name : null,\r\n          method: step.method ? step.method.name : null,\r\n          outputMappings: step.outputMappings.map((output) =>\r\n            this.artifactMappingService.getMappings(output)\r\n          ),\r\n          predefinedInput: step.predefinedInput,\r\n        })\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport {\r\n  MethodElement,\r\n  MethodElementInit,\r\n} from '../../development-process-registry/method-elements/method-element';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class MethodElementLoaderService<\r\n  T extends MethodElement,\r\n  S extends MethodElementInit\r\n> extends ElementLoaderService {\r\n  methodElement: T = null;\r\n  listNames: string[] = [];\r\n\r\n  constructor(\r\n    private methodElementService: MethodElementService<T, S>,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const methodElementId = paramMap.get('id');\r\n    this.changesFeed = this.methodElementService\r\n      .getChangesFeed(methodElementId)\r\n      .subscribe(() => this.loadMethodElement(methodElementId));\r\n    void this.loadMethodElement(methodElementId);\r\n  }\r\n\r\n  private async loadMethodElement(methodElementId: string): Promise<void> {\r\n    this.methodElement = await this.methodElementService.get(methodElementId);\r\n    this.listNames = (await this.methodElementService.getLists()).map(\r\n      (list) => list.listName\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup } from '@angular/forms';\r\nimport { ExecutionStep } from '../../development-process-registry/development-method/execution-step';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class MethodInfoStepsFormService {\r\n  constructor(private fb: FormBuilder, private moduleService: ModuleService) {}\r\n\r\n  createForm(executionSteps: ExecutionStep[], stepDecisions: any[]): FormArray {\r\n    return this.fb.array(\r\n      stepDecisions.map((step, index) =>\r\n        this.createStepDecisionForm(executionSteps[index], step)\r\n      )\r\n    );\r\n  }\r\n\r\n  createStepDecisionForm(\r\n    executionStep: ExecutionStep,\r\n    stepDecision: any\r\n  ): FormGroup {\r\n    const method = this.moduleService.getModuleMethod(\r\n      executionStep.module,\r\n      executionStep.method\r\n    );\r\n    if (method != null && method.createDecisionConfigurationForm != null) {\r\n      return method.createDecisionConfigurationForm(stepDecision);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  getStepDecisions(form: any[]): any[] {\r\n    return form;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Artifact } from '../../development-process-registry/method-elements/artifact/artifact';\r\nimport { ArtifactDataType } from '../../development-process-registry/running-process/artifact-data';\r\nimport { OutputArtifactMapping } from '../../development-process-registry/running-process/output-artifact-mapping';\r\n\r\nexport interface OutputArtifactMappingFormValue {\r\n  isDefinition: boolean;\r\n  artifact?: number;\r\n  artifactName?: string;\r\n  data: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class OutputArtifactMappingFormService {\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  createForm(\r\n    artifacts: Artifact[],\r\n    outputArtifacts?: OutputArtifactMapping[]\r\n  ): FormGroup {\r\n    const form = this.fb.group({\r\n      outputArtifacts: this.fb.array([]),\r\n    });\r\n    let formGroups: FormGroup[];\r\n    if (outputArtifacts != null) {\r\n      formGroups = artifacts.map((artifact, index) =>\r\n        this.createOutputArtifactMappingControl(outputArtifacts[index])\r\n      );\r\n    } else {\r\n      formGroups = artifacts.map(() =>\r\n        this.createOutputArtifactMappingControl()\r\n      );\r\n    }\r\n    form.setControl('outputArtifacts', this.fb.array(formGroups));\r\n    return form;\r\n  }\r\n\r\n  createOutputArtifactMappingControl(\r\n    outputArtifact?: OutputArtifactMapping\r\n  ): FormGroup {\r\n    if (outputArtifact == null) {\r\n      outputArtifact = new OutputArtifactMapping(undefined, {\r\n        isDefinition: false,\r\n        artifact: null,\r\n        artifactName: null,\r\n        data: {\r\n          type: ArtifactDataType.STRING,\r\n          data: '',\r\n        },\r\n      });\r\n    }\r\n    return this.fb.group(\r\n      {\r\n        isDefinition: this.fb.control(\r\n          outputArtifact.isDefinition,\r\n          Validators.required\r\n        ),\r\n        artifact: this.fb.control(outputArtifact.artifact),\r\n        artifactName: this.fb.control(outputArtifact.artifactName),\r\n        data: this.fb.control(\r\n          outputArtifact.data.type === ArtifactDataType.STRING\r\n            ? outputArtifact.data.data\r\n            : ''\r\n        ),\r\n      },\r\n      {\r\n        validators: (group) => {\r\n          if (group.get('isDefinition').value) {\r\n            if (!group.get('artifactName').value) {\r\n              return { requiredName: true };\r\n            } else {\r\n              return null;\r\n            }\r\n          } else {\r\n            if (\r\n              group.get('artifact').value === null ||\r\n              group.get('artifact').value === undefined\r\n            ) {\r\n              return { requiredArtifact: true };\r\n            } else {\r\n              return null;\r\n            }\r\n          }\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  get(formValue: OutputArtifactMappingFormValue[]): OutputArtifactMapping[] {\r\n    return formValue.map((item) => {\r\n      return new OutputArtifactMapping(undefined, {\r\n        isDefinition: item.isDefinition,\r\n        artifact: item.artifact,\r\n        artifactName: item.artifactName,\r\n        data: {\r\n          data: item.data,\r\n          type: ArtifactDataType.STRING,\r\n        },\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { ProcessPattern } from '../../development-process-registry/process-pattern/process-pattern';\r\nimport { ProcessPatternService } from '../../development-process-registry/process-pattern/process-pattern.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable()\r\nexport class ProcessPatternLoaderService extends ElementLoaderService {\r\n  processPattern: ProcessPattern = null;\r\n\r\n  constructor(\r\n    private processPatternService: ProcessPatternService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const processPatternId = paramMap.get('id');\r\n    this.changesFeed = this.processPatternService\r\n      .getChangesFeed(processPatternId)\r\n      .subscribe(() => this.loadProcessPattern(processPatternId));\r\n    void this.loadProcessPattern(processPatternId);\r\n  }\r\n\r\n  private async loadProcessPattern(processPatternId: string): Promise<void> {\r\n    this.processPattern = await this.processPatternService.get(\r\n      processPatternId\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RunningProcessLoaderService } from './running-process-loader.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { RunningMethod } from '../../development-process-registry/running-process/running-method';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\n\r\n@Injectable()\r\nexport class RunningMethodLoaderService extends RunningProcessLoaderService {\r\n  runningMethod: RunningMethod;\r\n  private executionId: string;\r\n\r\n  constructor(\r\n    runningProcessService: RunningProcessService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(runningProcessService, route);\r\n    this.loaded.subscribe(() => this.loadRunningMethod());\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    this.executionId = paramMap.get('executionId');\r\n    super.initParams(paramMap);\r\n  }\r\n\r\n  private loadRunningMethod(): void {\r\n    this.runningMethod = this.runningProcess.getRunningMethod(this.executionId);\r\n    if (this.runningMethod == null) {\r\n      this.runningMethod = null;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { RunningProcessService } from '../../development-process-registry/running-process/running-process.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class RunningProcessLoaderService extends ElementLoaderService {\r\n  runningProcess: RunningProcess;\r\n\r\n  error: boolean;\r\n  errorStatus: number;\r\n  errorReason: string;\r\n\r\n  constructor(\r\n    private runningProcessService: RunningProcessService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const runningProcessId = paramMap.get('id');\r\n    this.changesFeed = this.runningProcessService\r\n      .getChangesFeed(runningProcessId)\r\n      .subscribe(() => this.loadRunningProcess(runningProcessId));\r\n    void this.loadRunningProcess(runningProcessId);\r\n  }\r\n\r\n  private async loadRunningProcess(runningProcessId: string): Promise<void> {\r\n    try {\r\n      this.runningProcess = await this.runningProcessService.get(\r\n        runningProcessId\r\n      );\r\n    } catch (error) {\r\n      this.runningProcess = null;\r\n      this.error = true;\r\n      this.errorStatus = error.status;\r\n      this.errorReason = error.reason;\r\n      console.error(error);\r\n      return;\r\n    }\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","<form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"listName\" class=\"col-sm-4 col-form-label\">List Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        formControlName=\"list\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        id=\"listName\"\r\n        [ngbTypeahead]=\"searchLists\"\r\n        (click)=\"openListInput.next($any($event.target).value)\"\r\n        (focus)=\"openListInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">\r\n      Values<span *ngIf=\"situationalFactor.ordered\"> from low to high</span>\r\n    </h6>\r\n    <div class=\"form-group\" formArrayName=\"values\">\r\n      <app-form-array-list\r\n        elementName=\"Value\"\r\n        [formArray]=\"valuesFormArray\"\r\n        [ordered]=\"situationalFactor.ordered\"\r\n      ></app-form-array-list>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!form.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { SituationalFactorDefinition } from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport { debounceTime, map, tap } from 'rxjs/operators';\r\nimport { equalsListString, getTypeaheadInputPipe } from '../../shared/utils';\r\n\r\n@Component({\r\n  selector: 'app-situational-factor-form',\r\n  templateUrl: './situational-factor-form.component.html',\r\n  styleUrls: ['./situational-factor-form.component.css'],\r\n})\r\nexport class SituationalFactorFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() situationalFactor: SituationalFactorDefinition;\r\n  @Input() listNames: string[];\r\n\r\n  @Output() submitSituationalFactorForm = new EventEmitter<FormGroup>();\r\n\r\n  form: FormGroup = this.fb.group({\r\n    list: ['', Validators.required],\r\n    values: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  openListInput = new Subject<string>();\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.form.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !this.equals(this.situationalFactor, value))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.situationalFactor) {\r\n      const oldSituationalFactor: SituationalFactorDefinition =\r\n        changes.situationalFactor.previousValue;\r\n      const newSituationalFactor: SituationalFactorDefinition =\r\n        changes.situationalFactor.currentValue;\r\n      if (!this.equals(newSituationalFactor, oldSituationalFactor)) {\r\n        this.loadForm(newSituationalFactor);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n    this.openListInput.complete();\r\n  }\r\n\r\n  searchLists = (input: Observable<string>) => {\r\n    return merge(getTypeaheadInputPipe(input), this.openListInput).pipe(\r\n      map((term) =>\r\n        this.listNames\r\n          .filter((listItem) =>\r\n            listItem.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 10)\r\n      )\r\n    );\r\n  };\r\n\r\n  private equals(\r\n    situationalFactorA: SituationalFactorDefinition,\r\n    situationalFactorB: SituationalFactorDefinition\r\n  ) {\r\n    if (situationalFactorA == null && situationalFactorB == null) {\r\n      return true;\r\n    }\r\n    if (situationalFactorA == null || situationalFactorB == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      situationalFactorA.list === situationalFactorB.list &&\r\n      equalsListString(situationalFactorA.values, situationalFactorB.values)\r\n    );\r\n  }\r\n\r\n  private loadForm(situationalFactor: SituationalFactorDefinition) {\r\n    this.form.patchValue(situationalFactor);\r\n    this.valuesFormArray.clear();\r\n    situationalFactor.values.forEach((value, index) =>\r\n      this.valuesFormArray.setControl(\r\n        index,\r\n        this.fb.control(value, Validators.required)\r\n      )\r\n    );\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitSituationalFactorForm.emit(this.form);\r\n  }\r\n\r\n  get valuesFormArray() {\r\n    return this.form.get('values') as FormArray;\r\n  }\r\n}\r\n","<div [formGroup]=\"formGroup\" class=\"form-row\">\r\n  <div class=\"form-group col\">\r\n    <label for=\"listInput\">List</label>\r\n    <input\r\n      type=\"text\"\r\n      formControlName=\"list\"\r\n      class=\"form-control\"\r\n      [class.is-invalid]=\"listControl.invalid\"\r\n      id=\"listInput\"\r\n      aria-describedby=\"listInputFeedback\"\r\n      [ngbTypeahead]=\"searchLists\"\r\n      (click)=\"openListInput.next($any($event.target).value)\"\r\n      (focus)=\"openListInput.next($any($event.target).value)\"\r\n    />\r\n    <div id=\"listInputFeedback\" class=\"invalid-feedback\">\r\n      <span *ngIf=\"listControl.hasError('required')\"\r\n        >This field is required.</span\r\n      >\r\n    </div>\r\n  </div>\r\n  <ng-container formGroupName=\"element\">\r\n    <div class=\"form-group col\">\r\n      <label for=\"elementInput\">Situational Factor</label>\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"factor\"\r\n        class=\"form-control\"\r\n        id=\"elementInput\"\r\n        [ngbTypeahead]=\"searchElements\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (selectItem)=\"selectFactor($event)\"\r\n        (click)=\"openElementInput.next($any($event.target).value)\"\r\n        (focus)=\"openElementInput.next($any($event.target).value)\"\r\n      />\r\n    </div>\r\n    <div class=\"form-group col\">\r\n      <label for=\"factorValue\">Value</label>\r\n      <div class=\"input-group\">\r\n        <select class=\"form-control\" formControlName=\"value\" id=\"factorValue\">\r\n          <option *ngFor=\"let value of values\" [ngValue]=\"value\">\r\n            {{ value }}\r\n          </option>\r\n        </select>\r\n        <div class=\"input-group-append\">\r\n          <button\r\n            (click)=\"remove.emit()\"\r\n            class=\"btn btn-secondary align-self-baseline\"\r\n            type=\"button\"\r\n          >\r\n            Remove\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </ng-container>\r\n</div>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n} from '@angular/core';\r\nimport { merge, Observable, Subject, Subscription } from 'rxjs';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  FormGroupDirective,\r\n} from '@angular/forms';\r\nimport { filter, map, tap } from 'rxjs/operators';\r\nimport {\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionEntry,\r\n} from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\nimport { getTypeaheadInputPipe } from '../../shared/utils';\r\nimport { NgbTypeaheadSelectItemEvent } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-situational-factor-selection-form',\r\n  templateUrl: './situational-factor-selection-form.component.html',\r\n  styleUrls: ['./situational-factor-selection-form.component.css'],\r\n})\r\nexport class SituationalFactorSelectionFormComponent\r\n  implements OnInit, OnDestroy\r\n{\r\n  @Input() methodElements: SituationalFactorDefinitionEntry[];\r\n  @Input() listNames: string[];\r\n\r\n  @Output() remove = new EventEmitter<void>();\r\n\r\n  private listChangeSubscription: Subscription;\r\n  private factorChangeSubscription: Subscription;\r\n\r\n  openListInput = new Subject<string>();\r\n  openElementInput = new Subject<string>();\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private formGroupDirective: FormGroupDirective\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.listChangeSubscription = this.listControl.valueChanges\r\n      .pipe(\r\n        filter(\r\n          (value) =>\r\n            this.factorControl.value && this.factorControl.value.list !== value\r\n        ),\r\n        tap(() =>\r\n          this.elementControl.setValue({\r\n            factor: null,\r\n            value: null,\r\n          })\r\n        )\r\n      )\r\n      .subscribe();\r\n    this.factorChangeSubscription = this.factorControl.valueChanges\r\n      .pipe(\r\n        tap(() => this.valueControl.setValue(null)),\r\n        filter((value) => value && this.listControl.value !== value.list),\r\n        tap((value) => this.listControl.setValue(value.list))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.listChangeSubscription) {\r\n      this.listChangeSubscription.unsubscribe();\r\n    }\r\n    if (this.factorChangeSubscription) {\r\n      this.factorChangeSubscription.unsubscribe();\r\n    }\r\n    this.openListInput.complete();\r\n    this.openElementInput.complete();\r\n  }\r\n\r\n  searchLists = (input: Observable<string>): Observable<string[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openListInput).pipe(\r\n      map((term) =>\r\n        this.listNames\r\n          .filter((listItem) =>\r\n            listItem.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  searchElements = (\r\n    input: Observable<string>\r\n  ): Observable<SituationalFactorDefinitionEntry[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openElementInput).pipe(\r\n      map((term) =>\r\n        this.methodElements\r\n          .filter(\r\n            (methodElement) =>\r\n              (!this.listControl.value ||\r\n                methodElement.list.toLowerCase() ===\r\n                  this.listControl.value.toLowerCase()) &&\r\n              methodElement.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  selectFactor(\r\n    event: NgbTypeaheadSelectItemEvent<SituationalFactorDefinitionEntry>\r\n  ): void {\r\n    event.preventDefault();\r\n    this.factorControl.setValue(\r\n      new SituationalFactorDefinition(event.item, undefined)\r\n    );\r\n  }\r\n\r\n  get values(): string[] {\r\n    if (this.factorValue == null) {\r\n      return [];\r\n    }\r\n    return this.factorValue.values;\r\n  }\r\n\r\n  formatter(x: { name: string }): string {\r\n    return x.name;\r\n  }\r\n\r\n  get listControl(): FormControl {\r\n    return this.formGroup.get('list') as FormControl;\r\n  }\r\n\r\n  get elementControl(): FormControl {\r\n    return this.formGroup.get('element') as FormControl;\r\n  }\r\n\r\n  get factorControl(): FormControl {\r\n    return this.elementControl.get('factor') as FormControl;\r\n  }\r\n\r\n  get factorValue(): SituationalFactorDefinition | undefined {\r\n    return this.factorControl.value;\r\n  }\r\n\r\n  get valueControl(): FormControl {\r\n    return this.elementControl.get('value') as FormControl;\r\n  }\r\n\r\n  get formGroup(): FormGroup {\r\n    return this.formGroupDirective.control;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"situationalFactor\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{\r\n      situationalFactor.name\r\n    }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"situationalFactor\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Create a situational factor and define its values. Additionally, it is\r\n    possible to specify whether the values are ordered. If the values are\r\n    ordered, a lower value will include the higher values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Situational Factor</h6>\r\n    <div class=\"text-muted\">\r\n      <app-situational-factor-form\r\n        [situationalFactor]=\"situationalFactor\"\r\n        [listNames]=\"listNames\"\r\n        (submitSituationalFactorForm)=\"updateSituationalFactor($event)\"\r\n      ></app-situational-factor-form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Situational Factor Values Ordered\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"orderedForm\">\r\n        <div\r\n          class=\"btn-group btn-group-toggle\"\r\n          ngbRadioGroup\r\n          name=\"ordered\"\r\n          formControlName=\"ordered\"\r\n        >\r\n          <label ngbButtonLabel class=\"btn-primary\">\r\n            <input ngbButton type=\"radio\" [value]=\"false\" /> unordered\r\n          </label>\r\n          <label ngbButtonLabel class=\"btn-primary\">\r\n            <input ngbButton type=\"radio\" [value]=\"true\" /> ordered\r\n          </label>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">\r\n      Situational Factor Description\r\n    </h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-description-form\r\n        [description]=\"situationalFactor.description\"\r\n        (submitDescriptionForm)=\"updateSituationalFactor($event)\"\r\n      ></app-description-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { SituationalFactorService } from '../../development-process-registry/method-elements/situational-factor/situational-factor.service';\r\nimport {\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionInit,\r\n} from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\nimport { MethodElementLoaderService } from '../shared/method-element-loader.service';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\n\r\n@Component({\r\n  selector: 'app-situational-factor',\r\n  templateUrl: './situational-factor.component.html',\r\n  styleUrls: ['./situational-factor.component.css'],\r\n  providers: [\r\n    MethodElementLoaderService,\r\n    { provide: MethodElementService, useExisting: SituationalFactorService },\r\n  ],\r\n})\r\nexport class SituationalFactorComponent implements OnInit, OnDestroy {\r\n  orderedForm: FormGroup = this.fb.group({\r\n    ordered: [false, Validators.required],\r\n  });\r\n\r\n  private orderedSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private situationalFactorLoaderService: MethodElementLoaderService<\r\n      SituationalFactorDefinition,\r\n      SituationalFactorDefinitionInit\r\n    >,\r\n    private situationalFactorService: SituationalFactorService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.situationalFactorLoaderService.loaded.subscribe(() => {\r\n      this.orderedForm.patchValue(this.situationalFactor, { emitEvent: false });\r\n    });\r\n    this.orderedSubscription = this.orderedForm.valueChanges.subscribe(\r\n      (formValue) => this.updateSituationalFactorValue(formValue)\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.orderedSubscription) {\r\n      this.orderedSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async updateSituationalFactor(form: FormGroup): Promise<void> {\r\n    await this.updateSituationalFactorValue(form.value);\r\n  }\r\n\r\n  async updateSituationalFactorValue(value: any): Promise<void> {\r\n    await this.situationalFactorService.update(\r\n      this.situationalFactor._id,\r\n      value\r\n    );\r\n  }\r\n\r\n  get situationalFactor(): SituationalFactorDefinition {\r\n    return this.situationalFactorLoaderService.methodElement;\r\n  }\r\n\r\n  get listNames(): string[] {\r\n    return this.situationalFactorLoaderService.listNames;\r\n  }\r\n}\r\n","<table class=\"table mb-0\">\r\n  <tbody>\r\n    <tr>\r\n      <th scope=\"col\">List</th>\r\n      <th scope=\"col\">Situational Factor</th>\r\n      <th scope=\"col\">Needed Context</th>\r\n      <th scope=\"col\">Provided by Element</th>\r\n      <th scope=\"col\" class=\"text-center\">Fulfilled</th>\r\n    </tr>\r\n    <tr *ngFor=\"let factor of factors\">\r\n      <td>{{ factor.list }}</td>\r\n      <td>{{ factor.name }}</td>\r\n      <td>{{ factor.needed }}</td>\r\n      <td>{{ factor.provided }}</td>\r\n      <td class=\"text-center\">\r\n        <i\r\n          *ngIf=\"factor.fulfills === undefined\"\r\n          class=\"fas fa-question text-muted\"\r\n        ></i>\r\n        <i\r\n          *ngIf=\"factor.fulfills === false\"\r\n          class=\"fas fa-times text-danger\"\r\n        ></i>\r\n        <i\r\n          *ngIf=\"factor.fulfills === true\"\r\n          class=\"fas fa-check text-success\"\r\n        ></i>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { SituationalFactorDefinition } from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\n\r\n@Component({\r\n  selector: 'app-situational-factors-overview',\r\n  templateUrl: './situational-factors-overview.component.html',\r\n  styleUrls: ['./situational-factors-overview.component.css'],\r\n})\r\nexport class SituationalFactorsOverviewComponent implements OnChanges {\r\n  @Input() needed: SituationalFactor[];\r\n  @Input() provided: SituationalFactor[];\r\n\r\n  factors: {\r\n    list: string;\r\n    name: string;\r\n    needed: string;\r\n    provided: string;\r\n    fulfills: boolean | undefined;\r\n  }[] = [];\r\n  factorsMap: { [list: string]: { [name: string]: string } };\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.provided) {\r\n      this.createFactorsMap();\r\n    }\r\n    if (changes.needed || changes.provided) {\r\n      this.calculateFactors();\r\n    }\r\n  }\r\n\r\n  calculateFactors() {\r\n    this.factors = this.needed.map((factor) => {\r\n      const provided = this.getProvidedValue(factor.factor);\r\n      let fulfills: boolean;\r\n      if (provided) {\r\n        if (provided === factor.value) {\r\n          fulfills = true;\r\n        } else {\r\n          if (factor.factor.ordered) {\r\n            fulfills =\r\n              factor.factor.values.indexOf(factor.value) <=\r\n              factor.factor.values.indexOf(provided);\r\n          } else {\r\n            fulfills = false;\r\n          }\r\n        }\r\n      } else {\r\n        fulfills = undefined;\r\n      }\r\n      return {\r\n        list: factor.factor.list,\r\n        name: factor.factor.name,\r\n        needed: factor.value,\r\n        provided: provided ? provided : '-',\r\n        fulfills,\r\n      };\r\n    });\r\n  }\r\n\r\n  private createFactorsMap() {\r\n    this.factorsMap = SituationalFactor.createMap(this.provided);\r\n  }\r\n\r\n  private getProvidedValue(factor: SituationalFactorDefinition) {\r\n    if (factor.list in this.factorsMap) {\r\n      const provided = this.factorsMap[factor.list][factor.name];\r\n      if (provided) {\r\n        return provided;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n}\r\n","<ng-template\r\n  #situationalFactorSelectionForm\r\n  let-remove=\"remove\"\r\n  let-formGroup=\"formGroup\"\r\n  let-index=\"index\"\r\n>\r\n  <app-situational-factor-selection-form\r\n    [formGroup]=\"formGroup\"\r\n    [methodElements]=\"methodElements\"\r\n    [listNames]=\"listNames\"\r\n    (remove)=\"remove(index)\"\r\n  ></app-situational-factor-selection-form>\r\n</ng-template>\r\n\r\n<form [formGroup]=\"situationalFactorsForm\" (ngSubmit)=\"submitForm()\">\r\n  <app-method-elements-selection-form\r\n    class=\"form-group\"\r\n    formArrayName=\"situationalFactors\"\r\n    [createFormGroupFactory]=\"createFormGroupFactory\"\r\n    [listNames]=\"listNames\"\r\n    [methodElementFormTemplate]=\"situationalFactorSelectionForm\"\r\n    [methodElements]=\"methodElements\"\r\n    methodElementName=\"Situational Factor\"\r\n  ></app-method-elements-selection-form>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!situationalFactorsForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { SituationalFactor } from '../../development-process-registry/method-elements/situational-factor/situational-factor';\r\nimport { SituationalFactorDefinitionEntry } from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\nimport { SituationalFactorService } from '../../development-process-registry/method-elements/situational-factor/situational-factor.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { Selection } from '../../development-process-registry/development-method/selection';\r\nimport { equalsList } from '../../shared/utils';\r\n\r\n@Component({\r\n  selector: 'app-situational-factors-selection-form',\r\n  templateUrl: './situational-factors-selection-form.component.html',\r\n  styleUrls: ['./situational-factors-selection-form.component.css'],\r\n})\r\nexport class SituationalFactorsSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() situationalFactors: Selection<SituationalFactor>[];\r\n\r\n  @Output() submitSituationalFactorsForm = new EventEmitter<FormArray>();\r\n\r\n  situationalFactorsForm: FormGroup = this.fb.group({\r\n    situationalFactors: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  methodElements: SituationalFactorDefinitionEntry[] = [];\r\n  listNames: string[] = [];\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private situationalFactorService: SituationalFactorService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadFactors();\r\n    this.changeSubscription = this.situationalFactorsForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !equalsList(\r\n              this.situationalFactors,\r\n              value.situationalFactors\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.situationalFactors) {\r\n      const oldFactors: Selection<SituationalFactor>[] =\r\n        changes.situationalFactors.previousValue;\r\n      const newFactors: Selection<SituationalFactor>[] =\r\n        changes.situationalFactors.currentValue;\r\n      if (!equalsList(oldFactors, newFactors)) {\r\n        this.loadForm(newFactors);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitSituationalFactorsForm.emit(\r\n      this.situationalFactorsForm.get('situationalFactors') as FormArray\r\n    );\r\n  }\r\n\r\n  private loadForm(situationalFactors: Selection<SituationalFactor>[]): void {\r\n    const formGroups = situationalFactors.map((factor) =>\r\n      this.fb.group({\r\n        list: [factor.list, Validators.required],\r\n        element: this.fb.group({\r\n          factor: [factor.element.factor, Validators.required],\r\n          value: [factor.element.value, Validators.required],\r\n        }),\r\n      })\r\n    );\r\n    this.situationalFactorsForm.setControl(\r\n      'situationalFactors',\r\n      this.fb.array(formGroups)\r\n    );\r\n  }\r\n\r\n  private async loadFactors(): Promise<void> {\r\n    this.methodElements = await this.situationalFactorService.getList();\r\n    this.listNames = [\r\n      ...new Set(this.methodElements.map((element) => element.list)),\r\n    ];\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: this.fb.group({\r\n        factor: [null, Validators.required],\r\n        value: [null, Validators.required],\r\n      }),\r\n    });\r\n}\r\n","<ng-template #deleteSituationalFactorModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteSituationalFactor(modalSituationalFactor._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Situational Factor {{ modalSituationalFactor.name }}\r\n    </div>\r\n    You are deleting the situational factor {{ modalSituationalFactor.name }}.\r\n    This can not be undone. This action will not delete the situational factor\r\n    from method building blocks that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Situational Factors</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create situational Factors to use them for the definition of the context and\r\n    in Method Building Blocks\r\n  </div>\r\n\r\n  <app-method-element-list\r\n    listTitle=\"Situational Factors\"\r\n    [elementLists]=\"elementLists\"\r\n    (deleteElement)=\"openDeleteSituationalFactorModal($event)\"\r\n  ></app-method-element-list>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Situational Factor</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-method-element-form\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"addSituationalFactor($event)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { SituationalFactorService } from '../../development-process-registry/method-elements/situational-factor/situational-factor.service';\r\nimport { FormGroup } from '@angular/forms';\r\nimport {\r\n  SituationalFactorDefinition,\r\n  SituationalFactorDefinitionEntry,\r\n} from '../../development-process-registry/method-elements/situational-factor/situational-factor-definition';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-situational-factors',\r\n  templateUrl: './situational-factors.component.html',\r\n  styleUrls: ['./situational-factors.component.css'],\r\n})\r\nexport class SituationalFactorsComponent implements OnInit {\r\n  elementLists: {\r\n    listName: string;\r\n    elements: SituationalFactorDefinitionEntry[];\r\n  }[] = null;\r\n  listNames: string[] = [];\r\n\r\n  modalSituationalFactor: SituationalFactorDefinition;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteSituationalFactorModal', { static: true })\r\n  deleteSituationalFactorModal: unknown;\r\n\r\n  constructor(\r\n    private situationalFactorService: SituationalFactorService,\r\n    private modalService: NgbModal\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadSituationalFactors();\r\n  }\r\n\r\n  private async loadSituationalFactors(): Promise<void> {\r\n    this.elementLists = await this.situationalFactorService.getLists();\r\n    this.listNames = this.elementLists.map((list) => list.listName);\r\n  }\r\n\r\n  openDeleteSituationalFactorModal(\r\n    situationalFactor: SituationalFactorDefinition\r\n  ): void {\r\n    this.modalSituationalFactor = situationalFactor;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteSituationalFactorModal,\r\n      {\r\n        size: 'lg',\r\n      }\r\n    );\r\n  }\r\n\r\n  async deleteSituationalFactor(id: string): Promise<void> {\r\n    await this.situationalFactorService.delete(id);\r\n    await this.loadSituationalFactors();\r\n  }\r\n\r\n  async addSituationalFactor(situationalFactorForm: FormGroup): Promise<void> {\r\n    await this.situationalFactorService.add(situationalFactorForm.value);\r\n    await this.loadSituationalFactors();\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"stakeholder\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ stakeholder.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"stakeholder\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update a Stakeholder and define its values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Stakeholder</h6>\r\n    <div class=\"text-muted\">\r\n      <app-method-element-form\r\n        [methodElement]=\"stakeholder\"\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"updateValue($event.value)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderInit,\r\n} from '../../development-process-registry/method-elements/stakeholder/stakeholder';\r\nimport { StakeholderService } from '../../development-process-registry/method-elements/stakeholder/stakeholder.service';\r\nimport { MethodElementLoaderService } from '../shared/method-element-loader.service';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\n\r\n@Component({\r\n  selector: 'app-stakeholder',\r\n  templateUrl: './stakeholder.component.html',\r\n  styleUrls: ['./stakeholder.component.css'],\r\n  providers: [\r\n    MethodElementLoaderService,\r\n    { provide: MethodElementService, useExisting: StakeholderService },\r\n  ],\r\n})\r\nexport class StakeholderComponent {\r\n  constructor(\r\n    private stakeholderLoaderService: MethodElementLoaderService<\r\n      Stakeholder,\r\n      StakeholderInit\r\n    >,\r\n    private stakeholderService: StakeholderService\r\n  ) {}\r\n\r\n  async updateValue(value: any): Promise<void> {\r\n    await this.stakeholderService.update(this.stakeholder._id, value);\r\n  }\r\n\r\n  get stakeholder(): Stakeholder {\r\n    return this.stakeholderLoaderService.methodElement;\r\n  }\r\n\r\n  get listNames(): string[] {\r\n    return this.stakeholderLoaderService.listNames;\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderEntry,\r\n} from '../../development-process-registry/method-elements/stakeholder/stakeholder';\r\nimport { StakeholderService } from '../../development-process-registry/method-elements/stakeholder/stakeholder.service';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { GroupSelection } from '../../development-process-registry/bm-process/decision';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\n\r\n@Component({\r\n  selector: 'app-stakeholders-group-info',\r\n  templateUrl: './stakeholders-group-info.component.html',\r\n  styleUrls: ['./stakeholders-group-info.component.css'],\r\n})\r\nexport class StakeholdersGroupInfoComponent implements OnInit {\r\n  @Input() groups: MultipleSelection<Stakeholder>[][];\r\n  @Input() selection: GroupSelection<Stakeholder>;\r\n\r\n  @Output() submitGroupsForm = new EventEmitter<FormGroup>();\r\n\r\n  methodElements: StakeholderEntry[] = [];\r\n\r\n  constructor(private stakeholderService: StakeholderService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadMethodElements();\r\n  }\r\n\r\n  private async loadMethodElements(): Promise<void> {\r\n    this.methodElements = await this.stakeholderService.getList();\r\n  }\r\n}\r\n","<app-method-element-group-info\r\n  [groups]=\"groups\"\r\n  [selection]=\"selection\"\r\n  [methodElements]=\"methodElements\"\r\n  methodElementName=\"Stakeholder\"\r\n  (submitGroupsForm)=\"submitGroupsForm.emit($event)\"\r\n></app-method-element-group-info>\r\n","<form [formGroup]=\"stakeholdersForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\" formGroupName=\"stakeholders\">\r\n    <div\r\n      *ngFor=\"\r\n        let control of formArray.controls;\r\n        let index = index;\r\n        let first = first\r\n      \"\r\n      [class.mt-3]=\"!first\"\r\n      class=\"p-3 mb-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Group</h6>\r\n      <app-method-elements-selection-form\r\n        class=\"form-group\"\r\n        formArrayName=\"{{ index }}\"\r\n        [createFormGroupFactory]=\"createFormGroupFactory\"\r\n        [listNames]=\"listNames\"\r\n        [methodElements]=\"methodElements\"\r\n        [multipleAllowed]=\"true\"\r\n        methodElementName=\"Stakeholder\"\r\n      ></app-method-elements-selection-form>\r\n      <div class=\"form-group d-flex\">\r\n        <button\r\n          (click)=\"remove(index)\"\r\n          type=\"button\"\r\n          class=\"btn btn-secondary ml-auto\"\r\n        >\r\n          Remove OR Group\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group d-flex\">\r\n    <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n      Add OR Group\r\n    </button>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!stakeholdersForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderEntry,\r\n} from '../../development-process-registry/method-elements/stakeholder/stakeholder';\r\nimport { StakeholderService } from '../../development-process-registry/method-elements/stakeholder/stakeholder.service';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\nimport { Subscription } from 'rxjs';\r\nimport { equalsListOfLists } from '../../shared/utils';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-stakeholders-selection-form',\r\n  templateUrl: './stakeholders-selection-form.component.html',\r\n  styleUrls: ['./stakeholders-selection-form.component.css'],\r\n})\r\nexport class StakeholdersSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() stakeholders: MultipleSelection<Stakeholder>[][];\r\n\r\n  @Output() submitStakeholdersForm = new EventEmitter<FormArray>();\r\n\r\n  stakeholdersForm: FormGroup = this.fb.group({\r\n    stakeholders: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  methodElements: StakeholderEntry[] = [];\r\n  listNames: string[] = [];\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private stakeholderService: StakeholderService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadStakeholders();\r\n    this.changeSubscription = this.stakeholdersForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !equalsListOfLists(\r\n              this.stakeholders,\r\n              value.stakeholders\r\n            ))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.stakeholders) {\r\n      const oldStakeholderGroups: MultipleSelection<Stakeholder>[][] =\r\n        changes.stakeholders.previousValue;\r\n      const newStakeholderGroups: MultipleSelection<Stakeholder>[][] =\r\n        changes.stakeholders.currentValue;\r\n      if (!equalsListOfLists(oldStakeholderGroups, newStakeholderGroups)) {\r\n        this.loadForm(changes.stakeholders.currentValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  add(): void {\r\n    this.formArray.push(this.fb.array([]));\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitStakeholdersForm.emit(\r\n      this.stakeholdersForm.get('stakeholders') as FormArray\r\n    );\r\n  }\r\n\r\n  private loadForm(stakeholders: MultipleSelection<Stakeholder>[][]): void {\r\n    const formArrays = stakeholders.map((group) =>\r\n      this.fb.array(\r\n        group.map((element) =>\r\n          this.fb.group({\r\n            list: [element.list, Validators.required],\r\n            element: { value: element.element, disabled: element.multiple },\r\n            multiple: element.multiple,\r\n            multipleElements: {\r\n              value: element.multipleElements,\r\n              disabled: element.multiple,\r\n            },\r\n          })\r\n        )\r\n      )\r\n    );\r\n    this.stakeholdersForm.setControl('stakeholders', this.fb.array(formArrays));\r\n  }\r\n\r\n  private async loadStakeholders(): Promise<void> {\r\n    this.methodElements = await this.stakeholderService.getList();\r\n    this.listNames = [\r\n      ...new Set(this.methodElements.map((element) => element.list)),\r\n    ];\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.stakeholdersForm.get('stakeholders') as FormArray;\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: null,\r\n      multiple: false,\r\n      multipleElements: false,\r\n    });\r\n}\r\n","<ng-template #deleteStakeholderModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"delete(modalStakeholder._id); c()\"\r\n  >\r\n    <div modalTitle>Delete Stakeholder {{ modalStakeholder.name }}</div>\r\n    You are deleting the stakeholder {{ modalStakeholder.name }}. This can not\r\n    be undone. This action will not delete the stakeholder from method building\r\n    blocks that are using it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Stakeholders</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Stakeholders to use them for the definition of Method Fragments\r\n  </div>\r\n\r\n  <app-method-element-list\r\n    listTitle=\"Stakeholders\"\r\n    [elementLists]=\"elementLists\"\r\n    (deleteElement)=\"openDeleteStakeholderModal($event)\"\r\n  ></app-method-element-list>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Stakeholder</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-method-element-form\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"add($event)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { StakeholderService } from '../../development-process-registry/method-elements/stakeholder/stakeholder.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  Stakeholder,\r\n  StakeholderEntry,\r\n} from '../../development-process-registry/method-elements/stakeholder/stakeholder';\r\n\r\n@Component({\r\n  selector: 'app-stakeholders',\r\n  templateUrl: './stakeholders.component.html',\r\n  styleUrls: ['./stakeholders.component.css'],\r\n})\r\nexport class StakeholdersComponent implements OnInit {\r\n  elementLists: { listName: string; elements: StakeholderEntry[] }[] = null;\r\n  listNames: string[] = [];\r\n\r\n  modalStakeholder: Stakeholder;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteStakeholderModal', { static: true })\r\n  deleteStakeholderModal: unknown;\r\n\r\n  constructor(\r\n    private modalService: NgbModal,\r\n    private stakeholderService: StakeholderService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.load();\r\n  }\r\n\r\n  private load(): void {\r\n    this.stakeholderService\r\n      .getLists()\r\n      .then((lists) => {\r\n        this.elementLists = lists;\r\n        this.listNames = this.elementLists.map((list) => list.listName);\r\n      })\r\n      .catch((error) => console.log('Load: ' + error));\r\n  }\r\n\r\n  openDeleteStakeholderModal(stakeholder: Stakeholder): void {\r\n    this.modalStakeholder = stakeholder;\r\n    this.modalReference = this.modalService.open(this.deleteStakeholderModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  delete(id: string): void {\r\n    this.stakeholderService\r\n      .delete(id)\r\n      .then(() => this.load())\r\n      .catch((error) => console.log('Delete: ' + error));\r\n  }\r\n\r\n  add(form: FormGroup): void {\r\n    this.stakeholderService\r\n      .add(form.value)\r\n      .then(() => this.load())\r\n      .catch((error) => console.log('Add: ' + error));\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"tool\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ tool.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"tool\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update a Tool and define its values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Tool</h6>\r\n    <div class=\"text-muted\">\r\n      <app-method-element-form\r\n        [methodElement]=\"tool\"\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"updateValue($event.value)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport {\r\n  Tool,\r\n  ToolInit,\r\n} from '../../development-process-registry/method-elements/tool/tool';\r\nimport { ToolService } from '../../development-process-registry/method-elements/tool/tool.service';\r\nimport { MethodElementLoaderService } from '../shared/method-element-loader.service';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\n\r\n@Component({\r\n  selector: 'app-tool',\r\n  templateUrl: './tool.component.html',\r\n  styleUrls: ['./tool.component.css'],\r\n  providers: [\r\n    MethodElementLoaderService,\r\n    { provide: MethodElementService, useExisting: ToolService },\r\n  ],\r\n})\r\nexport class ToolComponent {\r\n  constructor(\r\n    private toolLoaderService: MethodElementLoaderService<Tool, ToolInit>,\r\n    private toolService: ToolService\r\n  ) {}\r\n\r\n  async updateValue(value: any): Promise<void> {\r\n    await this.toolService.update(this.tool._id, value);\r\n  }\r\n\r\n  get tool(): Tool {\r\n    return this.toolLoaderService.methodElement;\r\n  }\r\n\r\n  get listNames(): string[] {\r\n    return this.toolLoaderService.listNames;\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\nimport { GroupSelection } from '../../development-process-registry/bm-process/decision';\r\nimport { FormGroup } from '@angular/forms';\r\nimport {\r\n  Tool,\r\n  ToolEntry,\r\n} from '../../development-process-registry/method-elements/tool/tool';\r\nimport { ToolService } from '../../development-process-registry/method-elements/tool/tool.service';\r\n\r\n@Component({\r\n  selector: 'app-tools-group-info',\r\n  templateUrl: './tools-group-info.component.html',\r\n  styleUrls: ['./tools-group-info.component.css'],\r\n})\r\nexport class ToolsGroupInfoComponent implements OnInit {\r\n  @Input() groups: MultipleSelection<Tool>[][];\r\n  @Input() selection: GroupSelection<Tool>;\r\n\r\n  @Output() submitGroupsForm = new EventEmitter<FormGroup>();\r\n\r\n  methodElements: ToolEntry[] = [];\r\n\r\n  constructor(private toolService: ToolService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadMethodElements();\r\n  }\r\n\r\n  private async loadMethodElements(): Promise<void> {\r\n    this.methodElements = await this.toolService.getList();\r\n  }\r\n}\r\n","<app-method-element-group-info\r\n  [groups]=\"groups\"\r\n  [selection]=\"selection\"\r\n  [methodElements]=\"methodElements\"\r\n  methodElementName=\"Tool\"\r\n  (submitGroupsForm)=\"submitGroupsForm.emit($event)\"\r\n></app-method-element-group-info>\r\n","<form [formGroup]=\"toolsForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\" formGroupName=\"tools\">\r\n    <div\r\n      *ngFor=\"\r\n        let control of formArray.controls;\r\n        let index = index;\r\n        let first = first\r\n      \"\r\n      [class.mt-3]=\"!first\"\r\n      class=\"p-3 mb-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">Group</h6>\r\n      <app-method-elements-selection-form\r\n        class=\"form-group\"\r\n        formArrayName=\"{{ index }}\"\r\n        [createFormGroupFactory]=\"createFormGroupFactory\"\r\n        [listNames]=\"listNames\"\r\n        [methodElements]=\"methodElements\"\r\n        [multipleAllowed]=\"true\"\r\n        methodElementName=\"Tool\"\r\n      ></app-method-elements-selection-form>\r\n      <div class=\"form-group d-flex\">\r\n        <button\r\n          (click)=\"remove(index)\"\r\n          type=\"button\"\r\n          class=\"btn btn-secondary ml-auto\"\r\n        >\r\n          Remove OR Group\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group d-flex\">\r\n    <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n      Add OR Group\r\n    </button>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!toolsForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { ToolService } from '../../development-process-registry/method-elements/tool/tool.service';\r\nimport {\r\n  Tool,\r\n  ToolEntry,\r\n} from '../../development-process-registry/method-elements/tool/tool';\r\nimport { MultipleSelection } from '../../development-process-registry/development-method/multiple-selection';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsListOfLists } from '../../shared/utils';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\n\r\n@Component({\r\n  selector: 'app-tools-selection-form',\r\n  templateUrl: './tools-selection-form.component.html',\r\n  styleUrls: ['./tools-selection-form.component.css'],\r\n})\r\nexport class ToolsSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() tools: MultipleSelection<Tool>[][];\r\n\r\n  @Output() submitToolsForm = new EventEmitter<FormArray>();\r\n\r\n  toolsForm: FormGroup = this.fb.group({\r\n    tools: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  methodElements: ToolEntry[] = [];\r\n  listNames: string[] = [];\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private moduleService: ModuleService,\r\n    private toolService: ToolService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadTools();\r\n    this.changeSubscription = this.toolsForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = !equalsListOfLists(this.tools, value.tools))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.tools) {\r\n      const oldToolGroups: MultipleSelection<Tool>[][] =\r\n        changes.tools.previousValue;\r\n      const newToolGroups: MultipleSelection<Tool>[][] =\r\n        changes.tools.currentValue;\r\n      if (!equalsListOfLists(oldToolGroups, newToolGroups)) {\r\n        this.loadForm(newToolGroups);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  add(): void {\r\n    this.formArray.push(this.fb.array([]));\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitToolsForm.emit(this.toolsForm.get('tools') as FormArray);\r\n  }\r\n\r\n  private loadForm(tools: MultipleSelection<Tool>[][]): void {\r\n    const formArrays = tools.map((group) =>\r\n      this.fb.array(\r\n        group.map((element) =>\r\n          this.fb.group({\r\n            list: [element.list, Validators.required],\r\n            element: { value: element.element, disabled: element.multiple },\r\n            multiple: element.multiple,\r\n            multipleElements: {\r\n              value: element.multipleElements,\r\n              disabled: element.multiple,\r\n            },\r\n          })\r\n        )\r\n      )\r\n    );\r\n    this.toolsForm.setControl('tools', this.fb.array(formArrays));\r\n  }\r\n\r\n  private async loadTools(): Promise<void> {\r\n    const tools = await this.toolService.getList();\r\n    this.methodElements = tools.concat(\r\n      this.moduleService.modules.map((module) => {\r\n        return new Tool(undefined, {\r\n          name: module.name,\r\n          list: module.list,\r\n        }).toDb();\r\n      })\r\n    );\r\n    this.listNames = [\r\n      ...new Set(\r\n        this.methodElements\r\n          .map((element) => element.list)\r\n          .concat(this.moduleService.modules.map((module) => module.list))\r\n      ),\r\n    ];\r\n  }\r\n\r\n  get formArray(): FormArray {\r\n    return this.toolsForm.get('tools') as FormArray;\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: null,\r\n      multiple: false,\r\n      multipleElements: false,\r\n    });\r\n}\r\n","<ng-template #deleteToolModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal (dismiss)=\"d()\" (delete)=\"delete(modalTool._id); c()\">\r\n    <div modalTitle>Delete Tool {{ modalTool.name }}</div>\r\n    You are deleting the tool {{ modalTool.name }}. This can not be undone. This\r\n    action will not delete the tool from method building blocks that are using\r\n    it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Tools</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Tools to use them for the definition of Method Fragments\r\n  </div>\r\n\r\n  <app-method-element-list\r\n    listTitle=\"Tools\"\r\n    [elementLists]=\"elementLists\"\r\n    (deleteElement)=\"openDeleteToolModal($event)\"\r\n  ></app-method-element-list>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Tool</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-method-element-form\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"add($event)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Loaded Modules\"\r\n    [loading]=\"moduleLists == null\"\r\n    [noResults]=\"moduleLists && moduleLists.length === 0\"\r\n  >\r\n    <div noResults>No modules loaded.</div>\r\n    <div\r\n      results\r\n      *ngFor=\"let list of moduleLists\"\r\n      class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n    >\r\n      <h6 class=\"border-bottom border-gray pb-2\">{{ list.listName }}</h6>\r\n      <ul class=\"list-group\">\r\n        <li class=\"list-group-item\" *ngFor=\"let module of list.elements\">\r\n          <h6>{{ module.name }}</h6>\r\n          Methods:\r\n          <ul>\r\n            <li *ngFor=\"let method of module.methodNames\">{{ method }}</li>\r\n          </ul>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </app-list-wrapper>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { ToolService } from '../../development-process-registry/method-elements/tool/tool.service';\r\nimport { ModuleService } from '../../development-process-registry/module-api/module.service';\r\nimport { Module } from '../../development-process-registry/module-api/module';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  Tool,\r\n  ToolEntry,\r\n} from '../../development-process-registry/method-elements/tool/tool';\r\n\r\n@Component({\r\n  selector: 'app-tools',\r\n  templateUrl: './tools.component.html',\r\n  styleUrls: ['./tools.component.css'],\r\n})\r\nexport class ToolsComponent implements OnInit {\r\n  elementLists: { listName: string; elements: ToolEntry[] }[] = null;\r\n  listNames: string[] = [];\r\n\r\n  moduleLists: { listName: string; elements: Module[] }[] = null;\r\n\r\n  modalTool: Tool;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteToolModal', { static: true }) deleteToolModal: unknown;\r\n\r\n  constructor(\r\n    private modalService: NgbModal,\r\n    private moduleService: ModuleService,\r\n    private toolService: ToolService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.load();\r\n    this.moduleLists = this.moduleService.getLists();\r\n  }\r\n\r\n  private load(): void {\r\n    this.toolService\r\n      .getLists()\r\n      .then((lists) => {\r\n        this.elementLists = lists;\r\n        this.listNames = this.elementLists.map((list) => list.listName);\r\n      })\r\n      .catch((error) => console.log('Load: ' + error));\r\n  }\r\n\r\n  openDeleteToolModal(tool: Tool): void {\r\n    this.modalTool = tool;\r\n    this.modalReference = this.modalService.open(this.deleteToolModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  delete(id: string): void {\r\n    this.toolService\r\n      .delete(id)\r\n      .then(() => this.load())\r\n      .catch((error) => console.log('Delete: ' + error));\r\n  }\r\n\r\n  add(form: FormGroup): void {\r\n    this.toolService\r\n      .add(form.value)\r\n      .then(() => this.load())\r\n      .catch((error) => console.log('Add: ' + error));\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"type\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">{{ type.name }}</a>\r\n  </nav>\r\n</div>\r\n\r\n<main class=\"container\" *ngIf=\"type\">\r\n  <div class=\"alert alert-info mt-3\" role=\"alert\">\r\n    Update a Type and define its values.\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Type</h6>\r\n    <div class=\"text-muted\">\r\n      <app-method-element-form\r\n        [methodElement]=\"type\"\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"updateValue($event.value)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport {\r\n  Type,\r\n  TypeInit,\r\n} from '../../development-process-registry/method-elements/type/type';\r\nimport { TypeService } from '../../development-process-registry/method-elements/type/type.service';\r\nimport { MethodElementLoaderService } from '../shared/method-element-loader.service';\r\nimport { MethodElementService } from '../../development-process-registry/method-elements/method-element.service';\r\n\r\n@Component({\r\n  selector: 'app-type',\r\n  templateUrl: './type.component.html',\r\n  styleUrls: ['./type.component.css'],\r\n  providers: [\r\n    MethodElementLoaderService,\r\n    { provide: MethodElementService, useExisting: TypeService },\r\n  ],\r\n})\r\nexport class TypeComponent {\r\n  constructor(\r\n    private typeLoaderService: MethodElementLoaderService<Type, TypeInit>,\r\n    private typeService: TypeService\r\n  ) {}\r\n\r\n  async updateValue(value: any): Promise<void> {\r\n    await this.typeService.update(this.type._id, value);\r\n  }\r\n\r\n  get type(): Type {\r\n    return this.typeLoaderService.methodElement;\r\n  }\r\n\r\n  get listNames(): string[] {\r\n    return this.typeLoaderService.listNames;\r\n  }\r\n}\r\n","<form [formGroup]=\"typesForm\" (ngSubmit)=\"submitForm()\">\r\n  <app-method-elements-selection-form\r\n    class=\"form-group\"\r\n    formArrayName=\"types\"\r\n    [createFormGroupFactory]=\"createFormGroupFactory\"\r\n    [listNames]=\"listNames\"\r\n    [methodElements]=\"methodElements\"\r\n    methodElementName=\"Type\"\r\n  ></app-method-elements-selection-form>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!typesForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  Type,\r\n  TypeEntry,\r\n} from '../../development-process-registry/method-elements/type/type';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { TypeService } from '../../development-process-registry/method-elements/type/type.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsList } from '../../shared/utils';\r\nimport { Selection } from '../../development-process-registry/development-method/selection';\r\n\r\n@Component({\r\n  selector: 'app-types-selection-form',\r\n  templateUrl: './types-selection-form.component.html',\r\n  styleUrls: ['./types-selection-form.component.css'],\r\n})\r\nexport class TypesSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() types: Selection<Type>[];\r\n  /**\r\n   * Whether the internal types 'initialisation' and 'generic' should be\r\n   * displayed in auto complete.\r\n   */\r\n  @Input() internalTypes: boolean = false;\r\n\r\n  @Output() submitTypesForm = new EventEmitter<FormArray>();\r\n\r\n  typesForm: FormGroup = this.fb.group({\r\n    types: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  methodElements: TypeEntry[] = [];\r\n  listNames: string[] = [];\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder, private typeService: TypeService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadTypes();\r\n    this.changeSubscription = this.typesForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = !equalsList(this.types, value.types)))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.types) {\r\n      const oldTypes: Selection<Type>[] = changes.types.previousValue;\r\n      const newTypes: Selection<Type>[] = changes.types.currentValue;\r\n      if (!equalsList(oldTypes, newTypes)) {\r\n        this.loadForm(changes.types.currentValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitTypesForm.emit(this.typesForm.get('types') as FormArray);\r\n  }\r\n\r\n  private loadForm(types: Selection<Type>[]): void {\r\n    const formGroups = types.map((type) =>\r\n      this.fb.group({\r\n        list: [type.list, Validators.required],\r\n        element: type.element,\r\n      })\r\n    );\r\n    this.typesForm.setControl('types', this.fb.array(formGroups));\r\n  }\r\n\r\n  private async loadTypes(): Promise<void> {\r\n    this.methodElements = await this.typeService.getList();\r\n    this.listNames = [\r\n      ...new Set(this.methodElements.map((element) => element.list)),\r\n    ];\r\n    if (this.internalTypes) {\r\n      this.listNames.push('initialisation', 'generic');\r\n    }\r\n  }\r\n\r\n  createFormGroupFactory = (): FormGroup =>\r\n    this.fb.group({\r\n      list: ['', Validators.required],\r\n      element: null,\r\n    });\r\n}\r\n","<ng-template #deleteTypeModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal (dismiss)=\"d()\" (delete)=\"delete(modalType._id); c()\">\r\n    <div modalTitle>Delete Type {{ modalType.name }}</div>\r\n    You are deleting the type {{ modalType.name }}. This can not be undone. This\r\n    action will not delete the type from method building blocks that are using\r\n    it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Types</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Types to use them for the definition of Method Fragments\r\n  </div>\r\n\r\n  <app-method-element-list\r\n    listTitle=\"Types\"\r\n    [elementLists]=\"elementLists\"\r\n    (deleteElement)=\"openDeleteTypeModal($event)\"\r\n  ></app-method-element-list>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Type</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <app-method-element-form\r\n        [listNames]=\"listNames\"\r\n        (submitMethodElementForm)=\"add($event)\"\r\n      ></app-method-element-form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { TypeService } from '../../development-process-registry/method-elements/type/type.service';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  Type,\r\n  TypeEntry,\r\n} from '../../development-process-registry/method-elements/type/type';\r\n\r\n@Component({\r\n  selector: 'app-types',\r\n  templateUrl: './types.component.html',\r\n  styleUrls: ['./types.component.css'],\r\n})\r\nexport class TypesComponent implements OnInit {\r\n  elementLists: { listName: string; elements: TypeEntry[] }[] = null;\r\n  listNames: string[] = [];\r\n\r\n  modalType: Type;\r\n  private modalReference: NgbModalRef;\r\n\r\n  @ViewChild('deleteTypeModal', { static: true }) deleteTypeModal: unknown;\r\n\r\n  constructor(\r\n    private modalService: NgbModal,\r\n    private typeService: TypeService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.load();\r\n  }\r\n\r\n  private async load(): Promise<void> {\r\n    this.elementLists = await this.typeService.getLists();\r\n    this.listNames = this.elementLists.map((list) => list.listName);\r\n  }\r\n\r\n  openDeleteTypeModal(type: Type): void {\r\n    this.modalType = type;\r\n    this.modalReference = this.modalService.open(this.deleteTypeModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  async delete(id: string): Promise<void> {\r\n    await this.typeService.delete(id);\r\n    await this.load();\r\n  }\r\n\r\n  async add(form: FormGroup): Promise<void> {\r\n    await this.typeService.add(form.value);\r\n    await this.load();\r\n  }\r\n}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">\r\n    Explanation of the Situational Business Model Developer (SBMD)\r\n  </h6>\r\n  <p>\r\n    The Situational Business Model Developer that allows the enaction of\r\n    situation-specific Business Model Development Methods. It uses the Method\r\n    Modeler together with the Feature Modeler to support the business modeler in\r\n    the enaction. The business modeler is guided through the method in a kanban\r\n    board and also sees the enacted method.\r\n  </p>\r\n\r\n  <p class=\"mb-0\">\r\n    Additionally, the Situational Business Model Developer redirects the\r\n    business developer to the correct locations in the Feature Modeler to\r\n    support the creation of different canvases, e.g., business model canvas and\r\n    value proposition canvas.\r\n  </p>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Execution Steps</h6>\r\n\r\n    <ngb-carousel\r\n      interval=\"0\"\r\n      [showNavigationArrows]=\"false\"\r\n      [showNavigationIndicators]=\"false\"\r\n      (slide)=\"updatePagination($event)\"\r\n    >\r\n      <ng-template ngbSlide id=\"1\">\r\n        <figure class=\"figure\">\r\n          <img\r\n            src=\"assets/create_running_method.png\"\r\n            alt=\"Create running method\"\r\n            class=\"carousel-image figure-img\"\r\n          />\r\n          <figcaption class=\"figure-caption\">\r\n            1. Create a running method\r\n          </figcaption>\r\n        </figure>\r\n      </ng-template>\r\n      <ng-template ngbSlide id=\"2\">\r\n        <figure class=\"figure\">\r\n          <img\r\n            src=\"assets/kanban_board.png\"\r\n            alt=\"Kanban board to manage the enaction\"\r\n            class=\"carousel-image figure-img\"\r\n          />\r\n          <figcaption class=\"figure-caption\">\r\n            2. Manage the enaction in a kanban board\r\n          </figcaption>\r\n        </figure>\r\n      </ng-template>\r\n      <ng-template ngbSlide id=\"3\">\r\n        <figure class=\"figure\">\r\n          <img\r\n            src=\"assets/execute_method.png\"\r\n            alt=\"The building block execution page\"\r\n            class=\"carousel-image figure-img\"\r\n          />\r\n          <figcaption class=\"figure-caption\">\r\n            3. Execute building blocks\r\n          </figcaption>\r\n        </figure>\r\n      </ng-template>\r\n    </ngb-carousel>\r\n\r\n    <ngb-pagination\r\n      aria-label=\"Controls for the above images\"\r\n      class=\"d-flex justify-content-center\"\r\n      [collectionSize]=\"3\"\r\n      [pageSize]=\"1\"\r\n      (pageChange)=\"updateCarousel($event)\"\r\n    ></ngb-pagination>\r\n\r\n    <p class=\"mt-2\">Information about the execution steps:</p>\r\n\r\n    <ol class=\"mb-0\">\r\n      <li>\r\n        <strong>Create a running method:</strong> In the first step, an business\r\n        developer has to create a running method by selecting a method to enact\r\n        and giving it a name.\r\n      </li>\r\n      <li>\r\n        <strong>Manage the enaction in a kanban board:</strong> In a kanban\r\n        board it is visible which building blocks are currently ready to be\r\n        executed, are executed, and were executed.\r\n      </li>\r\n      <li>\r\n        <strong>Execute building blocks:</strong> On a page for the execution of\r\n        building blocks an overview of a building block is given and the steps\r\n        to execute are shown. On this page it is also possible to communicate\r\n        with other stakeholders through comments.\r\n      </li>\r\n    </ol>\r\n  </div>\r\n</div>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  NgbCarousel,\r\n  NgbPagination,\r\n  NgbSlideEvent,\r\n} from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-enaction-explanation',\r\n  templateUrl: './enaction-explanation.component.html',\r\n  styleUrls: ['./enaction-explanation.component.css'],\r\n})\r\nexport class EnactionExplanationComponent {\r\n  @ViewChild(NgbCarousel) carousel: NgbCarousel;\r\n  @ViewChild(NgbPagination) pagination: NgbPagination;\r\n\r\n  updateCarousel(tab: number) {\r\n    this.carousel.select(String(tab));\r\n  }\r\n\r\n  updatePagination(slideEvent: NgbSlideEvent) {\r\n    this.pagination.selectPage(Number(slideEvent.current));\r\n  }\r\n}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">\r\n    Explanation of the Model Engine\r\n  </h6>\r\n  <p>\r\n    The Model Engine is a tool to describe Business Models through a combination\r\n    of the Business Model Canvas (BMC) and a Software Product Line (SPL). We\r\n    call this concept Business Model Decision Line (BMDL), where each feature\r\n    describes a single business model decision. Features can be ordered in\r\n    hierarchies and marked as mandatory or optional for the business models.\r\n    Moreover, there can be Or (at least one sub-feature is selected) and\r\n    Alternate (exactly one sub-feature is selected) relationships between a\r\n    parent and a child feature. To refine the business models, cross-tree\r\n    constraints for requiring and excluding dependencies can be made.\r\n  </p>\r\n\r\n  <p>\r\n    The current state of the tool allows the creation, import and export of\r\n    canvas building blocks. The tool guides the user through the different steps\r\n    to create a canvas building block and can show errors if a canvas building\r\n    block does not allow the creation of consistent derived business models due\r\n    to too restrictive constraints. After creating or importing canvas building\r\n    blocks the user is able to merge these blocks into composed models.\r\n  </p>\r\n\r\n  <p>\r\n    Canvas building blocks support the creation of patterns and example business\r\n    models. These patterns and examples can be used in composed models later to\r\n    compare derived business models with them or to give hints about possible\r\n    patterns to the user.\r\n  </p>\r\n\r\n  <p>\r\n    New business model decisions of single business models are synchronized with\r\n    the corresponding composed model to ensure consistency. Moreover, the\r\n    conformance of business models can be checked with the composed model and\r\n    occurring conformance errors are explained. Additionally the tool checks for\r\n    strengths and weaknesses of the business model and gives hints about\r\n    patterns and possible supportive features. It is also possible to compare\r\n    the business model with other business models or to show used patterns.\r\n  </p>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">Execution Steps</h6>\r\n\r\n  <ngb-carousel\r\n    interval=\"0\"\r\n    [showNavigationArrows]=\"false\"\r\n    [showNavigationIndicators]=\"false\"\r\n    (slide)=\"updatePagination($event)\"\r\n  >\r\n    <ng-template ngbSlide id=\"1\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/bmdl_expert.png\"\r\n          alt=\"Canvas building block page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          1. Create the canvas building block by following the steps on the\r\n          canvas building block page\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n    <ng-template ngbSlide id=\"2\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/bmdl_company.png\"\r\n          alt=\"Composed Model page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          2. Create the composed model by merging canvas building blocks\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n    <ng-template ngbSlide id=\"3\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/bmdl_business.png\"\r\n          alt=\"Business model page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          3. Derive Business Models when enacting a method\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n  </ngb-carousel>\r\n\r\n  <ngb-pagination\r\n    aria-label=\"Controls for the above images\"\r\n    class=\"d-flex justify-content-center\"\r\n    [collectionSize]=\"3\"\r\n    [pageSize]=\"1\"\r\n    (pageChange)=\"updateCarousel($event)\"\r\n  ></ngb-pagination>\r\n\r\n  <p class=\"mt-2\">Information about the execution steps:</p>\r\n\r\n  <ol>\r\n    <li>\r\n      <strong>Create / Import Canvas Building Block:</strong> In the first step,\r\n      the user has to create or import a canvas building block with expert\r\n      knowledge. If creating such a model the conformance checking process can\r\n      be supported by defining mandatory and optional features, features that\r\n      have at least one subfeature (OR), features that have exactly one\r\n      subfeature (XOR) and creating dependencies (requires, excludes) between\r\n      the features. To support the hints the tool can give users of the canvas\r\n      building block, it is possible to define dependencies (supports, hurts)\r\n      that are later shown as hints, strengths and weaknesses. To support\r\n      pattern hints it is possible to define patterns as instances of the canvas\r\n      building block. To give users of the canvas building block examples of\r\n      possible business models, which they can later use to compare their\r\n      derived business models with, it is possible to define examples as\r\n      instances of the canvas building block.\r\n    </li>\r\n    <li>\r\n      <strong>Create Composed Model:</strong> In the second step, a method\r\n      engineer can create a composed model. While creating it the developer\r\n      selects canvas building blocks that should be merged into the composed\r\n      model and later merge it manually into the composed model. After that the\r\n      method engineer can edit the composed model and adapt it. In this step it\r\n      is also possible to see conflicting requirements that lead to the\r\n      impossibility to create conform derived business models.\r\n    </li>\r\n    <li>\r\n      <strong>Derive Business Models:</strong> In the third step, the business\r\n      developer can derive different business models from the composed model.\r\n      Here, he can use the existing features from the composed model or add new\r\n      business model decisions. These new feature decisions will be added to the\r\n      composed model to save consistency. Here it also possible to check the\r\n      conformance between the composed model and the business model. Conformance\r\n      errors will be explained to support the resolution. It is also possible to\r\n      show weaknesses (due to hurts cross-tree relation) and strengths (due to\r\n      supports cross-tree relation), hints about supportive features, hints\r\n      about patterns and used patterns. Moreover, it is possible to compare with\r\n      patterns of canvas building blocks. It is also possible to compare the\r\n      business model with other business models of the same composed model or\r\n      with examples of the merged canvas building blocks (if merged completely).\r\n      The corresponding views are automatically accessed, when the business\r\n      developer enacts a method.\r\n    </li>\r\n  </ol>\r\n</div>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  NgbCarousel,\r\n  NgbPagination,\r\n  NgbSlideEvent,\r\n} from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-feature-modeler-explanation',\r\n  templateUrl: './feature-modeler-explanation.component.html',\r\n  styleUrls: ['./feature-modeler-explanation.component.css'],\r\n})\r\nexport class FeatureModelerExplanationComponent {\r\n  @ViewChild(NgbCarousel) carousel: NgbCarousel;\r\n  @ViewChild(NgbPagination) pagination: NgbPagination;\r\n\r\n  updateCarousel(tab: number) {\r\n    this.carousel.select(String(tab));\r\n  }\r\n\r\n  updatePagination(slideEvent: NgbSlideEvent) {\r\n    this.pagination.selectPage(Number(slideEvent.current));\r\n  }\r\n}\r\n","<main role=\"main\">\r\n  <ngb-alert\r\n    *ngIf=\"expired\"\r\n    type=\"warning\"\r\n    class=\"container\"\r\n    (closed)=\"closeAlert()\"\r\n  >\r\n    The session has expired, because of inactivity.\r\n  </ngb-alert>\r\n  <ngb-alert\r\n    *ngIf=\"passwordChanged\"\r\n    type=\"success\"\r\n    class=\"container\"\r\n    (closed)=\"closeAlert()\"\r\n  >\r\n    The password has been changed successfully.\r\n  </ngb-alert>\r\n  <ngb-alert\r\n    *ngIf=\"dbError\"\r\n    type=\"danger\"\r\n    class=\"container\"\r\n    (closed)=\"closeAlert()\"\r\n  >\r\n    Critical error in database.\r\n  </ngb-alert>\r\n  <div class=\"m-auto my-3 p-3 bg-white rounded shadow-sm\" style=\"width: 20rem\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Login</h6>\r\n    <div class=\"text-muted\">\r\n      <form [formGroup]=\"form\" (submit)=\"login()\">\r\n        <div class=\"form-group\">\r\n          <label for=\"inputUser\">Username</label>\r\n          <input\r\n            class=\"form-control\"\r\n            id=\"inputUser\"\r\n            formControlName=\"username\"\r\n          />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"passwordInput\">Password</label>\r\n          <input\r\n            type=\"password\"\r\n            class=\"form-control\"\r\n            id=\"passwordInput\"\r\n            aria-describedby=\"passwordInput\"\r\n            formControlName=\"password\"\r\n          />\r\n          <small id=\"passwordInputHelp\" class=\"form-text text-muted\">\r\n            This is <strong>not</strong> your IMT Password.\r\n          </small>\r\n        </div>\r\n        <div>\r\n          <button\r\n            type=\"submit\"\r\n            class=\"btn btn-primary\"\r\n            [disabled]=\"!form.valid\"\r\n          >\r\n            Login\r\n          </button>\r\n        </div>\r\n        <div>\r\n          <small class=\"text-danger\" *ngIf=\"errorReason != null\">{{\r\n            errorReason\r\n          }}</small>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { AuthService } from '../database/auth.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.css'],\r\n})\r\nexport class LoginComponent implements OnInit, OnDestroy {\r\n  form = this.fb.group({\r\n    username: ['', Validators.required],\r\n    password: ['', Validators.required],\r\n  });\r\n  errorReason: string = null;\r\n\r\n  expired = false;\r\n  passwordChanged = false;\r\n  dbError = false;\r\n\r\n  private loginSubscription: Subscription;\r\n  private querySubscription: Subscription;\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private fb: FormBuilder,\r\n    private modalService: NgbModal,\r\n    private route: ActivatedRoute,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.modalService.dismissAll();\r\n    this.querySubscription = this.route.queryParamMap.subscribe(\r\n      (queryParamMap) => {\r\n        this.expired =\r\n          queryParamMap.has('expired') &&\r\n          queryParamMap.get('expired') === 'true';\r\n        this.passwordChanged =\r\n          queryParamMap.has('passwordChanged') &&\r\n          queryParamMap.get('passwordChanged') === 'true';\r\n        this.dbError =\r\n          queryParamMap.has('dbError') &&\r\n          queryParamMap.get('dbError') === 'true';\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.loginSubscription) {\r\n      this.loginSubscription.unsubscribe();\r\n    }\r\n    if (this.querySubscription) {\r\n      this.querySubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async closeAlert() {\r\n    await this.router.navigate([]);\r\n  }\r\n\r\n  async login() {\r\n    if (this.loginSubscription) {\r\n      this.loginSubscription.unsubscribe();\r\n    }\r\n    this.errorReason = null;\r\n    this.loginSubscription = this.authService\r\n      .login(this.form.get('username').value, this.form.get('password').value)\r\n      .subscribe(\r\n        () => (this.errorReason = null),\r\n        (error) => {\r\n          console.error(error);\r\n          if (error.message != null) {\r\n            this.errorReason = error.message;\r\n          }\r\n          if (error.error != null && error.error.reason != null) {\r\n            this.errorReason = error.error.reason;\r\n          }\r\n        }\r\n      );\r\n  }\r\n}\r\n","<!-- Show Explanation -->\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">\r\n    Explanation of the BMDL Modeler\r\n  </h6>\r\n  <p>\r\n    The BMDL Method Modeler is a tool to describe situation-specific Business\r\n    Model Development Methods. Business Model Development Methods can be\r\n    described by combining Method Patterns and inserting Method Building Blocks\r\n    into them. Method Patterns and Method Building Blocks are constructed from\r\n    Method Elements. Method Elements are Artifacts, Situational Factors,\r\n    Stakeholders, Tools and Types. Types are special, as they are used to\r\n    determine which Method Building Blocks or Method Patterns can be inserted\r\n    into activities of Method Patterns.\r\n  </p>\r\n\r\n  <p class=\"mb-0\">\r\n    Additionally, Method Building Blocks allow to select abstract list types for\r\n    input/output Artifacts, Stakeholders and Tools. The user can later decide\r\n    when developing the Business Model Development Methods, which concrete\r\n    Method Element to use, e.g. an expert selected the abstract list type Users\r\n    for stakeholders and the business developer can choose whether these are\r\n    Customers, Experts or Early Adopters. Furthermore, the tool allows to define\r\n    that a user is later able to select multiple instances of an abstract list\r\n    type, e.g., in the example above, Customers and Experts. It is also possible\r\n    to select between different Groups of input artifacts, output artifacts and\r\n    Stakeholders.\r\n  </p>\r\n</div>\r\n\r\n<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">Execution Steps</h6>\r\n\r\n  <ngb-carousel\r\n    interval=\"0\"\r\n    [showNavigationArrows]=\"false\"\r\n    [showNavigationIndicators]=\"false\"\r\n    (slide)=\"updatePagination($event)\"\r\n  >\r\n    <ng-template ngbSlide id=\"1\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/situational-factor.png\"\r\n          alt=\"Situational factor page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          1. Create Method Elements (in Picture: a situational factor)\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n    <ng-template ngbSlide id=\"2\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/building-block.png\"\r\n          alt=\"Method Building Block page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          2. Create Method Building Blocks\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n    <ng-template ngbSlide id=\"3\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/pattern.png\"\r\n          alt=\"Method Pattern page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          3. Create Method Patterns\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n    <ng-template ngbSlide id=\"4\">\r\n      <figure class=\"figure\">\r\n        <img\r\n          src=\"assets/process.png\"\r\n          alt=\"Business Model Development Method page\"\r\n          class=\"carousel-image figure-img\"\r\n        />\r\n        <figcaption class=\"figure-caption\">\r\n          4. Create Business Model Development Methods\r\n        </figcaption>\r\n      </figure>\r\n    </ng-template>\r\n  </ngb-carousel>\r\n\r\n  <ngb-pagination\r\n    aria-label=\"Controls for the above images\"\r\n    class=\"d-flex justify-content-center\"\r\n    [collectionSize]=\"4\"\r\n    [pageSize]=\"1\"\r\n    (pageChange)=\"updateCarousel($event)\"\r\n  ></ngb-pagination>\r\n\r\n  <p class=\"mt-2\">Information about the execution steps:</p>\r\n\r\n  <ol class=\"mb-0\">\r\n    <li>\r\n      <strong>Create Method Elements:</strong> In the first step, an expert has\r\n      to create Method Elements that are later used to define Method Building\r\n      Blocks and Method Patterns. Method Elements are Artifacts, Situational\r\n      Factors, Stakeholders, Tools and Types. Every Method Element belongs to a\r\n      list of other Method Elements to group them. Later, when creating Method\r\n      Building Blocks or Method Patterns, it is possible to reference such an\r\n      abstract list of Method Elements to allow the user to select a fitting\r\n      concrete Method Element when defining the Business Model Development\r\n      Method. Special Method Elements are Types and Situational Factors. Types\r\n      are used to filter which Method Building Blocks and Method Patterns can be\r\n      used together and Situational Factors are used to analyze whether the used\r\n      Method Patterns and Method Building Blocks fit to the development context.\r\n      Additionally, Situational Factors can define values. In this tool examples\r\n      for Method Elements are already created.\r\n    </li>\r\n    <li>\r\n      <strong>Create Method Building Blocks:</strong> In the second step, an\r\n      expert can create Method Building Blocks. Method Building Blocks consist\r\n      of input and output artifacts, involved stakeholders and tools.\r\n      Additionally, they have types and situational factors. Examples for Method\r\n      Building Blocks are already defined in this tool.\r\n    </li>\r\n    <li>\r\n      <strong>Create Method Patterns:</strong> In the third step, the expert can\r\n      create Method Patterns. They define the structure of the later Business\r\n      Model Development Methods. Method Patterns have types. A special type is\r\n      <i>initialisation</i> that defines that the pattern can be used as a\r\n      starting point. Additionally, a Method Pattern defines activities. The\r\n      expert can choose whether only Method Building Blocks or Method Building\r\n      Blocks and Method Patterns can be inserted into a single activity when the\r\n      Business Model Development Method is defined. Examples for Method Patterns\r\n      are already included in this tool.\r\n    </li>\r\n    <li>\r\n      <strong>Create Business Model Development Methods</strong> In the last\r\n      step, a business developer can create Business Model Development Methods.\r\n      To do this, the business developer first has to choose a Method Pattern as\r\n      a starting point. Then, it is possible to insert fitting Method Building\r\n      Blocks or Method Patterns into the activities of the Method Pattern.\r\n      Additionally, the business developer can use situational factors to define\r\n      the development context. This context is checked against the internal\r\n      situational factors of the used Method Patterns and Method Building Blocks\r\n      and mismatches are reported. Furthermore, the business developer can\r\n      select per Method Building Block how the Method Building Block should be\r\n      used, e.g., the business developer can select from lists which tools to\r\n      use if the Method Building Block was created with an abstract definition.\r\n    </li>\r\n  </ol>\r\n</div>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport {\r\n  NgbCarousel,\r\n  NgbPagination,\r\n  NgbSlideEvent,\r\n} from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-method-modeler-explanation',\r\n  templateUrl: './method-modeler-explanation.component.html',\r\n  styleUrls: ['./method-modeler-explanation.component.css'],\r\n})\r\nexport class MethodModelerExplanationComponent {\r\n  @ViewChild(NgbCarousel) carousel: NgbCarousel;\r\n  @ViewChild(NgbPagination) pagination: NgbPagination;\r\n\r\n  updateCarousel(tab: number) {\r\n    this.carousel.select(String(tab));\r\n  }\r\n\r\n  updatePagination(slideEvent: NgbSlideEvent) {\r\n    this.pagination.selectPage(Number(slideEvent.current));\r\n  }\r\n}\r\n","import { DatabaseModelPart } from '../database/database-model-part';\r\nimport { Equality } from '../shared/equality';\r\nimport { DatabaseEntry, DatabaseInit } from '../database/database-entry';\r\n\r\nexport interface AuthorInit extends DatabaseInit {\r\n  name?: string;\r\n  company?: string;\r\n  email?: string;\r\n  website?: string;\r\n}\r\n\r\nexport interface AuthorEntry extends DatabaseEntry {\r\n  name: string;\r\n  company: string;\r\n  email: string;\r\n  website: string;\r\n}\r\n\r\nexport class Author implements AuthorInit, Equality<Author>, DatabaseModelPart {\r\n  // JSON Schema (stored)\r\n  name: string;\r\n  company: string;\r\n  email: string;\r\n  website: string;\r\n\r\n  constructor(entry: AuthorEntry | undefined, init: AuthorInit | undefined) {\r\n    const element = entry ?? init;\r\n    this.name = element.name;\r\n    this.company = element.company;\r\n    this.email = element.email;\r\n    this.website = element.website;\r\n  }\r\n\r\n  /**\r\n   * Update this author with new values\r\n   *\r\n   * @param author the new values of this author (values will be copied to the current object)\r\n   */\r\n  update(author: Partial<AuthorInit>): void {\r\n    Object.assign(this, author);\r\n  }\r\n\r\n  toDb(): AuthorEntry {\r\n    return {\r\n      name: this.name,\r\n      company: this.company,\r\n      email: this.email,\r\n      website: this.website,\r\n    };\r\n  }\r\n\r\n  equals(other: Author): boolean {\r\n    if (other == null) {\r\n      return false;\r\n    }\r\n    return (\r\n      this.name === other.name &&\r\n      this.company === other.company &&\r\n      this.email === other.email &&\r\n      this.website === other.website\r\n    );\r\n  }\r\n}\r\n","/**\r\n * Convert a name to an id\r\n *\r\n * @param name the name\r\n */\r\nexport function nameToId(name: string): string {\r\n  return name.toLowerCase().replace(/ /g, '-');\r\n}\r\n\r\n/**\r\n * Get the next unique id by name\r\n *\r\n * @param name the name to get the id from\r\n * @param currentIdList all ids currently used\r\n */\r\nexport function getId(name: string, currentIdList: string[]): string {\r\n  const id = nameToId(name);\r\n  const ids = currentIdList.filter((i) => i.startsWith(id));\r\n  if (ids.length === 0) {\r\n    return id;\r\n  }\r\n  const currentCount = Math.max(\r\n    ...ids\r\n      .map((i) => i.substring(id.length + 1))\r\n      .filter((i) => /^[0-9]+$/.test(i))\r\n      .map((i) => parseInt(i, 10)),\r\n    0\r\n  );\r\n  return id + '-' + (currentCount + 1);\r\n}\r\n","<nav class=\"navbar navbar-expand-xl fixed-top navbar-dark bg-dark\">\r\n  <a class=\"navbar-brand mr-auto mr-xl-0\" [routerLink]=\"['/']\">SBMD</a>\r\n  <button\r\n    class=\"navbar-toggler p-0 border-0\"\r\n    type=\"button\"\r\n    aria-controls=\"bmdlNavbar\"\r\n    [attr.aria-expanded]=\"navExpanded\"\r\n    aria-label=\"Toggle navigation\"\r\n    (click)=\"navExpanded = !navExpanded\"\r\n  >\r\n    <span class=\"navbar-toggler-icon\"></span>\r\n  </button>\r\n  <div\r\n    [class.open]=\"navExpanded\"\r\n    class=\"navbar-collapse offcanvas-collapse\"\r\n    id=\"bmdlNavbar\"\r\n  >\r\n    <ul class=\"navbar-nav mr-auto\">\r\n      <ng-container *ngFor=\"let navItem of navItems\">\r\n        <ng-container *ngIf=\"navItem.roles.includes(currentRole)\">\r\n          <li\r\n            *ngIf=\"!navItem.submenu\"\r\n            class=\"nav-item\"\r\n            routerLinkActive=\"active\"\r\n            #itemActive=\"routerLinkActive\"\r\n          >\r\n            <a class=\"nav-link text-nowrap\" [routerLink]=\"navItem.route\">\r\n              {{ navItem.name }}\r\n              <span *ngIf=\"itemActive.isActive\" class=\"sr-only\">(current)</span>\r\n            </a>\r\n          </li>\r\n          <li *ngIf=\"navItem.submenu\" class=\"nav-item\" ngbDropdown>\r\n            <a\r\n              class=\"nav-link\"\r\n              type=\"button\"\r\n              id=\"dropdown\"\r\n              ngbDropdownToggle\r\n              role=\"button\"\r\n            >\r\n              {{ navItem.name }}\r\n            </a>\r\n            <div ngbDropdownMenu aria-labelledby=\"dropdown\">\r\n              <a\r\n                *ngFor=\"let item of navItem.submenu\"\r\n                [routerLink]=\"item.route\"\r\n                ngbDropdownItem\r\n                routerLinkActive=\"active\"\r\n                #active=\"routerLinkActive\"\r\n                >{{ item.name }}\r\n                <span *ngIf=\"active.isActive\" class=\"sr-only\"\r\n                  >(current)</span\r\n                ></a\r\n              >\r\n            </div>\r\n          </li>\r\n        </ng-container>\r\n      </ng-container>\r\n    </ul>\r\n    <form [formGroup]=\"roleForm\" class=\"form-inline my-2 my-xl-0\">\r\n      <label for=\"roleSelector\" class=\"mr-2 text-light\">Role</label>\r\n      <select formControlName=\"role\" class=\"form-control\" id=\"roleSelector\">\r\n        <option *ngFor=\"let role of roles\" [ngValue]=\"role\">{{ role }}</option>\r\n      </select>\r\n    </form>\r\n  </div>\r\n</nav>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { InternalRoles, UserService } from '../user.service';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { Router } from '@angular/router';\r\n\r\nclass NavItem {\r\n  name: string;\r\n  route?: string[];\r\n  roles: string[];\r\n}\r\n\r\nclass RootNavItem extends NavItem {\r\n  submenu?: RootNavItem[];\r\n}\r\n\r\n@Component({\r\n  selector: 'app-navbar',\r\n  templateUrl: './navbar.component.html',\r\n  styleUrls: ['./navbar.component.css'],\r\n})\r\nexport class NavbarComponent implements OnInit, OnDestroy {\r\n  navItems: RootNavItem[] = [\r\n    {\r\n      name: 'Method Enactment',\r\n      route: ['runningprocess'],\r\n      roles: [InternalRoles.BUSINESSDEVELOPER],\r\n    },\r\n    {\r\n      name: 'Artifacts',\r\n      route: ['concreteArtifacts'],\r\n      roles: [InternalRoles.BUSINESSDEVELOPER],\r\n    },\r\n    {\r\n      name: 'Method Composition',\r\n      route: ['bmprocess'],\r\n      roles: [InternalRoles.EXPERT],\r\n    },\r\n    {\r\n      name: 'Method Repository',\r\n      submenu: [\r\n        {\r\n          name: 'Method Patterns',\r\n          route: ['process'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n        {\r\n          name: 'Method Building Blocks',\r\n          route: ['methods'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n        {\r\n          name: 'Method Elements',\r\n          route: ['methodElements'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n      ],\r\n      roles: [InternalRoles.EXPERT],\r\n    },\r\n    {\r\n      name: 'Model Composition',\r\n      route: ['companyModels'],\r\n      roles: [InternalRoles.EXPERT],\r\n    },\r\n    {\r\n      name: 'Canvas Model Repository',\r\n      submenu: [\r\n        {\r\n          name: 'Canvas Building Blocks',\r\n          route: ['expertModels'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n        {\r\n          name: 'Canvas Models',\r\n          route: ['canvas', 'definitions'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n        {\r\n          name: 'Canvas Elements',\r\n          route: ['canvasElements'],\r\n          roles: [InternalRoles.EXPERT],\r\n        },\r\n      ],\r\n      roles: [InternalRoles.EXPERT],\r\n    },\r\n    {\r\n      name: 'Templates',\r\n      route: ['whiteboard', 'templates'],\r\n      roles: [InternalRoles.EXPERT],\r\n    },\r\n    {\r\n      name: 'Explanation',\r\n      route: ['explanation'],\r\n      roles: [InternalRoles.EXPERT, InternalRoles.BUSINESSDEVELOPER],\r\n    },\r\n  ];\r\n  navExpanded = false;\r\n\r\n  roleForm = this.fb.group({\r\n    role: [],\r\n  });\r\n\r\n  private roleSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private router: Router,\r\n    private userService: UserService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.roleForm.setValue({ role: this.userService.activatedRole });\r\n    this.roleSubscription = this.roleForm\r\n      .get('role')\r\n      .valueChanges.subscribe((role) => {\r\n        this.userService.activatedRole = role;\r\n        void this.router.navigate(['/', 'start']);\r\n      });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.roleSubscription) {\r\n      this.roleSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  get roles(): InternalRoles[] {\r\n    return Object.values(InternalRoles);\r\n  }\r\n\r\n  get currentRole(): InternalRoles {\r\n    return this.userService.activatedRole;\r\n  }\r\n}\r\n","<ng-template #importModal let-d=\"dismiss\">\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Import Database</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"d()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <div class=\"alert alert-danger\">\r\n      This step will do the following:\r\n      <ol>\r\n        <li>\r\n          <strong>Delete all documents in the current database</strong><br />\r\n          This will remove everything that is in the database. After this step\r\n          the database is empty. <strong>This can not be undone.</strong>\r\n        </li>\r\n        <li>\r\n          <strong>Import the file</strong><br />\r\n          Then the given file will be imported. On any error the database will\r\n          <strong>remain empty</strong>. So please have a backup of the current\r\n          state.\r\n        </li>\r\n      </ol>\r\n      You should be really sure when executing this step. To confirm this step\r\n      enter \"{{ verifyString }}\" into the verify input field.<br />\r\n      Again, this step <strong>can not be undone</strong>.\r\n    </div>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"form\" (ngSubmit)=\"submitForm()\">\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"file\" class=\"col-sm-4 col-form-label\">File</label>\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"file\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"importError != null\"\r\n              id=\"file\"\r\n              aria-describedby=\"fileErrorDescription\"\r\n              formControlName=\"file\"\r\n              (change)=\"fileChange($event)\"\r\n            />\r\n            <div id=\"fileErrorDescription\" class=\"invalid-feedback\">\r\n              {{ importError }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group form-row\">\r\n          <label for=\"inputVerify\" class=\"col-sm-4 col-form-label\"\r\n            >Verify</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"verifyControl.invalid\"\r\n              id=\"inputVerify\"\r\n              formControlName=\"verify\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group form-row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              [disabled]=\"!form.valid\"\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n            >\r\n              Reset database and import file into database\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n\r\n<main class=\"container\">\r\n  <app-profile></app-profile>\r\n\r\n  <div *ngIf=\"isLocalDatabase()\" class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Reset Database</h6>\r\n    <button\r\n      type=\"button\"\r\n      (click)=\"resetDatabase()\"\r\n      class=\"btn btn-dark btn-sm btn-block\"\r\n    >\r\n      Reset Database to Default\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Database Import/Export</h6>\r\n    <button\r\n      type=\"button\"\r\n      (click)=\"openImportDatabase()\"\r\n      class=\"btn btn-dark btn-sm btn-block\"\r\n    >\r\n      Import database\r\n    </button>\r\n    <button\r\n      type=\"button\"\r\n      (click)=\"exportDatabase()\"\r\n      class=\"btn btn-dark btn-sm btn-block\"\r\n    >\r\n      Export database\r\n    </button>\r\n  </div>\r\n\r\n  <div\r\n    *ngIf=\"username != null && !isLocalDatabase()\"\r\n    class=\"my-3 p-3 bg-white rounded shadow-sm\"\r\n  >\r\n    <h6 class=\"border-bottom border-gray pb-2\">Change Password</h6>\r\n    <app-change-password-form\r\n      (changePassword)=\"changePassword($event)\"\r\n    ></app-change-password-form>\r\n    <div class=\"alert alert-danger\" *ngIf=\"passwordChangeError\">\r\n      Password not changed due to an error.\r\n    </div>\r\n    <div class=\"alert alert-danger\" *ngIf=\"passwordChangeForbidden\">\r\n      You do not have the permission to change your password.\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { AuthService } from '../database/auth.service';\r\nimport { environment } from '../../environments/environment';\r\nimport { PouchdbService } from '../database/pouchdb.service';\r\nimport { saveAs } from 'file-saver';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport {\r\n  AbstractControl,\r\n  FormBuilder,\r\n  ValidationErrors,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { ImportExportService } from '../database/import-export.service';\r\n\r\n@Component({\r\n  selector: 'app-options',\r\n  templateUrl: './options.component.html',\r\n  styleUrls: ['./options.component.css'],\r\n})\r\nexport class OptionsComponent {\r\n  passwordChangeError = false;\r\n  passwordChangeForbidden = false;\r\n\r\n  readonly verifyString = 'resetDB';\r\n  file?: File;\r\n  form = this.fb.group({\r\n    file: [null, Validators.required],\r\n    verify: [\r\n      '',\r\n      [\r\n        Validators.required,\r\n        (control: AbstractControl): ValidationErrors | null => {\r\n          return control.value !== this.verifyString\r\n            ? { notVerified: true }\r\n            : null;\r\n        },\r\n      ],\r\n    ],\r\n  });\r\n  importError?: string;\r\n\r\n  @ViewChild('importModal', { static: true }) importModal: unknown;\r\n  private modalReference?: NgbModalRef;\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private fb: FormBuilder,\r\n    private importExportService: ImportExportService,\r\n    private modalService: NgbModal,\r\n    private pouchdbService: PouchdbService\r\n  ) {}\r\n\r\n  changePassword(newPassword: string): void {\r\n    this.passwordChangeError = false;\r\n    this.passwordChangeForbidden = false;\r\n    this.authService.changePassword(newPassword).subscribe(\r\n      () => console.log('Password changed.'),\r\n      (error) => {\r\n        console.error(error);\r\n        console.log('Password NOT changed.');\r\n        if (error.status === 403) {\r\n          this.passwordChangeForbidden = true;\r\n        } else {\r\n          this.passwordChangeError = true;\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  openImportDatabase(): void {\r\n    this.modalReference = this.modalService.open(this.importModal, {\r\n      size: 'lg',\r\n    });\r\n  }\r\n\r\n  fileChange(event: Event): void {\r\n    this.importError = null;\r\n    const fileInput = event.target as HTMLInputElement;\r\n    this.file = fileInput.files[0];\r\n  }\r\n\r\n  async submitForm(): Promise<void> {\r\n    try {\r\n      await this.importExportService.importDatabase(this.file);\r\n    } catch (error) {\r\n      if (typeof error === 'string') {\r\n        this.importError = error;\r\n      } else if (error instanceof Error) {\r\n        this.importError = error.message;\r\n      } else {\r\n        this.importError =\r\n          \"Unknown Error. See browser's console for more info.\";\r\n      }\r\n      throw error;\r\n    }\r\n    this.modalReference!.close();\r\n  }\r\n\r\n  async exportDatabase(): Promise<void> {\r\n    saveAs(await this.importExportService.exportDatabase(), 'db.json');\r\n  }\r\n\r\n  get username(): string | undefined {\r\n    return this.authService.username;\r\n  }\r\n\r\n  isLocalDatabase(): boolean {\r\n    return environment.localDatabase === true;\r\n  }\r\n\r\n  /**\r\n   * Reset the local database.\r\n   */\r\n  async resetDatabase(): Promise<void> {\r\n    console.log('Delete Database');\r\n    await this.pouchdbService.clearDatabase();\r\n    console.log('Add default data');\r\n    await this.pouchdbService.addDefaultData();\r\n  }\r\n\r\n  get verifyControl(): AbstractControl {\r\n    return this.form.get('verify');\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-page-not-found',\r\n  templateUrl: './page-not-found.component.html',\r\n  styleUrls: ['./page-not-found.component.css'],\r\n})\r\nexport class PageNotFoundComponent {}\r\n","<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">404 Not Found</h6>\r\n    This page does not exist.\r\n  </div>\r\n</main>\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h6 class=\"border-bottom border-gray pb-2\">Profile</h6>\r\n  <table class=\"table\" *ngIf=\"username != null || group != null\">\r\n    <tbody>\r\n      <tr *ngIf=\"username != null\">\r\n        <th scope=\"row\">Username</th>\r\n        <td>{{ username }}</td>\r\n      </tr>\r\n      <tr *ngIf=\"group != null\">\r\n        <th scope=\"row\">Group</th>\r\n        <td>{{ group }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <span *ngIf=\"isLocalDatabase()\">Connected to a local database</span>\r\n</div>\r\n","import { Component } from '@angular/core';\r\nimport { environment } from '../../environments/environment';\r\nimport { AuthService } from '../database/auth.service';\r\n\r\n@Component({\r\n  selector: 'app-profile',\r\n  templateUrl: './profile.component.html',\r\n  styleUrls: ['./profile.component.css'],\r\n})\r\nexport class ProfileComponent {\r\n  constructor(private authService: AuthService) {}\r\n\r\n  get username(): string | undefined {\r\n    return this.authService.username;\r\n  }\r\n\r\n  get group(): string | undefined {\r\n    return this.authService.group;\r\n  }\r\n\r\n  isLocalDatabase(): boolean {\r\n    return environment.localDatabase === true;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\" *ngIf=\"runningProcess\">\r\n    <a\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        runningProcess._id\r\n      ]\"\r\n    >\r\n      {{ runningProcess.process.name }} &ndash;\r\n      {{ runningProcess.name }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"runningMethod != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[\r\n        '/',\r\n        'runningprocess',\r\n        'runningprocessview',\r\n        runningProcess._id,\r\n        'method',\r\n        runningMethod.executionId\r\n      ]\"\r\n    >\r\n      {{ runningMethod.methodName }}\r\n    </a>\r\n    <ng-content></ng-content>\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\" [queryParams]=\"queryParams\">\r\n      {{ apiName ?? 'Step' }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { ProcessApiService } from '../../development-process-registry/module-api/process-api.service';\r\nimport { RunningProcess } from '../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../development-process-registry/running-process/running-method';\r\n\r\n@Component({\r\n  selector: 'app-api-navigation',\r\n  templateUrl: './api-navigation.component.html',\r\n  styleUrls: ['./api-navigation.component.css'],\r\n})\r\nexport class ApiNavigationComponent {\r\n  @Input() apiName?: string;\r\n\r\n  constructor(private processApiService: ProcessApiService) {}\r\n\r\n  get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  get queryParams(): {\r\n    step: number;\r\n    runningProcessId: string;\r\n    executionId: string;\r\n  } {\r\n    return this.processApiService.queryParams;\r\n  }\r\n}\r\n","<form [formGroup]=\"authorForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group row\">\r\n    <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"name\"\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"company\" class=\"col-sm-4 col-form-label\">Company</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"text\"\r\n        formControlName=\"company\"\r\n        class=\"form-control\"\r\n        id=\"company\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"email\" class=\"col-sm-4 col-form-label\">Email</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"email\"\r\n        formControlName=\"email\"\r\n        class=\"form-control\"\r\n        id=\"email\"\r\n        aria-describedby=\"eMailErrorDescription\"\r\n        [class.is-invalid]=\"authorForm.get('email').hasError('email')\"\r\n      />\r\n      <div id=\"eMailErrorDescription\" class=\"invalid-feedback\">\r\n        Email is not valid.\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <label for=\"website\" class=\"col-sm-4 col-form-label\">Website</label>\r\n    <div class=\"col-sm-8\">\r\n      <input\r\n        type=\"url\"\r\n        formControlName=\"website\"\r\n        class=\"form-control\"\r\n        id=\"website\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!authorForm.valid\"\r\n      >\r\n        Update Author Info<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Author } from '../../model/author';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-author-form',\r\n  templateUrl: './author-form.component.html',\r\n  styleUrls: ['./author-form.component.css'],\r\n})\r\nexport class AuthorFormComponent implements OnInit, OnChanges {\r\n  @Input() author: Author = null;\r\n\r\n  @Output() submitAuthorForm = new EventEmitter<FormGroup>();\r\n\r\n  authorForm: FormGroup = this.fb.group({\r\n    name: '',\r\n    company: '',\r\n    email: ['', Validators.email],\r\n    website: '',\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    if (this.author === null) {\r\n      this.loadForm();\r\n    }\r\n    this.changeSubscription = this.authorForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) =>\r\n            (this.changed = this.author != null && !this.author.equals(value))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.author) {\r\n      const oldAuthor: Author = changes.author.previousValue;\r\n      const newAuthor: Author = changes.author.currentValue;\r\n      if (!newAuthor.equals(oldAuthor)) {\r\n        this.loadForm(changes.author.currentValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitAuthorForm.emit(this.authorForm);\r\n  }\r\n\r\n  private loadForm(author: Author = new Author(undefined, {})): void {\r\n    this.authorForm.patchValue(author);\r\n  }\r\n}\r\n","<div class=\"text-muted small\">\r\n  <div *ngIf=\"author && author.name\">\r\n    Author: {{ author.name }}\r\n    <ng-container *ngIf=\"author.email\"> ({{ author.email }}) </ng-container>\r\n    <ng-container *ngIf=\"author.company\">\r\n      from {{ author.company }}</ng-container\r\n    >\r\n  </div>\r\n  <div *ngIf=\"author.website\">Website: {{ author.website }}</div>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { Author, AuthorEntry } from '../../model/author';\r\n\r\n@Component({\r\n  selector: 'app-author-info',\r\n  templateUrl: './author-info.component.html',\r\n  styleUrls: ['./author-info.component.css'],\r\n})\r\nexport class AuthorInfoComponent {\r\n  @Input() author: Author | AuthorEntry;\r\n}\r\n","import { Component, EventEmitter, Output } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-delete-modal',\r\n  templateUrl: './delete-modal.component.html',\r\n  styleUrls: ['./delete-modal.component.css'],\r\n})\r\nexport class DeleteModalComponent {\r\n  @Output() delete = new EventEmitter();\r\n  @Output() dismiss = new EventEmitter();\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">\r\n    <ng-content select=\"[modalTitle]\"></ng-content>\r\n  </h4>\r\n  <button\r\n    type=\"button\"\r\n    class=\"close\"\r\n    aria-label=\"Close\"\r\n    (click)=\"dismiss.emit()\"\r\n  >\r\n    <span aria-hidden=\"true\">&times;</span>\r\n    <span class=\"sr-only\">Close Window</span>\r\n  </button>\r\n</div>\r\n<div class=\"modal-body\">\r\n  <div class=\"alert alert-warning\">\r\n    <ng-content></ng-content>\r\n  </div>\r\n</div>\r\n<div class=\"modal-footer d-flex\">\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"dismiss.emit()\">\r\n    Abort deletion\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-danger ml-auto\" (click)=\"delete.emit()\">\r\n    Delete anyway\r\n  </button>\r\n</div>\r\n","<form [formGroup]=\"descriptionForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\">\r\n    <label for=\"description\">Description</label>\r\n    <textarea\r\n      formControlName=\"description\"\r\n      class=\"form-control\"\r\n      id=\"description\"\r\n      rows=\"3\"\r\n    ></textarea>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!descriptionForm.valid\"\r\n      >\r\n        Update Description<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-description-form',\r\n  templateUrl: './description-form.component.html',\r\n  styleUrls: ['./description-form.component.css'],\r\n})\r\nexport class DescriptionFormComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() description: string;\r\n\r\n  @Output() submitDescriptionForm = new EventEmitter<FormGroup>();\r\n\r\n  descriptionForm: FormGroup = this.fb.group({\r\n    description: this.fb.control(''),\r\n  });\r\n  changed = false;\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  ngOnInit() {\r\n    this.changeSubscription = this.descriptionForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap((value) => (this.changed = this.description !== value.description))\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.description) {\r\n      this.loadForm(changes.description.currentValue);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    this.submitDescriptionForm.emit(this.descriptionForm);\r\n  }\r\n\r\n  private loadForm(description: string) {\r\n    if (description) {\r\n      this.descriptionForm.setValue({ description });\r\n    } else {\r\n      this.descriptionForm.setValue({ description: '' });\r\n    }\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport {\r\n  Domain,\r\n  DomainEntry,\r\n} from '../../development-process-registry/knowledge/domain';\r\nimport { merge, Observable, Subject } from 'rxjs';\r\nimport { getTypeaheadInputPipe } from '../utils';\r\nimport { map } from 'rxjs/operators';\r\nimport { ControlContainer, FormControl } from '@angular/forms';\r\nimport { NgbTypeaheadSelectItemEvent } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-domain-selection-form',\r\n  templateUrl: './domain-selection-form.component.html',\r\n  styleUrls: ['./domain-selection-form.component.css'],\r\n})\r\nexport class DomainSelectionFormComponent {\r\n  @Input() domainDefinitions: DomainEntry[] = [];\r\n  @Input() index: number;\r\n\r\n  @Output() remove = new EventEmitter<void>();\r\n\r\n  openDomainInput = new Subject<string>();\r\n\r\n  constructor(private controlContainer: ControlContainer) {}\r\n\r\n  searchDomains = (input: Observable<string>): Observable<DomainEntry[]> => {\r\n    return merge(getTypeaheadInputPipe(input), this.openDomainInput).pipe(\r\n      map((term) =>\r\n        this.domainDefinitions\r\n          .filter((domain) =>\r\n            domain.name.toLowerCase().includes(term.toLowerCase())\r\n          )\r\n          .slice(0, 7)\r\n      )\r\n    );\r\n  };\r\n\r\n  formatter(x: { name: string }): string {\r\n    return x.name;\r\n  }\r\n\r\n  selectItem(event: NgbTypeaheadSelectItemEvent<DomainEntry>): void {\r\n    event.preventDefault();\r\n    this.formControl.setValue(new Domain(event.item, undefined));\r\n  }\r\n\r\n  get formControl(): FormControl {\r\n    return this.controlContainer.control as FormControl;\r\n  }\r\n}\r\n","<div class=\"form-row\">\r\n  <div class=\"form-group col\">\r\n    <label for=\"domainSelection{{ index }}\">Domain</label>\r\n    <div class=\"input-group\">\r\n      <input\r\n        type=\"text\"\r\n        [formControl]=\"formControl\"\r\n        class=\"form-control\"\r\n        id=\"domainSelection{{ index }}\"\r\n        [ngbTypeahead]=\"searchDomains\"\r\n        [editable]=\"false\"\r\n        [resultFormatter]=\"formatter\"\r\n        [inputFormatter]=\"formatter\"\r\n        (selectItem)=\"selectItem($event)\"\r\n        (click)=\"openDomainInput.next($any($event.target).value)\"\r\n        (focus)=\"openDomainInput.next($any($event.target).value)\"\r\n      />\r\n      <div class=\"input-group-append\">\r\n        <button\r\n          (click)=\"remove.emit()\"\r\n          class=\"btn btn-secondary align-self-baseline\"\r\n          type=\"button\"\r\n        >\r\n          Remove\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","<form [formGroup]=\"domainsForm\" (ngSubmit)=\"submitForm()\">\r\n  <div class=\"form-group\" formArrayName=\"domains\">\r\n    <app-domain-selection-form\r\n      *ngFor=\"let control of domainsFormArray.controls; let index = index\"\r\n      [formGroupName]=\"index.toString()\"\r\n      [domainDefinitions]=\"domainDefinitions\"\r\n      [index]=\"index\"\r\n      (remove)=\"remove(index)\"\r\n    ></app-domain-selection-form>\r\n  </div>\r\n  <div class=\"form-group d-flex\">\r\n    <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n      Add Domain\r\n    </button>\r\n  </div>\r\n  <div class=\"form-group row\">\r\n    <div class=\"col-sm-12\">\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn btn-sm btn-block\"\r\n        [class.btn-dark]=\"!changed\"\r\n        [class.btn-primary]=\"changed\"\r\n        [disabled]=\"!domainsForm.valid\"\r\n      >\r\n        Update<span *ngIf=\"changed\"> (unsaved changes)</span>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  Domain,\r\n  DomainEntry,\r\n} from '../../development-process-registry/knowledge/domain';\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { DomainService } from '../../development-process-registry/knowledge/domain.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { equalsList } from '../utils';\r\n\r\n@Component({\r\n  selector: 'app-domains-selection-form',\r\n  templateUrl: './domains-selection-form.component.html',\r\n  styleUrls: ['./domains-selection-form.component.css'],\r\n})\r\nexport class DomainsSelectionFormComponent\r\n  implements OnInit, OnChanges, OnDestroy\r\n{\r\n  @Input() domains: Domain[];\r\n\r\n  /**\r\n   * Emits a form array containing of real domains,\r\n   * i.e., of type Domain\r\n   */\r\n  @Output() submitDomainsForm = new EventEmitter<FormArray>();\r\n\r\n  domainsForm: FormGroup = this.fb.group({\r\n    domains: this.fb.array([]),\r\n  });\r\n  changed = false;\r\n\r\n  domainDefinitions: DomainEntry[] = [];\r\n\r\n  private changeSubscription: Subscription;\r\n\r\n  constructor(private domainService: DomainService, private fb: FormBuilder) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadDomains();\r\n    this.changeSubscription = this.domainsForm.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(\r\n          (value) => (this.changed = !equalsList(this.domains, value.domains))\r\n        )\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.domains) {\r\n      const oldDomains: Domain[] = changes.domains.previousValue;\r\n      const newDomains: Domain[] = changes.domains.currentValue;\r\n      if (!equalsList(oldDomains, newDomains)) {\r\n        this.loadForm(newDomains);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.changeSubscription) {\r\n      this.changeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  add(): void {\r\n    this.domainsFormArray.push(this.fb.control(null, Validators.required));\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.domainsFormArray.removeAt(index);\r\n  }\r\n\r\n  private loadForm(domains: Domain[]): void {\r\n    const formGroups = domains.map((domain) =>\r\n      this.fb.control(domain, Validators.required)\r\n    );\r\n    this.domainsForm.setControl('domains', this.fb.array(formGroups));\r\n  }\r\n\r\n  submitForm(): void {\r\n    this.submitDomainsForm.emit(this.domainsFormArray);\r\n  }\r\n\r\n  get domainsFormArray(): FormArray {\r\n    return this.domainsForm.get('domains') as FormArray;\r\n  }\r\n\r\n  private async loadDomains(): Promise<void> {\r\n    this.domainDefinitions = await this.domainService.getList();\r\n  }\r\n}\r\n","<div\r\n  *ngFor=\"\r\n    let control of formArray.controls;\r\n    let index = index;\r\n    let first = first;\r\n    let last = last\r\n  \"\r\n  class=\"form-group row\"\r\n>\r\n  <label for=\"elementName\" class=\"col-sm-4 col-form-label\">{{\r\n    elementName\r\n  }}</label>\r\n  <div class=\"col-sm-8 input-group\">\r\n    <input\r\n      type=\"text\"\r\n      [formControl]=\"asFormControl(control)\"\r\n      class=\"form-control\"\r\n      [class.is-invalid]=\"control.invalid\"\r\n      id=\"elementName\"\r\n      aria-describedby=\"elementNameFeedback\"\r\n    />\r\n    <div class=\"input-group-append\">\r\n      <ng-container *ngIf=\"ordered\">\r\n        <button\r\n          [disabled]=\"first\"\r\n          (click)=\"up(index)\"\r\n          class=\"btn btn-outline-secondary\"\r\n          type=\"button\"\r\n        >\r\n          Up\r\n        </button>\r\n        <button\r\n          [disabled]=\"last\"\r\n          (click)=\"down(index)\"\r\n          class=\"btn btn-outline-secondary\"\r\n          type=\"button\"\r\n        >\r\n          Down\r\n        </button>\r\n      </ng-container>\r\n      <button\r\n        (click)=\"remove(index)\"\r\n        class=\"btn btn-outline-secondary\"\r\n        type=\"button\"\r\n      >\r\n        Remove\r\n      </button>\r\n    </div>\r\n    <div id=\"elementNameFeedback\" class=\"invalid-feedback\">\r\n      <span *ngIf=\"control.hasError('required')\">This field is required.</span>\r\n      <span\r\n        *ngIf=\"!control.hasError('required') && control.hasError('lowercase')\"\r\n      >\r\n        The name of the element should consist of letters only and be written in\r\n        lower case.\r\n      </span>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\"d-flex\">\r\n  <button (click)=\"add()\" type=\"button\" class=\"btn btn-secondary ml-auto\">\r\n    Add {{ elementName }}\r\n  </button>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport {\r\n  AbstractControl,\r\n  FormArray,\r\n  FormBuilder,\r\n  FormControl,\r\n  ValidationErrors,\r\n  Validators,\r\n} from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-form-array-list',\r\n  templateUrl: './form-array-list.component.html',\r\n  styleUrls: ['./form-array-list.component.css'],\r\n})\r\nexport class FormArrayListComponent {\r\n  @Input() elementName: string;\r\n  @Input() formArray: FormArray;\r\n  @Input() validators: ((control: AbstractControl) => ValidationErrors)[] = [\r\n    Validators.required,\r\n  ];\r\n\r\n  @Input() ordered = false;\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  add(): void {\r\n    this.formArray.push(this.fb.control('', this.validators));\r\n  }\r\n\r\n  up(position: number): void {\r\n    this.changePosition(position, -1);\r\n  }\r\n\r\n  down(position: number): void {\r\n    this.changePosition(position, 1);\r\n  }\r\n\r\n  changePosition(position: number, delta: number): void {\r\n    const control = this.formArray.controls[position];\r\n    const newPosition = position + delta;\r\n    this.formArray.removeAt(position);\r\n    this.formArray.insert(newPosition, control);\r\n  }\r\n\r\n  remove(index: number): void {\r\n    this.formArray.removeAt(index);\r\n  }\r\n\r\n  asFormControl(control: AbstractControl): FormControl {\r\n    return control as FormControl;\r\n  }\r\n}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <div class=\"d-flex border-bottom border-gray mb-2\">\r\n    <h6 class=\"pb-2 mb-0\">{{ listTitle }}</h6>\r\n    <div\r\n      *ngIf=\"!loading && reloading\"\r\n      class=\"spinner-border spinner-border-sm ml-auto\"\r\n      role=\"status\"\r\n    >\r\n      <span class=\"sr-only\">Loading...</span>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"loading\">\r\n    <div class=\"d-flex justify-content-center\">\r\n      <div class=\"spinner-border\" role=\"status\">\r\n        <span class=\"sr-only\">Loading...</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div *ngIf=\"!loading && noResults\">\r\n    <ng-content select=\"[noResults]\"></ng-content>\r\n  </div>\r\n  <div *ngIf=\"!loading && !noResults\">\r\n    <ng-content select=\"[results]\"></ng-content>\r\n  </div>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-list-wrapper',\r\n  templateUrl: './list-wrapper.component.html',\r\n  styleUrls: ['./list-wrapper.component.css'],\r\n})\r\nexport class ListWrapperComponent {\r\n  @Input() listTitle: string;\r\n  @Input() loading: boolean = false;\r\n  @Input() reloading: boolean = false;\r\n  @Input() noResults: boolean = false;\r\n}\r\n","import { Inject, Injectable, InjectionToken } from '@angular/core';\r\nimport { DatabaseModel } from '../database/database-model';\r\nimport { ElementService } from '../database/element.service';\r\nimport { DatabaseRootInit } from '../database/database-entry';\r\nimport { EntryType } from '../database/database-model-part';\r\n\r\nexport const ELEMENT_SERVICE = new InjectionToken<\r\n  ElementService<DatabaseModel, DatabaseRootInit>\r\n>('Element service');\r\n\r\n@Injectable()\r\nexport class ListService<T extends DatabaseModel, S extends DatabaseRootInit> {\r\n  private _elements: EntryType<T>[];\r\n  get elements(): EntryType<T>[] {\r\n    return this._elements;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.elements == null;\r\n  }\r\n\r\n  private _reloading: boolean;\r\n  get reloading(): boolean {\r\n    return this._reloading;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.elements != null && this.elements.length === 0;\r\n  }\r\n\r\n  constructor(\r\n    @Inject(ELEMENT_SERVICE) private elementService: ElementService<T, S>\r\n  ) {\r\n    void this.load();\r\n  }\r\n\r\n  async add(element: S): Promise<void> {\r\n    this._reloading = true;\r\n    await this.elementService.add(element);\r\n    await this.load();\r\n  }\r\n\r\n  async delete(elementId: string): Promise<void> {\r\n    this._reloading = true;\r\n    const elements = this._elements;\r\n    await this.elementService.delete(elementId);\r\n    // check that no reload happened before updating the local version\r\n    if (elements === this._elements) {\r\n      this._elements = this._elements.filter(\r\n        (element) => element._id !== elementId\r\n      );\r\n    }\r\n    await this.load();\r\n  }\r\n\r\n  /**\r\n   * Loads the elements list.\r\n   * Calling this method should be necessary only in some edge cases.\r\n   */\r\n  async load(): Promise<void> {\r\n    this._reloading = true;\r\n    this._elements = await this.elementService.getList();\r\n    this._reloading = false;\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-results-list-item',\r\n  templateUrl: './results-list-item.component.html',\r\n  styleUrls: ['./results-list-item.component.css'],\r\n})\r\nexport class ResultsListItemComponent {\r\n  @Input() viewLink: string[];\r\n  @Output() delete = new EventEmitter();\r\n}\r\n","<div class=\"d-flex justify-content-between align-items-baseline\">\r\n  <div class=\"mr-3\">\r\n    <span><ng-content select=\"[itemTitle]\"></ng-content></span>\r\n    <div class=\"text-muted small\">\r\n      <ng-content select=\"[itemDescription]\"></ng-content>\r\n    </div>\r\n    <ng-content></ng-content>\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <a [routerLink]=\"viewLink\" type=\"button\" class=\"btn btn-dark btn-xs\">\r\n      View\r\n    </a>\r\n    <button\r\n      (click)=\"delete.emit()\"\r\n      type=\"button\"\r\n      class=\"btn btn-danger btn-xs ml-1\"\r\n    >\r\n      Delete\r\n    </button>\r\n  </div>\r\n</div>\r\n","import { Inject, Injectable, InjectionToken, OnDestroy } from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\ntype SearchFunction<T> = (searchValue: string, item: T) => boolean;\r\n\r\nexport const SEARCH_FUNCTION = new InjectionToken<SearchFunction<any>>(\r\n  'Search function'\r\n);\r\n\r\nexport function searchFunction<T extends { name: string }>(\r\n  searchValue: string,\r\n  item: T\r\n): boolean {\r\n  return item.name.toLowerCase().includes(searchValue);\r\n}\r\n\r\n@Injectable()\r\nexport class SearchService<T> implements OnDestroy {\r\n  searchForm: FormGroup = this.fb.group({\r\n    search: [''],\r\n  });\r\n\r\n  private _items: T[];\r\n  set items(items: T[]) {\r\n    this._items = items;\r\n    this.search(this.searchForm.value.search);\r\n  }\r\n\r\n  private _filteredResults: T[];\r\n  get filteredResults() {\r\n    return this._filteredResults;\r\n  }\r\n\r\n  private searchSubscription: Subscription;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    @Inject(SEARCH_FUNCTION) private searchFunction: SearchFunction<T>\r\n  ) {\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.searchSubscription = this.searchForm\r\n      .get('search')\r\n      .valueChanges.pipe(debounceTime(300))\r\n      .subscribe((value) => this.search(value));\r\n  }\r\n\r\n  private search(value?: string) {\r\n    if (value != null) {\r\n      value = value.toLowerCase();\r\n      this._filteredResults = this._items.filter((item) =>\r\n        this.searchFunction(value, item)\r\n      );\r\n    } else {\r\n      this._filteredResults = this._items;\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.searchSubscription.unsubscribe();\r\n  }\r\n}\r\n","<form [formGroup]=\"searchForm\" class=\"form-inline\">\r\n  <label class=\"sr-only\" for=\"search\">Search</label>\r\n  <input\r\n    formControlName=\"search\"\r\n    type=\"text\"\r\n    class=\"form-control mb-2 mr-sm-2\"\r\n    id=\"search\"\r\n    placeholder=\"Search\"\r\n  />\r\n</form>\r\n<h5>{{ heading }}</h5>\r\n<div *ngIf=\"!items\" class=\"alert alert-info\">Loading...</div>\r\n<div *ngIf=\"items && items.length === 0\" class=\"alert alert-info\">\r\n  No fitting {{ itemName }}\r\n</div>\r\n<div\r\n  *ngIf=\"\r\n    items && items.length > 0 && filteredResults && filteredResults.length === 0\r\n  \"\r\n>\r\n  No fitting {{ itemName }} for search {{ searchForm.value.search }}.\r\n</div>\r\n<ul\r\n  *ngIf=\"filteredResults && filteredResults.length > 0\"\r\n  class=\"list-group shadow-sm\"\r\n>\r\n  <li *ngFor=\"let item of filteredResults\" class=\"list-group-item\">\r\n    <ng-container\r\n      [ngTemplateOutlet]=\"content\"\r\n      [ngTemplateOutletContext]=\"{ $implicit: item }\"\r\n    ></ng-container>\r\n  </li>\r\n</ul>\r\n","import {\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  TemplateRef,\r\n} from '@angular/core';\r\nimport { SearchService } from '../search.service';\r\nimport { FormGroup } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-search',\r\n  templateUrl: './search.component.html',\r\n  styleUrls: ['./search.component.css'],\r\n  providers: [SearchService],\r\n})\r\nexport class SearchComponent<T> implements OnChanges {\r\n  @Input() heading: string;\r\n  @Input() itemName: string;\r\n  @Input() content: TemplateRef<unknown>;\r\n  @Input() items: T[];\r\n\r\n  constructor(private searchService: SearchService<T>) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes.items) {\r\n      this.searchForm.reset();\r\n      this.searchService.items = changes.items.currentValue;\r\n    }\r\n  }\r\n\r\n  get searchForm(): FormGroup {\r\n    return this.searchService.searchForm;\r\n  }\r\n\r\n  get filteredResults(): T[] {\r\n    return this.searchService.filteredResults;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { AuthorFormComponent } from './author-form/author-form.component';\r\nimport { AuthorInfoComponent } from './author-info/author-info.component';\r\nimport { DescriptionFormComponent } from './description-form/description-form.component';\r\nimport { DevelopmentProcessViewModule } from '../development-process-view/development-process-view.module';\r\nimport { FormArrayListComponent } from './form-array-list/form-array-list.component';\r\nimport { DomainSelectionFormComponent } from './domain-selection-form/domain-selection-form.component';\r\nimport { DomainsSelectionFormComponent } from './domains-selection-form/domains-selection-form.component';\r\nimport { DeleteModalComponent } from './delete-modal/delete-modal.component';\r\nimport { SearchComponent } from './search/search.component';\r\nimport { ListWrapperComponent } from './list-wrapper/list-wrapper.component';\r\nimport { ResultsListItemComponent } from './results-list-item/results-list-item.component';\r\nimport { RouterModule } from '@angular/router';\r\nimport { ApiNavigationComponent } from './api-navigation/api-navigation.component';\r\nimport { StepErrorsComponent } from './step-errors/step-errors.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ApiNavigationComponent,\r\n    AuthorFormComponent,\r\n    AuthorInfoComponent,\r\n    DescriptionFormComponent,\r\n    FormArrayListComponent,\r\n    DomainSelectionFormComponent,\r\n    DomainsSelectionFormComponent,\r\n    DeleteModalComponent,\r\n    SearchComponent,\r\n    ListWrapperComponent,\r\n    ResultsListItemComponent,\r\n    StepErrorsComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    DevelopmentProcessViewModule,\r\n    NgbModule,\r\n    ReactiveFormsModule,\r\n    RouterModule,\r\n  ],\r\n  exports: [\r\n    CommonModule,\r\n    NgbModule,\r\n    ReactiveFormsModule,\r\n\r\n    ApiNavigationComponent,\r\n    AuthorFormComponent,\r\n    AuthorInfoComponent,\r\n    DeleteModalComponent,\r\n    DescriptionFormComponent,\r\n    DevelopmentProcessViewModule,\r\n    FormArrayListComponent,\r\n    DomainsSelectionFormComponent,\r\n    SearchComponent,\r\n    ListWrapperComponent,\r\n    ResultsListItemComponent,\r\n    StepErrorsComponent,\r\n  ],\r\n})\r\nexport class SharedModule {}\r\n","<main\r\n  *ngIf=\"\r\n    processApiService.runningProcess == null && processApiService.errorLoading\r\n  \"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"alert alert-info my-3\">\r\n    <p>The running method can not be loaded.</p>\r\n    <p class=\"mb-0\">\r\n      <a [routerLink]=\"['/', 'runningprocess']\"\r\n        >Go back to overview of running methods</a\r\n      >\r\n    </p>\r\n  </div>\r\n</main>\r\n\r\n<main\r\n  *ngIf=\"\r\n    processApiService.runningMethod == null &&\r\n    processApiService.runningProcess != null &&\r\n    processApiService.errorLoading\r\n  \"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"alert alert-info my-3\">\r\n    <p>\r\n      Selected development step is currently not executed or has been canceled.\r\n    </p>\r\n    <p class=\"mb-0\">\r\n      <a\r\n        [routerLink]=\"[\r\n          '/',\r\n          'runningprocess',\r\n          'runningprocessview',\r\n          processApiService.runningProcess._id\r\n        ]\"\r\n      >\r\n        Go back to kanban board of running method\r\n      </a>\r\n    </p>\r\n  </div>\r\n</main>\r\n\r\n<main\r\n  *ngIf=\"\r\n    processApiService.runningMethod != null &&\r\n    !processApiService.isCorrectStep()\r\n  \"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"alert alert-info my-3\">\r\n    <p\r\n      *ngIf=\"\r\n        processApiService.stepInfo.step >\r\n        processApiService.runningMethod.currentStepNumber\r\n      \"\r\n    >\r\n      This step cannot be executed yet, because the previous step has not been\r\n      completed.\r\n    </p>\r\n    <p\r\n      *ngIf=\"\r\n        processApiService.stepInfo.step <\r\n        processApiService.runningMethod.currentStepNumber\r\n      \"\r\n    >\r\n      Step already executed.\r\n    </p>\r\n    <p class=\"mb-0\">\r\n      <a\r\n        [routerLink]=\"[\r\n          '/',\r\n          'runningprocess',\r\n          'runningprocessview',\r\n          processApiService.runningProcess._id,\r\n          'method',\r\n          processApiService.runningMethod.executionId\r\n        ]\"\r\n      >\r\n        Go back to development step overview\r\n      </a>\r\n    </p>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { ProcessApiService } from '../../development-process-registry/module-api/process-api.service';\r\n\r\n@Component({\r\n  selector: 'app-step-errors',\r\n  templateUrl: './step-errors.component.html',\r\n  styleUrls: ['./step-errors.component.css'],\r\n})\r\nexport class StepErrorsComponent {\r\n  constructor(public processApiService: ProcessApiService) {}\r\n}\r\n","import { Observable } from 'rxjs';\r\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\r\nimport { Equality } from './equality';\r\n\r\nexport function getTypeaheadInputPipe(input: Observable<string>) {\r\n  return input.pipe(debounceTime(150), distinctUntilChanged());\r\n}\r\n\r\n/**\r\n * Check whether list of lists is equal to another list of lists\r\n *\r\n * @param listsA the first list of lists\r\n * @param listsB the second list of lists\r\n * @return true if the lists are both null/undefined or have the same amount of elements and all elements are equal at the same index\r\n */\r\nexport function equalsListOfLists<T>(\r\n  listsA: Equality<T>[][],\r\n  listsB: T[][]\r\n): boolean {\r\n  return equalsListGeneric<Equality<T>[], T[]>(listsA, listsB, (a, b) =>\r\n    equalsList(a, b)\r\n  );\r\n}\r\n\r\n/**\r\n * Check whether is a list is equal to another list\r\n *\r\n * @param listA the first list\r\n * @param listB the second list\r\n * @return true if the lists are both null/undefined or have the same amount of elements and all elements are equal at the same index\r\n */\r\nexport function equalsList<T>(listA: Equality<T>[], listB: T[]): boolean {\r\n  return equalsListGeneric<Equality<T>, T>(listA, listB, (a, b) => a.equals(b));\r\n}\r\n\r\n/**\r\n * Check whether a list of strings is equal to another list of strings\r\n *\r\n * @param listA the first list of strings\r\n * @param listB the second list of strings\r\n * @return true if the lists are both null/undefined or have the same amount of elements and all elements are equal at the same index\r\n */\r\nexport function equalsListString(listA: string[], listB: string[]): boolean {\r\n  return equalsListGeneric<string, string>(listA, listB, (a, b) => a === b);\r\n}\r\n\r\n/**\r\n * Check whether a list is equal to another list\r\n *\r\n * @param listA the first list\r\n * @param listB the second list\r\n * @param compare the function used to compare the elements\r\n * @return true if the lists are both null/undefined or have the same amount of elements and all elements are equal at the same index\r\n */\r\nexport function equalsListGeneric<T, S>(\r\n  listA: T[],\r\n  listB: S[],\r\n  compare: (a: T, b: S) => boolean\r\n): boolean {\r\n  if (listA == null && listB == null) {\r\n    return true;\r\n  }\r\n  if (listA == null || listB == null) {\r\n    return false;\r\n  }\r\n  return (\r\n    listA.length === listB.length &&\r\n    listB.every((itemB, index) => {\r\n      const itemA = listA[index];\r\n      if (itemA == null && itemB == null) {\r\n        return true;\r\n      }\r\n      if (itemA == null || itemB == null) {\r\n        return false;\r\n      }\r\n      return compare(itemA, itemB);\r\n    })\r\n  );\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-start-business-developer',\r\n  templateUrl: './start-business-developer.component.html',\r\n  styleUrls: ['./start-business-developer.component.css'],\r\n})\r\nexport class StartBusinessDeveloperComponent {}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h2 class=\"border-bottom border-gray pb-2\">Business Developer Role</h2>\r\n  <p class=\"mb-0\">\r\n    The Business Developer Role is used to enact the defined Business Model\r\n    Development Methods.\r\n  </p>\r\n</div>\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-start-method-engineer',\r\n  templateUrl: './start-method-engineer.component.html',\r\n  styleUrls: ['./start-method-engineer.component.css'],\r\n})\r\nexport class StartMethodEngineerComponent {}\r\n","<div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n  <h2 class=\"border-bottom border-gray pb-2\">Method Engineer Role</h2>\r\n  <p>\r\n    The Method Engineer Role is used to define Business Model Development\r\n    Methods.\r\n  </p>\r\n  <p class=\"mb-0\">The process to do this is separated into multiple steps:</p>\r\n  <ol class=\"mb-0\">\r\n    <li>\r\n      <a [routerLink]=\"['/', 'methodElements']\">\r\n        Create Method Elements in the Method Repository\r\n      </a>\r\n    </li>\r\n    <li>\r\n      <a [routerLink]=\"['/', 'methods']\">\r\n        Assemble Method Building Blocks from these Method Elements\r\n      </a>\r\n    </li>\r\n    <li>\r\n      <a [routerLink]=\"['/', 'process']\">\r\n        Create Method Patterns that will be used to connect different Method\r\n        Building Blocks\r\n      </a>\r\n    </li>\r\n    <li>\r\n      <a [routerLink]=\"['/', 'bmprocess']\">\r\n        Compose Business Model Development Methods by selecting Method Patterns\r\n        and filling them with Method Building Blocks\r\n      </a>\r\n    </li>\r\n  </ol>\r\n</div>\r\n","<main role=\"main\" class=\"container\">\r\n  <app-profile *ngIf=\"!isLocalDatabase()\"></app-profile>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h1 class=\"border-bottom border-gray pb-2\">\r\n      Situational Business Model Developer\r\n    </h1>\r\n    <p>\r\n      Welcome to the Situational Business Model Developer (SBMD). The SBMD\r\n      allows the development of business models by taking the context of the\r\n      company and the product/service into account.\r\n    </p>\r\n    <p class=\"mb-0\">\r\n      A detailed explanation is given\r\n      <a [routerLink]=\"['/', 'explanation']\">here</a>.\r\n    </p>\r\n  </div>\r\n\r\n  <app-start-business-developer\r\n    *ngIf=\"currentRole === roles.BUSINESSDEVELOPER\"\r\n  ></app-start-business-developer>\r\n  <app-start-method-engineer\r\n    *ngIf=\"currentRole === roles.EXPERT\"\r\n  ></app-start-method-engineer>\r\n</main>\r\n","import { Component } from '@angular/core';\r\nimport { InternalRoles, UserService } from '../user.service';\r\nimport { environment } from '../../environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-start',\r\n  templateUrl: './start.component.html',\r\n  styleUrls: ['./start.component.css'],\r\n})\r\nexport class StartComponent {\r\n  constructor(private userService: UserService) {}\r\n\r\n  get currentRole(): InternalRoles {\r\n    return this.userService.activatedRole;\r\n  }\r\n\r\n  get roles(): typeof InternalRoles {\r\n    return InternalRoles;\r\n  }\r\n\r\n  isLocalDatabase(): boolean {\r\n    return environment.localDatabase === true;\r\n  }\r\n}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Tool Explanation</a>\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Explanations</h6>\r\n    <ul ngbNav #nav=\"ngbNav\" class=\"nav-pills nav-justified\">\r\n      <li ngbNavItem>\r\n        <a ngbNavLink>Enaction</a>\r\n        <ng-template ngbNavContent>\r\n          <app-enaction-explanation></app-enaction-explanation>\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem>\r\n        <a ngbNavLink>Method Modeler</a>\r\n        <ng-template ngbNavContent>\r\n          <app-method-modeler-explanation></app-method-modeler-explanation>\r\n        </ng-template>\r\n      </li>\r\n      <li ngbNavItem>\r\n        <a ngbNavLink>Feature Modeler</a>\r\n        <ng-template ngbNavContent>\r\n          <app-feature-modeler-explanation></app-feature-modeler-explanation>\r\n        </ng-template>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <div class=\"mt-1\" [ngbNavOutlet]=\"nav\"></div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Further Information</h6>\r\n    <p class=\"mt-2\">Further information can be accessed in two ways:</p>\r\n    <ul class=\"mb-0\">\r\n      <li>\r\n        <strong>Download Source Code:</strong>\r\n        <a\r\n          href=\"https://github.com/SebastianGTTS/situational-business-modeler-developer\"\r\n        >\r\n          https://github.com/SebastianGTTS/situational-business-modeler-developer\r\n        </a>\r\n      </li>\r\n      <li><strong>Read Research Paper:</strong> Currently under review</li>\r\n    </ul>\r\n  </div>\r\n</main>\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-tool-explanation',\r\n  templateUrl: './tool-explanation.component.html',\r\n  styleUrls: ['./tool-explanation.component.css'],\r\n})\r\n/**\r\n * The ToolExplanationComponent shows the explanation of the tool in the web application.\r\n *\r\n * @author Sebastian Gottschalk\r\n */\r\nexport class ToolExplanationComponent {}\r\n","import { Injectable } from '@angular/core';\r\n\r\nexport enum InternalRoles {\r\n  EXPERT = 'Method Engineer',\r\n  BUSINESSDEVELOPER = 'Business Developer',\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class UserService {\r\n  activatedRole: InternalRoles = InternalRoles.BUSINESSDEVELOPER;\r\n}\r\n","import { fabric } from 'fabric';\r\n\r\nexport interface CanvasNoteInit {\r\n  color: string | undefined;\r\n  darkerColor: string | undefined;\r\n  point: fabric.Point;\r\n}\r\n\r\ninterface CanvasNoteFromObjectInit {\r\n  objects?: fabric.Object[];\r\n  options?: fabric.IGroupOptions;\r\n  isAlreadyGrouped?: boolean;\r\n}\r\n\r\nexport interface CanvasNoteConstructor {\r\n  new (\r\n    init?: CanvasNoteInit,\r\n    fromObject?: CanvasNoteFromObjectInit\r\n  ): CanvasNote;\r\n\r\n  fromObject: Function;\r\n}\r\n\r\nexport interface CanvasNote extends fabric.Group {\r\n  setFillColor(color: string | undefined, darker: string | undefined): void;\r\n\r\n  setStrokeColor(color: string | undefined): void;\r\n\r\n  getTextbox(): fabric.Textbox;\r\n\r\n  getTriangle(): fabric.Polygon;\r\n\r\n  getRectangle(): fabric.Polygon;\r\n}\r\n\r\nexport const CanvasNote: CanvasNoteConstructor = fabric.util.createClass(\r\n  fabric.Group,\r\n  {\r\n    type: 'canvasNote',\r\n\r\n    initialize: function (\r\n      init?: CanvasNoteInit,\r\n      fromObject?: CanvasNoteFromObjectInit\r\n    ): void {\r\n      if (init != null) {\r\n        const width = 200;\r\n        const height = 100;\r\n        const text = new fabric.Textbox('Note...', {\r\n          originX: 'center',\r\n          originY: 'center',\r\n          width: 100,\r\n        });\r\n        const noteRect = new fabric.Polygon(\r\n          [\r\n            { x: -width / 2, y: -height / 2 },\r\n            { x: width / 2 - 20, y: -height / 2 },\r\n            { x: width / 2, y: -height / 2 + 20 },\r\n            { x: width / 2, y: height / 2 },\r\n            { x: -width / 2, y: height / 2 },\r\n          ],\r\n          {\r\n            fill: init.color,\r\n            shadow: new fabric.Shadow({\r\n              offsetY: 5,\r\n              color: 'rgba(0,0,0,0.25)',\r\n            }),\r\n            selectable: false,\r\n          }\r\n        );\r\n        const noteTriangle = new fabric.Polygon(\r\n          [\r\n            { x: width / 2 - 20, y: -height / 2 },\r\n            { x: width / 2 - 20, y: -height / 2 + 20 },\r\n            { x: width / 2, y: -height / 2 + 20 },\r\n          ],\r\n          {\r\n            fill: init.darkerColor,\r\n            selectable: false,\r\n          }\r\n        );\r\n        this.callSuper('initialize', [noteRect, noteTriangle, text], {\r\n          left: init.point.x - 100,\r\n          top: init.point.y - 50,\r\n          fill: init.color,\r\n        });\r\n      } else if (fromObject != null) {\r\n        this.callSuper(\r\n          'initialize',\r\n          fromObject.objects,\r\n          fromObject.options,\r\n          fromObject.isAlreadyGrouped\r\n        );\r\n      } else {\r\n        throw new Error('Either init or fromObject must be provided!');\r\n      }\r\n\r\n      this._initEventListeners();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _initEventListeners: function (this: CanvasNote): void {\r\n      const mousedblclickHandler = (): void => {\r\n        const text = this.getTextbox();\r\n        const canvas = this.canvas!;\r\n        this.off();\r\n        const objects = this.getObjects();\r\n        this.destroy();\r\n        canvas.remove(this);\r\n        canvas.add(...objects);\r\n        canvas.setActiveObject(text);\r\n        text.enterEditing();\r\n        text.selectAll();\r\n        const handleExitEditing = (): void => {\r\n          canvas.off('save', handleExitEditing);\r\n          text.off('editing:exited', handleExitEditing);\r\n          canvas.remove(...objects);\r\n          const note = new CanvasNote(undefined, { objects });\r\n          canvas.add(note);\r\n        };\r\n        text.on('editing:exited', handleExitEditing);\r\n        canvas.on('save', handleExitEditing);\r\n      };\r\n      this.on('mousedblclick', mousedblclickHandler);\r\n    },\r\n\r\n    _set(this: CanvasNote, key: string, value: unknown): fabric.Object {\r\n      if (key === 'strokeWidth' && this._objects.length === 3) {\r\n        this.getRectangle().set('strokeWidth', value as number);\r\n        this.getTriangle().set('strokeWidth', value as number);\r\n      }\r\n      return fabric.Group.prototype._set.call(this, key, value);\r\n    },\r\n\r\n    setFillColor(\r\n      this: CanvasNote,\r\n      color: string | undefined,\r\n      darker: string | undefined\r\n    ): void {\r\n      this.getRectangle().set('fill', color);\r\n      this.getTriangle().set('fill', darker);\r\n      this.set('fill', color);\r\n    },\r\n\r\n    setStrokeColor(this: CanvasNote, color: string | undefined): void {\r\n      this.getRectangle().set('stroke', color);\r\n      this.getTriangle().set('stroke', color);\r\n      this.set('stroke', color);\r\n    },\r\n\r\n    getTextbox: function (this: CanvasNote): fabric.Textbox {\r\n      return this.item(2) as unknown as fabric.Textbox;\r\n    },\r\n\r\n    getTriangle: function (this: CanvasNote): fabric.Polygon {\r\n      return this.item(1) as unknown as fabric.Polygon;\r\n    },\r\n\r\n    getRectangle: function (this: CanvasNote): fabric.Polygon {\r\n      return this.item(0) as unknown as fabric.Polygon;\r\n    },\r\n  }\r\n);\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nCanvasNote.fromObject = function (object: any, callback: Function): void {\r\n  fabric.util.enlivenObjects(\r\n    object.objects,\r\n    function (enlivenedObjects: fabric.Object[]): void {\r\n      // @ts-ignore\r\n      const options = fabric.util.object.clone(object, true);\r\n      delete options.objects;\r\n      callback(\r\n        new CanvasNote(undefined, {\r\n          objects: enlivenedObjects,\r\n          options,\r\n          isAlreadyGrouped: true,\r\n        })\r\n      );\r\n    },\r\n    'fabric'\r\n  );\r\n};\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n(fabric as any).CanvasNote = CanvasNote;\r\n","import { Injectable } from '@angular/core';\r\nimport { WhiteboardCanvas } from './whiteboard';\r\nimport { fabric } from 'fabric';\r\n\r\ninterface CanvasObjectData {\r\n  interactive: boolean;\r\n}\r\n\r\n@Injectable()\r\nexport class WhiteboardCanvasService {\r\n  /**\r\n   * Get a fabric whiteboard canvas instance that is read only\r\n   *\r\n   * @param canvasElement the canvas element to which to connect\r\n   * @param whiteboardCanvas the whiteboard canvas to load\r\n   * @return the read only fabric canvas instance\r\n   */\r\n  async getReadonlyWhiteboardCanvas(\r\n    canvasElement: HTMLCanvasElement,\r\n    whiteboardCanvas: WhiteboardCanvas\r\n  ): Promise<fabric.Canvas> {\r\n    const canvas = new fabric.Canvas(canvasElement);\r\n    canvas.interactive = false;\r\n    canvas.selection = false;\r\n    await new Promise((resolve) =>\r\n      canvas.loadFromJSON(whiteboardCanvas, resolve)\r\n    );\r\n    canvas.forEachObject((object) =>\r\n      object.set({\r\n        selectable: false,\r\n        lockMovementX: true,\r\n        lockMovementY: true,\r\n        lockScalingX: true,\r\n        lockScalingY: true,\r\n        lockUniScaling: true,\r\n        lockRotation: true,\r\n        hoverCursor: 'default',\r\n        moveCursor: 'default',\r\n      })\r\n    );\r\n    return canvas;\r\n  }\r\n\r\n  /**\r\n   * Get a fabric whiteboard canvas instance\r\n   *\r\n   * @param canvasElement the canvas element to which to connect\r\n   * @param whiteboardCanvas the whiteboard canvas to load\r\n   * @return the fabric canvas instance\r\n   */\r\n  async getWhiteboardCanvas(\r\n    canvasElement: HTMLCanvasElement,\r\n    whiteboardCanvas: WhiteboardCanvas\r\n  ): Promise<fabric.Canvas> {\r\n    const canvas = new fabric.Canvas(canvasElement);\r\n    await new Promise((resolve) =>\r\n      canvas.loadFromJSON(whiteboardCanvas, resolve)\r\n    );\r\n    canvas.forEachObject((object) => {\r\n      const data: CanvasObjectData | undefined = object.get('data');\r\n      if (data != null) {\r\n        if (!data.interactive) {\r\n          object.set({\r\n            selectable: false,\r\n            lockMovementX: true,\r\n            lockMovementY: true,\r\n            lockScalingX: true,\r\n            lockScalingY: true,\r\n            lockUniScaling: true,\r\n            lockRotation: true,\r\n            hoverCursor: 'default',\r\n            moveCursor: 'default',\r\n          });\r\n        }\r\n      }\r\n    });\r\n    return canvas;\r\n  }\r\n\r\n  /**\r\n   * Get the whiteboard canvas serialization\r\n   *\r\n   * @param canvas the canvas\r\n   * @return the serialization as a json string\r\n   */\r\n  getWhiteboardCanvasSerialization(canvas: fabric.Canvas): string {\r\n    canvas.fire('save');\r\n    return JSON.stringify(canvas.toJSON(['data']));\r\n  }\r\n\r\n  /**\r\n   * Creates an empty whiteboard canvas.\r\n   */\r\n  getEmptyWhiteboardCanvas(): WhiteboardCanvas {\r\n    const canvas = new fabric.Canvas(null);\r\n    const serialization = JSON.stringify(canvas);\r\n    canvas.dispose();\r\n    return serialization;\r\n  }\r\n\r\n  /**\r\n   * Sets all elements in a whiteboard canvas to read only\r\n   *\r\n   * @param whiteboardCanvas the canvas to make read only\r\n   * @return the canvas with all elements marked as readonly\r\n   */\r\n  async setReadOnly(\r\n    whiteboardCanvas: WhiteboardCanvas\r\n  ): Promise<WhiteboardCanvas> {\r\n    const canvas = new fabric.Canvas(null);\r\n    await new Promise((resolve) =>\r\n      canvas.loadFromJSON(whiteboardCanvas, resolve)\r\n    );\r\n    const data: CanvasObjectData = {\r\n      interactive: false,\r\n    };\r\n    canvas.forEachObject((object) => {\r\n      object.set('data', data);\r\n    });\r\n    const serialization = this.getWhiteboardCanvasSerialization(canvas);\r\n    canvas.dispose();\r\n    return serialization;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DefaultElementService } from '../database/default-element.service';\r\nimport {\r\n  WhiteboardInstance,\r\n  WhiteboardInstanceInit,\r\n} from './whiteboard-instance';\r\nimport { PouchdbService } from '../database/pouchdb.service';\r\nimport { WhiteboardTemplate } from './whiteboard-template';\r\nimport { DbId } from '../database/database-entry';\r\nimport { WhiteboardCanvas } from './whiteboard';\r\nimport { WhiteboardCanvasService } from './whiteboard-canvas.service';\r\n\r\n@Injectable()\r\nexport class WhiteboardInstanceService extends DefaultElementService<\r\n  WhiteboardInstance,\r\n  WhiteboardInstanceInit\r\n> {\r\n  protected readonly typeName = WhiteboardInstance.typeName;\r\n\r\n  protected readonly elementConstructor = WhiteboardInstance;\r\n\r\n  constructor(\r\n    pouchdbService: PouchdbService,\r\n    private whiteboardCanvasService: WhiteboardCanvasService\r\n  ) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  async addByTemplate(\r\n    name: string,\r\n    template: WhiteboardTemplate\r\n  ): Promise<WhiteboardInstance> {\r\n    const instance = new WhiteboardInstance(undefined, {\r\n      name,\r\n      whiteboard: await this.whiteboardCanvasService.setReadOnly(\r\n        template.whiteboard\r\n      ),\r\n    });\r\n    await this.save(instance);\r\n    return instance;\r\n  }\r\n\r\n  async saveWhiteboardCanvas(\r\n    id: DbId,\r\n    whiteboardCanvas: WhiteboardCanvas\r\n  ): Promise<void> {\r\n    const template = await this.get(id);\r\n    template.whiteboard = whiteboardCanvas;\r\n    await this.save(template);\r\n  }\r\n}\r\n","import { Whiteboard, WhiteboardEntry, WhiteboardInit } from './whiteboard';\r\n\r\nexport interface WhiteboardInstanceInit extends WhiteboardInit {}\r\n\r\nexport interface WhiteboardInstanceEntry extends WhiteboardEntry {}\r\n\r\nexport class WhiteboardInstance\r\n  extends Whiteboard\r\n  implements WhiteboardInstanceInit\r\n{\r\n  static readonly typeName = 'WhiteboardInstance';\r\n\r\n  constructor(\r\n    entry: WhiteboardInstanceEntry | undefined,\r\n    init: WhiteboardInstanceInit | undefined\r\n  ) {\r\n    super(entry, init, WhiteboardInstance.typeName);\r\n  }\r\n\r\n  toDb(): WhiteboardInstanceEntry {\r\n    return super.toDb();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  MetaModelApi,\r\n  Reference,\r\n} from '../development-process-registry/meta-model-definition';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { Router } from '@angular/router';\r\nimport { WhiteboardInstanceService } from './whiteboard-instance.service';\r\nimport { WhiteboardInstance } from './whiteboard-instance';\r\n\r\n@Injectable()\r\nexport class WhiteboardMetaModelApiService implements MetaModelApi {\r\n  viewMethod?: (\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ) => void;\r\n\r\n  constructor(private whiteboardInstanceService: WhiteboardInstanceService) {}\r\n\r\n  async copy(model: ArtifactDataReference): Promise<ArtifactDataReference> {\r\n    const instance = await this.whiteboardInstanceService.get(model.id);\r\n    instance.resetDatabaseState();\r\n    await this.whiteboardInstanceService.add(instance);\r\n    return {\r\n      id: instance._id,\r\n      type: WhiteboardInstance.typeName,\r\n    };\r\n  }\r\n\r\n  async getName(model: ArtifactDataReference): Promise<string | undefined> {\r\n    const instance = await this.whiteboardInstanceService.get(model.id);\r\n    return instance.name;\r\n  }\r\n\r\n  async remove(model: ArtifactDataReference): Promise<void> {\r\n    await this.whiteboardInstanceService.delete(model.id);\r\n  }\r\n\r\n  view(\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ): void {\r\n    if (this.viewMethod == null) {\r\n      console.warn('No module to view whiteboards added');\r\n    } else {\r\n      this.viewMethod(model, router, reference);\r\n    }\r\n  }\r\n}\r\n","import { APP_INITIALIZER, NgModule, Optional, SkipSelf } from '@angular/core';\r\nimport { WhiteboardMetaModelService } from './whiteboard-meta-model.service';\r\nimport { WhiteboardMetaModelApiService } from './whiteboard-meta-model-api.service';\r\nimport { WhiteboardInstanceService } from './whiteboard-instance.service';\r\nimport { WhiteboardCanvasService } from './whiteboard-canvas.service';\r\n\r\n@NgModule({\r\n  providers: [\r\n    WhiteboardCanvasService,\r\n    WhiteboardInstanceService,\r\n    WhiteboardMetaModelService,\r\n    WhiteboardMetaModelApiService,\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory:\r\n        (whiteboardMetaModelModule: WhiteboardMetaModelService) => (): void =>\r\n          whiteboardMetaModelModule.init(),\r\n      deps: [WhiteboardMetaModelService],\r\n      multi: true,\r\n    },\r\n  ],\r\n})\r\nexport class WhiteboardMetaModelModule {\r\n  // see https://angular.io/guide/singleton-services#prevent-reimport-of-the-greetingmodule\r\n  constructor(\r\n    @Optional()\r\n    @SkipSelf()\r\n    whiteboardMetaModelModule?: WhiteboardMetaModelModule\r\n  ) {\r\n    if (whiteboardMetaModelModule) {\r\n      throw new Error(\r\n        'WhiteboardMetaModelModule is already loaded. Import it in the AppModule only.'\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MetaModelService } from '../development-process-registry/meta-model.service';\r\nimport {\r\n  MetaModelDefinition,\r\n  MetaModelIdentifier,\r\n  Reference,\r\n} from '../development-process-registry/meta-model-definition';\r\nimport { Whiteboard } from './whiteboard';\r\nimport { WhiteboardInstance } from './whiteboard-instance';\r\nimport { WhiteboardMetaModelApiService } from './whiteboard-meta-model-api.service';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { Router } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class WhiteboardMetaModelService {\r\n  readonly whiteboardMetaModelIdentifier: Readonly<MetaModelIdentifier> = {\r\n    name: 'Whiteboard',\r\n    type: WhiteboardInstance.typeName,\r\n  };\r\n\r\n  constructor(\r\n    private metaModelService: MetaModelService,\r\n    private whiteboardMetaModelApiService: WhiteboardMetaModelApiService\r\n  ) {}\r\n\r\n  init(): void {\r\n    const definition: MetaModelDefinition = {\r\n      ...this.whiteboardMetaModelIdentifier,\r\n      api: this.whiteboardMetaModelApiService,\r\n    };\r\n    this.metaModelService.registerMetaModel(definition);\r\n    console.log('Registered Whiteboard Meta Model');\r\n  }\r\n\r\n  registerViewMethod(\r\n    view: (\r\n      model: ArtifactDataReference,\r\n      router: Router,\r\n      reference: Reference\r\n    ) => Promise<void>\r\n  ): void {\r\n    this.whiteboardMetaModelApiService.viewMethod = view;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { WhiteboardMetaModelModule } from './whiteboard-meta-model.module';\r\nimport { DefaultElementService } from '../database/default-element.service';\r\nimport {\r\n  WhiteboardTemplate,\r\n  WhiteboardTemplateInit,\r\n} from './whiteboard-template';\r\nimport { PouchdbService } from '../database/pouchdb.service';\r\nimport { WhiteboardCanvasService } from './whiteboard-canvas.service';\r\nimport { DbId } from '../database/database-entry';\r\nimport { WhiteboardCanvas } from './whiteboard';\r\n\r\n@Injectable({\r\n  providedIn: WhiteboardMetaModelModule,\r\n})\r\nexport class WhiteboardTemplateService extends DefaultElementService<\r\n  WhiteboardTemplate,\r\n  WhiteboardTemplateInit\r\n> {\r\n  protected readonly typeName = WhiteboardTemplate.typeName;\r\n\r\n  protected readonly elementConstructor = WhiteboardTemplate;\r\n\r\n  constructor(\r\n    pouchdbService: PouchdbService,\r\n    private whiteboardCanvasService: WhiteboardCanvasService\r\n  ) {\r\n    super(pouchdbService);\r\n  }\r\n\r\n  getWhiteboardTemplateInitialization(name: string): WhiteboardTemplateInit {\r\n    return {\r\n      name,\r\n      whiteboard: this.whiteboardCanvasService.getEmptyWhiteboardCanvas(),\r\n    };\r\n  }\r\n\r\n  async saveWhiteboardCanvas(\r\n    id: DbId,\r\n    whiteboardCanvas: WhiteboardCanvas\r\n  ): Promise<void> {\r\n    const template = await this.get(id);\r\n    template.whiteboard = whiteboardCanvas;\r\n    await this.save(template);\r\n  }\r\n}\r\n","import { Whiteboard, WhiteboardEntry, WhiteboardInit } from './whiteboard';\r\nimport { Author, AuthorEntry, AuthorInit } from '../model/author';\r\n\r\nexport interface WhiteboardTemplateInit extends WhiteboardInit {\r\n  author?: AuthorInit;\r\n  description?: string;\r\n}\r\n\r\nexport interface WhiteboardTemplateEntry extends WhiteboardEntry {\r\n  author: AuthorEntry;\r\n  description: string;\r\n}\r\n\r\nexport class WhiteboardTemplate\r\n  extends Whiteboard\r\n  implements WhiteboardTemplateInit\r\n{\r\n  static readonly typeName = 'WhiteboardTemplate';\r\n\r\n  author: Author;\r\n  description: string = '';\r\n\r\n  constructor(\r\n    entry: WhiteboardTemplateEntry | undefined,\r\n    init: WhiteboardTemplateInit | undefined\r\n  ) {\r\n    super(entry, init, WhiteboardTemplate.typeName);\r\n    const element = entry ?? init!;\r\n    this.description = element.description ?? this.description;\r\n    if (entry != null) {\r\n      this.author = new Author(entry.author, undefined);\r\n    } else {\r\n      this.author = new Author(undefined, init!.author ?? {});\r\n    }\r\n  }\r\n\r\n  toDb(): WhiteboardTemplateEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      description: this.description,\r\n      author: this.author.toDb(),\r\n    };\r\n  }\r\n}\r\n","import { DatabaseModel } from '../database/database-model';\r\nimport {\r\n  DatabaseRootEntry,\r\n  DatabaseRootInit,\r\n  DbType,\r\n} from '../database/database-entry';\r\n\r\nexport type WhiteboardCanvas = string;\r\n\r\nexport interface WhiteboardInit extends DatabaseRootInit {\r\n  name: string;\r\n  whiteboard: WhiteboardCanvas;\r\n}\r\n\r\nexport interface WhiteboardEntry extends DatabaseRootEntry {\r\n  name: string;\r\n  whiteboard: WhiteboardCanvas;\r\n}\r\n\r\nexport class Whiteboard extends DatabaseModel implements WhiteboardInit {\r\n  name: string;\r\n  whiteboard: WhiteboardCanvas;\r\n\r\n  constructor(\r\n    entry: WhiteboardEntry | undefined,\r\n    init: WhiteboardInit | undefined,\r\n    type: DbType\r\n  ) {\r\n    super(entry, init, type);\r\n    const element = entry ?? init!;\r\n    this.name = element.name;\r\n    this.whiteboard = element.whiteboard;\r\n  }\r\n\r\n  toDb(): WhiteboardEntry {\r\n    return {\r\n      ...super.toDb(),\r\n      name: this.name,\r\n      whiteboard: this.whiteboard,\r\n    };\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Create Place\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"runningMethod != null && isCorrectStep()\"\r\n  role=\"main\"\r\n  class=\"container\"\r\n>\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Create Place</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form [formGroup]=\"form\" (ngSubmit)=\"submit()\">\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\">Name</label>\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              [class.is-invalid]=\"nameControl.invalid\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!form.valid && whiteboardTemplate != null\"\r\n            >\r\n              Create Place\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n\r\n  <!--<div *ngIf=\"companyModel\" class=\"my-3 p-3 bg-white rounded shadow-sm\"> TODO add preview\r\n    <h6 class=\"border-bottom border-gray pb-2\">\r\n      Canvas Artifact Preview: {{ companyModel.definition.name }}\r\n    </h6>\r\n    <section>\r\n      <app-feature-model [featureModel]=\"companyModel\"></app-feature-model>\r\n    </section>\r\n    <section class=\"mt-3\" *ngIf=\"companyModel.definition.description\">\r\n      <h6>Description</h6>\r\n      <p class=\"mb-0\">{{ companyModel.definition.description }}</p>\r\n    </section>\r\n  </div>-->\r\n</main>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { WhiteboardTemplate } from '../../../whiteboard-meta-model/whiteboard-template';\r\nimport { WhiteboardTemplateService } from '../../../whiteboard-meta-model/whiteboard-template.service';\r\nimport { WhiteboardInstanceService } from '../../../whiteboard-meta-model/whiteboard-instance.service';\r\nimport { WhiteboardResolveService } from '../../whiteboard-resolve.service';\r\nimport { CreateWhiteboardPredefinedInput } from '../select-whiteboard-template-configuration/select-whiteboard-template-configuration.component';\r\n\r\n@Component({\r\n  selector: 'app-create-whiteboard-instance',\r\n  templateUrl: './create-whiteboard-instance.component.html',\r\n  styleUrls: ['./create-whiteboard-instance.component.css'],\r\n  providers: [ProcessApiService],\r\n})\r\nexport class CreateWhiteboardInstanceComponent implements OnInit {\r\n  whiteboardTemplate?: WhiteboardTemplate;\r\n  form: FormGroup = this.fb.group({\r\n    name: ['', Validators.required],\r\n  });\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private processApiService: ProcessApiService,\r\n    private whiteboardInstanceService: WhiteboardInstanceService,\r\n    private whiteboardResolveService: WhiteboardResolveService,\r\n    private whiteboardTemplateService: WhiteboardTemplateService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.processApiService.loaded.subscribe(() =>\r\n      this.loadWhiteboardTemplate()\r\n    );\r\n  }\r\n\r\n  async submit(): Promise<void> {\r\n    if (\r\n      this.processApiService.stepInfo != null &&\r\n      this.whiteboardTemplate != null\r\n    ) {\r\n      const instance = await this.whiteboardInstanceService.addByTemplate(\r\n        this.nameControl.value,\r\n        this.whiteboardTemplate\r\n      );\r\n      this.whiteboardResolveService.resolve(\r\n        this.processApiService.stepInfo,\r\n        instance._id\r\n      );\r\n    }\r\n  }\r\n\r\n  private async loadWhiteboardTemplate(): Promise<void> {\r\n    this.whiteboardTemplate = await this.whiteboardTemplateService.get(\r\n      (\r\n        this.runningMethod.currentStep\r\n          .predefinedInput as CreateWhiteboardPredefinedInput\r\n      ).templateId!\r\n    );\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n\r\n  get nameControl(): FormControl {\r\n    return this.form.get('name') as FormControl;\r\n  }\r\n}\r\n","<app-api-navigation apiName=\"Edit Place\"></app-api-navigation>\r\n\r\n<app-step-errors></app-step-errors>\r\n\r\n<main\r\n  *ngIf=\"whiteboardInstance && runningMethod && isCorrectStep()\"\r\n  role=\"main\"\r\n>\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Place</h6>\r\n    <app-whiteboard-canvas\r\n      [whiteboardCanvas]=\"whiteboardInstance.whiteboard\"\r\n    ></app-whiteboard-canvas>\r\n    <button class=\"btn btn-primary mt-1\" (click)=\"saveWhiteboard()\">\r\n      Save Whiteboard\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"container\">\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <app-running-process-method-comments\r\n        [comments]=\"runningMethod.comments\"\r\n        (addComment)=\"addComment($event)\"\r\n        (updateComment)=\"updateComment($event)\"\r\n        (removeComment)=\"removeComment($event)\"\r\n      ></app-running-process-method-comments>\r\n    </div>\r\n\r\n    <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n      <h6 class=\"border-bottom border-gray pb-2\">Finish editing</h6>\r\n      <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n        Finish editing\r\n      </button>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { RunningProcessService } from '../../../development-process-registry/running-process/running-process.service';\r\nimport { Comment } from '../../../development-process-registry/running-process/comment';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { WhiteboardResolveService } from '../../whiteboard-resolve.service';\r\nimport { WhiteboardInstance } from '../../../whiteboard-meta-model/whiteboard-instance';\r\nimport { WhiteboardCanvasComponent } from '../../whiteboard-canvas/whiteboard-canvas.component';\r\nimport { WhiteboardCanvasControls } from '../../whiteboard-canvas/whiteboard-canvas-controls';\r\nimport { WhiteboardInstanceService } from '../../../whiteboard-meta-model/whiteboard-instance.service';\r\nimport { WhiteboardInstanceLoaderService } from '../../shared/whiteboard-instance-loader.service';\r\nimport { WhiteboardEditComponent } from '../../shared/whiteboard-edit-component';\r\n\r\n@Component({\r\n  selector: 'app-edit-whiteboard-instance',\r\n  templateUrl: './edit-whiteboard-instance.component.html',\r\n  styleUrls: ['./edit-whiteboard-instance.component.css'],\r\n  providers: [ProcessApiService, WhiteboardInstanceLoaderService],\r\n})\r\nexport class EditWhiteboardInstanceComponent\r\n  implements WhiteboardEditComponent\r\n{\r\n  @ViewChild(WhiteboardCanvasComponent)\r\n  whiteboardCanvasControls!: WhiteboardCanvasControls;\r\n\r\n  private changesSaved = false;\r\n\r\n  constructor(\r\n    private processApiService: ProcessApiService,\r\n    private runningProcessService: RunningProcessService,\r\n    private whiteboardInstanceLoaderService: WhiteboardInstanceLoaderService,\r\n    private whiteboardInstanceService: WhiteboardInstanceService,\r\n    private whiteboardResolveService: WhiteboardResolveService\r\n  ) {}\r\n\r\n  async addComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.addComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async updateComment(comment: Comment): Promise<void> {\r\n    await this.runningProcessService.updateComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      comment\r\n    );\r\n  }\r\n\r\n  async removeComment(commentId: string): Promise<void> {\r\n    await this.runningProcessService.removeComment(\r\n      this.runningProcess._id,\r\n      this.runningMethod.executionId,\r\n      commentId\r\n    );\r\n  }\r\n\r\n  async finish(): Promise<void> {\r\n    if (await this.whiteboardChanged()) {\r\n      await this.saveWhiteboard();\r\n      this.changesSaved = true;\r\n    }\r\n    if (this.whiteboardInstance != null) {\r\n      this.whiteboardResolveService.resolve(\r\n        this.processApiService.stepInfo,\r\n        this.whiteboardInstance._id\r\n      );\r\n    }\r\n  }\r\n\r\n  async saveWhiteboard(): Promise<void> {\r\n    if (\r\n      this.whiteboardInstance != null &&\r\n      this.runningMethod != null &&\r\n      this.isCorrectStep()\r\n    ) {\r\n      const whiteboard = this.whiteboardCanvasControls.save();\r\n      await this.whiteboardInstanceService.saveWhiteboardCanvas(\r\n        this.whiteboardInstance._id,\r\n        whiteboard\r\n      );\r\n    }\r\n  }\r\n\r\n  get whiteboardInstance(): WhiteboardInstance | undefined {\r\n    return this.whiteboardInstanceLoaderService.whiteboardInstance;\r\n  }\r\n\r\n  private get runningProcess(): RunningProcess {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.processApiService.isCorrectStep();\r\n  }\r\n\r\n  async whiteboardChanged(): Promise<boolean> {\r\n    if (this.changesSaved) {\r\n      return false;\r\n    }\r\n    if (\r\n      this.whiteboardCanvasControls != null &&\r\n      this.whiteboardInstance != null\r\n    ) {\r\n      return (\r\n        this.whiteboardCanvasControls.save() !==\r\n        this.whiteboardInstance.whiteboard\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","<ng-container [formGroup]=\"formGroup\">\r\n  <div class=\"form-group form-row\">\r\n    <label for=\"templateSelector\" class=\"col-sm-6 col-form-label\"\r\n      >Whiteboard Template</label\r\n    >\r\n    <div class=\"col-sm-6\">\r\n      <select\r\n        id=\"templateSelector\"\r\n        formControlName=\"templateId\"\r\n        class=\"form-control\"\r\n        [class.is-invalid]=\"\r\n          templateIdControl.invalid && templateIdControl.touched\r\n        \"\r\n      >\r\n        <option\r\n          *ngFor=\"let template of whiteboardTemplates\"\r\n          [ngValue]=\"template._id\"\r\n        >\r\n          {{ template.name }}\r\n        </option>\r\n        <option *ngIf=\"whiteboardTemplates == null\">Loading...</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { BmProcess } from '../../../development-process-registry/bm-process/bm-process';\r\nimport { FormControl, FormGroup } from '@angular/forms';\r\nimport { DbId } from '../../../database/database-entry';\r\nimport { WhiteboardTemplateService } from '../../../whiteboard-meta-model/whiteboard-template.service';\r\nimport { WhiteboardTemplateEntry } from '../../../whiteboard-meta-model/whiteboard-template';\r\nimport { ConfigurationFormComponent } from '../../../development-process-registry/module-api/configuration-form-component';\r\n\r\nexport interface CreateWhiteboardPredefinedInput {\r\n  templateId: DbId | undefined;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-select-whiteboard-template-configuration',\r\n  templateUrl: './select-whiteboard-template-configuration.component.html',\r\n  styleUrls: ['./select-whiteboard-template-configuration.component.css'],\r\n})\r\nexport class SelectWhiteboardTemplateConfigurationComponent\r\n  implements OnInit, ConfigurationFormComponent\r\n{\r\n  bmProcess!: BmProcess;\r\n  formGroup!: FormGroup;\r\n\r\n  whiteboardTemplates?: WhiteboardTemplateEntry[];\r\n\r\n  constructor(private whiteboardTemplateService: WhiteboardTemplateService) {}\r\n\r\n  ngOnInit(): void {\r\n    void this.loadWhiteboardTemplates();\r\n  }\r\n\r\n  async loadWhiteboardTemplates(): Promise<void> {\r\n    this.whiteboardTemplates = await this.whiteboardTemplateService.getList();\r\n  }\r\n\r\n  get templateIdControl(): FormControl {\r\n    return this.formGroup.get('templateId') as FormControl;\r\n  }\r\n}\r\n","<app-api-navigation\r\n  *ngIf=\"runningProcess != null\"\r\n  apiName=\"View Whiteboard\"\r\n></app-api-navigation>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\" *ngIf=\"runningProcess == null\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a\r\n      *ngIf=\"artifact != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts']\"\r\n    >\r\n      Concrete Artifacts\r\n    </a>\r\n    <a\r\n      *ngIf=\"artifact != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts', 'detail', artifact._id]\"\r\n    >\r\n      {{ artifact.identifier }}\r\n    </a>\r\n    <a\r\n      *ngIf=\"artifact != null && version != null\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"['/', 'concreteArtifacts', 'detail', artifact._id]\"\r\n    >\r\n      Version #{{ version + 1 }}\r\n    </a>\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\" [queryParams]=\"queryParams\">\r\n      View Whiteboard\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"whiteboardInstance\" role=\"main\">\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Place</h6>\r\n    <app-whiteboard-canvas-view\r\n      [whiteboardCanvas]=\"whiteboardInstance.whiteboard\"\r\n    ></app-whiteboard-canvas-view>\r\n  </div>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\" *ngIf=\"isCorrectStep()\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Finish viewing</h6>\r\n    <button class=\"btn btn-sm btn-primary btn-block\" (click)=\"finish()\">\r\n      Finish viewing\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { WhiteboardInstance } from '../../../whiteboard-meta-model/whiteboard-instance';\r\nimport { WhiteboardInstanceLoaderService } from '../../shared/whiteboard-instance-loader.service';\r\nimport { ProcessApiService } from '../../../development-process-registry/module-api/process-api.service';\r\nimport { RunningMethod } from '../../../development-process-registry/running-process/running-method';\r\nimport { WhiteboardResolveService } from '../../whiteboard-resolve.service';\r\nimport { RunningArtifact } from '../../../development-process-registry/running-process/running-artifact';\r\nimport { Subscription } from 'rxjs';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { ConcreteArtifactService } from '../../../development-process-registry/running-process/concrete-artifact.service';\r\nimport { RunningProcess } from '../../../development-process-registry/running-process/running-process';\r\n\r\n@Component({\r\n  selector: 'app-view-whiteboard-instance',\r\n  templateUrl: './view-whiteboard-instance.component.html',\r\n  styleUrls: ['./view-whiteboard-instance.component.css'],\r\n  providers: [ProcessApiService, WhiteboardInstanceLoaderService],\r\n})\r\nexport class ViewWhiteboardInstanceComponent implements OnInit, OnDestroy {\r\n  artifact?: RunningArtifact;\r\n  version?: number;\r\n\r\n  private querySubscription?: Subscription;\r\n\r\n  constructor(\r\n    private concreteArtifactService: ConcreteArtifactService,\r\n    private processApiService: ProcessApiService,\r\n    private route: ActivatedRoute,\r\n    private whiteboardInstanceLoaderService: WhiteboardInstanceLoaderService,\r\n    private whiteboardResolveService: WhiteboardResolveService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.querySubscription = this.route.queryParamMap.subscribe(\r\n      async (params) => {\r\n        if (params.has('artifactId')) {\r\n          this.artifact = await this.concreteArtifactService.get(\r\n            params.get('artifactId')!\r\n          );\r\n          if (params.has('versionId')) {\r\n            this.version = +params.get('versionId')!;\r\n          } else {\r\n            this.version = undefined;\r\n          }\r\n        } else {\r\n          this.artifact = undefined;\r\n          this.version = undefined;\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.querySubscription) {\r\n      this.querySubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  finish(): void {\r\n    if (this.whiteboardInstance != null) {\r\n      this.whiteboardResolveService.resolve(\r\n        this.processApiService.stepInfo,\r\n        this.whiteboardInstance._id\r\n      );\r\n    }\r\n  }\r\n\r\n  get whiteboardInstance(): WhiteboardInstance | undefined {\r\n    return this.whiteboardInstanceLoaderService.whiteboardInstance;\r\n  }\r\n\r\n  get runningProcess(): RunningProcess | undefined {\r\n    return this.processApiService.runningProcess;\r\n  }\r\n\r\n  get runningMethod(): RunningMethod | undefined {\r\n    return this.processApiService.runningMethod;\r\n  }\r\n\r\n  isCorrectStep(): boolean {\r\n    return this.runningMethod != null && this.processApiService.isCorrectStep();\r\n  }\r\n\r\n  get queryParams(): { artifactId: string } | undefined {\r\n    if (this.artifact != null) {\r\n      return {\r\n        artifactId: this.artifact._id,\r\n      };\r\n    }\r\n    return undefined;\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Component({\r\n  selector: 'app-confirm-leave-whiteboard-modal',\r\n  templateUrl: './confirm-leave-whiteboard-modal.component.html',\r\n  styleUrls: ['./confirm-leave-whiteboard-modal.component.css'],\r\n})\r\nexport class ConfirmLeaveWhiteboardModalComponent {\r\n  constructor(private activeModal: NgbActiveModal) {}\r\n\r\n  close(): void {\r\n    this.activeModal.dismiss();\r\n  }\r\n\r\n  leave(): void {\r\n    this.activeModal.close(false);\r\n  }\r\n\r\n  saveChanges(): void {\r\n    this.activeModal.close(true);\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h4 class=\"modal-title\">You have unsaved changes in the whiteboard</h4>\r\n</div>\r\n<div class=\"modal-body\">\r\n  You can stay on this page, discard them or save them.\r\n</div>\r\n<div class=\"modal-footer\">\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"close()\">\r\n    Close\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"leave()\">\r\n    Leave without saving\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-primary\" (click)=\"saveChanges()\">\r\n    Save changes\r\n  </button>\r\n</div>\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  ActivatedRouteSnapshot,\r\n  CanDeactivate,\r\n  RouterStateSnapshot,\r\n} from '@angular/router';\r\nimport { WhiteboardEditComponent } from './whiteboard-edit-component';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ConfirmLeaveWhiteboardModalComponent } from '../confirm-leave-whiteboard-modal/confirm-leave-whiteboard-modal.component';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class WhiteboardChangeGuard\r\n  implements CanDeactivate<WhiteboardEditComponent>\r\n{\r\n  constructor(private modalService: NgbModal) {}\r\n\r\n  async canDeactivate(\r\n    component: WhiteboardEditComponent,\r\n    currentRoute: ActivatedRouteSnapshot,\r\n    currentState: RouterStateSnapshot,\r\n    nextState?: RouterStateSnapshot\r\n  ): Promise<boolean> {\r\n    const changed = await component.whiteboardChanged();\r\n    if (changed) {\r\n      const modal = this.modalService.open(\r\n        ConfirmLeaveWhiteboardModalComponent,\r\n        {\r\n          size: 'lg',\r\n        }\r\n      );\r\n      try {\r\n        const result = await modal.result;\r\n        if (result) {\r\n          await component.saveWhiteboard();\r\n        }\r\n        return true;\r\n      } catch {\r\n        return false;\r\n      }\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { DbId } from '../../database/database-entry';\r\nimport { WhiteboardInstance } from '../../whiteboard-meta-model/whiteboard-instance';\r\nimport { WhiteboardInstanceService } from '../../whiteboard-meta-model/whiteboard-instance.service';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class WhiteboardInstanceLoaderService extends ElementLoaderService {\r\n  whiteboardInstance?: WhiteboardInstance;\r\n\r\n  constructor(\r\n    private whiteboardInstanceService: WhiteboardInstanceService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const whiteboardInstanceId = paramMap.get('id')!;\r\n    this.changesFeed = this.whiteboardInstanceService\r\n      .getChangesFeed(whiteboardInstanceId)\r\n      .subscribe(() => this.loadWhiteboardInstance(whiteboardInstanceId));\r\n    void this.loadWhiteboardInstance(whiteboardInstanceId);\r\n  }\r\n\r\n  private async loadWhiteboardInstance(\r\n    whiteboardInstanceId: DbId\r\n  ): Promise<void> {\r\n    this.whiteboardInstance = await this.whiteboardInstanceService.get(\r\n      whiteboardInstanceId\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ElementLoaderService } from '../../database/element-loader.service';\r\nimport { ActivatedRoute, ParamMap } from '@angular/router';\r\nimport { WhiteboardTemplate } from '../../whiteboard-meta-model/whiteboard-template';\r\nimport { WhiteboardTemplateService } from '../../whiteboard-meta-model/whiteboard-template.service';\r\nimport { DbId } from '../../database/database-entry';\r\n\r\n@Injectable()\r\nexport class WhiteboardTemplateLoaderService extends ElementLoaderService {\r\n  whiteboardTemplate?: WhiteboardTemplate;\r\n\r\n  constructor(\r\n    private whiteboardTemplateService: WhiteboardTemplateService,\r\n    route: ActivatedRoute\r\n  ) {\r\n    super(route);\r\n  }\r\n\r\n  protected initParams(paramMap: ParamMap): void {\r\n    const whiteboardTemplateId = paramMap.get('id')!;\r\n    this.changesFeed = this.whiteboardTemplateService\r\n      .getChangesFeed(whiteboardTemplateId)\r\n      .subscribe(() => this.loadWhiteboardTemplate(whiteboardTemplateId));\r\n    void this.loadWhiteboardTemplate(whiteboardTemplateId);\r\n  }\r\n\r\n  private async loadWhiteboardTemplate(\r\n    whiteboardTemplateId: DbId\r\n  ): Promise<void> {\r\n    this.whiteboardTemplate = await this.whiteboardTemplateService.get(\r\n      whiteboardTemplateId\r\n    );\r\n    this.elementLoaded();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ModuleApiService } from '../development-process-registry/module-api/module-api-service';\r\nimport { MethodExecutionInput } from '../development-process-registry/module-api/method-execution-input';\r\nimport { StepInfo } from '../development-process-registry/module-api/step-info';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class WhiteboardApiService implements ModuleApiService {\r\n  constructor() {}\r\n\r\n  createWhiteboard(input: MethodExecutionInput): void {\r\n    const stepInfo = this.getStepInfo(input);\r\n    void input.router.navigate(['whiteboard', 'instance', 'create'], {\r\n      queryParams: stepInfo,\r\n    });\r\n  }\r\n\r\n  editWhiteboard(input: MethodExecutionInput): void {\r\n    const stepInfo: StepInfo = this.getStepInfo(input);\r\n    const reference: ArtifactDataReference =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['whiteboard', 'instance', reference.id, 'edit'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  viewWhiteboard(input: MethodExecutionInput): void {\r\n    const stepInfo: StepInfo = this.getStepInfo(input);\r\n    const reference: ArtifactDataReference =\r\n      input.inputStepArtifacts[0].data.data;\r\n    void input.router.navigate(\r\n      ['whiteboard', 'instance', reference.id, 'view'],\r\n      { queryParams: stepInfo }\r\n    );\r\n  }\r\n\r\n  executeMethod(methodName: string, input: MethodExecutionInput): void {\r\n    switch (methodName) {\r\n      case 'createWhiteboard':\r\n        this.createWhiteboard(input);\r\n        break;\r\n      case 'editWhiteboard':\r\n        this.editWhiteboard(input);\r\n        break;\r\n      case 'viewWhiteboard':\r\n        this.viewWhiteboard(input);\r\n        break;\r\n    }\r\n  }\r\n\r\n  private getStepInfo(input: MethodExecutionInput): StepInfo {\r\n    return {\r\n      step: input.runningMethod.currentStepNumber,\r\n      executionId: input.runningMethod.executionId,\r\n      runningProcessId: input.runningProcess._id,\r\n    };\r\n  }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  OnDestroy,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { fabric } from 'fabric';\r\nimport { WhiteboardCanvas } from '../../whiteboard-meta-model/whiteboard';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { WhiteboardCanvasService } from '../../whiteboard-meta-model/whiteboard-canvas.service';\r\n\r\n@Component({\r\n  selector: 'app-whiteboard-canvas-view',\r\n  templateUrl: './whiteboard-canvas-view.component.html',\r\n  styleUrls: ['./whiteboard-canvas-view.component.css'],\r\n})\r\nexport class WhiteboardCanvasViewComponent implements AfterViewInit, OnDestroy {\r\n  @Input() whiteboardCanvas!: WhiteboardCanvas;\r\n\r\n  @ViewChild('canvasElement') canvasElement!: ElementRef<HTMLCanvasElement>;\r\n  @ViewChild('canvasWrapper') canvasWrapper!: ElementRef<HTMLDivElement>;\r\n\r\n  private canvas!: fabric.Canvas;\r\n\r\n  private resizeSubscription?: Subscription;\r\n\r\n  private zoomValue: number = 1;\r\n  private lastMousePosition?: fabric.Point;\r\n  private moving: boolean = false;\r\n\r\n  constructor(private whiteboardCanvasService: WhiteboardCanvasService) {}\r\n\r\n  ngAfterViewInit(): void {\r\n    void this.initCanvas();\r\n    this.resizeSubscription = fromEvent(window, 'resize')\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(() => this.resize())\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.resizeSubscription != null) {\r\n      this.resizeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private async initCanvas(): Promise<void> {\r\n    this.canvas =\r\n      await this.whiteboardCanvasService.getReadonlyWhiteboardCanvas(\r\n        this.canvasElement.nativeElement,\r\n        this.whiteboardCanvas\r\n      );\r\n    this.resize();\r\n    this.canvas.on('mouse:move', (options) => this.mouseMove(options));\r\n    this.canvas.on('mouse:down', (options) => this.mouseDown(options));\r\n    this.canvas.on('mouse:up', () => this.mouseUp());\r\n  }\r\n\r\n  private resize(): void {\r\n    const newWidth = this.canvasWrapper.nativeElement.clientWidth;\r\n    this.canvas.setWidth(newWidth);\r\n    this.canvas.setHeight(newWidth / 3.5);\r\n    this.canvas.setZoom((newWidth * this.zoomValue) / 1140);\r\n  }\r\n\r\n  zoom(number: number): void {\r\n    this.zoomValue += number * 0.1;\r\n    this.resize();\r\n  }\r\n\r\n  zoomReset(): void {\r\n    this.zoomValue = 1;\r\n    this.resize();\r\n  }\r\n\r\n  private mouseMove(options: fabric.IEvent<MouseEvent>): void {\r\n    if (options.absolutePointer == null) {\r\n      return;\r\n    }\r\n    if (this.moving && this.lastMousePosition != null) {\r\n      const viewport = this.canvas.viewportTransform!;\r\n      viewport[4] += options.absolutePointer.x - this.lastMousePosition.x;\r\n      viewport[5] += options.absolutePointer.y - this.lastMousePosition.y;\r\n      this.canvas.setViewportTransform(viewport);\r\n    }\r\n  }\r\n\r\n  private mouseDown(options: fabric.IEvent<MouseEvent>): void {\r\n    if (options.absolutePointer != null) {\r\n      this.lastMousePosition = options.absolutePointer;\r\n      this.moving = true;\r\n    }\r\n  }\r\n\r\n  private mouseUp(): void {\r\n    this.moving = false;\r\n  }\r\n}\r\n","<div class=\"btn-group mb-1\" role=\"group\" aria-label=\"Zoom\">\r\n  <button type=\"button\" class=\"btn btn-light\" (click)=\"zoom(-1)\">\r\n    <i class=\"fas fa-minus fa-fw whiteboard-icon\"></i\r\n    ><span class=\"sr-only\">Zoom out</span>\r\n  </button>\r\n  <button type=\"button\" class=\"btn btn-light\" (click)=\"zoom(1)\">\r\n    <i class=\"fas fa-plus fa-fw whiteboard-icon\"></i\r\n    ><span class=\"sr-only\">Zoom in</span>\r\n  </button>\r\n  <button type=\"button\" class=\"ml-3 btn btn-light\" (click)=\"zoomReset()\">\r\n    <b>Reset zoom</b>\r\n  </button>\r\n</div>\r\n<div class=\"border\" #canvasWrapper>\r\n  <canvas #canvasElement></canvas>\r\n</div>\r\n","export interface ColorDefinition {\r\n  name: string;\r\n  value: string | undefined;\r\n  darker: string | undefined;\r\n}\r\n\r\nexport const noColor: ColorDefinition = {\r\n  name: 'no color',\r\n  value: undefined,\r\n  darker: undefined,\r\n};\r\n\r\nexport const colors: ColorDefinition[] = [\r\n  {\r\n    name: 'black',\r\n    value: '#000000',\r\n    darker: '#000000',\r\n  },\r\n  {\r\n    name: 'gray',\r\n    value: '#757575',\r\n    darker: '#363636',\r\n  },\r\n  {\r\n    name: 'white',\r\n    value: '#FFFFFF',\r\n    darker: '#BFBFBF',\r\n  },\r\n  {\r\n    name: 'yellow',\r\n    value: '#FFFFA5',\r\n    darker: '#E6E695',\r\n  },\r\n  {\r\n    name: 'blue',\r\n    value: '#58A7E0',\r\n    darker: '#3F78A1',\r\n  },\r\n  {\r\n    name: 'red',\r\n    value: '#E02E2B',\r\n    darker: '#A1211F',\r\n  },\r\n  {\r\n    name: 'green',\r\n    value: '#58E058',\r\n    darker: '#3FA13F',\r\n  },\r\n];\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { fabric } from 'fabric';\r\nimport { ColorDefinition, colors, noColor } from './color-definition';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { CanvasNote } from '../../whiteboard-meta-model/canvas-note';\r\n\r\nexport enum ColorControls {\r\n  FILL,\r\n  STROKE,\r\n}\r\n\r\n@Injectable()\r\nexport class ColorFormService implements OnDestroy {\r\n  private canvas?: fabric.Canvas;\r\n\r\n  colorForm: FormGroup = this.fb.group({\r\n    control: this.fb.control(ColorControls.FILL, Validators.required),\r\n    color: this.fb.control(undefined),\r\n  });\r\n\r\n  private colorFormSubscriptions: Subscription[] = [];\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  init(canvas: fabric.Canvas): void {\r\n    this.canvas = canvas;\r\n    this.colorFormSubscriptions.push(\r\n      this.colorControlControl.valueChanges.subscribe(() =>\r\n        this.updateColorForm()\r\n      )\r\n    );\r\n    this.colorFormSubscriptions.push(\r\n      this.colorControl.valueChanges\r\n        .pipe(filter((value) => value != null))\r\n        .subscribe((value: ColorDefinition) => this.setColor(value))\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.colorFormSubscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  updateColorForm(): void {\r\n    if (this.canvas != null) {\r\n      if (this.canvas.isDrawingMode) {\r\n        this.colorControl.setValue(\r\n          this.getColorFromValue(this.canvas.freeDrawingBrush.color)\r\n        );\r\n        return;\r\n      }\r\n      const objects = this.canvas.getActiveObjects();\r\n      if (objects.length === 0) {\r\n        this.colorControl.setValue(undefined);\r\n        return;\r\n      }\r\n      const colorControlValue = this.colorControlValue;\r\n      let key: 'fill' | 'stroke';\r\n      switch (colorControlValue) {\r\n        case ColorControls.STROKE:\r\n          key = 'stroke';\r\n          break;\r\n        case ColorControls.FILL:\r\n          key = 'fill';\r\n          break;\r\n        default:\r\n          this.colorControl.setValue(undefined);\r\n          return;\r\n      }\r\n      const firstObject = objects[0];\r\n      let colorValue: unknown;\r\n      if (\r\n        firstObject.type === 'textbox' &&\r\n        (firstObject as fabric.IText).isEditing\r\n      ) {\r\n        const text: fabric.IText = firstObject as fabric.IText;\r\n        const selectionStyles = text.getSelectionStyles();\r\n        if (selectionStyles.length === 0) {\r\n          this.colorControl.setValue(undefined);\r\n          return;\r\n        }\r\n        colorValue = selectionStyles[0][key];\r\n        for (const style of selectionStyles) {\r\n          if (colorValue !== style[key]) {\r\n            this.colorControl.setValue(undefined);\r\n            return;\r\n          }\r\n        }\r\n      } else {\r\n        colorValue = objects[0][key];\r\n        for (const object of objects) {\r\n          if (colorValue !== object[key]) {\r\n            this.colorControl.setValue(undefined);\r\n            return;\r\n          }\r\n        }\r\n      }\r\n      this.colorControl.setValue(this.getColorFromValue(colorValue));\r\n    } else {\r\n      throw new Error('ColorFormService not initialized');\r\n    }\r\n  }\r\n\r\n  private setColor(color: ColorDefinition): void {\r\n    if (this.canvas != null) {\r\n      if (this.canvas.isDrawingMode) {\r\n        this.canvas.freeDrawingBrush.color = color.value!;\r\n        return;\r\n      }\r\n      const objects = this.canvas.getActiveObjects();\r\n      for (const object of objects) {\r\n        if (object.type === 'canvasNote') {\r\n          const canvasNote = object as CanvasNote;\r\n          switch (this.colorControlValue) {\r\n            case ColorControls.FILL:\r\n              canvasNote.setFillColor(color.value, color.darker);\r\n              break;\r\n            case ColorControls.STROKE:\r\n              canvasNote.setStrokeColor(color.value);\r\n              break;\r\n          }\r\n        } else if (\r\n          object.type === 'textbox' &&\r\n          (object as fabric.IText).isEditing\r\n        ) {\r\n          const text: fabric.IText = object as fabric.IText;\r\n          switch (this.colorControlValue) {\r\n            case ColorControls.FILL:\r\n              text.setSelectionStyles({ fill: color.value });\r\n              break;\r\n            case ColorControls.STROKE:\r\n              text.setSelectionStyles({ stroke: color.value });\r\n              break;\r\n          }\r\n        } else {\r\n          switch (this.colorControlValue) {\r\n            case ColorControls.FILL:\r\n              object.set('fill', color.value);\r\n              break;\r\n            case ColorControls.STROKE:\r\n              object.set('stroke', color.value);\r\n              break;\r\n          }\r\n        }\r\n      }\r\n      this.canvas.renderAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the correct color definition or undefined from any value.\r\n   *\r\n   * @param colorValue the color value to check\r\n   * @return the color definition or undefined if no color definition was found\r\n   */\r\n  private getColorFromValue(colorValue: unknown): ColorDefinition | undefined {\r\n    if (typeof colorValue === 'string') {\r\n      return colors.find((color) => color.value === colorValue);\r\n    } else if (colorValue == null) {\r\n      return noColor;\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  private get colorControlControl(): FormControl {\r\n    return this.colorForm.get('control') as FormControl;\r\n  }\r\n\r\n  private get colorControlValue(): ColorControls {\r\n    return this.colorControlControl.value;\r\n  }\r\n\r\n  private get colorControl(): FormControl {\r\n    return this.colorForm.get('color') as FormControl;\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter, tap } from 'rxjs/operators';\r\n\r\nexport enum Controls {\r\n  VIEW,\r\n  MOVE,\r\n  DRAWING,\r\n  TEXT,\r\n  NOTE,\r\n  RECT,\r\n}\r\n\r\n@Injectable()\r\nexport class ControlFormService implements OnDestroy {\r\n  controlsForm: FormGroup = this.fb.group({\r\n    control: this.fb.control(Controls.VIEW, Validators.required),\r\n    colorMenu: this.fb.control(false, Validators.required),\r\n    fontMenu: this.fb.control(false, Validators.required),\r\n    propertiesMenu: this.fb.control(false, Validators.required),\r\n  });\r\n\r\n  private controlChangeSubscriptions: Subscription[] = [];\r\n\r\n  constructor(private fb: FormBuilder) {\r\n    this.init();\r\n  }\r\n\r\n  private init(): void {\r\n    this.controlChangeSubscriptions.push(\r\n      this.colorMenuControl.valueChanges\r\n        .pipe(\r\n          filter((value) => value),\r\n          tap(() => {\r\n            this.fontMenuControl.setValue(false);\r\n            this.propertiesMenuControl.setValue(false);\r\n          })\r\n        )\r\n        .subscribe()\r\n    );\r\n    this.controlChangeSubscriptions.push(\r\n      this.fontMenuControl.valueChanges\r\n        .pipe(\r\n          filter((value) => value),\r\n          tap(() => {\r\n            this.colorMenuControl.setValue(false);\r\n            this.propertiesMenuControl.setValue(false);\r\n          })\r\n        )\r\n        .subscribe()\r\n    );\r\n    this.controlChangeSubscriptions.push(\r\n      this.propertiesMenuControl.valueChanges\r\n        .pipe(\r\n          filter((value) => value),\r\n          tap(() => {\r\n            this.colorMenuControl.setValue(false);\r\n            this.fontMenuControl.setValue(false);\r\n          })\r\n        )\r\n        .subscribe()\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.controlChangeSubscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  get controlControl(): FormControl {\r\n    return this.controlsForm.get('control') as FormControl;\r\n  }\r\n\r\n  get controlValue(): Controls {\r\n    return this.controlControl.value;\r\n  }\r\n\r\n  private get colorMenuControl(): FormControl {\r\n    return this.controlsForm.get('colorMenu') as FormControl;\r\n  }\r\n\r\n  get colorMenuShown(): boolean {\r\n    return this.colorMenuControl.value;\r\n  }\r\n\r\n  private get fontMenuControl(): FormControl {\r\n    return this.controlsForm.get('fontMenu') as FormControl;\r\n  }\r\n\r\n  get fontMenuShown(): boolean {\r\n    return this.fontMenuControl.value;\r\n  }\r\n\r\n  private get propertiesMenuControl(): FormControl {\r\n    return this.controlsForm.get('propertiesMenu') as FormControl;\r\n  }\r\n\r\n  get propertiesMenuShown(): boolean {\r\n    return this.propertiesMenuControl.value;\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { fabric } from 'fabric';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class PropertiesFormService implements OnDestroy {\r\n  private canvas?: fabric.Canvas;\r\n\r\n  propertiesForm: FormGroup = this.fb.group({\r\n    width: this.fb.control(1, [Validators.required, Validators.min(0)]),\r\n  });\r\n\r\n  private propertiesFormSubscriptions: Subscription[] = [];\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  init(canvas: fabric.Canvas): void {\r\n    this.canvas = canvas;\r\n    this.propertiesFormSubscriptions.push(\r\n      this.widthControl.valueChanges\r\n        .pipe(filter((value) => value != null && value > 0))\r\n        .subscribe((value) => this.setWidth(value))\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.propertiesFormSubscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the properties form after the selection changed\r\n   * or the control changed\r\n   */\r\n  updatePropertiesForm(): void {\r\n    if (this.canvas != null) {\r\n      if (this.canvas.isDrawingMode) {\r\n        this.widthControl.setValue(this.canvas.freeDrawingBrush.width);\r\n        return;\r\n      }\r\n      const objects = this.canvas.getActiveObjects();\r\n      if (objects.length === 0) {\r\n        this.widthControl.setValue(undefined);\r\n        return;\r\n      }\r\n      const firstObject = objects[0];\r\n      let strokeWidth: number | undefined;\r\n      if (\r\n        firstObject.type === 'textbox' &&\r\n        (firstObject as fabric.IText).isEditing\r\n      ) {\r\n        const text: fabric.IText = firstObject as fabric.IText;\r\n        const selectionStyles = text.getSelectionStyles();\r\n        if (selectionStyles.length === 0) {\r\n          this.widthControl.setValue(undefined);\r\n          return;\r\n        }\r\n        strokeWidth = selectionStyles[0]['strokeWidth'];\r\n        for (const style of selectionStyles) {\r\n          if (strokeWidth !== style['strokeWidth']) {\r\n            this.widthControl.setValue(undefined);\r\n            return;\r\n          }\r\n        }\r\n      } else {\r\n        strokeWidth = firstObject.get('strokeWidth');\r\n        for (const object of objects) {\r\n          if (strokeWidth !== object.get('strokeWidth')) {\r\n            this.widthControl.setValue(undefined);\r\n            return;\r\n          }\r\n        }\r\n      }\r\n      this.widthControl.setValue(strokeWidth);\r\n    } else {\r\n      throw new Error('PropertiesFormService not initialized');\r\n    }\r\n  }\r\n\r\n  private setWidth(width: number): void {\r\n    if (this.canvas != null) {\r\n      if (this.canvas.isDrawingMode) {\r\n        this.canvas.freeDrawingBrush.width = width;\r\n        return;\r\n      }\r\n      const objects = this.canvas.getActiveObjects();\r\n      for (const object of objects) {\r\n        if (object.type === 'textbox' && (object as fabric.IText).isEditing) {\r\n          const text: fabric.IText = object as fabric.IText;\r\n          text.setSelectionStyles({ strokeWidth: width });\r\n        } else {\r\n          object.set('strokeWidth', width);\r\n        }\r\n      }\r\n      this.canvas.renderAll();\r\n    }\r\n  }\r\n\r\n  private get widthControl(): FormControl {\r\n    return this.propertiesForm.get('width') as FormControl;\r\n  }\r\n\r\n  get widthControlValue(): number {\r\n    return this.widthControl.value;\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  FormBuilder,\r\n  FormControl,\r\n  FormGroup,\r\n  Validators,\r\n} from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport { fabric } from 'fabric';\r\n\r\ntype TextFormValue = {\r\n  bold: boolean;\r\n  italic: boolean;\r\n  underline: boolean;\r\n  strikethrough: boolean;\r\n};\r\n\r\n@Injectable()\r\nexport class TextFormService implements OnDestroy {\r\n  private canvas?: fabric.Canvas;\r\n\r\n  textForm: FormGroup = this.fb.group({\r\n    bold: this.fb.control(false, Validators.required),\r\n    italic: this.fb.control(false, Validators.required),\r\n    underline: this.fb.control(false, Validators.required),\r\n    strikethrough: this.fb.control(false, Validators.required),\r\n  });\r\n\r\n  private textFormSubscriptions: Subscription[] = [];\r\n\r\n  constructor(private fb: FormBuilder) {}\r\n\r\n  init(canvas: fabric.Canvas): void {\r\n    this.canvas = canvas;\r\n    this.textFormSubscriptions.push(\r\n      this.boldControl.valueChanges.subscribe((value) => this.setBold(value))\r\n    );\r\n    this.textFormSubscriptions.push(\r\n      this.italicControl.valueChanges.subscribe((value) =>\r\n        this.setItalic(value)\r\n      )\r\n    );\r\n    this.textFormSubscriptions.push(\r\n      this.underlineControl.valueChanges.subscribe((value) =>\r\n        this.setUnderline(value)\r\n      )\r\n    );\r\n    this.textFormSubscriptions.push(\r\n      this.strikethroughControl.valueChanges.subscribe((value) =>\r\n        this.setStrikethrough(value)\r\n      )\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.textFormSubscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the text form after the selection changed\r\n   */\r\n  updateTextForm(): void {\r\n    if (this.canvas != null) {\r\n      const objects = this.canvas\r\n        .getActiveObjects()\r\n        .filter((object) => object.type === 'textbox');\r\n      const values: TextFormValue = {\r\n        bold: true,\r\n        italic: true,\r\n        underline: true,\r\n        strikethrough: true,\r\n      };\r\n      if (objects.length === 0) {\r\n        values.bold = false;\r\n        values.italic = false;\r\n        values.underline = false;\r\n        values.strikethrough = false;\r\n      }\r\n      for (const object of objects) {\r\n        const text: fabric.IText = object as fabric.IText;\r\n        if (text.isEditing) {\r\n          const selectionStyles = text.getSelectionStyles();\r\n          if (selectionStyles.length === 0) {\r\n            values.bold = false;\r\n            values.italic = false;\r\n            values.underline = false;\r\n            values.strikethrough = false;\r\n          }\r\n          for (const style of selectionStyles) {\r\n            if (!('fontWeight' in style) || style['fontWeight'] !== 'bold') {\r\n              values.bold = false;\r\n            }\r\n            if (!('fontStyle' in style) || style['fontStyle'] !== 'italic') {\r\n              values.italic = false;\r\n            }\r\n            if (!('underline' in style) || !style['underline']) {\r\n              values.underline = false;\r\n            }\r\n            if (!('linethrough' in style) || !style['linethrough']) {\r\n              values.strikethrough = false;\r\n            }\r\n          }\r\n        } else {\r\n          if (text.get('fontWeight') !== 'bold') {\r\n            values.bold = false;\r\n          }\r\n          if (text.get('fontStyle') !== 'italic') {\r\n            values.italic = false;\r\n          }\r\n          if (!text.get('underline')) {\r\n            values.underline = false;\r\n          }\r\n          if (!text.get('linethrough')) {\r\n            values.strikethrough = false;\r\n          }\r\n        }\r\n      }\r\n      this.textForm.setValue(values, { emitEvent: false });\r\n    } else {\r\n      throw new Error('TextFormService not initialized');\r\n    }\r\n  }\r\n\r\n  private setBold(bold: boolean): void {\r\n    const value = bold ? 'bold' : 'normal';\r\n    this.setTextStyle('fontWeight', value);\r\n  }\r\n\r\n  private setItalic(italic: boolean): void {\r\n    const value = italic ? 'italic' : 'normal';\r\n    this.setTextStyle('fontStyle', value);\r\n  }\r\n\r\n  private setUnderline(underline: boolean): void {\r\n    this.setTextStyle('underline', underline);\r\n  }\r\n\r\n  private setStrikethrough(strikethrough: boolean): void {\r\n    this.setTextStyle('linethrough', strikethrough);\r\n  }\r\n\r\n  private setTextStyle(\r\n    key: keyof fabric.IText,\r\n    value: string | boolean | undefined\r\n  ): void {\r\n    if (this.canvas != null) {\r\n      const activeObjects = this.canvas.getActiveObjects();\r\n      for (const activeObject of activeObjects) {\r\n        if (activeObject.type === 'textbox') {\r\n          const text: fabric.IText = activeObject as fabric.IText;\r\n          if (text.isEditing) {\r\n            text.setSelectionStyles({ [key]: value });\r\n          } else {\r\n            text.set(key, value);\r\n            text.setSelectionStyles({ [key]: value }, 0, text.text!.length);\r\n          }\r\n        }\r\n      }\r\n      this.canvas.renderAll();\r\n    }\r\n  }\r\n\r\n  private get boldControl(): FormControl {\r\n    return this.textForm.get('bold') as FormControl;\r\n  }\r\n\r\n  private get italicControl(): FormControl {\r\n    return this.textForm.get('italic') as FormControl;\r\n  }\r\n\r\n  private get underlineControl(): FormControl {\r\n    return this.textForm.get('underline') as FormControl;\r\n  }\r\n\r\n  private get strikethroughControl(): FormControl {\r\n    return this.textForm.get('strikethrough') as FormControl;\r\n  }\r\n}\r\n","<div class=\"d-flex mb-1 justify-content-center\">\r\n  <div class=\"d-flex flex-1\">\r\n    <div class=\"btn-group\" role=\"group\" aria-label=\"Zoom\">\r\n      <button type=\"button\" class=\"btn btn-light\" (click)=\"zoom(-1)\">\r\n        <i class=\"fas fa-minus fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">Zoom out</span>\r\n      </button>\r\n      <button type=\"button\" class=\"btn btn-light\" (click)=\"zoom(1)\">\r\n        <i class=\"fas fa-plus fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">Zoom in</span>\r\n      </button>\r\n      <button type=\"button\" class=\"ml-3 btn btn-light\" (click)=\"zoomReset()\">\r\n        <b>Reset zoom</b>\r\n      </button>\r\n    </div>\r\n  </div>\r\n  <div class=\"d-flex\">\r\n    <form [formGroup]=\"controlsForm\">\r\n      <div\r\n        class=\"btn-group btn-group-toggle\"\r\n        ngbRadioGroup\r\n        name=\"control\"\r\n        formControlName=\"control\"\r\n      >\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.VIEW\" />\r\n          <i class=\"fas fa-mouse-pointer fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">View</span>\r\n        </label>\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.MOVE\" />\r\n          <i class=\"fas fa-arrows-alt fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Move screen</span>\r\n        </label>\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.DRAWING\" />\r\n          <i class=\"fas fa-pen fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Free drawing</span>\r\n        </label>\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.TEXT\" />\r\n          <i class=\"fas fa-paragraph fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Text</span>\r\n        </label>\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.NOTE\" />\r\n          <i class=\"far fa-sticky-note fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Note</span>\r\n        </label>\r\n        <label ngbButtonLabel class=\"btn-light\">\r\n          <input ngbButton type=\"radio\" [value]=\"controls.RECT\" />\r\n          <i class=\"far fa-square fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Rectangle</span>\r\n        </label>\r\n      </div>\r\n      <div class=\"ml-3 btn-group btn-group-toggle\">\r\n        <label class=\"btn-light\" ngbButtonLabel>\r\n          <input type=\"checkbox\" formControlName=\"colorMenu\" ngbButton />\r\n          <i class=\"fas fa-palette fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Color</span>\r\n        </label>\r\n        <label class=\"btn-light\" ngbButtonLabel>\r\n          <input type=\"checkbox\" formControlName=\"fontMenu\" ngbButton />\r\n          <i class=\"fas fa-font fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Font</span>\r\n        </label>\r\n        <label class=\"btn-light\" ngbButtonLabel>\r\n          <input type=\"checkbox\" formControlName=\"propertiesMenu\" ngbButton />\r\n          <i class=\"fas fa-sliders-h fa-fw whiteboard-icon\"></i\r\n          ><span class=\"sr-only\">Properties</span>\r\n        </label>\r\n      </div>\r\n    </form>\r\n  </div>\r\n  <div class=\"flex-1 d-flex\">\r\n    <button class=\"ml-auto btn btn-light\" (click)=\"delete()\">\r\n      <i class=\"fas fa-trash fa-fw whiteboard-icon\"></i\r\n      ><span class=\"sr-only\">Delete</span>\r\n    </button>\r\n  </div>\r\n</div>\r\n<div *ngIf=\"colorMenuShown\" class=\"d-flex mb-1 justify-content-center\">\r\n  <form [formGroup]=\"colorForm\">\r\n    <div\r\n      *ngIf=\"!isDrawingMode\"\r\n      class=\"btn-group btn-group-toggle mr-3\"\r\n      ngbRadioGroup\r\n      name=\"control\"\r\n      formControlName=\"control\"\r\n    >\r\n      <label ngbButtonLabel class=\"btn-light\">\r\n        <input ngbButton type=\"radio\" [value]=\"colorControls.FILL\" />\r\n        <i class=\"fas fa-square fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">fill</span>\r\n      </label>\r\n      <label ngbButtonLabel class=\"btn-light\">\r\n        <input ngbButton type=\"radio\" [value]=\"colorControls.STROKE\" />\r\n        <i class=\"far fa-square fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">outline</span>\r\n      </label>\r\n    </div>\r\n    <div\r\n      class=\"btn-group btn-group-toggle\"\r\n      ngbRadioGroup\r\n      name=\"color\"\r\n      formControlName=\"color\"\r\n    >\r\n      <label *ngIf=\"!isDrawingMode\" ngbButtonLabel class=\"btn-light\">\r\n        <input ngbButton type=\"radio\" [value]=\"noColor\" />\r\n        <i class=\"fas fa-tint-slash fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">{{ noColor.name }}</span>\r\n      </label>\r\n      <label *ngFor=\"let color of colors\" ngbButtonLabel class=\"btn-light\">\r\n        <input ngbButton type=\"radio\" [value]=\"color\" />\r\n        <i\r\n          [style.color]=\"color.value\"\r\n          class=\"fas fa-square fa-fw whiteboard-icon\"\r\n        ></i\r\n        ><span class=\"sr-only\">{{ color.name }}</span>\r\n      </label>\r\n    </div>\r\n  </form>\r\n</div>\r\n<div *ngIf=\"fontMenuShown\" class=\"d-flex mb-1 justify-content-center\">\r\n  <form [formGroup]=\"textForm\">\r\n    <div class=\"btn-group btn-group-toggle\">\r\n      <label class=\"btn-light\" ngbButtonLabel>\r\n        <input type=\"checkbox\" formControlName=\"bold\" ngbButton />\r\n        <i class=\"fas fa-bold fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">bold</span>\r\n      </label>\r\n      <label class=\"btn-light\" ngbButtonLabel>\r\n        <input type=\"checkbox\" formControlName=\"italic\" ngbButton />\r\n        <i class=\"fas fa-italic fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">italic</span>\r\n      </label>\r\n      <label class=\"btn-light\" ngbButtonLabel>\r\n        <input type=\"checkbox\" formControlName=\"underline\" ngbButton />\r\n        <i class=\"fas fa-underline fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">underline</span>\r\n      </label>\r\n      <label class=\"btn-light\" ngbButtonLabel>\r\n        <input type=\"checkbox\" formControlName=\"strikethrough\" ngbButton />\r\n        <i class=\"fas fa-strikethrough fa-fw whiteboard-icon\"></i\r\n        ><span class=\"sr-only\">strikethrough</span>\r\n      </label>\r\n    </div>\r\n  </form>\r\n</div>\r\n<div *ngIf=\"propertiesMenuShown\" class=\"d-flex mb-1 justify-content-center\">\r\n  <form [formGroup]=\"propertiesForm\">\r\n    <div class=\"form-group mb-0\">\r\n      <label for=\"widthInput\">Line Width</label>\r\n      <input\r\n        id=\"widthInput\"\r\n        class=\"form-control\"\r\n        type=\"number\"\r\n        formControlName=\"width\"\r\n        min=\"0\"\r\n        step=\"0.1\"\r\n        placeholder=\"e.g., 1\"\r\n      />\r\n    </div>\r\n  </form>\r\n</div>\r\n<div class=\"border\" #canvasWrapper>\r\n  <canvas #canvasElement></canvas>\r\n</div>\r\n","import {\r\n  AfterViewInit,\r\n  Component,\r\n  ElementRef,\r\n  HostListener,\r\n  Input,\r\n  OnDestroy,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { fabric } from 'fabric';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { debounceTime, tap } from 'rxjs/operators';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { WhiteboardCanvas } from '../../whiteboard-meta-model/whiteboard';\r\nimport { WhiteboardCanvasControls } from './whiteboard-canvas-controls';\r\nimport { CanvasNote } from '../../whiteboard-meta-model/canvas-note';\r\nimport { WhiteboardCanvasService } from '../../whiteboard-meta-model/whiteboard-canvas.service';\r\nimport { ColorDefinition, colors, noColor } from './color-definition';\r\nimport { TextFormService } from './text-form.service';\r\nimport { ColorControls, ColorFormService } from './color-form.service';\r\nimport { ControlFormService, Controls } from './control-form.service';\r\nimport { PropertiesFormService } from './properties-form.service';\r\n\r\n@Component({\r\n  selector: 'app-whiteboard-canvas',\r\n  templateUrl: './whiteboard-canvas.component.html',\r\n  styleUrls: ['./whiteboard-canvas.component.css'],\r\n  providers: [\r\n    ColorFormService,\r\n    ControlFormService,\r\n    PropertiesFormService,\r\n    TextFormService,\r\n  ],\r\n})\r\nexport class WhiteboardCanvasComponent\r\n  implements WhiteboardCanvasControls, AfterViewInit, OnDestroy\r\n{\r\n  @Input() whiteboardCanvas!: WhiteboardCanvas;\r\n\r\n  @ViewChild('canvasElement') canvasElement!: ElementRef<HTMLCanvasElement>;\r\n  @ViewChild('canvasWrapper') canvasWrapper!: ElementRef<HTMLDivElement>;\r\n\r\n  private canvas!: fabric.Canvas;\r\n\r\n  private resizeSubscription?: Subscription;\r\n  private controlChangeSubscription?: Subscription;\r\n\r\n  private zoomValue: number = 1;\r\n  private lastMousePosition?: fabric.Point;\r\n  private moving: boolean = false;\r\n  private adding: boolean = false;\r\n\r\n  constructor(\r\n    private colorFormService: ColorFormService,\r\n    private controlFormService: ControlFormService,\r\n    private propertiesFormService: PropertiesFormService,\r\n    private textFormService: TextFormService,\r\n    private whiteboardCanvasService: WhiteboardCanvasService\r\n  ) {}\r\n\r\n  ngAfterViewInit(): void {\r\n    void this.initCanvas();\r\n    this.controlChangeSubscription =\r\n      this.controlFormService.controlControl.valueChanges\r\n        .pipe(tap((value) => this.controlChange(value)))\r\n        .subscribe();\r\n    this.resizeSubscription = fromEvent(window, 'resize')\r\n      .pipe(\r\n        debounceTime(300),\r\n        tap(() => this.resize())\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.resizeSubscription != null) {\r\n      this.resizeSubscription.unsubscribe();\r\n    }\r\n    if (this.canvas != null) {\r\n      this.canvas.dispose();\r\n    }\r\n  }\r\n\r\n  private async initCanvas(): Promise<void> {\r\n    this.canvas = await this.whiteboardCanvasService.getWhiteboardCanvas(\r\n      this.canvasElement.nativeElement,\r\n      this.whiteboardCanvas\r\n    );\r\n    this.canvas.freeDrawingBrush.color = colors[0].value!;\r\n    this.canvas.freeDrawingBrush.width =\r\n      this.propertiesFormService.widthControlValue;\r\n    this.resize();\r\n    this.colorFormService.init(this.canvas);\r\n    this.textFormService.init(this.canvas);\r\n    this.propertiesFormService.init(this.canvas);\r\n    this.canvas.on('mouse:move', (options) => this.mouseMove(options));\r\n    this.canvas.on('mouse:down', (options) => this.mouseDown(options));\r\n    this.canvas.on('mouse:up', (options) => this.mouseUp(options));\r\n    this.canvas.on('selection:created', () => this.updateForms());\r\n    this.canvas.on('selection:updated', () => this.updateForms());\r\n    this.canvas.on('selection:cleared', () => this.updateForms());\r\n    this.canvas.on('text:selection:changed', () => this.updateForms());\r\n  }\r\n\r\n  private resize(): void {\r\n    const newWidth = this.canvasWrapper.nativeElement.clientWidth;\r\n    this.canvas.setWidth(newWidth);\r\n    this.canvas.setHeight(newWidth / 3.5);\r\n    this.canvas.setZoom((newWidth * this.zoomValue) / 1140);\r\n  }\r\n\r\n  /**\r\n   * Update the different forms if the selection changes\r\n   */\r\n  private updateForms(): void {\r\n    this.colorFormService.updateColorForm();\r\n    this.textFormService.updateTextForm();\r\n    this.propertiesFormService.updatePropertiesForm();\r\n  }\r\n\r\n  private controlChange(controlValue: Controls): void {\r\n    this.canvas.selection = true;\r\n    this.canvas.isDrawingMode = false;\r\n    switch (controlValue) {\r\n      case Controls.VIEW:\r\n        this.canvas.defaultCursor = 'default';\r\n        break;\r\n      case Controls.MOVE:\r\n        this.canvas.defaultCursor = 'move';\r\n        this.canvas.selection = false;\r\n        break;\r\n      case Controls.DRAWING:\r\n        this.canvas.isDrawingMode = true;\r\n        break;\r\n      case Controls.TEXT:\r\n      case Controls.NOTE:\r\n      case Controls.RECT:\r\n        this.canvas.defaultCursor = 'cell';\r\n        break;\r\n    }\r\n    this.colorFormService.updateColorForm();\r\n    this.propertiesFormService.updatePropertiesForm();\r\n  }\r\n\r\n  private mouseMove(options: fabric.IEvent<MouseEvent>): void {\r\n    if (options.absolutePointer == null) {\r\n      return;\r\n    }\r\n    if (\r\n      this.moving &&\r\n      this.lastMousePosition != null &&\r\n      this.controlFormService.controlValue === Controls.MOVE\r\n    ) {\r\n      const viewport = this.canvas.viewportTransform!;\r\n      viewport[4] += options.absolutePointer.x - this.lastMousePosition.x;\r\n      viewport[5] += options.absolutePointer.y - this.lastMousePosition.y;\r\n      this.canvas.setViewportTransform(viewport);\r\n    }\r\n  }\r\n\r\n  private mouseDown(options: fabric.IEvent<MouseEvent>): void {\r\n    if (options.target != null || options.absolutePointer == null) {\r\n      return;\r\n    }\r\n    switch (this.controlFormService.controlValue) {\r\n      case Controls.TEXT:\r\n        const text = new fabric.Textbox('Text', {\r\n          top: options.absolutePointer.y,\r\n          left: options.absolutePointer.x,\r\n          width: 50,\r\n        });\r\n        this.canvas.add(text);\r\n        this.controlFormService.controlControl.setValue(Controls.VIEW);\r\n        break;\r\n      case Controls.NOTE:\r\n        this.canvas.add(this.createNote(options.absolutePointer));\r\n        this.controlFormService.controlControl.setValue(Controls.VIEW);\r\n        break;\r\n      case Controls.RECT:\r\n        this.lastMousePosition = options.absolutePointer;\r\n        this.adding = true;\r\n        break;\r\n      case Controls.MOVE:\r\n        this.lastMousePosition = options.absolutePointer;\r\n        this.moving = true;\r\n        break;\r\n    }\r\n  }\r\n\r\n  private mouseUp(options: fabric.IEvent<MouseEvent>): void {\r\n    if (\r\n      this.adding &&\r\n      options.absolutePointer != null &&\r\n      this.lastMousePosition != null\r\n    ) {\r\n      let position: {\r\n        left: number;\r\n        top: number;\r\n        width: number;\r\n        height: number;\r\n      };\r\n      if (options.absolutePointer.distanceFrom(this.lastMousePosition) < 10) {\r\n        position = {\r\n          left: options.absolutePointer.x - 10,\r\n          top: options.absolutePointer.y - 10,\r\n          width: 20,\r\n          height: 20,\r\n        };\r\n      } else {\r\n        position = {\r\n          left: Math.min(this.lastMousePosition.x, options.absolutePointer.x),\r\n          top: Math.min(this.lastMousePosition.y, options.absolutePointer.y),\r\n          width: Math.abs(this.lastMousePosition.x - options.absolutePointer.x),\r\n          height: Math.abs(\r\n            this.lastMousePosition.y - options.absolutePointer.y\r\n          ),\r\n        };\r\n      }\r\n      switch (this.controlFormService.controlValue) {\r\n        case Controls.RECT:\r\n          const rect = new fabric.Rect({\r\n            ...position,\r\n            fill: colors[1].value,\r\n          });\r\n          this.canvas.add(rect);\r\n          break;\r\n      }\r\n      this.controlFormService.controlControl.setValue(Controls.VIEW);\r\n    }\r\n    this.moving = false;\r\n    this.adding = false;\r\n  }\r\n\r\n  @HostListener('window:keydown', ['$event'])\r\n  private keydown(event: KeyboardEvent): void {\r\n    switch (event.key) {\r\n      case 'Delete':\r\n      case 'Backspace':\r\n        // TODO look for interference with other input fields first\r\n        break;\r\n    }\r\n  }\r\n\r\n  zoom(number: number): void {\r\n    this.zoomValue += number * 0.1;\r\n    this.resize();\r\n  }\r\n\r\n  zoomReset(): void {\r\n    this.zoomValue = 1;\r\n    this.resize();\r\n  }\r\n\r\n  /**\r\n   * Deletes currently selected object\r\n   */\r\n  delete(): void {\r\n    this.canvas.remove(...this.canvas.getActiveObjects());\r\n    this.canvas.discardActiveObject();\r\n  }\r\n\r\n  save(): string {\r\n    return this.whiteboardCanvasService.getWhiteboardCanvasSerialization(\r\n      this.canvas\r\n    );\r\n  }\r\n\r\n  get colorMenuShown(): boolean {\r\n    return this.controlFormService.colorMenuShown;\r\n  }\r\n\r\n  get fontMenuShown(): boolean {\r\n    return this.controlFormService.fontMenuShown;\r\n  }\r\n\r\n  get propertiesMenuShown(): boolean {\r\n    return this.controlFormService.propertiesMenuShown;\r\n  }\r\n\r\n  get controls(): typeof Controls {\r\n    return Controls;\r\n  }\r\n\r\n  get colorControls(): typeof ColorControls {\r\n    return ColorControls;\r\n  }\r\n\r\n  get colors(): ColorDefinition[] {\r\n    return colors;\r\n  }\r\n\r\n  get noColor(): ColorDefinition {\r\n    return noColor;\r\n  }\r\n\r\n  get isDrawingMode(): boolean {\r\n    return !!this.canvas?.isDrawingMode;\r\n  }\r\n\r\n  get controlsForm(): FormGroup {\r\n    return this.controlFormService.controlsForm;\r\n  }\r\n\r\n  get colorForm(): FormGroup {\r\n    return this.colorFormService.colorForm;\r\n  }\r\n\r\n  get textForm(): FormGroup {\r\n    return this.textFormService.textForm;\r\n  }\r\n\r\n  get propertiesForm(): FormGroup {\r\n    return this.propertiesFormService.propertiesForm;\r\n  }\r\n\r\n  private createNote(point: fabric.Point): fabric.Group {\r\n    return new CanvasNote({\r\n      color: colors[3].value,\r\n      darkerColor: colors[3].darker,\r\n      point,\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RunningProcessService } from '../development-process-registry/running-process/running-process.service';\r\nimport { StepInfo } from '../development-process-registry/module-api/step-info';\r\nimport {\r\n  ArtifactData,\r\n  ArtifactDataReference,\r\n  ArtifactDataType,\r\n} from '../development-process-registry/running-process/artifact-data';\r\nimport { DbId } from '../database/database-entry';\r\nimport { WhiteboardInstance } from '../whiteboard-meta-model/whiteboard-instance';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class WhiteboardResolveService {\r\n  constructor(private runningProcessService: RunningProcessService) {}\r\n\r\n  resolve(stepInfo: StepInfo, whiteboardInstanceId: DbId): void {\r\n    const placeData = this.getPlaceData(whiteboardInstanceId);\r\n    void this.runningProcessService.finishExecuteStep(stepInfo, {\r\n      outputArtifactData: [placeData],\r\n    });\r\n  }\r\n\r\n  private getPlaceData(whiteboardInstanceId: DbId): ArtifactData {\r\n    const reference: ArtifactDataReference = {\r\n      id: whiteboardInstanceId,\r\n      type: WhiteboardInstance.typeName,\r\n    };\r\n    return new ArtifactData(undefined, {\r\n      data: reference,\r\n      type: ArtifactDataType.REFERENCE,\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { AuthGuard } from '../database/auth.guard';\r\nimport { WhiteboardTemplatesComponent } from './whiteboard-templates/whiteboard-templates.component';\r\nimport { WhiteboardTemplateComponent } from './whiteboard-template/whiteboard-template.component';\r\nimport { CreateWhiteboardInstanceComponent } from './api/create-whiteboard-instance/create-whiteboard-instance.component';\r\nimport { EditWhiteboardInstanceComponent } from './api/edit-whiteboard-instance/edit-whiteboard-instance.component';\r\nimport { ViewWhiteboardInstanceComponent } from './api/view-whiteboard-instance/view-whiteboard-instance.component';\r\nimport { WhiteboardChangeGuard } from './shared/whiteboard-change.guard';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'whiteboard',\r\n    canActivate: [AuthGuard],\r\n    children: [\r\n      {\r\n        path: 'templates',\r\n        children: [\r\n          { path: '', component: WhiteboardTemplatesComponent },\r\n          {\r\n            path: ':id',\r\n            component: WhiteboardTemplateComponent,\r\n            canDeactivate: [WhiteboardChangeGuard],\r\n          },\r\n        ],\r\n      },\r\n      {\r\n        path: 'instance',\r\n        children: [\r\n          { path: 'create', component: CreateWhiteboardInstanceComponent },\r\n          {\r\n            path: ':id',\r\n            children: [\r\n              {\r\n                path: 'edit',\r\n                component: EditWhiteboardInstanceComponent,\r\n                canDeactivate: [WhiteboardChangeGuard],\r\n              },\r\n              { path: 'view', component: ViewWhiteboardInstanceComponent },\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class WhiteboardRoutingModule {}\r\n","<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link\" [routerLink]=\"['/', 'whiteboard', 'templates']\">\r\n      Whiteboard Templates\r\n    </a>\r\n    <a\r\n      *ngIf=\"whiteboardTemplate != null\"\r\n      class=\"nav-link active\"\r\n      [routerLink]=\"[]\"\r\n    >\r\n      {{ whiteboardTemplate.name }}\r\n    </a>\r\n  </nav>\r\n</div>\r\n\r\n<main *ngIf=\"whiteboardTemplate != null\" role=\"main\">\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2\">Whiteboard Template</h6>\r\n    <app-whiteboard-canvas\r\n      [whiteboardCanvas]=\"whiteboardTemplate.whiteboard\"\r\n    ></app-whiteboard-canvas>\r\n    <button class=\"btn btn-primary mt-1\" (click)=\"saveWhiteboard()\">\r\n      Save Whiteboard\r\n    </button>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { WhiteboardTemplateLoaderService } from '../shared/whiteboard-template-loader.service';\r\nimport { WhiteboardTemplate } from '../../whiteboard-meta-model/whiteboard-template';\r\nimport { WhiteboardCanvasComponent } from '../whiteboard-canvas/whiteboard-canvas.component';\r\nimport { WhiteboardCanvasControls } from '../whiteboard-canvas/whiteboard-canvas-controls';\r\nimport { WhiteboardTemplateService } from '../../whiteboard-meta-model/whiteboard-template.service';\r\nimport { WhiteboardEditComponent } from '../shared/whiteboard-edit-component';\r\n\r\n@Component({\r\n  selector: 'app-whiteboard-template',\r\n  templateUrl: './whiteboard-template.component.html',\r\n  styleUrls: ['./whiteboard-template.component.css'],\r\n  providers: [WhiteboardTemplateLoaderService],\r\n})\r\nexport class WhiteboardTemplateComponent implements WhiteboardEditComponent {\r\n  @ViewChild(WhiteboardCanvasComponent)\r\n  whiteboardCanvasControls!: WhiteboardCanvasControls;\r\n\r\n  constructor(\r\n    private whiteboardTemplateLoaderService: WhiteboardTemplateLoaderService,\r\n    private whiteboardTemplateService: WhiteboardTemplateService\r\n  ) {}\r\n\r\n  async saveWhiteboard(): Promise<void> {\r\n    if (this.whiteboardTemplate != null) {\r\n      const whiteboard = this.whiteboardCanvasControls.save();\r\n      await this.whiteboardTemplateService.saveWhiteboardCanvas(\r\n        this.whiteboardTemplate._id,\r\n        whiteboard\r\n      );\r\n    }\r\n  }\r\n\r\n  get whiteboardTemplate(): WhiteboardTemplate | undefined {\r\n    return this.whiteboardTemplateLoaderService.whiteboardTemplate;\r\n  }\r\n\r\n  async whiteboardChanged(): Promise<boolean> {\r\n    if (this.whiteboardTemplate != null) {\r\n      return (\r\n        this.whiteboardCanvasControls.save() !==\r\n        this.whiteboardTemplate.whiteboard\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","<ng-template #deleteWhiteboardTemplateModal let-d=\"dismiss\" let-c=\"close\">\r\n  <app-delete-modal\r\n    (dismiss)=\"d()\"\r\n    (delete)=\"deleteWhiteboardTemplate(modalWhiteboardTemplate._id); c()\"\r\n  >\r\n    <div modalTitle>\r\n      Delete Whiteboard Template {{ modalWhiteboardTemplate.name }}\r\n    </div>\r\n    You are deleting the whiteboard template\r\n    {{ modalWhiteboardTemplate.name }}. This can not be undone. This action will\r\n    not delete the whiteboard template from whiteboard instances that are using\r\n    it.\r\n  </app-delete-modal>\r\n</ng-template>\r\n\r\n<div class=\"nav-scroller bg-white shadow-sm\">\r\n  <nav class=\"nav nav-underline\">\r\n    <a class=\"nav-link active\" [routerLink]=\"[]\">Whiteboard Templates</a>\r\n    <a\r\n      *ngFor=\"let whiteboardTemplate of whiteboardTemplatesList\"\r\n      class=\"nav-link\"\r\n      [routerLink]=\"[whiteboardTemplate._id]\"\r\n      >{{ whiteboardTemplate.name }}</a\r\n    >\r\n  </nav>\r\n</div>\r\n\r\n<main role=\"main\" class=\"container\">\r\n  <div class=\"my-3 alert alert-info\" role=\"alert\">\r\n    Create Whiteboard Templates to use them for Whiteboard Instances\r\n  </div>\r\n\r\n  <app-list-wrapper\r\n    listTitle=\"Whiteboard Templates\"\r\n    [reloading]=\"reloading\"\r\n    [loading]=\"loading\"\r\n    [noResults]=\"noResults\"\r\n  >\r\n    <div noResults>No Whiteboard Templates defined.</div>\r\n    <ul results class=\"list-group\">\r\n      <li\r\n        class=\"list-group-item\"\r\n        *ngFor=\"let whiteboardTemplate of whiteboardTemplatesList\"\r\n      >\r\n        <app-results-list-item\r\n          [viewLink]=\"[whiteboardTemplate._id]\"\r\n          (delete)=\"openDeleteWhiteboardTemplateModal(whiteboardTemplate)\"\r\n        >\r\n          <ng-container itemTitle>\r\n            {{ whiteboardTemplate.name }}\r\n          </ng-container>\r\n          <ng-container itemDescription>\r\n            {{ whiteboardTemplate.description }}\r\n          </ng-container>\r\n          <app-author-info\r\n            [author]=\"whiteboardTemplate.author\"\r\n          ></app-author-info>\r\n        </app-results-list-item>\r\n      </li>\r\n    </ul>\r\n  </app-list-wrapper>\r\n\r\n  <div class=\"my-3 p-3 bg-white rounded shadow-sm\">\r\n    <h6 class=\"border-bottom border-gray pb-2 mb-0\">Add Whiteboard Template</h6>\r\n    <div class=\"text-muted pt-3\">\r\n      <form\r\n        [formGroup]=\"whiteboardTemplateForm\"\r\n        (ngSubmit)=\"addWhiteboardTemplate(whiteboardTemplateForm)\"\r\n      >\r\n        <div class=\"form-group row\">\r\n          <label for=\"name\" class=\"col-sm-4 col-form-label\"\r\n            >Whiteboard Template Name</label\r\n          >\r\n          <div class=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n              class=\"form-control\"\r\n              id=\"name\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"form-group row\">\r\n          <div class=\"col-sm-12\">\r\n            <button\r\n              type=\"submit\"\r\n              class=\"btn btn-sm btn-dark btn-block\"\r\n              [disabled]=\"!whiteboardTemplateForm.valid\"\r\n            >\r\n              Add Whiteboard Template\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</main>\r\n","import { Component, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { NgbModal, NgbModalRef } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ELEMENT_SERVICE, ListService } from '../../shared/list.service';\r\nimport {\r\n  WhiteboardTemplate,\r\n  WhiteboardTemplateEntry,\r\n  WhiteboardTemplateInit,\r\n} from '../../whiteboard-meta-model/whiteboard-template';\r\nimport { WhiteboardTemplateService } from '../../whiteboard-meta-model/whiteboard-template.service';\r\n\r\n@Component({\r\n  selector: 'app-whiteboard-templates',\r\n  templateUrl: './whiteboard-templates.component.html',\r\n  styleUrls: ['./whiteboard-templates.component.css'],\r\n  providers: [\r\n    ListService,\r\n    { provide: ELEMENT_SERVICE, useExisting: WhiteboardTemplateService },\r\n  ],\r\n})\r\nexport class WhiteboardTemplatesComponent {\r\n  whiteboardTemplateForm = this.fb.group({\r\n    name: this.fb.control('', Validators.required),\r\n  });\r\n\r\n  modalWhiteboardTemplate?: WhiteboardTemplateEntry;\r\n  private modalReference?: NgbModalRef;\r\n\r\n  @ViewChild('deleteWhiteboardTemplateModal', { static: true })\r\n  deleteWhiteboardTemplateModal: unknown;\r\n\r\n  constructor(\r\n    private listService: ListService<\r\n      WhiteboardTemplate,\r\n      WhiteboardTemplateInit\r\n    >,\r\n    private fb: FormBuilder,\r\n    private modalService: NgbModal,\r\n    private whiteboardTemplateService: WhiteboardTemplateService\r\n  ) {}\r\n\r\n  openDeleteWhiteboardTemplateModal(\r\n    whiteboardTemplate: WhiteboardTemplateEntry\r\n  ): void {\r\n    this.modalWhiteboardTemplate = whiteboardTemplate;\r\n    this.modalReference = this.modalService.open(\r\n      this.deleteWhiteboardTemplateModal,\r\n      {\r\n        size: 'lg',\r\n      }\r\n    );\r\n  }\r\n\r\n  async deleteWhiteboardTemplate(id: string): Promise<void> {\r\n    await this.listService.delete(id);\r\n  }\r\n\r\n  async addWhiteboardTemplate(\r\n    whiteboardTemplateForm: FormGroup\r\n  ): Promise<void> {\r\n    await this.listService.add(\r\n      this.whiteboardTemplateService.getWhiteboardTemplateInitialization(\r\n        whiteboardTemplateForm.value.name\r\n      )\r\n    );\r\n    this.whiteboardTemplateForm.reset();\r\n  }\r\n\r\n  get whiteboardTemplatesList(): WhiteboardTemplateEntry[] {\r\n    return this.listService.elements;\r\n  }\r\n\r\n  get noResults(): boolean {\r\n    return this.listService.noResults;\r\n  }\r\n\r\n  get loading(): boolean {\r\n    return this.listService.loading;\r\n  }\r\n\r\n  get reloading(): boolean {\r\n    return this.listService.reloading;\r\n  }\r\n}\r\n","import { APP_INITIALIZER, NgModule } from '@angular/core';\r\n\r\nimport { WhiteboardRoutingModule } from './whiteboard-routing.module';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { WhiteboardCanvasComponent } from './whiteboard-canvas/whiteboard-canvas.component';\r\nimport { WhiteboardTemplatesComponent } from './whiteboard-templates/whiteboard-templates.component';\r\nimport { WhiteboardTemplateComponent } from './whiteboard-template/whiteboard-template.component';\r\nimport { CreateWhiteboardInstanceComponent } from './api/create-whiteboard-instance/create-whiteboard-instance.component';\r\nimport { SelectWhiteboardTemplateConfigurationComponent } from './api/select-whiteboard-template-configuration/select-whiteboard-template-configuration.component';\r\nimport { WhiteboardService } from './whiteboard.service';\r\nimport { EditWhiteboardInstanceComponent } from './api/edit-whiteboard-instance/edit-whiteboard-instance.component';\r\nimport { WhiteboardCanvasViewComponent } from './whiteboard-canvas-view/whiteboard-canvas-view.component';\r\nimport { ViewWhiteboardInstanceComponent } from './api/view-whiteboard-instance/view-whiteboard-instance.component';\r\nimport { ConfirmLeaveWhiteboardModalComponent } from './confirm-leave-whiteboard-modal/confirm-leave-whiteboard-modal.component';\r\n\r\n@NgModule({\r\n  providers: [\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: (whiteboardService: WhiteboardService) => (): void =>\r\n        whiteboardService.init(),\r\n      deps: [WhiteboardService],\r\n      multi: true,\r\n    },\r\n  ],\r\n  declarations: [\r\n    WhiteboardCanvasComponent,\r\n    WhiteboardTemplatesComponent,\r\n    WhiteboardTemplateComponent,\r\n    CreateWhiteboardInstanceComponent,\r\n    SelectWhiteboardTemplateConfigurationComponent,\r\n    EditWhiteboardInstanceComponent,\r\n    WhiteboardCanvasViewComponent,\r\n    ViewWhiteboardInstanceComponent,\r\n    ConfirmLeaveWhiteboardModalComponent,\r\n  ],\r\n  imports: [SharedModule, WhiteboardRoutingModule],\r\n})\r\nexport class WhiteboardModule {}\r\n","import { Injectable } from '@angular/core';\r\nimport { ModuleService } from '../development-process-registry/module-api/module.service';\r\nimport { Module } from '../development-process-registry/module-api/module';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { WhiteboardApiService } from './whiteboard-api.service';\r\nimport { WhiteboardMetaModelService } from '../whiteboard-meta-model/whiteboard-meta-model.service';\r\nimport { ArtifactDataReference } from '../development-process-registry/running-process/artifact-data';\r\nimport { Router } from '@angular/router';\r\nimport { Reference } from '../development-process-registry/meta-model-definition';\r\nimport {\r\n  CreateWhiteboardPredefinedInput,\r\n  SelectWhiteboardTemplateConfigurationComponent,\r\n} from './api/select-whiteboard-template-configuration/select-whiteboard-template-configuration.component';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class WhiteboardService {\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private moduleService: ModuleService,\r\n    private whiteboardApiService: WhiteboardApiService,\r\n    private whiteboardMetaModelService: WhiteboardMetaModelService\r\n  ) {}\r\n\r\n  init(): void {\r\n    const module = new Module();\r\n    module.list = 'Whiteboard Tools';\r\n    module.name = 'Whiteboard Module';\r\n    this.addMethods(module);\r\n    module.service = this.whiteboardApiService;\r\n    this.moduleService.registerModule(module);\r\n    console.log('Registered Whiteboard Module');\r\n    this.whiteboardMetaModelService.registerViewMethod(\r\n      this.viewWhiteboardInstance\r\n    );\r\n    console.log(\r\n      'Registered Whiteboard Module as view method for whiteboard instances'\r\n    );\r\n  }\r\n\r\n  private addMethods(module: Module): void {\r\n    const self = this;\r\n    module.addMethod({\r\n      name: 'createWhiteboard',\r\n      description: 'Creates a whiteboard instance',\r\n      input: [],\r\n      output: [this.whiteboardMetaModelService.whiteboardMetaModelIdentifier],\r\n      configurationFormComponent:\r\n        SelectWhiteboardTemplateConfigurationComponent,\r\n      createConfigurationForm(\r\n        predefinedInput: CreateWhiteboardPredefinedInput | undefined\r\n      ): FormGroup {\r\n        if (predefinedInput == null) {\r\n          predefinedInput = {\r\n            templateId: undefined,\r\n          };\r\n        }\r\n        return self.fb.group({\r\n          templateId: [predefinedInput.templateId, Validators.required],\r\n        });\r\n      },\r\n      equalPredefinedInput(\r\n        predefinedInputA: CreateWhiteboardPredefinedInput | undefined,\r\n        predefinedInputB: CreateWhiteboardPredefinedInput | undefined\r\n      ): boolean {\r\n        if (predefinedInputA == null && predefinedInputB == null) {\r\n          return true;\r\n        }\r\n        if (predefinedInputA == null || predefinedInputB == null) {\r\n          return false;\r\n        }\r\n        return predefinedInputA.templateId === predefinedInputB.templateId;\r\n      },\r\n    });\r\n    module.addMethod({\r\n      name: 'editWhiteboard',\r\n      description: 'Edit a Whiteboard',\r\n      input: [this.whiteboardMetaModelService.whiteboardMetaModelIdentifier],\r\n      output: [this.whiteboardMetaModelService.whiteboardMetaModelIdentifier],\r\n    });\r\n    module.addMethod({\r\n      name: 'viewWhiteboard',\r\n      description: 'View a Whiteboard',\r\n      input: [this.whiteboardMetaModelService.whiteboardMetaModelIdentifier],\r\n      output: [this.whiteboardMetaModelService.whiteboardMetaModelIdentifier],\r\n    });\r\n  }\r\n\r\n  async viewWhiteboardInstance(\r\n    model: ArtifactDataReference,\r\n    router: Router,\r\n    reference: Reference\r\n  ): Promise<void> {\r\n    let queryParams: {\r\n      runningProcessId?: string;\r\n      executionId?: string;\r\n      artifactId?: string;\r\n      versionId?: number;\r\n    };\r\n    switch (reference.referenceType) {\r\n      case 'Process':\r\n        queryParams = {\r\n          runningProcessId: reference.runningProcessId,\r\n        };\r\n        break;\r\n      case 'Method':\r\n        queryParams = {\r\n          runningProcessId: reference.runningProcessId,\r\n          executionId: reference.executionId,\r\n        };\r\n        break;\r\n      case 'Artifact':\r\n        queryParams = {\r\n          artifactId: reference.artifactId,\r\n          versionId: reference.versionId,\r\n        };\r\n        break;\r\n    }\r\n    await router.navigate(['whiteboard', 'instance', model.id, 'view'], {\r\n      queryParams,\r\n    });\r\n  }\r\n}\r\n","// Automatically generated file\r\nexport const version = '1.0.3';\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false,\r\n  localDatabase: true,\r\n  exampleData: true,\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\r\n","import db from './db.json';\r\n\r\nexport default [...db.docs];\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic()\r\n  .bootstrapModule(AppModule)\r\n  .catch((err) => console.error(err));\r\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */"]}